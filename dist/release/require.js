var requirejs,require,define;(function(e){function a(e,t){var n,r,i,o,u,a,f,l,c,h,p=t&&t.split("/"),d=s.map,v=d&&d["*"]||{};if(e&&e.charAt(0)==="."&&t){p=p.slice(0,p.length-1),e=p.concat(e.split("/"));for(l=0;l<e.length;l+=1){h=e[l];if(h===".")e.splice(l,1),l-=1;else if(h===".."){if(l===1&&(e[2]===".."||e[0]===".."))return!0;l>0&&(e.splice(l-1,2),l-=2)}}e=e.join("/")}if((p||v)&&d){n=e.split("/");for(l=n.length;l>0;l-=1){r=n.slice(0,l).join("/");if(p)for(c=p.length;c>0;c-=1){i=d[p.slice(0,c).join("/")];if(i){i=i[r];if(i){o=i,u=l;break}}}if(o)break;!a&&v&&v[r]&&(a=v[r],f=l)}!o&&a&&(o=a,u=f),o&&(n.splice(0,u,o),e=n.join("/"))}return e}function f(t,r){return function(){return n.apply(e,u.call(arguments,0).concat([t,r]))}}function l(e){return function(t){return a(t,e)}}function c(e){return function(t){r[e]=t}}function h(n){if(i.hasOwnProperty(n)){var s=i[n];delete i[n],o[n]=!0,t.apply(e,s)}if(!r.hasOwnProperty(n))throw new Error("No "+n);return r[n]}function p(e,t){var n,r,i=e.indexOf("!");return i!==-1?(n=a(e.slice(0,i),t),e=e.slice(i+1),r=h(n),r&&r.normalize?e=r.normalize(e,l(t)):e=a(e,t)):e=a(e,t),{f:n?n+"!"+e:e,n:e,p:r}}function d(e){return function(){return s&&s.config&&s.config[e]||{}}}var t,n,r={},i={},s={},o={},u=[].slice;t=function(t,n,s,u){var a,l,v,m,g,y=[],b;u=u||t;if(typeof s=="function"){n=!n.length&&s.length?["require","exports","module"]:n;for(g=0;g<n.length;g+=1){m=p(n[g],u),l=m.f;if(l==="require")y[g]=f(t);else if(l==="exports")y[g]=r[t]={},b=!0;else if(l==="module")a=y[g]={id:t,uri:"",exports:r[t],config:d(t)};else if(r.hasOwnProperty(l)||i.hasOwnProperty(l))y[g]=h(l);else if(m.p)m.p.load(m.n,f(u,!0),c(l),{}),y[g]=r[l];else if(!o[l])throw new Error(t+" missing "+l)}v=s.apply(r[t],y);if(t)if(a&&a.exports!==e&&a.exports!==r[t])r[t]=a.exports;else if(v!==e||!b)r[t]=v}else t&&(r[t]=s)},requirejs=require=n=function(r,i,o,u,a){return typeof r=="string"?h(p(r,i).f):(r.splice||(s=r,i.splice?(r=i,i=o,o=null):r=e),i=i||function(){},typeof o=="function"&&(o=u,u=a),u?t(e,r,i,o):setTimeout(function(){t(e,r,i,o)},15),n)},n.config=function(e){return s=e,n},define=function(e,t,n){t.splice||(n=t,t=[]),i[e]=[e,t,n]},define.amd={jQuery:!0}})(),this.JST=this.JST||{},this.JST["app/templates/bgb-end.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="<div class='END-inner-wrapper'>\n  <div class='headline'>\n    THANKS FOR WATCHING<br/>ROUGH RIDE\n  </div>\n\n  <div class='end-actions'>\n    <a href='http://blackgoldboom.com' target='blank' class='visit-link'>VISIT THE FULL SITE FOR<br/>MORE STORIES</a>\n    <a class='share-icons' target='blank' href='http://twitter.com/share?text=Check%20out%20Black%20Gold%20Boom&url=http://www.blackgoldboom.org/'><img src='assets/img/twitter-large.png'/></a>\n        \n    <a class='share-icons' target='blank' href='http://www.facebook.com/sharer.php?u=http://www.blackgoldboom.com/'><img src='assets/img/facebook-large.png'/></a>\n    <a class='share-icons' target='blank' href='mailto:your-friend@example.com?subject=Black%20Gold%20Boom!&body=http://www.blackgoldboom.com/'><img src='assets/img/email-large.png'/></a>\n  </div>\n</div>\n<div class='END-footer'>\n  Brought to you by Prairie Public, Zeega, and Localore, a national initiative produced by AIR, with financial support from the Corporation for Public Broadcasting, the Wyncote Foundation, the John D. and Catherine T. MacArthur Foundation, and the National Endowment for the Arts.\n</div>\n<div class=\"END-bg\" style=\"background: url("+rndImgUrl+'); background-position: 50% 50%; background-repeat: no-repeat no-repeat; background-attachment: fixed; -webkit-background-size: cover; -moz-background-size: cover; -o-background-size: cover; background-size: cover;"></div>\n';return __p},this.JST["app/templates/bgbloader.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+='<div class="loader-content">\n	<div class="logo">\n		<div class="logo-splat"></div>\n        <div class="logo-splat-under"></div>\n	</div>\n	<div class="intro-text">\n		<p>Rumble. Screech. Bam.</p>\n		<p>For the next 20 minutes or so, you\'ll see and hear stories from North Dakota oil country.</p>\n		<p>This interactive documentary has 9 chapters, each with its own video. Plus there are songs, data and tips from people working there.</p>\n		<p>Let\'s go.</p>\n		<div class=\'fullscreen-loader\'>\n			GET THE BEST EXPERIENCE IN\n			<a href=\'#\' class=\'fullscreen\'> <img src="assets/img/fullscreen-icon.png" width="12" height="12"> FULL SCREEN</strong>\n		</div>\n	</div>\n</div>\n<div class="loader-logo-shelf">\n	<a href="http://www.prairiepublic.org/" target="_blank"><img src="assets/img/logos/logo-prarie-public.png"  width="86" height="66" alt="Prarie Public"></a>\n	<a href="http://2belowzero.org/" target="_blank"><img src="assets/img/logos/logo-2-below-zero.png" width="71" height="62" alt="2 below zero"></a>\n	<a href="http://www.airmediaworks.org/" target="_blank"><img src="assets/img/logos/logo-air.png" width="61" height="39" alt="AIR"></a>\n	<a href="http://airmediaworks.org/localore" target="_blank"><img src="assets/img/logos/logo-localore.png" width="153" height="34" alt="Localore"></a>\n	<a href="http://zeega.org/" target="_blank"><img src="assets/img/logos/logo-zeega.png" width="101" height="31" alt="Zeega"></a>\n</div>\n<div class="ZEEGA-loader-bg" style="background: url('+rndImgUrl+'); background-position: 50% 50%; background-repeat: no-repeat no-repeat; background-attachment: fixed; -webkit-background-size: cover; -moz-background-size: cover; -o-background-size: cover; background-size: cover;"></div>';return __p},this.JST["app/templates/controls.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="<div class=\"nav-box\">\n    <a class='prev-arrow'></a>\n    <a class='next-arrow'></a>\n    <div class='arrow-text'></div>\n</div>";return __p},this.JST["app/templates/share.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="  <div class='overlay-wrapper'>\n    <div class='BGB-overlay-title'><h2>SHARE BLACK GOLD BOOM'S ROUGH RIDE</h2></div>\n    <a href='#' class='close-modal'><h3>close</h3></a>\n\n\n    <div class='BGB-overlay-content-wrapper-plain clearfix'>\n\n      <a class='share-icons' target='blank' href='http://twitter.com/share?text=Check%20out%20Black%20Gold%20Boom&url=http://roughride.blackgoldboom.com/'><img src='assets/img/twitter-large.png'/></a>\n        \n      <a class='share-icons' target='blank' href='http://www.facebook.com/sharer.php?u=http://roughride.blackgoldboom.com/'><img src='assets/img/facebook-large.png'/></a>\n      <a class='share-icons' target='blank' href='mailto:your-friend@example.com?subject=Black%20Gold%20Boom!&body=http://roughride.blackgoldboom.com/'><img src='assets/img/email-large.png'/></a>\n      <br/>\n\n    </div>\n  </div>";return __p},this.JST["app/templates/titles.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="<a href='#' class='play-pause'></a>\n<div class='title-bar-above'>\n  <div class='title-level'>\n    <h1>"+title+"</h1>\n    <div class='elapsed'>\n      <span class='time-elapsed'>1:23</span> / <span class='time-duration'>4:56</span>\n    </div>\n  </div>\n  <h2>"+seqTitle+"</h2>\n  <div class='aux-controls'>\n    <div class=''><a href='#' class='share'>SHARE</a></div>\n    <div class=''><a href='#' class='fullscreen'>FULLSCREEN</a></div>\n  </div>\n</div>\n<div class='elapsed-bar-wrapper'>\n  <div class='elapsed-bar'></div>\n</div>";return __p},this.JST["app/templates/ui-base.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+='<a href="http://blackgoldboom.com/" target="_blank" class="bgb-logo" title="View more stories on blackgoldboom.com">\n    <img src="assets/img/bgblogo.png" width="85" height="92" alt="Black Gold Boom">\n</a>\n<div class="block-clickthrough"></div>\n<span class="bottom-credit">powered by <a href="http://zeega.org" target="_blank">zeega</a></span>';return __p},this.JST["app/templates/zeega-popup.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="<h1 class='popup-title'>"+name+'</h1>\n<div id="ZEEGA-popup-'+id+'" class="ZEEGA-popup-project-target"></div>\n',caption!=""&&(__p+="\n  <div class='caption'>\n    "+caption+'\n    <div class=\'actions\'>\n      <a href="#" class="continue">Ok, let me see</a>\n      <a href="#" class="skip">Skip the gallery</a>\n    </div>\n  </div>\n'),__p+="";return __p},this.JST=this.JST||{},this.JST["app/templates/layouts/player-layout.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="<div class='ZEEGA-player-window'></div>";return __p},this.JST["app/templates/plugins/audio.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="";return __p},this.JST["app/templates/plugins/image.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+='<img src="'+attr.uri+"\" width='100%' />";return __p},this.JST["app/templates/plugins/link.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="<a href='#' class='ZEEGA-link-inner'>\n  ",mode=="editor"&&!_.isNull(attr.to_frame)&&(__p+='\n    <i class="icon-share go-to-sequence"></i>\n  '),__p+="\n</a>";return __p},this.JST["app/templates/plugins/popup-image.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="<div class='ZEEGA-popup-click-content popup-image' style=\"\n  background: url("+attr.popup_content.uri+') no-repeat center center;\n  -webkit-background-size: contain;\n  -moz-background-size: contain;\n  -o-background-size: contain;\n  background-size: contain;\n">\n  <a href="#" class="popup-close">close</a>\n</div>\n';return __p},this.JST["app/templates/plugins/popup-video.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+='<div class=\'ZEEGA-popup-click-content popup-video\' >\n  <a href="#" class="popup-close">close</a>\n</div>\n';return __p},this.JST["app/templates/plugins/popup.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+='<a\n  href="#"\n  class="ZEEGA-popup-click-target"\n  ',attr.popup_target&&(__p+='\n  style="\n    background: url('+attr.popup_target.uri+') no-repeat center center;\n    -webkit-background-size: cover;\n    -moz-background-size: cover;\n    -o-background-size: cover;\n    background-size: cover;\n  "\n  '),__p+='\n  data-caption="',attr.popup_content&&(__p+=""+attr.popup_content.title+""),__p+='"\n  >\n  ',attr.popup_content&&(__p+="<span class=\"popup-title\" style='display:none'>"+attr.popup_content.title+"</span>"),__p+="\n</a>";return __p},this.JST["app/templates/plugins/rectangle.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="";return __p},this.JST["app/templates/plugins/slideshow-metadata.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="<div class='slide-title'>"+title+"</div>\n<div class='slide-description'>"+description+'</div>\n<a href="'+attribution_uri+"\" target='blank' class='attribution-link'>\n    <i class='slideshow-icon-"+archive.toLowerCase()+" ssarchive'></i>\n</a>\n";return __p},this.JST["app/templates/plugins/slideshow.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="<a href='#' class='slideshow-arrow arrow-left slideshow-control-prev disabled'></a>\n<a href='#' class='slideshow-arrow arrow-right slideshow-control-next'></a>\n\n<div class='slideshow-container' style='width:"+(attr.slides.length*100+"%")+"'>\n	",_.each(attr.slides,function(e,t){__p+="\n		<div class='slideshow-slide slideshow-slide-"+t+"' style='width:"+(100/attr.slides.length+"%")+";background:url("+e.attr.uri+") no-repeat center center;-webkit-background-size: ",slides_bleed?__p+="cover":__p+="contain",__p+="; -moz-background-size: ",slides_bleed?__p+="cover":__p+="contain",__p+="; -o-background-size: ",slides_bleed?__p+="cover":__p+="contain",__p+="; background-size: ",slides_bleed?__p+="cover":__p+="contain",__p+=";'></div>\n	"}),__p+="\n</div>";return __p},this.JST["app/templates/plugins/slideshowthumbslider.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="<div class='slideshow-thumb-wrapper'>\n    <ul>\n        ",_.each(attr.slides,function(e,t){__p+="\n            <li>\n                <div class='slideshow-thumbnail' style=\"background:url("+e.attr.thumbnail_url+"); background-repeat:no-repeat;background-size:100%;background-position:center\">\n                    <a href='#' class='slider-thumb' data-slidenum=\""+t+'"></a>\n                </div>\n            </li>\n        '}),__p+="\n    </ul>\n</div>";return __p},this.JST["app/templates/plugins/text.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+=""+attr.content+"";return __p},this.JST["app/templates/plugins/video.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="";return __p},function(){var e;(function(){if(typeof e=="undefined"){e={};var t,n,r;(function(e){function c(e,t){var n,r,i,s,o,u,f,l,c,h,p=t&&t.split("/"),d=a.map,v=d&&d["*"]||{};if(e&&e.charAt(0)==="."&&t){p=p.slice(0,p.length-1),e=p.concat(e.split("/"));for(l=0;l<e.length;l+=1){h=e[l];if(h===".")e.splice(l,1),l-=1;else if(h===".."){if(l===1&&(e[2]===".."||e[0]===".."))return!0;l>0&&(e.splice(l-1,2),l-=2)}}e=e.join("/")}if((p||v)&&d){n=e.split("/");for(l=n.length;l>0;l-=1){r=n.slice(0,l).join("/");if(p)for(c=p.length;c>0;c-=1){i=d[p.slice(0,c).join("/")];if(i){i=i[r];if(i){s=i,o=l;break}}}if(s)break;!u&&v&&v[r]&&(u=v[r],f=l)}!s&&u&&(s=u,o=f),s&&(n.splice(0,o,s),e=n.join("/"))}return e}function h(t,n){return function(){return s.apply(e,l.call(arguments,0).concat([t,n]))}}function p(e){return function(t){return c(t,e)}}function d(e){return function(t){o[e]=t}}function v(t){if(u.hasOwnProperty(t)){var n=u[t];delete u[t],f[t]=!0,i.apply(e,n)}if(!o.hasOwnProperty(t))throw new Error("No "+t);return o[t]}function m(e,t){var n,r,i=e.indexOf("!");return i!==-1?(n=c(e.slice(0,i),t),e=e.slice(i+1),r=v(n),r&&r.normalize?e=r.normalize(e,p(t)):e=c(e,t)):e=c(e,t),{f:n?n+"!"+e:e,n:e,p:r}}function g(e){return function(){return a&&a.config&&a.config[e]||{}}}var i,s,o={},u={},a={},f={},l=[].slice;i=function(t,n,r,i){var s,a,l,c,p,y=[],b;i=i||t;if(typeof r=="function"){n=!n.length&&r.length?["require","exports","module"]:n;for(p=0;p<n.length;p+=1){c=m(n[p],i),a=c.f;if(a==="require")y[p]=h(t);else if(a==="exports")y[p]=o[t]={},b=!0;else if(a==="module")s=y[p]={id:t,uri:"",exports:o[t],config:g(t)};else if(o.hasOwnProperty(a)||u.hasOwnProperty(a))y[p]=v(a);else if(c.p)c.p.load(c.n,h(i,!0),d(a),{}),y[p]=o[a];else if(!f[a])throw new Error(t+" missing "+a)}l=r.apply(o[t],y);if(t)if(s&&s.exports!==e&&s.exports!==o[t])o[t]=s.exports;else if(l!==e||!b)o[t]=l}else t&&(o[t]=r)},t=n=s=function(t,n,r,o,u){return typeof t=="string"?v(m(t,n).f):(t.splice||(a=t,n.splice?(t=n,n=r,r=null):t=e),n=n||function(){},typeof r=="function"&&(r=o,o=u),o?i(e,t,n,r):setTimeout(function(){i(e,t,n,r)},15),s)},s.config=function(e){return a=e,s},r=function(e,t,n){t.splice||(n=t,t=[]),u[e]=[e,t,n]},r.amd={jQuery:!0}})(),e.requirejs=t,e.require=n,e.define=r}})(),e.define("../assets/js/libs/almond",function(){}),function(t,n){function ht(e){return new pt(e)}function pt(e){if(e&&e._wrapped)return e;this._wrapped=e}function xt(e,t,n){t||(t=0);var r=e.length,i=r-t>=(n||30),s=i?{}:e;if(i){var o,u=t-1;while(++u<r)o=e[u]+"",(O.call(s,o)?s[o]:s[o]=[]).push(e[u])}return function(e){if(i){var n=e+"";return O.call(s,n)&&Dn(s[n],e)>-1}return Dn(s,e,t)>-1}}function Tt(){var e,t,n,r=-1,i=arguments.length,s={bottom:"",exit:"",init:"",top:"",arrayBranch:{beforeLoop:""},objectBranch:{beforeLoop:""}};while(++r<i){e=arguments[r];for(t in e)n=(n=e[t])==null?"":n,/beforeLoop|inLoop/.test(t)?(typeof n=="string"&&(n={array:n,object:n}),s.arrayBranch[t]=n.array,s.objectBranch[t]=n.object):s[t]=n}var o=s.args,u=/^[^,]+/.exec(o)[0];s.firstArg=u,s.hasDontEnumBug=Q,s.isKeysFast=st,s.noArgsEnum=Y,s.shadowed=N,s.useHas=s.useHas!==!1,s.useStrict=s.useStrict!==!1,"noCharByIndex"in s||(s.noCharByIndex=tt),s.exit||(s.exit="if (!"+u+") return result");if(u!="collection"||!s.arrayBranch.inLoop)s.arrayBranch=null;var f=Function("arrayLikeClasses, ArrayProto, bind, compareAscending, concat, forIn, hasOwnProperty, identity, indexOf, isArguments, isArray, isFunction, isPlainObject, iteratorBind, objectClass, objectTypes, nativeKeys, propertyIsEnumerable, slice, stringClass, toString","var callee = function("+o+") {\n"+dt(s)+"\n};\n"+"return callee");return f(ut,a,Qn,Nt,A,zt,O,ar,Dn,Ht,Bt,jt,At,Ot,X,lt,F,_,D,$,P)}function Nt(e,t){var r=e.index,i=t.index;return e=e.criteria,t=t.criteria,e===n?1:t===n?-1:e<t?-1:e>t?1:r<i?-1:1}function Ct(e,t){return L[t]}function kt(e){return"\\"+ct[e]}function Lt(e){return ft[e]}function At(e,t){var n=!1;if(!e||typeof e!="object"||!t&&Ht(e))return n;var r=e.constructor;return(!nt||typeof e.toString=="function"||typeof (e+"")!="string")&&(!jt(r)||r instanceof r)?G?(zt(e,function(t,r){return n=!O.call(e,r),!1}),n===!1):(zt(e,function(e,t){n=t}),n===!1||O.call(e,n)):n}function Ot(e,t){return function(n,r,i){return e.call(t,n,r,i)}}function Mt(){}function _t(e,t){if(e&&v.test(t))return"<e%-"+t+"%>";var n=L.length;return L[n]="' +\n__e("+t+") +\n'",k+n}function Dt(e,t,n,r){if(r){var i=L.length;return L[i]="';\n"+r+";\n__p += '",k+i}return t?_t(null,t):Pt(null,n)}function Pt(e,t){if(e&&v.test(t))return"<e%="+t+"%>";var n=L.length;return L[n]="' +\n((__t = ("+t+")) == null ? '' : __t) +\n'",k+n}function Ht(e){return P.call(e)==I}function jt(e){return typeof e=="function"}function It(e,t,n,r,i){if(e==null)return e;n&&(t=!1),i||(i={value:null}),i.value==null&&(i.value=!!(f.clone||c.clone||h.clone));var s=lt[typeof e];if((s||i.value)&&e.clone&&jt(e.clone))return i.value=null,e.clone(t);if(s){var o=P.call(e);if(!at[o]||Z&&Ht(e))return e;var u=o==q;s=u||(o==X?At(e,!0):s)}if(!s||!t)return s?u?D.call(e):Ut({},e):e;var a=e.constructor;switch(o){case R:return new a(e==1);case U:return new a(+e);case W:case $:return new a(e);case V:return a(e.source,b.exec(e))}r||(r=[]);var l=r.length;while(l--)if(r[l].source==e)return r[l].value;l=e.length;var p=u?a(l):{};r.push({value:p,source:e});if(u){var d=-1;while(++d<l)p[d]=It(e[d],t,null,r,i)}else Wt(e,function(e,n){p[n]=It(e,t,null,r,i)});return p}function Vt(e,t){return e?O.call(e,t):!1}function $t(e){return e===!0||e===!1||P.call(e)==R}function Jt(e){return P.call(e)==U}function Kt(e){return e?e.nodeType===1:!1}function Gt(e,t,n,r){if(e==null||t==null)return e===t;r||(r={value:null}),r.value==null&&(r.value=!!(f.isEqual||c.isEqual||h.isEqual));if(lt[typeof e]||lt[typeof t]||r.value){e._chain&&(e=e._wrapped),t._chain&&(t=t._wrapped);if(e.isEqual&&jt(e.isEqual))return r.value=null,e.isEqual(t);if(t.isEqual&&jt(t.isEqual))return r.value=null,t.isEqual(e)}if(e===t)return e!==0||1/e==1/t;var i=P.call(e);if(i!=P.call(t))return!1;switch(i){case R:case U:return+e==+t;case W:return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case V:case $:return e==t+""}var s=ut[i];if(Z&&!s&&(s=Ht(e))&&!Ht(t))return!1;if(!s&&(i!=X||nt&&(typeof e.toString!="function"&&typeof (e+"")=="string"||typeof t.toString!="function"&&typeof (t+"")=="string")))return!1;n||(n=[]);var o=n.length;while(o--)if(n[o]==e)return!0;var u=-1,a=!0,l=0;n.push(e);if(s){l=e.length,a=l==t.length;if(a)while(l--)if(!(a=Gt(e[l],t[l],n,r)))break;return a}var p=e.constructor,d=t.constructor;if(p!=d&&!(jt(p)&&p instanceof p&&jt(d)&&d instanceof d))return!1;for(var v in e)if(O.call(e,v)){l++;if(!O.call(t,v)||!Gt(e[v],t[v],n,r))return!1}for(v in t)if(O.call(t,v)&&!(l--))return!1;if(Q)while(++u<7){v=N[u];if(O.call(e,v)&&(!O.call(t,v)||!Gt(e[v],t[v],n,r)))return!1}return!0}function Yt(e){return j(e)&&P.call(e)==W}function Zt(e){return e?lt[typeof e]:!1}function en(e){return P.call(e)==W&&e!=+e}function tn(e){return e===null}function nn(e){return P.call(e)==W}function rn(e){return P.call(e)==V}function sn(e){return P.call(e)==$}function on(e){return e===n}function fn(e){var t={};if(!e)return t;var n,r=0,i=A.apply(a,arguments),s=i.length;while(++r<s)n=i[r],n in e&&(t[n]=e[n]);return t}function ln(e){if(!e)return 0;var t=P.call(e),n=e.length;return ut[t]||Z&&Ht(e)||t==X&&n>-1&&n===n>>>0&&jt(e.splice)?n:un(e).length}function xn(e,t,n,r){if(!e)return n;var i=e.length,s=arguments.length<3;r&&(t=Ot(t,r));if(i>-1&&i===i>>>0){var o=tt&&P.call(e)==$?e.split(""):e;i&&s&&(n=o[--i]);while(i--)n=t(n,o[i],i,e);return n}var u,a=un(e);i=a.length,i&&s&&(n=e[a[--i]]);while(i--)u=a[i],n=t(n,e[u],u,e);return n}function kn(e){if(!e)return[];if(e.toArray&&jt(e.toArray))return e.toArray();var t=e.length;return t>-1&&t===t>>>0?(et?P.call(e)==$:typeof e=="string")?e.split(""):D.call(e):cn(e)}function An(e){var t=[];if(!e)return t;var n=-1,r=e.length;while(++n<r)e[n]&&t.push(e[n]);return t}function On(e){var t=[];if(!e)return t;var n=-1,r=e.length,i=A.apply(t,arguments),s=xt(i,r);while(++n<r)s(e[n])||t.push(e[n]);return t}function Mn(e,t,n){if(e)return t==null||n?e[0]:D.call(e,0,t)}function _n(e,t){var n=[];if(!e)return n;var r,i=-1,s=e.length;while(++i<s)r=e[i],Bt(r)?M.apply(n,t?r:_n(r)):n.push(r);return n}function Dn(e,t,n){if(!e)return-1;var r=-1,i=e.length;if(n){if(typeof n!="number")return r=zn(e,t),e[r]===t?r:-1;r=(n<0?Math.max(0,i+n):n)-1}while(++r<i)if(e[r]===t)return r;return-1}function Pn(e,t,n){return e?D.call(e,0,-(t==null||n?1:t)):[]}function Hn(e){var t=[];if(!e)return t;var n,r=-1,i=e.length,s=D.call(arguments,1),o=[];while(++r<i)n=e[r],Dn(t,n)<0&&dn(s,function(e,t){return(o[t]||(o[t]=xt(e)))(n)})&&t.push(n);return t}function Bn(e,t,n){if(e){var r=e.length;return t==null||n?e[r-1]:D.call(e,-t||r)}}function jn(e,t,n){if(!e)return-1;var r=e.length;n&&typeof n=="number"&&(r=(n<0?Math.max(0,r+n):Math.min(n,r-1))+1);while(r--)if(e[r]===t)return r;return-1}function Fn(e,t,n){var r=-Infinity,i=r;if(!e)return i;var s,o=-1,u=e.length;if(!t){while(++o<u)e[o]>i&&(i=e[o]);return i}n&&(t=Ot(t,n));while(++o<u)s=t(e[o],o,e),s>r&&(r=s,i=e[o]);return i}function In(e,t,n){var r=Infinity,i=r;if(!e)return i;var s,o=-1,u=e.length;if(!t){while(++o<u)e[o]<i&&(i=e[o]);return i}n&&(t=Ot(t,n));while(++o<u)s=t(e[o],o,e),s<r&&(r=s,i=e[o]);return i}function qn(e,t,n){e=+e||0,n=+n||1,t==null&&(t=e,e=0);var r=-1,i=Math.max(0,Math.ceil((t-e)/n)),s=Array(i);while(++r<i)s[r]=e,e+=n;return s}function Rn(e,t,n){return e?D.call(e,t==null||n?1:t):[]}function Un(e){if(!e)return[];var t,n=-1,r=e.length,i=Array(r);while(++n<r)t=Math.floor(Math.random()*(n+1)),i[n]=i[t],i[t]=e[n];return i}function zn(e,t,n,r){if(!e)return 0;var i,s=0,o=e.length;if(n){r&&(n=Qn(n,r)),t=n(t);while(s<o)i=s+o>>>1,n(e[i])<t?s=i+1:o=i}else while(s<o)i=s+o>>>1,e[i]<t?s=i+1:o=i;return s}function Wn(){var e=-1,t=[],n=A.apply(t,arguments),r=n.length;while(++e<r)Dn(t,n[e])<0&&t.push(n[e]);return t}function Xn(e,t,n,r){var i=[];if(!e)return i;var s,o=-1,u=e.length,a=[];typeof t=="function"&&(r=n,n=t,t=!1),n?r&&(n=Ot(n,r)):n=ar;while(++o<u){s=n(e[o],o,e);if(t?!o||a[a.length-1]!==s:Dn(a,s)<0)a.push(s),i.push(e[o])}return i}function Vn(e){var t=[];if(!e)return t;var n=-1,r=e.length,i=xt(arguments,1,20);while(++n<r)i(e[n])||t.push(e[n]);return t}function $n(e){if(!e)return[];var t=-1,n=Fn(En(arguments,"length")),r=Array(n);while(++t<n)r[t]=En(arguments,t);return r}function Jn(e,t){if(!e)return{};var n=-1,r=e.length,i={};t||(t=[]);while(++n<r)i[e[n]]=t[n];return i}function Kn(e,t){return e<1?t():function(){if(--e<1)return t.apply(this,arguments)}}function Qn(e,t){function s(){var o=arguments,u=t;r||(e=t[n]),i.length&&(o=o.length?i.concat(D.call(o)):i);if(this instanceof s){Mt.prototype=e.prototype,u=new Mt;var a=e.apply(u,o);return a&&lt[typeof a]?a:u}return e.apply(u,o)}var n,r=jt(e);if(!r)n=t,t=e;else if(it||H&&arguments.length>2)return H.call.apply(H,arguments);var i=D.call(arguments,2);return s}function Yn(){var e=arguments;return function(){var t=arguments,n=e.length;while(n--)t=[e[n].apply(this,t)];return t[0]}}function Zn(e,t,n){function u(){o=null,n||e.apply(s,r)}var r,i,s,o;return function(){var a=n&&!o;return r=arguments,s=this,J(o),o=K(u,t),a&&(i=e.apply(s,r)),i}}function er(e,t){var r=D.call(arguments,2);return K(function(){return e.apply(n,r)},t)}function tr(e){var t=D.call(arguments,1);return K(function(){return e.apply(n,t)},1)}function nr(e,t){var n={};return function(){var r=t?t.apply(this,arguments):arguments[0];return O.call(n,r)?n[r]:n[r]=e.apply(this,arguments)}}function rr(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}}function ir(e){var t=D.call(arguments,1),n=t.length;return function(){var r,i=arguments;return i.length&&(t.length=n,M.apply(t,i)),r=t.length==1?e.call(this,t[0]):e.apply(this,t),t.length=n,r}}function sr(e,t){function u(){o=new Date,s=null,e.apply(i,n)}var n,r,i,s,o=0;return function(){var a=new Date,f=t-(a-o);return n=arguments,i=this,f<=0?(o=a,r=e.apply(i,n)):s||(s=K(u,f)),r}}function or(e,t){return function(){var n=[e];return arguments.length&&M.apply(n,arguments),t.apply(this,n)}}function ur(e){return e==null?"":(e+"").replace(x,Lt)}function ar(e){return e}function fr(e){gn(Xt(e),function(t){var n=ht[t]=e[t];pt.prototype[t]=function(){var e=[this._wrapped];arguments.length&&M.apply(e,arguments);var t=n.apply(ht,e);return this._chain&&(t=new pt(t),t._chain=!0),t}})}function lr(){return t._=d,this}function cr(e,t){if(!e)return null;var n=e[t];return jt(n)?e[t]():n}function hr(e,t,n){n||(n={}),e+="";var u,a,f=n.escape,l=n.evaluate,c=n.interpolate,h=ht.templateSettings,p=n.variable||h.variable,d=p;f==null&&(f=h.escape),l==null&&(l=h.evaluate||!1),c==null&&(c=h.interpolate),f&&(e=e.replace(f,_t)),c&&(e=e.replace(c,Pt)),l!=r&&(r=l,o=RegExp("<e%-([\\s\\S]+?)%>|<e%=([\\s\\S]+?)%>"+(l?"|"+l.source:""),"g")),u=L.length,e=e.replace(o,Dt),u=u!=L.length,e="__p += '"+e.replace(T,kt).replace(S,Ct)+"';\n",L.length=0,d||(p=i||"obj",u?e="with ("+p+") {\n"+e+"\n}\n":(p!=i&&(i=p,s=RegExp("(\\(\\s*)"+p+"\\."+p+"\\b","g")),e=e.replace(w,"$&"+p+".").replace(s,"$1__d"))),e=(u?e.replace(m,""):e).replace(g,"$1").replace(y,"$1;"),e="function("+p+") {\n"+(d?"":p+" || ("+p+" = {});\n")+"var __t, __p = '', __e = _.escape"+(u?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":(d?"":", __d = "+p+"."+p+" || "+p)+";\n")+e+"return __p\n}",ot&&(e+="\n//@ sourceURL=/lodash/template/source["+C++ +"]");try{a=Function("_","return "+e)(ht)}catch(v){a=function(){throw v}}return t?a(t):(a.source=e,a)}function pr(e,t,n){var r=-1;if(n)while(++r<e)t.call(n,r);else while(++r<e)t(r)}function dr(e){var t=p++;return e?e+t:t}function vr(e){return e=new pt(e),e._chain=!0,e}function mr(e,t){return t(e),e}function gr(){return this._chain=!0,this}function yr(){return this._wrapped}var r,i,s,o,u=typeof exports=="object"&&exports&&(typeof global=="object"&&global&&global==global.global&&(t=global),exports),a=Array.prototype,f=Boolean.prototype,l=Object.prototype,c=Number.prototype,h=String.prototype,p=0,d=t._,v=/[-+=!~*%&^<>|{(\/]|\[\D|\b(?:delete|in|instanceof|new|typeof|void)\b/,m=/\b__p \+= '';/g,g=/\b(__p \+=) '' \+/g,y=/(__e\(.*?\)|\b__t\)) \+\n'';/g,b=/\w*$/,w=/(?:__e|__t = )\(\s*(?![\d\s"']|this\.)/g,E=RegExp("^"+(l.valueOf+"").replace(/[.*+?^=!:${}()|[\]\/\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),S=/__token__(\d+)/g,x=/[&<"']/g,T=/['\n\r\t\u2028\u2029\\]/g,N=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],C=0,k="__token__",L=[],A=a.concat,O=l.hasOwnProperty,M=a.push,_=l.propertyIsEnumerable,D=a.slice,P=l.toString,H=E.test(H=D.bind)&&H,B=E.test(B=Array.isArray)&&B,j=t.isFinite,F=E.test(F=Object.keys)&&F,I="[object Arguments]",q="[object Array]",R="[object Boolean]",U="[object Date]",z="[object Function]",W="[object Number]",X="[object Object]",V="[object RegExp]",$="[object String]",J=t.clearTimeout,K=t.setTimeout,Q,G,Y=!0;(function(){function t(){this.x=1}var e=[];t.prototype={valueOf:1,y:1};for(var n in new t)e.push(n);for(n in arguments)Y=!n;Q=(e+"").length<4,G=e[0]!="x"})(1);var Z=!Ht(arguments),et=D.call("x")[0]!="x",tt="x"[0]+Object("x")[0]!="xx";try{var nt=({toString:0}+"",P.call(t.document||0)==X)}catch(rt){}var it=H&&/\n|Opera/.test(H+P.call(t.opera)),st=F&&/^.+$|true/.test(F+!!t.attachEvent);try{var ot=(Function("//@cc_on !")(),!0)}catch(rt){}var ut={};ut[R]=ut[U]=ut[z]=ut[W]=ut[X]=ut[V]=!1,ut[I]=ut[q]=ut[$]=!0;var at={};at[I]=at[z]=!1,at[q]=at[R]=at[U]=at[W]=at[X]=at[V]=at[$]=!0;var ft={"&":"&amp;","<":"&lt;",'"':"&quot;","'":"&#x27;"},lt={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,"undefined":!1,unknown:!0},ct={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"};ht.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,variable:""};var dt=hr("<% if (useStrict) { %>'use strict';\n<% } %>var index, value, iteratee = <%= firstArg %>, result<% if (init) { %> = <%= init %><% } %>;\n<%= exit %>;\n<%= top %>;\n<% if (arrayBranch) { %>var length = iteratee.length; index = -1;  <% if (objectBranch) { %>\nif (length > -1 && length === length >>> 0) {<% } %>  <% if (noCharByIndex) { %>\n  if (toString.call(iteratee) == stringClass) {\n    iteratee = iteratee.split('')\n  }  <% } %>\n  <%= arrayBranch.beforeLoop %>;\n  while (++index < length) {\n    value = iteratee[index];\n    <%= arrayBranch.inLoop %>\n  }  <% if (objectBranch) { %>\n}<% } %><% } %><% if (objectBranch) { %>  <% if (arrayBranch) { %>\nelse {  <%  } else if (noArgsEnum) { %>\n  var length = iteratee.length; index = -1;\n  if (length && isArguments(iteratee)) {\n    while (++index < length) {\n      value = iteratee[index += ''];\n      <%= objectBranch.inLoop %>\n    }\n  } else {  <% } %>  <% if (!hasDontEnumBug) { %>\n  var skipProto = typeof iteratee == 'function' && \n    propertyIsEnumerable.call(iteratee, 'prototype');\n  <% } %>  <% if (isKeysFast && useHas) { %>\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iteratee] ? nativeKeys(iteratee) : [],\n      length = ownProps.length;\n\n  <%= objectBranch.beforeLoop %>;\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n    <% if (!hasDontEnumBug) { %>if (!(skipProto && index == 'prototype')) {\n  <% } %>    value = iteratee[index];\n    <%= objectBranch.inLoop %>\n    <% if (!hasDontEnumBug) { %>}\n<% } %>  }  <% } else { %>\n  <%= objectBranch.beforeLoop %>;\n  for (index in iteratee) {    <% if (hasDontEnumBug) { %>\n    <%   if (useHas) { %>if (hasOwnProperty.call(iteratee, index)) {\n  <% } %>    value = iteratee[index];\n    <%= objectBranch.inLoop %>;\n    <%   if (useHas) { %>}<% } %>    <% } else { %>\n    if (!(skipProto && index == 'prototype')<% if (useHas) { %> &&\n        hasOwnProperty.call(iteratee, index)<% } %>) {\n      value = iteratee[index];\n      <%= objectBranch.inLoop %>\n    }    <% } %>\n  }  <% } %>  <% if (hasDontEnumBug) { %>\n\n  var ctor = iteratee.constructor;\n    <% for (var k = 0; k < 7; k++) { %>\n  index = '<%= shadowed[k] %>';\n  if (<%      if (shadowed[k] == 'constructor') {        %>!(ctor && ctor.prototype === iteratee) && <%      } %>hasOwnProperty.call(iteratee, index)) {\n    value = iteratee[index];\n    <%= objectBranch.inLoop %>\n  }    <% } %>  <% } %>  <% if (arrayBranch || noArgsEnum) { %>\n}<% } %><% } %>\n<%= bottom %>;\nreturn result"),vt={args:"collection, callback, thisArg",init:"collection",top:"if (!callback) {\n  callback = identity\n}\nelse if (thisArg) {\n  callback = iteratorBind(callback, thisArg)\n}",inLoop:"if (callback(value, index, collection) === false) return result"},mt={init:"{}",top:"var prop;\nif (typeof callback != 'function') {\n  var valueProp = callback;\n  callback = function(value) { return value[valueProp] }\n}\nelse if (thisArg) {\n  callback = iteratorBind(callback, thisArg)\n}",inLoop:"prop = callback(value, index, collection);\n(hasOwnProperty.call(result, prop) ? result[prop]++ : result[prop] = 1)"},gt={init:"true",inLoop:"if (!callback(value, index, collection)) return !result"},yt={useHas:!1,useStrict:!1,args:"object",init:"object",top:"for (var argsIndex = 1, argsLength = arguments.length; argsIndex < argsLength; argsIndex++) {\n  if (iteratee = arguments[argsIndex]) {",inLoop:"result[index] = value",bottom:"  }\n}"},bt={init:"[]",inLoop:"callback(value, index, collection) && result.push(value)"},wt={top:"if (thisArg) callback = iteratorBind(callback, thisArg)"},Et={inLoop:{object:vt.inLoop}},St={init:"",exit:"if (!collection) return []",beforeLoop:{array:"result = Array(length)",object:"result = "+(st?"Array(length)":"[]")},inLoop:{array:"result[index] = callback(value, index, collection)",object:"result"+(st?"[ownIndex] = ":".push")+"(callback(value, index, collection))"}};Z&&(Ht=function(e){return!!e&&!!O.call(e,"callee")});var Bt=B||function(e){return P.call(e)==q};jt(/x/)&&(jt=function(e){return P.call(e)==z});var Ft=Tt({args:"object",init:"[]",inLoop:"result.push(index)"}),qt=Tt(yt,{inLoop:"if (result[index] == null) "+yt.inLoop}),Rt=Tt({useHas:!1,args:"object",init:"{}",top:"var props = concat.apply(ArrayProto, arguments)",inLoop:"if (indexOf(props, index) < 0) result[index] = value"}),Ut=Tt(yt),zt=Tt(vt,wt,Et,{useHas:!1}),Wt=Tt(vt,wt,Et),Xt=Tt({useHas:!1,args:"object",init:"[]",inLoop:"if (isFunction(value)) result.push(index)",bottom:"result.sort()"}),Qt=Tt({args:"value",init:"true",top:"var className = toString.call(value),\n    length = value.length;\nif (arrayLikeClasses[className]"+(Z?" || isArguments(value)":"")+" ||\n"+"  (className == objectClass && length > -1 && length === length >>> 0 &&\n"+"  isFunction(value.splice))"+") return !length",inLoop:{object:"return false"}}),un=F?function(e){var t=typeof e;return t=="function"&&_.call(e,"prototype")?Ft(e):e&&lt[t]?F(e):[]}:Ft,an=Tt(yt,{args:"object, source, indicator, stack",top:"var destValue, found, isArr, stackLength, recursive = indicator == isPlainObject;\nif (!recursive) stack = [];\nfor (var argsIndex = 1, argsLength = recursive ? 2 : arguments.length; argsIndex < argsLength; argsIndex++) {\n  if (iteratee = arguments[argsIndex]) {",inLoop:"if (value && ((isArr = isArray(value)) || isPlainObject(value))) {\n  found = false; stackLength = stack.length;\n  while (stackLength--) {\n    if (found = stack[stackLength].source == value) break\n  }\n  if (found) {\n    result[index] = stack[stackLength].value\n  } else {\n    destValue = (destValue = result[index]) && isArr\n      ? (isArray(destValue) ? destValue : [])\n      : (isPlainObject(destValue) ? destValue : {});\n    stack.push({ value: destValue, source: value });\n    result[index] = callee(destValue, value, isPlainObject, stack)\n  }\n} else if (value != null) {\n  result[index] = value\n}"}),cn=Tt({args:"object",init:"[]",inLoop:"result.push(value)"}),hn=Tt({args:"collection, target",init:"false",noCharByIndex:!1,beforeLoop:{array:"if (toString.call(iteratee) == stringClass) return collection.indexOf(target) > -1"},inLoop:"if (value === target) return true"}),pn=Tt(vt,mt),dn=Tt(vt,gt),vn=Tt(vt,bt),mn=Tt(vt,wt,{init:"",inLoop:"if (callback(value, index, collection)) return value"}),gn=Tt(vt,wt),yn=Tt(vt,mt,{inLoop:"prop = callback(value, index, collection);\n(hasOwnProperty.call(result, prop) ? result[prop] : result[prop] = []).push(value)"}),bn=Tt(St,{args:"collection, methodName",top:"var args = slice.call(arguments, 2),\n    isFunc = typeof methodName == 'function'",inLoop:{array:"result[index] = (isFunc ? methodName : value[methodName]).apply(value, args)",object:"result"+(st?"[ownIndex] = ":".push")+"((isFunc ? methodName : value[methodName]).apply(value, args))"}}),wn=Tt(vt,St),En=Tt(St,{args:"collection, property",inLoop:{array:"result[index] = value[property]",object:"result"+(st?"[ownIndex] = ":".push")+"(value[property])"}}),Sn=Tt({args:"collection, callback, accumulator, thisArg",init:"accumulator",top:"var noaccum = arguments.length < 3;\nif (thisArg) callback = iteratorBind(callback, thisArg)",beforeLoop:{array:"if (noaccum) result = collection[++index]"},inLoop:{array:"result = callback(result, value, index, collection)",object:"result = noaccum\n  ? (noaccum = false, value)\n  : callback(result, value, index, collection)"}}),Tn=Tt(vt,bt,{inLoop:"!"+bt.inLoop}),Nn=Tt(vt,gt,{init:"false",inLoop:gt.inLoop.replace("!","")}),Cn=Tt(vt,mt,St,{inLoop:{array:"result[index] = {\n  criteria: callback(value, index, collection),\n  index: index,\n  value: value\n}",object:"result"+(st?"[ownIndex] = ":".push")+"({\n"+"  criteria: callback(value, index, collection),\n"+"  index: index,\n"+"  value: value\n"+"})"},bottom:"result.sort(compareAscending);\nlength = result.length;\nwhile (length--) {\n  result[length] = result[length].value\n}"}),Ln=Tt(bt,{args:"collection, properties",top:"var pass, prop, propIndex, props = [];\nforIn(properties, function(value, prop) { props.push(prop) });\nvar propsLength = props.length",inLoop:"for (pass = true, propIndex = 0; propIndex < propsLength; propIndex++) {\n  prop = props[propIndex];\n  if (!(pass = value[prop] === properties[prop])) break\n}\nif (pass) result.push(value)"}),Gn=Tt({useHas:!1,useStrict:!1,args:"object",init:"object",top:"var funcs = arguments,\n    length = funcs.length;\nif (length > 1) {\n  for (var index = 1; index < length; index++) {\n    result[funcs[index]] = bind(result[funcs[index]], result)\n  }\n  return result\n}",inLoop:"if (isFunction(result[index])) {\n  result[index] = bind(result[index], result)\n}"});ht.VERSION="0.5.2",ht.after=Kn,ht.bind=Qn,ht.bindAll=Gn,ht.chain=vr,ht.clone=It,ht.compact=An,ht.compose=Yn,ht.contains=hn,ht.countBy=pn,ht.debounce=Zn,ht.defaults=qt,ht.defer=tr,ht.delay=er,ht.difference=On,ht.drop=Rt,ht.escape=ur,ht.every=dn,ht.extend=Ut,ht.filter=vn,ht.find=mn,ht.first=Mn,ht.flatten=_n,ht.forEach=gn,ht.forIn=zt,ht.forOwn=Wt,ht.functions=Xt,ht.groupBy=yn,ht.has=Vt,ht.identity=ar,ht.indexOf=Dn,ht.initial=Pn,ht.intersection=Hn,ht.invoke=bn,ht.isArguments=Ht,ht.isArray=Bt,ht.isBoolean=$t,ht.isDate=Jt,ht.isElement=Kt,ht.isEmpty=Qt,ht.isEqual=Gt,ht.isFinite=Yt,ht.isFunction=jt,ht.isNaN=en,ht.isNull=tn,ht.isNumber=nn,ht.isObject=Zt,ht.isRegExp=rn,ht.isString=sn,ht.isUndefined=on,ht.keys=un,ht.last=Bn,ht.lastIndexOf=jn,ht.map=wn,ht.max=Fn,ht.memoize=nr,ht.merge=an,ht.min=In,ht.mixin=fr,ht.noConflict=lr,ht.once=rr,ht.partial=ir,ht.pick=fn,ht.pluck=En,ht.range=qn,ht.reduce=Sn,ht.reduceRight=xn,ht.reject=Tn,ht.rest=Rn,ht.result=cr,ht.shuffle=Un,ht.size=ln,ht.some=Nn,ht.sortBy=Cn,ht.sortedIndex=zn,ht.tap=mr,ht.template=hr,ht.throttle=sr,ht.times=pr,ht.toArray=kn,ht.union=Wn,ht.uniq=Xn,ht.uniqueId=dr,ht.values=cn,ht.where=Ln,ht.without=Vn,ht.wrap=or,ht.zip=$n,ht.zipObject=Jn,ht.all=dn,ht.any=Nn,ht.collect=wn,ht.detect=mn,ht.each=gn,ht.foldl=Sn,ht.foldr=xn,ht.head=Mn,ht.include=hn,ht.inject=Sn,ht.methods=Xt,ht.select=vn,ht.tail=Rn,ht.take=Mn,ht.unique=Xn,ht._iteratorTemplate=dt,ht._shimKeys=Ft,pt.prototype=ht.prototype,fr(ht),pt.prototype.chain=gr,pt.prototype.value=yr,gn(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=a[e];pt.prototype[e]=function(){var e=this._wrapped;return t.apply(e,arguments),e.length===0&&delete e[0],this._chain&&(e=new pt(e),e._chain=!0),e}}),gn(["concat","join","slice"],function(e){var t=a[e];pt.prototype[e]=function(){var e=this._wrapped,n=t.apply(e,arguments);return this._chain&&(n=new pt(n),n._chain=!0),n}}),typeof e.define=="function"&&typeof e.define.amd=="object"&&e.define.amd?(t._=ht,e.define("lodash",[],function(){return ht})):u?typeof module=="object"&&module&&module.exports==u?(module.exports=ht)._=ht:u._=ht:t._=ht}(this),function(){var t=this,n=t.Backbone,r=Array.prototype.slice,i=Array.prototype.splice,s;typeof exports!="undefined"?s=exports:s=t.Backbone={},s.VERSION="0.9.2";var o=t._;!o&&typeof require!="undefined"&&(o=e.require("underscore"));var u=t.jQuery||t.Zepto||t.ender;s.setDomLibrary=function(e){u=e},s.noConflict=function(){return t.Backbone=n,this},s.emulateHTTP=!1,s.emulateJSON=!1;var a=/\s+/,f=s.Events={on:function(e,t,n){var r,i,s,o,u;if(!t)return this;e=e.split(a),r=this._callbacks||(this._callbacks={});while(i=e.shift())u=r[i],s=u?u.tail:{},s.next=o={},s.context=n,s.callback=t,r[i]={tail:o,next:u?u.next:s};return this},off:function(e,t,n){var r,i,s,u,f,l;if(!(i=this._callbacks))return;if(!(e||t||n))return delete this._callbacks,this;e=e?e.split(a):o.keys(i);while(r=e.shift()){s=i[r],delete i[r];if(!s||!t&&!n)continue;u=s.tail;while((s=s.next)!==u)f=s.callback,l=s.context,(t&&f!==t||n&&l!==n)&&this.on(r,f,l)}return this},trigger:function(e){var t,n,i,s,o,u,f;if(!(i=this._callbacks))return this;u=i.all,e=e.split(a),f=r.call(arguments,1);while(t=e.shift()){if(n=i[t]){s=n.tail;while((n=n.next)!==s)n.callback.apply(n.context||this,f)}if(n=u){s=n.tail,o=[t].concat(f);while((n=n.next)!==s)n.callback.apply(n.context||this,o)}}return this}};f.bind=f.on,f.unbind=f.off;var l=s.Model=function(e,t){var n;e||(e={}),t&&t.parse&&(e=this.parse(e));if(n=k(this,"defaults"))e=o.extend({},n,e);t&&t.collection&&(this.collection=t.collection),this.attributes={},this._escapedAttributes={},this.cid=o.uniqueId("c"),this.changed={},this._silent={},this._pending={},this.set(e,{silent:!0}),this.changed={},this._silent={},this._pending={},this._previousAttributes=o.clone(this.attributes),this.initialize.apply(this,arguments)};o.extend(l.prototype,f,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return o.clone(this.attributes)},get:function(e){return this.attributes[e]},escape:function(e){var t;if(t=this._escapedAttributes[e])return t;var n=this.get(e);return this._escapedAttributes[e]=o.escape(n==null?"":""+n)},has:function(e){return this.get(e)!=null},set:function(e,t,n){var r,i,s;o.isObject(e)||e==null?(r=e,n=t):(r={},r[e]=t),n||(n={});if(!r)return this;r instanceof l&&(r=r.attributes);if(n.unset)for(i in r)r[i]=void 0;if(!this._validate(r,n))return!1;this.idAttribute in r&&(this.id=r[this.idAttribute]);var u=n.changes={},a=this.attributes,f=this._escapedAttributes,c=this._previousAttributes||{};for(i in r){s=r[i];if(!o.isEqual(a[i],s)||n.unset&&o.has(a,i))delete f[i],(n.silent?this._silent:u)[i]=!0;n.unset?delete a[i]:a[i]=s,!o.isEqual(c[i],s)||o.has(a,i)!=o.has(c,i)?(this.changed[i]=s,n.silent||(this._pending[i]=!0)):(delete this.changed[i],delete this._pending[i])}return n.silent||this.change(n),this},unset:function(e,t){return(t||(t={})).unset=!0,this.set(e,null,t)},clear:function(e){return(e||(e={})).unset=!0,this.set(o.clone(this.attributes),e)},fetch:function(e){e=e?o.clone(e):{};var t=this,n=e.success;return e.success=function(r,i,s){if(!t.set(t.parse(r,s),e))return!1;n&&n(t,r)},e.error=s.wrapError(e.error,t,e),(this.sync||s.sync).call(this,"read",this,e)},save:function(e,t,n){var r,i;o.isObject(e)||e==null?(r=e,n=t):(r={},r[e]=t),n=n?o.clone(n):{};if(n.wait){if(!this._validate(r,n))return!1;i=o.clone(this.attributes)}var u=o.extend({},n,{silent:!0});if(r&&!this.set(r,n.wait?u:n))return!1;var a=this,f=n.success;n.success=function(e,t,i){var s=a.parse(e,i);n.wait&&(delete n.wait,s=o.extend(r||{},s));if(!a.set(s,n))return!1;f?f(a,e):a.trigger("sync",a,e,n)},n.error=s.wrapError(n.error,a,n);var l=this.isNew()?"create":"update",c=(this.sync||s.sync).call(this,l,this,n);return n.wait&&this.set(i,u),c},destroy:function(e){e=e?o.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};if(this.isNew())return r(),!1;e.success=function(i){e.wait&&r(),n?n(t,i):t.trigger("sync",t,i,e)},e.error=s.wrapError(e.error,t,e);var i=(this.sync||s.sync).call(this,"delete",this,e);return e.wait||r(),i},url:function(){var e=k(this,"urlRoot")||k(this.collection,"url")||L();return this.isNew()?e:e+(e.charAt(e.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(e){e||(e={});var t=this._changing;this._changing=!0;for(var n in this._silent)this._pending[n]=!0;var r=o.extend({},e.changes,this._silent);this._silent={};for(var n in r)this.trigger("change:"+n,this,this.get(n),e);if(t)return this;while(!o.isEmpty(this._pending)){this._pending={},this.trigger("change",this,e);for(var n in this.changed){if(this._pending[n]||this._silent[n])continue;delete this.changed[n]}this._previousAttributes=o.clone(this.attributes)}return this._changing=!1,this},hasChanged:function(e){return arguments.length?o.has(this.changed,e):!o.isEmpty(this.changed)},changedAttributes:function(e){if(!e)return this.hasChanged()?o.clone(this.changed):!1;var t,n=!1,r=this._previousAttributes;for(var i in e){if(o.isEqual(r[i],t=e[i]))continue;(n||(n={}))[i]=t}return n},previous:function(e){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return o.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(e,t){if(t.silent||!this.validate)return!0;e=o.extend({},this.attributes,e);var n=this.validate(e,t);return n?(t&&t.error?t.error(this,n,t):this.trigger("error",this,n,t),!1):!0}});var c=s.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,{silent:!0,parse:t.parse})};o.extend(c.prototype,f,{model:l,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},add:function(e,t){var n,r,s,u,a,f,l={},c={},h=[];t||(t={}),e=o.isArray(e)?e.slice():[e];for(n=0,s=e.length;n<s;n++){if(!(u=e[n]=this._prepareModel(e[n],t)))throw new Error("Can't add an invalid model to a collection");a=u.cid,f=u.id;if(l[a]||this._byCid[a]||f!=null&&(c[f]||this._byId[f])){h.push(n);continue}l[a]=c[f]=u}n=h.length;while(n--)e.splice(h[n],1);for(n=0,s=e.length;n<s;n++)(u=e[n]).on("all",this._onModelEvent,this),this._byCid[u.cid]=u,u.id!=null&&(this._byId[u.id]=u);this.length+=s,r=t.at!=null?t.at:this.models.length,i.apply(this.models,[r,0].concat(e)),this.comparator&&this.sort({silent:!0});if(t.silent)return this;for(n=0,s=this.models.length;n<s;n++){if(!l[(u=this.models[n]).cid])continue;t.index=n,u.trigger("add",u,this,t)}return this},remove:function(e,t){var n,r,i,s;t||(t={}),e=o.isArray(e)?e.slice():[e];for(n=0,r=e.length;n<r;n++){s=this.getByCid(e[n])||this.get(e[n]);if(!s)continue;delete this._byId[s.id],delete this._byCid[s.cid],i=this.indexOf(s),this.models.splice(i,1),this.length--,t.silent||(t.index=i,s.trigger("remove",s,this,t)),this._removeReference(s)}return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,t),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,o.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},get:function(e){return e==null?void 0:this._byId[e.id!=null?e.id:e]},getByCid:function(e){return e&&this._byCid[e.cid||e]},at:function(e){return this.models[e]},where:function(e){return o.isEmpty(e)?[]:this.filter(function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},sort:function(e){e||(e={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");var t=o.bind(this.comparator,this);return this.comparator.length==1?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("reset",this,e),this},pluck:function(e){return o.map(this.models,function(t){return t.get(e)})},reset:function(e,t){e||(e=[]),t||(t={});for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return this._reset(),this.add(e,o.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},fetch:function(e){e=e?o.clone(e):{},e.parse===undefined&&(e.parse=!0);var t=this,n=e.success;return e.success=function(r,i,s){t[e.add?"add":"reset"](t.parse(r,s),e),n&&n(t,r)},e.error=s.wrapError(e.error,t,e),(this.sync||s.sync).call(this,"read",this,e)},create:function(e,t){var n=this;t=t?o.clone(t):{},e=this._prepareModel(e,t);if(!e)return!1;t.wait||n.add(e,t);var r=t.success;return t.success=function(i,s,o){t.wait&&n.add(i,t),r?r(i,s):i.trigger("sync",e,s,t)},e.save(null,t),e},parse:function(e,t){return e},chain:function(){return o(this.models).chain()},_reset:function(e){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(e,t){t||(t={});if(e instanceof l)e.collection||(e.collection=this);else{var n=e;t.collection=this,e=new this.model(n,t),e._validate(e.attributes,t)||(e=!1)}return e},_removeReference:function(e){this==e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e=="add"||e=="remove")&&n!=this)return;e=="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],this._byId[t.id]=t),this.trigger.apply(this,arguments)}});var h=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];o.each(h,function(e){c.prototype[e]=function(){return o[e].apply(o,[this.models].concat(o.toArray(arguments)))}});var p=s.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},d=/:\w+/g,v=/\*\w+/g,m=/[-[\]{}()+?.,\\^$|#\s]/g;o.extend(p.prototype,f,{initialize:function(){},route:function(e,t,n){return s.history||(s.history=new g),o.isRegExp(e)||(e=this._routeToRegExp(e)),n||(n=this[t]),s.history.route(e,o.bind(function(r){var i=this._extractParameters(e,r);n&&n.apply(this,i),this.trigger.apply(this,["route:"+t].concat(i)),s.history.trigger("route",this,t,i)},this)),this},navigate:function(e,t){s.history.navigate(e,t)},_bindRoutes:function(){if(!this.routes)return;var e=[];for(var t in this.routes)e.unshift([t,this.routes[t]]);for(var n=0,r=e.length;n<r;n++)this.route(e[n][0],e[n][1],this[e[n][1]])},_routeToRegExp:function(e){return e=e.replace(m,"\\$&").replace(d,"([^/]+)").replace(v,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var g=s.History=function(){this.handlers=[],o.bindAll(this,"checkUrl")},y=/^[#\/]/,b=/msie [\w.]+/;g.started=!1,o.extend(g.prototype,f,{interval:50,getHash:function(e){var t=e?e.location:window.location,n=t.href.match(/#(.*)$/);return n?n[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||t){e=window.location.pathname;var n=window.location.search;n&&(e+=n)}else e=this.getHash();return e.indexOf(this.options.root)||(e=e.substr(this.options.root.length)),e.replace(y,"")},start:function(e){if(g.started)throw new Error("Backbone.history has already been started");g.started=!0,this.options=o.extend({},{root:"/"},this.options,e),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var t=this.getFragment(),n=document.documentMode,r=b.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);r&&(this.iframe=u('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?u(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?u(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=window.location,s=i.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!s)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&s&&i.hash&&(this.fragment=this.getHash().replace(y,""),window.history.replaceState({},document.title,i.protocol+"//"+i.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){u(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),g.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t==this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t==this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=o.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0});return n},navigate:function(e,t){if(!g.started)return!1;if(!t||t===!0)t={trigger:t};var n=(e||"").replace(y,"");if(this.fragment==n)return;this._hasPushState?(n.indexOf(this.options.root)!=0&&(n=this.options.root+n),this.fragment=n,window.history[t.replace?"replaceState":"pushState"]({},document.title,n)):this._wantsHashChange?(this.fragment=n,this._updateHash(window.location,n,t.replace),this.iframe&&n!=this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,n,t.replace))):window.location.assign(this.options.root+e),t.trigger&&this.loadUrl(e)},_updateHash:function(e,t,n){n?e.replace(e.toString().replace(/(javascript:|#).*$/,"")+"#"+t):e.hash=t}});var w=s.View=function(e){this.cid=o.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},E=/^(\S+)\s*(.*)$/,S=["model","collection","el","id","attributes","className","tagName"];o.extend(w.prototype,f,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(e,t,n){var r=document.createElement(e);return t&&u(r).attr(t),n&&u(r).html(n),r},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof u?e:u(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=k(this,"events")))return;this.undelegateEvents();for(var t in e){var n=e[t];o.isFunction(n)||(n=this[e[t]]);if(!n)throw new Error('Method "'+e[t]+'" does not exist');var r=t.match(E),i=r[1],s=r[2];n=o.bind(n,this),i+=".delegateEvents"+this.cid,s===""?this.$el.bind(i,n):this.$el.delegate(s,i,n)}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=o.extend({},this.options,e));for(var t=0,n=S.length;t<n;t++){var r=S[t];e[r]&&(this[r]=e[r])}this.options=e},_ensureElement:function(){if(!this.el){var e=k(this,"attributes")||{};this.id&&(e.id=this.id),this.className&&(e["class"]=this.className),this.setElement(this.make(this.tagName,e),!1)}else this.setElement(this.el,!1)}});var x=function(e,t){var n=C(this,e,t);return n.extend=this.extend,n};l.extend=c.extend=p.extend=w.extend=x;var T={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};s.sync=function(e,t,n){var r=T[e];n||(n={});var i={type:r,dataType:"json"};return n.url||(i.url=k(t,"url")||L()),!n.data&&t&&(e=="create"||e=="update")&&(i.contentType="application/json",i.data=JSON.stringify(t.toJSON())),s.emulateJSON&&(i.contentType="application/x-www-form-urlencoded",i.data=i.data?{model:i.data}:{}),s.emulateHTTP&&(r==="PUT"||r==="DELETE")&&(s.emulateJSON&&(i.data._method=r),i.type="POST",i.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r)}),i.type!=="GET"&&!s.emulateJSON&&(i.processData=!1),u.ajax(o.extend(i,n))},s.wrapError=function(e,t,n){return function(r,i){i=r===t?i:r,e?e(t,i,n):t.trigger("error",t,i,n)}};var N=function(){},C=function(e,t,n){var r;return t&&t.hasOwnProperty("constructor")?r=t.constructor:r=function(){e.apply(this,arguments)},o.extend(r,e),N.prototype=e.prototype,r.prototype=new N,t&&o.extend(r.prototype,t),n&&o.extend(r,n),r.prototype.constructor=r,r.__super__=e.prototype,r},k=function(e,t){return!e||!e[t]?null:o.isFunction(e[t])?e[t]():e[t]},L=function(){throw new Error('A "url" property or function must be specified')}}.call(this),e.define("backbone",["lodash"],function(e){return function(){var t,n;return t||e.Backbone}}(this)),function(e){var t,n=e.Backbone,r=e._,i=e.$,s=n.View.prototype._configure,o=n.View.prototype.render,u=n.View.extend({constructor:function(t){t=t||{},u.setupView(this,t),n.View.call(this,t)},swapLayout:function(e){return e.views=r.defaults({},this.views,e.views),e.setElement(this.el),e},insertView:function(e,t){return t?this.setView(e,t,!0):this.setView(e,!0)},insertViews:function(e){return r.each(e,function(t,n){e[n]=[].concat(t)}),this.setViews(e)},getView:function(e){return this.getViews(e).first().value()},getViews:function(e){var t=r.chain(this.views).map(function(e){return[].concat(e)},this).flatten().value();return r.chain(r.filter(t,e?e:r.identity))},setView:function(e,t,n){var i,s,o=this;r.isString(e)||(n=t,t=e,e=""),this.views=this.views||{},!n&&this.views[e]&&(r.isArray(this.views[e])?r.each(this.views[e],function(e){e.remove()}):this.views[e].remove());if(!t.__manager__)throw new Error("manage property not set.  http://tbranyen.github.com/backbone.layoutmanager/#usage/structuring-a-view");return s=t._options(),t.render=function(i){function l(){(!n||t.keep||!f.hasRendered)&&s.partial(o.el,e,t.el,n),t.delegateEvents(),f.handler&&(f.handler.resolveWith(t,[t.el]),delete f.handler),a.resolveWith(t,[t.el]),r.isFunction(i)&&i.call(t,t.el)}var a=s.deferred(),f=t.__manager__;return f.viewDeferred=a,t._removeViews(),u.prototype.render.call(t).then(l),a.promise()},t.__manager__.parent=o,t.__manager__.selector=e,n?(i=this.views[e]=this.views[e]||[],r.isArray(this.views[e])||(i=this.views[e]=[this.views[e]]),r.indexOf(i,t)>-1?t:(i.push(t),t.__manager__.append=!0,t)):this.views[e]=t},setViews:function(e){return r.each(e,function(e,t){if(r.isArray(e))return r.each(e,function(e){this.insertView(t,e)},this);this.setView(t,e)},this),this},render:function(e){var t,n=this,i=this._options(),s=i.deferred(),o=this.__manager__;return o.renderDeferred?(o.callback=e,o.renderDeferred):(o.renderDeferred=s,this._render(u._viewRender).fetch.then(function(){var e=r.map(n.views,function(e){function n(e,t){if(!e.length)return t();var r=e.shift();r.render(function(){n(e,t)})}var t;return r.isArray(e)?(t=i.deferred(),n(r.clone(e),function(){t.resolve()}),t.promise()):e.render()});i.when(e).then(function(){s.resolveWith(n,[n.el])})}),t=s.then(function(){r.isFunction(e)&&e.call(n,n.el),n.__manager__.handler&&(n.__manager__.handler.resolveWith(n,[n.el]),delete n.__manager__.handler),r.isFunction(n.__manager__.callback)&&(n.__manager__.callback.call(n,n.el),delete n.__manager__.callback),delete n.__manager__.renderDeferred}),r.defaults(t,n))},remove:function(){return u._removeView(this,!0),this._remove.apply(this,arguments)},_options:function(){return r.extend({},this,u.prototype.options,this.options)}},{_cache:{},_makeAsync:function(e,t){var n=e.deferred();return n.async=function(){return n._isAsync=!0,t},n},_viewRender:function(e){function o(n,r){u.cache(t,r),r&&s.html(e.el,s.render(r,n)),i.fetch.resolveWith(e,[e.el])}var t,n,i,s=e._options();return{render:function(a){var f=e.__manager__,l=e.template||s.template;return e.serialize&&(s.serialize=e.serialize),!a&&r.isFunction(s.serialize)?a=s.serialize.call(e):!a&&r.isObject(s.serialize)&&(a=s.serialize),i=u._makeAsync(s,r.bind(o,e,a)),i.fetch=s.deferred(),f.handler=i,r.isString(l)&&(t=f.prefix+l),(n=u.cache(t))?(o(a,n,t),i):(r.isString(l)?n=s.fetch.call(i,f.prefix+l):l!=null&&(n=s.fetch.call(i,l)),i._isAsync||o(a,n),i)}}},cleanViews:function(e){r.each([].concat(e),function(e){e.unbind(),e.views&&r.each(e.views,function(e){u.cleanViews(e)}),r.isFunction(e.cleanup)&&e.cleanup.call(e)})},cache:function(e,t){if(e in this._cache)return this._cache[e];if(e!=null&&t!=null)return this._cache[e]=t},configure:function(e){r.extend(u.prototype.options,e),e.manage&&(n.View.prototype.manage=!0)},setupView:function(e,i){var s,o,a=n.LayoutManager.prototype,f=r.pick(e,t);if(e.__manager__)return;r.defaults(e,{views:{},__manager__:{},_options:u.prototype._options,_removeViews:u._removeViews,_removeView:u._removeView}),e instanceof n.Layout?e.__manager__.prefix=e._options().paths.layout||"":e.__manager__.prefix=e._options().paths.template||"",i=e.options=r.defaults(i||{},e.options,a.options),o=r.pick(i,["events"].concat(r.values(i.events))),r.extend(e,o),delete f.render,r.extend(i,f),e._remove=n.View.prototype.remove,e._render=function(e){var t,n=this._options().beforeRender,s=this._options().afterRender;return this._removeViews(),r.isFunction(n)&&n.call(this,this),this.trigger("beforeRender",this),t=e(this).render(),t.then(function(){var e=this,t=e.__manager__,n=t.parent,o=function(){e.delegateEvents(),e.__manager__.hasRendered=!0,r.isFunction(s)&&s.call(e,e),e.trigger("afterRender",e)},u=function(e){var t=e.__manager__;return t.parent&&!t.parent.__manager__.hasRendered?t.parent:e};if(!n)return o.call(e);if(n.__manager__.hasRendered)return i.when([t.viewDeferred,n.__manager__.viewDeferred]).then(function(){o.call(e)});n=u(e),n.on("afterRender",function(){n.off(null,null,e),o.call(e)},e)}),t},e.render=u.prototype.render,e.remove!==a.remove&&(e._remove=e.remove,e.remove=a.remove),s=i.views||e.views,r.keys(s).length&&e.setViews(s),e.template&&(i.template=e.template,delete e.template)},_removeViews:function(e){e=e||this,e.getViews().each(function(e){u._removeView(e,!0)})},_removeView:function(e,t){var n=e.__manager__,i=r.isBoolean(e.keep)?e.keep:e.options.keep;t=t&&n.parent,u.cleanViews(e);if(!i&&(n.append===!0||t)&&n.hasRendered){e.$el.remove();if(r.isArray(n.parent.views[n.selector]))return n.parent.getView(function(e,t){e.__manager__===n&&n.parent.views[n.selector].splice(t,1)});delete n.parent.views[n.selector]}}});r.each(["get","set","insert"],function(e){var t=n.View.prototype,r=u.prototype;t[e+"View"]=r[e+"View"],t[e+"Views"]=r[e+"Views"]}),n.Layout=n.LayoutManager=u,n.LayoutView=n.View.extend({manage:!0}),n.View.prototype._configure=function(){var e=s.apply(this,arguments);return this.manage&&u.setupView(this),e},u.prototype.options={paths:{},deferred:function(){return i.Deferred()},fetch:function(e){return r.template(i(e).html())},partial:function(e,t,n,r){var s=t?i(e).find(t):i(e);return s.length?(this[r?"append":"html"](s,n),!0):!1},html:function(e,t){i(e).html(t)},append:function(e,t){i(e).append(t)},when:function(e){return i.when.apply(null,e)},render:function(e,t){return e(t)}},t=r.keys(u.prototype.options)}(this),e.define("plugins/backbone.layoutmanager",function(){}),e.define("zeega",["backbone","plugins/backbone.layoutmanager"],function(e){var t={root:"/"},n=window.JST=window.JST||{},r=e.noConflict();return r.Model.prototype.put=function(){var e=[].slice.call(arguments).concat([{silent:!0}]);return this.set.apply(this,e)},_.extend(t,{module:function(e){return _.extend({Views:{}},e)},Backbone:r},r.Events)}),e.define("modules/player/data",["zeega"],function(e){var t={};return t.Model=e.Backbone.Model.extend({url:null,defaults:{authors:null,cover_image:null,date_created:null,date_published:null,date_updated:null,description:null,enabled:!0,estimated_time:null,frames:[],id:3662,item_id:null,layers:[],location:null,published:!1,sequences:[],tags:null,title:null,user_id:null},validate:function(e){this.clear({silent:!0}),this.put(_.pick(e,_.keys(this.defaults)))}}),t}),e.define("zeega_dir/plugins/layers/_layer/_layer",["zeega"],function(e){return _Layer=e.Backbone.Model.extend({layerType:null,controls:[],defaults:{citation:!0,default_controls:!0,draggable:!0,has_controls:!0,linkable:!0,mode:"player",resizable:!1},defaultAttributes:{},initialize:function(){this.defaults=_.extend(this.defaults,this.defaultAttributes),this.init()},init:function(){},player_onPreload:function(){},player_onPlay:function(){},player_onPause:function(){},player_onExit:function(){},player_onUnrender:function(){},player_onRenderError:function(){},editor_onLayerEnter:function(){},editor_onLayerExit:function(){},editor_onControlsOpen:function(){},editor_onControlsClosed:function(){}}),_Layer.Visual=e.Backbone.LayoutView.extend({className:"visual-element",template:"",fetch:function(t){var n;return t="app/templates/"+t+".html",JST[t]?JST[t]:(n=this.async(),$.ajax({url:e.root+t}).then(function(e){n(JST[t]=_.template(e))}))},serialize:function(){return this.model.toJSON()},initialize:function(){this.init()},beforePlayerRender:function(){},beforeRender:function(){var e=$(this.model.get("_target")).find(".ZEEGA-player-window");this.className=this._className+" "+this.className,this.beforePlayerRender(),$(e).append(this.el),this.$el.addClass("visual-element-"+this.model.get("type").toLowerCase()),this.moveOffStage(),this.applySize()},afterRender:function(){this.verifyReady(),this.onRender()},onRender:function(){},applySize:function(){this.$el.css({height:this.getAttr("height")+"%",width:this.getAttr("width")+"%"})},init:function(){},render:function(){},verifyReady:function(){this.model.trigger("visual_ready",this.model.id)},player_onPreload:function(){this.render()},player_onPlay:function(){this.onPlay()},player_onPause:function(){this.onPause()},player_onExit:function(){this.pause(),this.moveOffStage(),this.onExit()},player_onUnrender:function(){},player_onRenderError:function(){},onPreload:function(){},onPlay:function(){},onPause:function(){},onExit:function(){},updateZIndex:function(e){this.$el.css("z-index",e)},editor_onLayerEnter:function(){},editor_onLayerExit:function(){},editor_onControlsOpen:function(){},editor_onControlsClosed:function(){},moveOffStage:function(){this.$el.css({top:"-1000%",left:"-1000%"})},moveOnStage:function(){this.$el.css({top:this.getAttr("top")+"%",left:this.getAttr("left")+"%"})},play:function(){this.isPlaying=!0,this.moveOnStage(),this.player_onPlay()},pause:function(){this.isPlaying=!1,this.player_onPause()},playPause:function(){this.isPlaying!==!1?(this.isPlaying=!1,this.player_onPause()):(this.isPlaying=!0,this.player_onPlay())},getAttr:function(e){return this.model.get("attr")[e]}}),_Layer.LayoutView=e.Backbone.LayoutView.extend({fetch:function(t){var n;return t="app/templates/"+t+".html",JST[t]?JST[t]:(n=this.async(),$.ajax({url:e.root+t}).then(function(e){n(JST[t]=_.template(e))}))}}),_Layer}),function(e,t){var n="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";e.fn.imagesLoaded=function(r){function i(){var t=e(h),n=e(p);u&&(p.length?u.reject(f,t,n):u.resolve(f)),e.isFunction(r)&&r.call(o,f,t,n)}function s(t,r){t.src===n||-1!==e.inArray(t,l)||(l.push(t),r?p.push(t):h.push(t),e.data(t,"imagesLoaded",{isBroken:r,src:t.src}),a&&u.notifyWith(e(t),[r,f,e(h),e(p)]),f.length===l.length&&(setTimeout(i),f.unbind(".imagesLoaded")))}var o=this,u=e.isFunction(e.Deferred)?e.Deferred():0,a=e.isFunction(u.notify),f=o.find("img").add(o.filter("img")),l=[],h=[],p=[];return f.length?f.bind("load.imagesLoaded error.imagesLoaded",function(e){s(e.target,"error"===e.type)}).each(function(r,i){var o=i.src,u=e.data(i,"imagesLoaded");if(u&&u.src===o)s(i,u.isBroken);else if(i.complete&&i.naturalWidth!==t)s(i,0===i.naturalWidth||0===i.naturalHeight);else if(i.readyState||i.complete)i.src=n,i.src=o}):i(),u?u.promise(o):o}}(jQuery),e.define("plugins/jquery.imagesloaded.min",function(){}),e.define("zeega_dir/plugins/layers/image/image",["zeega","zeega_dir/plugins/layers/_layer/_layer","plugins/jquery.imagesloaded.min"],function(e,t){var n=e.module();return n.Image=t.extend({layerType:"Image",defaultAttributes:{title:"Image Layer",url:"none",left:0,top:0,height:100,width:100,opacity:1,aspect:1.33},controls:[{type:"checkbox",property:"dissolve",label:"Fade In"},{type:"slider",property:"width",label:"Scale",suffix:"%",min:1,max:200},{type:"slider",property:"opacity",label:"Scale",step:.01,min:.05,max:1}]}),n.Image.Visual=t.Visual.extend({template:"plugins/image",serialize:function(){return this.model.toJSON()},verifyReady:function(){var e=this.$el.imagesLoaded();e.done(function(){this.model.trigger("visual_ready",this.model.id)}.bind(this)),e.fail(function(){this.model.trigger("visual_error",this.model.id)}.bind(this))}}),n}),e.define("zeega_dir/plugins/layers/link/link",["zeega","zeega_dir/plugins/layers/_layer/_layer"],function(e,t){var n=e.module();return n.Link=t.extend({layerType:"Link",defaultAttributes:{title:"Link Layer",from_sequence:null,to_frame:null,from_frame:null,left:25,top:25,height:50,width:50,opacity:1,opacity_hover:1,blink_on_start:!0,glow_on_hover:!0,citation:!1,linkable:!1,default_controls:!1}}),n.Link.Visual=t.Visual.extend({template:"plugins/link",serialize:function(){return console.log("link layer",this.model),this.model.toJSON()},beforePlayerRender:function(){var e=this,t={"border-radius":"0",height:this.getAttr("height")+"%",background:this.getAttr("backgroundColor"),opacity:this.getAttr("opacity"),"box-shadow":"0 0 10px rgba(255,255,255,"+this.getAttr("opacity")+")"};this.$el.attr("data-glowOnHover",this.getAttr("glow_on_hover")),this.$(".ZEEGA-link-inner").css(t)},events:{"click a":"goClick",mouseover:"onMouseOver",mouseout:"onMouseOut"},onMouseOver:function(){this.$el.stop().fadeTo(500,this.getAttr("opacity_hover"))},onMouseOut:function(){this.$el.stop().fadeTo(500,this.getAttr("opacity"))},goClick:function(){return this.model.relay.set("current_frame",this.getAttr("to_frame")),!1}}),n}),e.define("zeega_dir/plugins/layers/slideshow/slideshow-metadata",["zeega","zeega_dir/plugins/layers/_layer/_layer"],function(e,t){var n={};return n.View=t.LayoutView.extend({className:"slide-metadata",template:"plugins/slideshow-metadata",initialize:function(){this.model.on("all",function(e){console.log("e",e)}),this.model.on("slideshow_update",this.onUpdate,this),this.slideInfo=this.model.get("attr").slides[0].attr},onUpdate:function(e){this.slideInfo=e.data.attr,this.render()},serialize:function(){return _.extend({title:"",description:""},this.slideInfo)}}),n}),e.define("zeega_dir/plugins/layers/slideshow/thumbnail-slider",["zeega","zeega_dir/plugins/layers/_layer/_layer","zeega_dir/plugins/layers/slideshow/slideshow-metadata"],function(e,t,n){var r=t.LayoutView.extend({slide:0,slidePos:0,className:"slideshow-slider",template:"plugins/slideshowthumbslider",initialize:function(){this.slideNum=this.model.get("attr").slides.length,this.model.on("slideshow_update",function(e){this.highlightThumb(e.slideNum)},this),e.on("resize_window",this.onResize,this)},serialize:function(){return this.model.toJSON()},afterRender:function(){this.makeDraggable(),this.sinkThumbSlider(),this.metadata=new n.View({model:this.model}),this.$el.prepend(this.metadata.el),this.metadata.render()},makeDraggable:function(){var e=this.$el.closest(".ZEEGA-player-window").width(),t=-this.$(".slideshow-thumb-wrapper ul").width()+e-10;this.$(".slideshow-thumb-wrapper ul").draggable({axis:"x",containment:[t-e/2,0,e/2,0]})},onResize:function(){this.$el.css("bottom",0)},events:{"click a.slider-thumb":"onClickThumb","click a.trackback":"onClickTrackback",mouseenter:"onMouseOver",mouseleave:"sinkThumbSlider"},onMouseOver:function(){this.sinkThumbsTimer&&clearTimeout(this.sinkThumbsTimer),$(".slideshow-slider").animate({bottom:0})},sinkThumbSlider:function(){var e=this;this.sinkThumbsTimer=setTimeout(function(){$(".slideshow-slider").animate({bottom:-70})},2e3)},onClickThumb:function(e){var t=$(e.target).closest("a").data("slidenum");return this.highlightThumb(t),this.model.trigger("slideshow_switch-frame",t),!1},onClickTrackback:function(){return!1},highlightThumb:function(e){var t=this.$el.closest(".ZEEGA-player-window").width(),n=0,r=this.$("li"),i=r.eq(e);this.slide=e,r.removeClass("active"),i.addClass("active"),n=t/2-i.position().left,this.$(".slideshow-thumb-wrapper ul").stop().animate({left:n},250)}});return r}),function(e,t){function r(t){e.fn.cycle.debug&&i(t)}function i(){window.console&&console.log&&console.log("[cycle] "+Array.prototype.join.call(arguments," "))}function s(t,n,r){var i=e(t).data("cycle.opts");if(!i)return;var s=!!t.cyclePause;s&&i.paused?i.paused(t,i,n,r):!s&&i.resumed&&i.resumed(t,i,n,r)}function o(n,r,o){function l(t,n,r){if(!t&&n===!0){var s=e(r).data("cycle.opts");if(!s)return i("options not found, can not resume"),!1;r.cycleTimeout&&(clearTimeout(r.cycleTimeout),r.cycleTimeout=0),p(s.elements,s,1,!s.backwards)}}n.cycleStop===t&&(n.cycleStop=0);if(r===t||r===null)r={};if(r.constructor==String){switch(r){case"destroy":case"stop":var u=e(n).data("cycle.opts");if(!u)return!1;return n.cycleStop++,n.cycleTimeout&&clearTimeout(n.cycleTimeout),n.cycleTimeout=0,u.elements&&e(u.elements).stop(),e(n).removeData("cycle.opts"),r=="destroy"&&a(n,u),!1;case"toggle":return n.cyclePause=n.cyclePause===1?0:1,l(n.cyclePause,o,n),s(n),!1;case"pause":return n.cyclePause=1,s(n),!1;case"resume":return n.cyclePause=0,l(!1,o,n),s(n),!1;case"prev":case"next":u=e(n).data("cycle.opts");if(!u)return i('options not found, "prev/next" ignored'),!1;return e.fn.cycle[r](u),!1;default:r={fx:r}}return r}if(r.constructor==Number){var f=r;return r=e(n).data("cycle.opts"),r?f<0||f>=r.elements.length?(i("invalid slide index: "+f),!1):(r.nextSlide=f,n.cycleTimeout&&(clearTimeout(n.cycleTimeout),n.cycleTimeout=0),typeof o=="string"&&(r.oneTimeFx=o),p(r.elements,r,1,f>=r.currSlide),!1):(i("options not found, can not advance slide"),!1)}return r}function u(t,n){if(!e.support.opacity&&n.cleartype&&t.style.filter)try{t.style.removeAttribute("filter")}catch(r){}}function a(t,n){n.next&&e(n.next).unbind(n.prevNextEvent),n.prev&&e(n.prev).unbind(n.prevNextEvent),(n.pager||n.pagerAnchorBuilder)&&e.each(n.pagerAnchors||[],function(){this.unbind().remove()}),n.pagerAnchors=null,e(t).unbind("mouseenter.cycle mouseleave.cycle"),n.destroy&&n.destroy(n)}function f(n,r,o,a,f){var d,y=e.extend({},e.fn.cycle.defaults,a||{},e.metadata?n.metadata():e.meta?n.data():{}),b=e.isFunction(n.data)?n.data(y.metaAttr):null;b&&(y=e.extend(y,b)),y.autostop&&(y.countdown=y.autostopCount||o.length);var w=n[0];n.data("cycle.opts",y),y.$cont=n,y.stopCount=w.cycleStop,y.elements=o,y.before=y.before?[y.before]:[],y.after=y.after?[y.after]:[],!e.support.opacity&&y.cleartype&&y.after.push(function(){u(this,y)}),y.continuous&&y.after.push(function(){p(o,y,0,!y.backwards)}),l(y),!e.support.opacity&&y.cleartype&&!y.cleartypeNoBg&&g(r),n.css("position")=="static"&&n.css("position","relative"),y.width&&n.width(y.width),y.height&&y.height!="auto"&&n.height(y.height),y.startingSlide!==t?(y.startingSlide=parseInt(y.startingSlide,10),y.startingSlide>=o.length||y.startSlide<0?y.startingSlide=0:d=!0):y.backwards?y.startingSlide=o.length-1:y.startingSlide=0;if(y.random){y.randomMap=[];for(var E=0;E<o.length;E++)y.randomMap.push(E);y.randomMap.sort(function(e,t){return Math.random()-.5});if(d)for(var S=0;S<o.length;S++)y.startingSlide==y.randomMap[S]&&(y.randomIndex=S);else y.randomIndex=1,y.startingSlide=y.randomMap[1]}else y.startingSlide>=o.length&&(y.startingSlide=0);y.currSlide=y.startingSlide||0;var x=y.startingSlide;r.css({position:"absolute",top:0,left:0}).hide().each(function(t){var n;y.backwards?n=x?t<=x?o.length+(t-x):x-t:o.length-t:n=x?t>=x?o.length-(t-x):x-t:o.length-t,e(this).css("z-index",n)}),e(o[x]).css("opacity",1).show(),u(o[x],y),y.fit&&(y.aspect?r.each(function(){var t=e(this),n=y.aspect===!0?t.width()/t.height():y.aspect;y.width&&t.width()!=y.width&&(t.width(y.width),t.height(y.width/n)),y.height&&t.height()<y.height&&(t.height(y.height),t.width(y.height*n))}):(y.width&&r.width(y.width),y.height&&y.height!="auto"&&r.height(y.height))),y.center&&(!y.fit||y.aspect)&&r.each(function(){var t=e(this);t.css({"margin-left":y.width?(y.width-t.width())/2+"px":0,"margin-top":y.height?(y.height-t.height())/2+"px":0})}),y.center&&!y.fit&&!y.slideResize&&r.each(function(){var t=e(this);t.css({"margin-left":y.width?(y.width-t.width())/2+"px":0,"margin-top":y.height?(y.height-t.height())/2+"px":0})});var T=(y.containerResize||y.containerResizeHeight)&&!n.innerHeight();if(T){var N=0,C=0;for(var k=0;k<o.length;k++){var L=e(o[k]),A=L[0],O=L.outerWidth(),M=L.outerHeight();O||(O=A.offsetWidth||A.width||L.attr("width")),M||(M=A.offsetHeight||A.height||L.attr("height")),N=O>N?O:N,C=M>C?M:C}y.containerResize&&N>0&&C>0&&n.css({width:N+"px",height:C+"px"}),y.containerResizeHeight&&C>0&&n.css({height:C+"px"})}var _=!1;y.pause&&n.bind("mouseenter.cycle",function(){_=!0,this.cyclePause++,s(w,!0)}).bind("mouseleave.cycle",function(){_&&this.cyclePause--,s(w,!0)});if(c(y)===!1)return!1;var D=!1;a.requeueAttempts=a.requeueAttempts||0,r.each(function(){var t=e(this);this.cycleH=y.fit&&y.height?y.height:t.height()||this.offsetHeight||this.height||t.attr("height")||0,this.cycleW=y.fit&&y.width?y.width:t.width()||this.offsetWidth||this.width||t.attr("width")||0;if(t.is("img")){var n=e.browser.msie&&this.cycleW==28&&this.cycleH==30&&!this.complete,r=e.browser.mozilla&&this.cycleW==34&&this.cycleH==19&&!this.complete,s=e.browser.opera&&(this.cycleW==42&&this.cycleH==19||this.cycleW==37&&this.cycleH==17)&&!this.complete,o=this.cycleH===0&&this.cycleW===0&&!this.complete;if(n||r||s||o){if(f.s&&y.requeueOnImageNotLoaded&&++a.requeueAttempts<100)return i(a.requeueAttempts," - img slide not loaded, requeuing slideshow: ",this.src,this.cycleW,this.cycleH),setTimeout(function(){e(f.s,f.c).cycle(a)},y.requeueTimeout),D=!0,!1;i("could not determine size of image: "+this.src,this.cycleW,this.cycleH)}}return!0});if(D)return!1;y.cssBefore=y.cssBefore||{},y.cssAfter=y.cssAfter||{},y.cssFirst=y.cssFirst||{},y.animIn=y.animIn||{},y.animOut=y.animOut||{},r.not(":eq("+x+")").css(y.cssBefore),e(r[x]).css(y.cssFirst);if(y.timeout){y.timeout=parseInt(y.timeout,10),y.speed.constructor==String&&(y.speed=e.fx.speeds[y.speed]||parseInt(y.speed,10)),y.sync||(y.speed=y.speed/2);var P=y.fx=="none"?0:y.fx=="shuffle"?500:250;while(y.timeout-y.speed<P)y.timeout+=y.speed}y.easing&&(y.easeIn=y.easeOut=y.easing),y.speedIn||(y.speedIn=y.speed),y.speedOut||(y.speedOut=y.speed),y.slideCount=o.length,y.currSlide=y.lastSlide=x,y.random?(++y.randomIndex==o.length&&(y.randomIndex=0),y.nextSlide=y.randomMap[y.randomIndex]):y.backwards?y.nextSlide=y.startingSlide===0?o.length-1:y.startingSlide-1:y.nextSlide=y.startingSlide>=o.length-1?0:y.startingSlide+1;if(!y.multiFx){var H=e.fn.cycle.transitions[y.fx];if(e.isFunction(H))H(n,r,y);else if(y.fx!="custom"&&!y.multiFx)return i("unknown transition: "+y.fx,"; slideshow terminating"),!1}var B=r[x];return y.skipInitializationCallbacks||(y.before.length&&y.before[0].apply(B,[B,B,y,!0]),y.after.length&&y.after[0].apply(B,[B,B,y,!0])),y.next&&e(y.next).bind(y.prevNextEvent,function(){return v(y,1)}),y.prev&&e(y.prev).bind(y.prevNextEvent,function(){return v(y,0)}),(y.pager||y.pagerAnchorBuilder)&&m(o,y),h(y,o),y}function l(t){t.original={before:[],after:[]},t.original.cssBefore=e.extend({},t.cssBefore),t.original.cssAfter=e.extend({},t.cssAfter),t.original.animIn=e.extend({},t.animIn),t.original.animOut=e.extend({},t.animOut),e.each(t.before,function(){t.original.before.push(this)}),e.each(t.after,function(){t.original.after.push(this)})}function c(t){var n,s,o=e.fn.cycle.transitions;if(t.fx.indexOf(",")>0){t.multiFx=!0,t.fxs=t.fx.replace(/\s*/g,"").split(",");for(n=0;n<t.fxs.length;n++){var u=t.fxs[n];s=o[u];if(!s||!o.hasOwnProperty(u)||!e.isFunction(s))i("discarding unknown transition: ",u),t.fxs.splice(n,1),n--}if(!t.fxs.length)return i("No valid transitions named; slideshow terminating."),!1}else if(t.fx=="all"){t.multiFx=!0,t.fxs=[];for(var a in o)o.hasOwnProperty(a)&&(s=o[a],o.hasOwnProperty(a)&&e.isFunction(s)&&t.fxs.push(a))}if(t.multiFx&&t.randomizeEffects){var f=Math.floor(Math.random()*20)+30;for(n=0;n<f;n++){var l=Math.floor(Math.random()*t.fxs.length);t.fxs.push(t.fxs.splice(l,1)[0])}r("randomized fx sequence: ",t.fxs)}return!0}function h(t,n){t.addSlide=function(r,i){var s=e(r),o=s[0];t.autostopCount||t.countdown++,n[i?"unshift":"push"](o),t.els&&t.els[i?"unshift":"push"](o),t.slideCount=n.length,t.random&&(t.randomMap.push(t.slideCount-1),t.randomMap.sort(function(e,t){return Math.random()-.5})),s.css("position","absolute"),s[i?"prependTo":"appendTo"](t.$cont),i&&(t.currSlide++,t.nextSlide++),!e.support.opacity&&t.cleartype&&!t.cleartypeNoBg&&g(s),t.fit&&t.width&&s.width(t.width),t.fit&&t.height&&t.height!="auto"&&s.height(t.height),o.cycleH=t.fit&&t.height?t.height:s.height(),o.cycleW=t.fit&&t.width?t.width:s.width(),s.css(t.cssBefore),(t.pager||t.pagerAnchorBuilder)&&e.fn.cycle.createPagerAnchor(n.length-1,o,e(t.pager),n,t),e.isFunction(t.onAddSlide)?t.onAddSlide(s):s.hide()}}function p(n,i,s,o){function m(){var e=0,t=i.timeout;i.timeout&&!i.continuous?(e=d(n[i.currSlide],n[i.nextSlide],i,o),i.fx=="shuffle"&&(e-=i.speedOut)):i.continuous&&u.cyclePause&&(e=10),e>0&&(u.cycleTimeout=setTimeout(function(){p(n,i,0,!i.backwards)},e))}var u=i.$cont[0],a=n[i.currSlide],f=n[i.nextSlide];s&&i.busy&&i.manualTrump&&(r("manualTrump in go(), stopping active transition"),e(n).stop(!0,!0),i.busy=0,clearTimeout(u.cycleTimeout));if(i.busy){r("transition active, ignoring new tx request");return}if(u.cycleStop!=i.stopCount||u.cycleTimeout===0&&!s)return;if(!s&&!u.cyclePause&&!i.bounce&&(i.autostop&&--i.countdown<=0||i.nowrap&&!i.random&&i.nextSlide<i.currSlide)){i.end&&i.end(i);return}var l=!1;if((s||!u.cyclePause)&&i.nextSlide!=i.currSlide){l=!0;var c=i.fx;a.cycleH=a.cycleH||e(a).height(),a.cycleW=a.cycleW||e(a).width(),f.cycleH=f.cycleH||e(f).height(),f.cycleW=f.cycleW||e(f).width(),i.multiFx&&(o&&(i.lastFx===t||++i.lastFx>=i.fxs.length)?i.lastFx=0:!o&&(i.lastFx===t||--i.lastFx<0)&&(i.lastFx=i.fxs.length-1),c=i.fxs[i.lastFx]),i.oneTimeFx&&(c=i.oneTimeFx,i.oneTimeFx=null),e.fn.cycle.resetState(i,c),i.before.length&&e.each(i.before,function(e,t){if(u.cycleStop!=i.stopCount)return;t.apply(f,[a,f,i,o])});var h=function(){i.busy=0,e.each(i.after,function(e,t){if(u.cycleStop!=i.stopCount)return;t.apply(f,[a,f,i,o])}),u.cycleStop||m()};r("tx firing("+c+"); currSlide: "+i.currSlide+"; nextSlide: "+i.nextSlide),i.busy=1,i.fxFn?i.fxFn(a,f,i,h,o,s&&i.fastOnEvent):e.isFunction(e.fn.cycle[i.fx])?e.fn.cycle[i.fx](a,f,i,h,o,s&&i.fastOnEvent):e.fn.cycle.custom(a,f,i,h,o,s&&i.fastOnEvent)}else m();if(l||i.nextSlide==i.currSlide){var v;i.lastSlide=i.currSlide,i.random?(i.currSlide=i.nextSlide,++i.randomIndex==n.length&&(i.randomIndex=0,i.randomMap.sort(function(e,t){return Math.random()-.5})),i.nextSlide=i.randomMap[i.randomIndex],i.nextSlide==i.currSlide&&(i.nextSlide=i.currSlide==i.slideCount-1?0:i.currSlide+1)):i.backwards?(v=i.nextSlide-1<0,v&&i.bounce?(i.backwards=!i.backwards,i.nextSlide=1,i.currSlide=0):(i.nextSlide=v?n.length-1:i.nextSlide-1,i.currSlide=v?0:i.nextSlide+1)):(v=i.nextSlide+1==n.length,v&&i.bounce?(i.backwards=!i.backwards,i.nextSlide=n.length-2,i.currSlide=n.length-1):(i.nextSlide=v?0:i.nextSlide+1,i.currSlide=v?n.length-1:i.nextSlide-1))}l&&i.pager&&i.updateActivePagerLink(i.pager,i.currSlide,i.activePagerClass)}function d(e,t,n,i){if(n.timeoutFn){var s=n.timeoutFn.call(e,e,t,n,i);while(n.fx!="none"&&s-n.speed<250)s+=n.speed;r("calculated timeout: "+s+"; speed: "+n.speed);if(s!==!1)return s}return n.timeout}function v(t,n){var r=n?1:-1,i=t.elements,s=t.$cont[0],o=s.cycleTimeout;o&&(clearTimeout(o),s.cycleTimeout=0);if(t.random&&r<0)t.randomIndex--,--t.randomIndex==-2?t.randomIndex=i.length-2:t.randomIndex==-1&&(t.randomIndex=i.length-1),t.nextSlide=t.randomMap[t.randomIndex];else if(t.random)t.nextSlide=t.randomMap[t.randomIndex];else{t.nextSlide=t.currSlide+r;if(t.nextSlide<0){if(t.nowrap)return!1;t.nextSlide=i.length-1}else if(t.nextSlide>=i.length){if(t.nowrap)return!1;t.nextSlide=0}}var u=t.onPrevNextEvent||t.prevNextClick;return e.isFunction(u)&&u(r>0,t.nextSlide,i[t.nextSlide]),p(i,t,1,n),!1}function m(t,n){var r=e(n.pager);e.each(t,function(i,s){e.fn.cycle.createPagerAnchor(i,s,r,t,n)}),n.updateActivePagerLink(n.pager,n.startingSlide,n.activePagerClass)}function g(t){function n(e){return e=parseInt(e,10).toString(16),e.length<2?"0"+e:e}function i(t){for(;t&&t.nodeName.toLowerCase()!="html";t=t.parentNode){var r=e.css(t,"background-color");if(r&&r.indexOf("rgb")>=0){var i=r.match(/\d+/g);return"#"+n(i[0])+n(i[1])+n(i[2])}if(r&&r!="transparent")return r}return"#ffffff"}r("applying clearType background-color hack"),t.each(function(){e(this).css("background-color",i(this))})}var n="2.9999.8";e.support===t&&(e.support={opacity:!e.browser.msie}),e.expr[":"].paused=function(e){return e.cyclePause},e.fn.cycle=function(t,n){var s={s:this.selector,c:this.context};return this.length===0&&t!="stop"?!e.isReady&&s.s?(i("DOM not ready, queuing slideshow"),e(function(){e(s.s,s.c).cycle(t,n)}),this):(i("terminating; zero elements found by selector"+(e.isReady?"":" (DOM not ready)")),this):this.each(function(){var u=o(this,t,n);if(u===!1)return;u.updateActivePagerLink=u.updateActivePagerLink||e.fn.cycle.updateActivePagerLink,this.cycleTimeout&&clearTimeout(this.cycleTimeout),this.cycleTimeout=this.cyclePause=0,this.cycleStop=0;var a=e(this),l=u.slideExpr?e(u.slideExpr,this):a.children(),c=l.get();if(c.length<2){i("terminating; too few slides: "+c.length);return}var h=f(a,l,c,u,s);if(h===!1)return;var v=h.continuous?10:d(c[h.currSlide],c[h.nextSlide],h,!h.backwards);v&&(v+=h.delay||0,v<10&&(v=10),r("first timeout: "+v),this.cycleTimeout=setTimeout(function(){p(c,h,0,!u.backwards)},v))})},e.fn.cycle.resetState=function(t,n){n=n||t.fx,t.before=[],t.after=[],t.cssBefore=e.extend({},t.original.cssBefore),t.cssAfter=e.extend({},t.original.cssAfter),t.animIn=e.extend({},t.original.animIn),t.animOut=e.extend({},t.original.animOut),t.fxFn=null,e.each(t.original.before,function(){t.before.push(this)}),e.each(t.original.after,function(){t.after.push(this)});var r=e.fn.cycle.transitions[n];e.isFunction(r)&&r(t.$cont,e(t.elements),t)},e.fn.cycle.updateActivePagerLink=function(t,n,r){e(t).each(function(){e(this).children().removeClass(r).eq(n).addClass(r)})},e.fn.cycle.next=function(e){v(e,1)},e.fn.cycle.prev=function(e){v(e,0)},e.fn.cycle.createPagerAnchor=function(t,n,i,o,u){var a;e.isFunction(u.pagerAnchorBuilder)?(a=u.pagerAnchorBuilder(t,n),r("pagerAnchorBuilder("+t+", el) returned: "+a)):a='<a href="#">'+(t+1)+"</a>";if(!a)return;var f=e(a);if(f.parents("body").length===0){var l=[];i.length>1?(i.each(function(){var t=f.clone(!0);e(this).append(t),l.push(t[0])}),f=e(l)):f.appendTo(i)}u.pagerAnchors=u.pagerAnchors||[],u.pagerAnchors.push(f);var c=function(n){n.preventDefault(),u.nextSlide=t;var r=u.$cont[0],i=r.cycleTimeout;i&&(clearTimeout(i),r.cycleTimeout=0);var s=u.onPagerEvent||u.pagerClick;e.isFunction(s)&&s(u.nextSlide,o[u.nextSlide]),p(o,u,1,u.currSlide<t)};/mouseenter|mouseover/i.test(u.pagerEvent)?f.hover(c,function(){}):f.bind(u.pagerEvent,c),!/^click/.test(u.pagerEvent)&&!u.allowPagerClickBubble&&f.bind("click.cycle",function(){return!1});var h=u.$cont[0],d=!1;u.pauseOnPagerHover&&f.hover(function(){d=!0,h.cyclePause++,s(h,!0,!0)},function(){d&&h.cyclePause--,s(h,!0,!0)})},e.fn.cycle.hopsFromLast=function(e,t){var n,r=e.lastSlide,i=e.currSlide;return t?n=i>r?i-r:e.slideCount-r:n=i<r?r-i:r+e.slideCount-i,n},e.fn.cycle.commonReset=function(t,n,r,i,s,o){e(r.elements).not(t).hide(),typeof r.cssBefore.opacity=="undefined"&&(r.cssBefore.opacity=1),r.cssBefore.display="block",r.slideResize&&i!==!1&&n.cycleW>0&&(r.cssBefore.width=n.cycleW),r.slideResize&&s!==!1&&n.cycleH>0&&(r.cssBefore.height=n.cycleH),r.cssAfter=r.cssAfter||{},r.cssAfter.display="none",e(t).css("zIndex",r.slideCount+(o===!0?1:0)),e(n).css("zIndex",r.slideCount+(o===!0?0:1))},e.fn.cycle.custom=function(t,n,r,i,s,o){var u=e(t),a=e(n),f=r.speedIn,l=r.speedOut,c=r.easeIn,h=r.easeOut;a.css(r.cssBefore),o&&(typeof o=="number"?f=l=o:f=l=1,c=h=null);var p=function(){a.animate(r.animIn,f,c,function(){i()})};u.animate(r.animOut,l,h,function(){u.css(r.cssAfter),r.sync||p()}),r.sync&&p()},e.fn.cycle.transitions={fade:function(t,n,r){n.not(":eq("+r.currSlide+")").css("opacity",0),r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r),r.cssBefore.opacity=0}),r.animIn={opacity:1},r.animOut={opacity:0},r.cssBefore={top:0,left:0}}},e.fn.cycle.ver=function(){return n},e.fn.cycle.defaults={activePagerClass:"activeSlide",after:null,allowPagerClickBubble:!1,animIn:null,animOut:null,aspect:!1,autostop:0,autostopCount:0,backwards:!1,before:null,center:null,cleartype:!e.support.opacity,cleartypeNoBg:!1,containerResize:1,containerResizeHeight:0,continuous:0,cssAfter:null,cssBefore:null,delay:0,easeIn:null,easeOut:null,easing:null,end:null,fastOnEvent:0,fit:0,fx:"fade",fxFn:null,height:"auto",manualTrump:!0,metaAttr:"cycle",next:null,nowrap:0,onPagerEvent:null,onPrevNextEvent:null,pager:null,pagerAnchorBuilder:null,pagerEvent:"click.cycle",pause:0,pauseOnPagerHover:0,prev:null,prevNextEvent:"click.cycle",random:0,randomizeEffects:1,requeueOnImageNotLoaded:!0,requeueTimeout:250,rev:0,shuffle:null,skipInitializationCallbacks:!1,slideExpr:null,slideResize:1,speed:1e3,speedIn:null,speedOut:null,startingSlide:t,sync:1,timeout:4e3,timeoutFn:null,updateActivePagerLink:null,width:null}}(jQuery),function(e){e.fn.cycle.transitions.none=function(t,n,r){r.fxFn=function(t,n,r,i){e(n).show(),e(t).hide(),i()}},e.fn.cycle.transitions.fadeout=function(t,n,r){n.not(":eq("+r.currSlide+")").css({display:"block",opacity:1}),r.before.push(function(t,n,r,i,s,o){e(t).css("zIndex",r.slideCount+(o!==!0?1:0)),e(n).css("zIndex",r.slideCount+(o!==!0?0:1))}),r.animIn.opacity=1,r.animOut.opacity=0,r.cssBefore.opacity=1,r.cssBefore.display="block",r.cssAfter.zIndex=0},e.fn.cycle.transitions.scrollUp=function(t,n,r){t.css("overflow","hidden"),r.before.push(e.fn.cycle.commonReset);var i=t.height();r.cssBefore.top=i,r.cssBefore.left=0,r.cssFirst.top=0,r.animIn.top=0,r.animOut.top=-i},e.fn.cycle.transitions.scrollDown=function(t,n,r){t.css("overflow","hidden"),r.before.push(e.fn.cycle.commonReset);var i=t.height();r.cssFirst.top=0,r.cssBefore.top=-i,r.cssBefore.left=0,r.animIn.top=0,r.animOut.top=i},e.fn.cycle.transitions.scrollLeft=function(t,n,r){t.css("overflow","hidden"),r.before.push(e.fn.cycle.commonReset);var i=t.width();r.cssFirst.left=0,r.cssBefore.left=i,r.cssBefore.top=0,r.animIn.left=0,r.animOut.left=0-i},e.fn.cycle.transitions.scrollRight=function(t,n,r){t.css("overflow","hidden"),r.before.push(e.fn.cycle.commonReset);var i=t.width();r.cssFirst.left=0,r.cssBefore.left=-i,r.cssBefore.top=0,r.animIn.left=0,r.animOut.left=i},e.fn.cycle.transitions.scrollHorz=function(t,n,r){t.css("overflow","hidden").width(),r.before.push(function(t,n,r,i){r.rev&&(i=!i),e.fn.cycle.commonReset(t,n,r),r.cssBefore.left=i?n.cycleW-1:1-n.cycleW,r.animOut.left=i?-t.cycleW:t.cycleW}),r.cssFirst.left=0,r.cssBefore.top=0,r.animIn.left=0,r.animOut.top=0},e.fn.cycle.transitions.scrollVert=function(t,n,r){t.css("overflow","hidden"),r.before.push(function(t,n,r,i){r.rev&&(i=!i),e.fn.cycle.commonReset(t,n,r),r.cssBefore.top=i?1-n.cycleH:n.cycleH-1,r.animOut.top=i?t.cycleH:-t.cycleH}),r.cssFirst.top=0,r.cssBefore.left=0,r.animIn.top=0,r.animOut.left=0},e.fn.cycle.transitions.slideX=function(t,n,r){r.before.push(function(t,n,r){e(r.elements).not(t).hide(),e.fn.cycle.commonReset(t,n,r,!1,!0),r.animIn.width=n.cycleW}),r.cssBefore.left=0,r.cssBefore.top=0,r.cssBefore.width=0,r.animIn.width="show",r.animOut.width=0},e.fn.cycle.transitions.slideY=function(t,n,r){r.before.push(function(t,n,r){e(r.elements).not(t).hide(),e.fn.cycle.commonReset(t,n,r,!0,!1),r.animIn.height=n.cycleH}),r.cssBefore.left=0,r.cssBefore.top=0,r.cssBefore.height=0,r.animIn.height="show",r.animOut.height=0},e.fn.cycle.transitions.shuffle=function(t,n,r){var i,s=t.css("overflow","visible").width();n.css({left:0,top:0}),r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r,!0,!0,!0)}),r.speedAdjusted||(r.speed=r.speed/2,r.speedAdjusted=!0),r.random=0,r.shuffle=r.shuffle||{left:-s,top:15},r.els=[];for(i=0;i<n.length;i++)r.els.push(n[i]);for(i=0;i<r.currSlide;i++)r.els.push(r.els.shift());r.fxFn=function(t,n,r,i,s){r.rev&&(s=!s);var o=s?e(t):e(n);e(n).css(r.cssBefore);var u=r.slideCount;o.animate(r.shuffle,r.speedIn,r.easeIn,function(){var n=e.fn.cycle.hopsFromLast(r,s);for(var a=0;a<n;a++)s?r.els.push(r.els.shift()):r.els.unshift(r.els.pop());if(s)for(var f=0,l=r.els.length;f<l;f++)e(r.els[f]).css("z-index",l-f+u);else{var c=e(t).css("z-index");o.css("z-index",parseInt(c,10)+1+u)}o.animate({left:0,top:0},r.speedOut,r.easeOut,function(){e(s?this:t).hide(),i&&i()})})},e.extend(r.cssBefore,{display:"block",opacity:1,top:0,left:0})},e.fn.cycle.transitions.turnUp=function(t,n,r){r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r,!0,!1),r.cssBefore.top=n.cycleH,r.animIn.height=n.cycleH,r.animOut.width=n.cycleW}),r.cssFirst.top=0,r.cssBefore.left=0,r.cssBefore.height=0,r.animIn.top=0,r.animOut.height=0},e.fn.cycle.transitions.turnDown=function(t,n,r){r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r,!0,!1),r.animIn.height=n.cycleH,r.animOut.top=t.cycleH}),r.cssFirst.top=0,r.cssBefore.left=0,r.cssBefore.top=0,r.cssBefore.height=0,r.animOut.height=0},e.fn.cycle.transitions.turnLeft=function(t,n,r){r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r,!1,!0),r.cssBefore.left=n.cycleW,r.animIn.width=n.cycleW}),r.cssBefore.top=0,r.cssBefore.width=0,r.animIn.left=0,r.animOut.width=0},e.fn.cycle.transitions.turnRight=function(t,n,r){r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r,!1,!0),r.animIn.width=n.cycleW,r.animOut.left=t.cycleW}),e.extend(r.cssBefore,{top:0,left:0,width:0}),r.animIn.left=0,r.animOut.width=0},e.fn.cycle.transitions.zoom=function(t,n,r){r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r,!1,!1,!0),r.cssBefore.top=n.cycleH/2,r.cssBefore.left=n.cycleW/2,e.extend(r.animIn,{top:0,left:0,width:n.cycleW,height:n.cycleH}),e.extend(r.animOut,{width:0,height:0,top:t.cycleH/2,left:t.cycleW/2})}),r.cssFirst.top=0,r.cssFirst.left=0,r.cssBefore.width=0,r.cssBefore.height=0},e.fn.cycle.transitions.fadeZoom=function(t,n,r){r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r,!1,!1),r.cssBefore.left=n.cycleW/2,r.cssBefore.top=n.cycleH/2,e.extend(r.animIn,{top:0,left:0,width:n.cycleW,height:n.cycleH})}),r.cssBefore.width=0,r.cssBefore.height=0,r.animOut.opacity=0},e.fn.cycle.transitions.blindX=function(t,n,r){var i=t.css("overflow","hidden").width();r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r),r.animIn.width=n.cycleW,r.animOut.left=t.cycleW}),r.cssBefore.left=i,r.cssBefore.top=0,r.animIn.left=0,r.animOut.left=i},e.fn.cycle.transitions.blindY=function(t,n,r){var i=t.css("overflow","hidden").height();r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r),r.animIn.height=n.cycleH,r.animOut.top=t.cycleH}),r.cssBefore.top=i,r.cssBefore.left=0,r.animIn.top=0,r.animOut.top=i},e.fn.cycle.transitions.blindZ=function(t,n,r){var i=t.css("overflow","hidden").height(),s=t.width();r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r),r.animIn.height=n.cycleH,r.animOut.top=t.cycleH}),r.cssBefore.top=i,r.cssBefore.left=s,r.animIn.top=0,r.animIn.left=0,r.animOut.top=i,r.animOut.left=s},e.fn.cycle.transitions.growX=function(t,n,r){r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r,!1,!0),r.cssBefore.left=this.cycleW/2,r.animIn.left=0,r.animIn.width=this.cycleW,r.animOut.left=0}),r.cssBefore.top=0,r.cssBefore.width=0},e.fn.cycle.transitions.growY=function(t,n,r){r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r,!0,!1),r.cssBefore.top=this.cycleH/2,r.animIn.top=0,r.animIn.height=this.cycleH,r.animOut.top=0}),r.cssBefore.height=0,r.cssBefore.left=0},e.fn.cycle.transitions.curtainX=function(t,n,r){r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r,!1,!0,!0),r.cssBefore.left=n.cycleW/2,r.animIn.left=0,r.animIn.width=this.cycleW,r.animOut.left=t.cycleW/2,r.animOut.width=0}),r.cssBefore.top=0,r.cssBefore.width=0},e.fn.cycle.transitions.curtainY=function(t,n,r){r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r,!0,!1,!0),r.cssBefore.top=n.cycleH/2,r.animIn.top=0,r.animIn.height=n.cycleH,r.animOut.top=t.cycleH/2,r.animOut.height=0}),r.cssBefore.height=0,r.cssBefore.left=0},e.fn.cycle.transitions.cover=function(t,n,r){var i=r.direction||"left",s=t.css("overflow","hidden").width(),o=t.height();r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r),r.cssAfter.display="",i=="right"?r.cssBefore.left=-s:i=="up"?r.cssBefore.top=o:i=="down"?r.cssBefore.top=-o:r.cssBefore.left=s}),r.animIn.left=0,r.animIn.top=0,r.cssBefore.top=0,r.cssBefore.left=0},e.fn.cycle.transitions.uncover=function(t,n,r){var i=r.direction||"left",s=t.css("overflow","hidden").width(),o=t.height();r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r,!0,!0,!0),i=="right"?r.animOut.left=s:i=="up"?r.animOut.top=-o:i=="down"?r.animOut.top=o:r.animOut.left=-s}),r.animIn.left=0,r.animIn.top=0,r.cssBefore.top=0,r.cssBefore.left=0},e.fn.cycle.transitions.toss=function(t,n,r){var i=t.css("overflow","visible").width(),s=t.height();r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r,!0,!0,!0),!r.animOut.left&&!r.animOut.top?e.extend(r.animOut,{left:i*2,top:-s/2,opacity:0}):r.animOut.opacity=0}),r.cssBefore.left=0,r.cssBefore.top=0,r.animIn.left=0},e.fn.cycle.transitions.wipe=function(t,n,r){var i=t.css("overflow","hidden").width(),s=t.height();r.cssBefore=r.cssBefore||{};var o;if(r.clip)if(/l2r/.test(r.clip))o="rect(0px 0px "+s+"px 0px)";else if(/r2l/.test(r.clip))o="rect(0px "+i+"px "+s+"px "+i+"px)";else if(/t2b/.test(r.clip))o="rect(0px "+i+"px 0px 0px)";else if(/b2t/.test(r.clip))o="rect("+s+"px "+i+"px "+s+"px 0px)";else if(/zoom/.test(r.clip)){var u=parseInt(s/2,10),a=parseInt(i/2,10);o="rect("+u+"px "+a+"px "+u+"px "+a+"px)"}r.cssBefore.clip=r.cssBefore.clip||o||"rect(0px 0px 0px 0px)";var f=r.cssBefore.clip.match(/(\d+)/g),l=parseInt(f[0],10),c=parseInt(f[1],10),h=parseInt(f[2],10),p=parseInt(f[3],10);r.before.push(function(t,n,r){if(t==n)return;var o=e(t),u=e(n);e.fn.cycle.commonReset(t,n,r,!0,!0,!1),r.cssAfter.display="block";var a=1,f=parseInt(r.speedIn/13,10)-1;(function d(){var e=l?l-parseInt(a*(l/f),10):0,t=p?p-parseInt(a*(p/f),10):0,n=h<s?h+parseInt(a*((s-h)/f||1),10):s,r=c<i?c+parseInt(a*((i-c)/f||1),10):i;u.css({clip:"rect("+e+"px "+r+"px "+n+"px "+t+"px)"}),a++<=f?setTimeout(d,13):o.css("display","none")})()}),e.extend(r.cssBefore,{display:"block",opacity:1,top:0,left:0}),r.animIn={left:0},r.animOut={left:0}}}(jQuery),e.define("zeega_dir/plugins/layers/slideshow/cycle/cycle",function(){}),e.define("zeega_dir/plugins/layers/slideshow/slideshow",["zeega","zeega_dir/plugins/layers/_layer/_layer","zeega_dir/plugins/layers/slideshow/thumbnail-slider","zeega_dir/plugins/layers/slideshow/cycle/cycle"],function(e,t,n){var r=e.module();return r.SlideShow=t.extend({layerType:"SlideShow",defaultAttributes:{arrows:!0,keyboard:!1,thumbnail_slider:!0,start_slide:null,start_slide_id:null,slides_bleed:!0,title:"Slideshow Layer",url:"none",left:0,top:0,height:100,width:100,opacity:1,aspect:1.33}}),r.SlideShow.Visual=t.Visual.extend({template:"plugins/slideshow",slide:0,init:function(){this.slideCount=this.model.get("attr").slides.length,this.model.on("slideshow_switch-frame",this.scrollTo,this),e.on("resize_window",this.positionArrows,this)},serialize:function(){return this.model.toJSON()},onPlay:function(){var e,t=this.model.get("start_slide"),n=this.model.get("start_slide_id");this.$el.css({height:"100%"}),this.hideArrows(),this.initKeyboard(),this.emitSlideData(this.slide),this.positionArrows(),this.$(".slideshow-container").cycle({timeout:0,fx:"scrollHorz"})},onRender:function(){this.$el.css("height",this.$el.closest(".ZEEGA-player").height()),this.thumbSlider=new n({model:this.model}),this.$el.append(this.thumbSlider.el),this.thumbSlider.render()},onExit:function(){this.killKeyboard(),this.$(".slideshow-container").cycle("destroy")},events:{"click  .slideshow-control-prev":"goLeft","click  .slideshow-control-next":"goRight"},goLeft:function(){return this.slide>0&&(this.slide--,this.scrollTo(this.slide)),!1},goRight:function(){return this.slide<this.slideCount-1&&(this.slide++,this.scrollTo(this.slide)),!1},scrollTo:function(e){this.slide=e,this.hideArrows(),this.$(".slideshow-container").cycle(e),this.updateTitle(e),this.emitSlideData(e)},updateTitle:function(e){var t=this.model.get("attr").slides[e];this.$(".slide-title").text(t.attr.title),this.$(".slide-description").text(t.attr.description)},emitSlideData:function(e){this.model.trigger("slideshow_update",{slideNum:e,data:this.getAttr("slides")[e]})},positionArrows:function(){this.$(".slideshow-arrow").css({top:this.$el.closest(".ZEEGA-player").height()/2-50+"px",height:this.$el.closest(".ZEEGA-player").height()/10+"px",width:this.$el.closest(".ZEEGA-player").height()/10+"px"})},hideArrows:function(){this.slideCount<=1?this.$(".slideshow-arrow").remove():this.slide===0?this.$(".slideshow-control-prev").addClass("disabled"):this.slide==this.slideCount-1?this.$(".slideshow-control-next").addClass("disabled"):this.$(".slideshow-control-prev, .slideshow-control-next").removeClass("disabled")},initKeyboard:function(){this.getAttr("keyboard")&&$(window).on("keyup.slideshow",function(e){switch(e.which){case 37:_this.goLeft();break;case 39:_this.goRight()}})},killKeyboard:function(){this.getAttr("keyboard")&&$(window).off("keyup.slideshow")}}),r}),window.Modernizr=function(e,t,n){function L(e){a.cssText=e}function A(e,t){return L(h.join(e+";")+(t||""))}function O(e,t){return typeof e===t}function M(e,t){return!!~(""+e).indexOf(t)}function _(e,t,r){for(var i in e){var s=t[e[i]];if(s!==n)return r===!1?e[i]:O(s,"function")?s.bind(r||t):s}return!1}function D(){i.input=function(n){for(var r=0,i=n.length;r<i;r++)b[n[r]]=n[r]in f;return b.list&&(b.list=!!t.createElement("datalist")&&!!e.HTMLDataListElement),b}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),i.inputtypes=function(e){for(var r=0,i,o,u,a=e.length;r<a;r++)f.setAttribute("type",o=e[r]),i=f.type!=="text",i&&(f.value=l,f.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(o)&&f.style.WebkitAppearance!==n?(s.appendChild(f),u=t.defaultView,i=u.getComputedStyle&&u.getComputedStyle(f,null).WebkitAppearance!=="textfield"&&f.offsetHeight!==0,s.removeChild(f)):/^(search|tel)$/.test(o)||(/^(url|email)$/.test(o)?i=f.checkValidity&&f.checkValidity()===!1:i=f.value!=l)),y[e[r]]=!!i;return y}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var r="2.6.2",i={},s=t.documentElement,o="modernizr",u=t.createElement(o),a=u.style,f=t.createElement("input"),l=":)",c={}.toString,h=" -webkit- -moz- -o- -ms- ".split(" "),p="Webkit Moz O ms",d=p.split(" "),v=p.toLowerCase().split(" "),m={svg:"http://www.w3.org/2000/svg"},g={},y={},b={},w=[],E=w.slice,S,x=function(e,n,r,i){var u,a,f,l,c=t.createElement("div"),h=t.body,p=h||t.createElement("body");if(parseInt(r,10))while(r--)f=t.createElement("div"),f.id=i?i[r]:o+(r+1),c.appendChild(f);return u=["&#173;",'<style id="s',o,'">',e,"</style>"].join(""),c.id=o,(h?c:p).innerHTML+=u,p.appendChild(c),h||(p.style.background="",p.style.overflow="hidden",l=s.style.overflow,s.style.overflow="hidden",s.appendChild(p)),a=n(c,e),h?c.parentNode.removeChild(c):(p.parentNode.removeChild(p),s.style.overflow=l),!!a},T=function(t){var n=e.matchMedia||e.msMatchMedia;if(n)return n(t).matches;var r;return x("@media "+t+" { #"+o+" { position: absolute; } }",function(t){r=(e.getComputedStyle?getComputedStyle(t,null):t.currentStyle)["position"]=="absolute"}),r},N=function(){function r(r,i){i=i||t.createElement(e[r]||"div"),r="on"+r;var s=r in i;return s||(i.setAttribute||(i=t.createElement("div")),i.setAttribute&&i.removeAttribute&&(i.setAttribute(r,""),s=O(i[r],"function"),O(i[r],"undefined")||(i[r]=n),i.removeAttribute(r))),i=null,s}var e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return r}(),C={}.hasOwnProperty,k;!O(C,"undefined")&&!O(C.call,"undefined")?k=function(e,t){return C.call(e,t)}:k=function(e,t){return t in e&&O(e.constructor.prototype[t],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(t){var n=this;if(typeof n!="function")throw new TypeError;var r=E.call(arguments,1),i=function(){if(this instanceof i){var e=function(){};e.prototype=n.prototype;var s=new e,o=n.apply(s,r.concat(E.call(arguments)));return Object(o)===o?o:s}return n.apply(t,r.concat(E.call(arguments)))};return i}),g.canvas=function(){var e=t.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")},g.canvastext=function(){return!!i.canvas&&!!O(t.createElement("canvas").getContext("2d").fillText,"function")},g.webgl=function(){return!!e.WebGLRenderingContext},g.touch=function(){var n;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?n=!0:x(["@media (",h.join("touch-enabled),("),o,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(e){n=e.offsetTop===9}),n},g.geolocation=function(){return"geolocation"in navigator},g.postmessage=function(){return!!e.postMessage},g.websqldatabase=function(){return!!e.openDatabase},g.hashchange=function(){return N("hashchange",e)&&(t.documentMode===n||t.documentMode>7)},g.history=function(){return!!e.history&&!!history.pushState},g.draganddrop=function(){var e=t.createElement("div");return"draggable"in e||"ondragstart"in e&&"ondrop"in e},g.websockets=function(){return"WebSocket"in e||"MozWebSocket"in e},g.video=function(){var e=t.createElement("video"),n=!1;try{if(n=!!e.canPlayType)n=new Boolean(n),n.ogg=e.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),n.h264=e.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),n.webm=e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")}catch(r){}return n},g.audio=function(){var e=t.createElement("audio"),n=!1;try{if(n=!!e.canPlayType)n=new Boolean(n),n.ogg=e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),n.mp3=e.canPlayType("audio/mpeg;").replace(/^no$/,""),n.wav=e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),n.m4a=(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,"")}catch(r){}return n},g.localstorage=function(){try{return localStorage.setItem(o,o),localStorage.removeItem(o),!0}catch(e){return!1}},g.sessionstorage=function(){try{return sessionStorage.setItem(o,o),sessionStorage.removeItem(o),!0}catch(e){return!1}},g.webworkers=function(){return!!e.Worker},g.applicationcache=function(){return!!e.applicationCache},g.svg=function(){return!!t.createElementNS&&!!t.createElementNS(m.svg,"svg").createSVGRect},g.inlinesvg=function(){var e=t.createElement("div");return e.innerHTML="<svg/>",(e.firstChild&&e.firstChild.namespaceURI)==m.svg},g.smil=function(){return!!t.createElementNS&&/SVGAnimate/.test(c.call(t.createElementNS(m.svg,"animate")))},g.svgclippaths=function(){return!!t.createElementNS&&/SVGClipPath/.test(c.call(t.createElementNS(m.svg,"clipPath")))};for(var P in g)k(g,P)&&(S=P.toLowerCase(),i[S]=g[P](),w.push((i[S]?"":"no-")+S));return i.input||D(),i.addTest=function(e,t){if(typeof e=="object")for(var r in e)k(e,r)&&i.addTest(r,e[r]);else{e=e.toLowerCase();if(i[e]!==n)return i;t=typeof t=="function"?t():t,typeof enableClasses!="undefined"&&enableClasses&&(s.className+=" "+(t?"":"no-")+e),i[e]=t}return i},L(""),u=f=null,function(e,t){function l(e,t){var n=e.createElement("p"),r=e.getElementsByTagName("head")[0]||e.documentElement;return n.innerHTML="x<style>"+t+"</style>",r.insertBefore(n.lastChild,r.firstChild)}function c(){var e=g.elements;return typeof e=="string"?e.split(" "):e}function h(e){var t=a[e[o]];return t||(t={},u++,e[o]=u,a[u]=t),t}function p(e,n,s){n||(n=t);if(f)return n.createElement(e);s||(s=h(n));var o;return s.cache[e]?o=s.cache[e].cloneNode():i.test(e)?o=(s.cache[e]=s.createElem(e)).cloneNode():o=s.createElem(e),o.canHaveChildren&&!r.test(e)?s.frag.appendChild(o):o}function d(e,n){e||(e=t);if(f)return e.createDocumentFragment();n=n||h(e);var r=n.frag.cloneNode(),i=0,s=c(),o=s.length;for(;i<o;i++)r.createElement(s[i]);return r}function v(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(n){return g.shivMethods?p(n,e,t):t.createElem(n)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+c().join().replace(/\w+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(g,t.frag)}function m(e){e||(e=t);var n=h(e);return g.shivCSS&&!s&&!n.hasCSS&&(n.hasCSS=!!l(e,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),f||v(e,n),e}var n=e.html5||{},r=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,i=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,s,o="_html5shiv",u=0,a={},f;(function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",s="hidden"in e,f=e.childNodes.length==1||function(){t.createElement("a");var e=t.createDocumentFragment();return typeof e.cloneNode=="undefined"||typeof e.createDocumentFragment=="undefined"||typeof e.createElement=="undefined"}()}catch(n){s=!0,f=!0}})();var g={elements:n.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:n.shivCSS!==!1,supportsUnknownElements:f,shivMethods:n.shivMethods!==!1,type:"default",shivDocument:m,createElement:p,createDocumentFragment:d};e.html5=g,m(t)}(this,t),i._version=r,i._prefixes=h,i._domPrefixes=v,i._cssomPrefixes=d,i.mq=T,i.hasEvent=N,i.testStyles=x,i}(this,this.document),e.define("libs/modernizr",function(){}),function(e,t){function y(e){m.put.call(this,e)}function b(e){this.parent=e,this.byStart=[{start:-1,end:-1}],this.byEnd=[{start:-1,end:-1}],this.animating=[],this.startIndex=0,this.endIndex=0,this.previousUpdateTime=-1,this.count=1}function w(e,t,n){return e[t]&&e[t]===n}function E(e,t){var n={};for(var r in e)u.call(t,r)&&u.call(e,r)&&(n[r]=e[r]);return n}function S(e,t){return function(){if(g.plugin.debug)return e.apply(this,arguments);try{return e.apply(this,arguments)}catch(n){g.plugin.errors.push({plugin:t,thrown:n,source:e.toString()}),this.emit("pluginerror",g.plugin.errors)}}}if(!t.addEventListener){e.Popcorn={isSupported:!1};var n="byId forEach extend effects error guid sizeOf isArray nop position disable enable destroyaddTrackEvent removeTrackEvent getTrackEvents getTrackEvent getLastTrackEventId timeUpdate plugin removePlugin compose effect xhr getJSONP getScript".split(/\s+/);while(n.length)e.Popcorn[n.shift()]=function(){};return}var r=Array.prototype,i=Object.prototype,s=r.forEach,o=r.slice,u=i.hasOwnProperty,a=i.toString,f=e.Popcorn,l=[],c=!1,h=!1,p={events:{hash:{},apis:{}}},d=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t,n){e.setTimeout(t,16)}}(),v=function(e){return Object.keys?Object.keys(e):function(e){var t,n=[];for(t in e)u.call(e,t)&&n.push(t);return n}(e)},m={put:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t])}},g=function(e,t){return new g.p.init(e,t||null)};g.version="95162da",g.isSupported=!0,g.instances=[],g.p=g.prototype={init:function(e,n){var r,i,s=this;if(typeof e=="function"){if(t.readyState==="complete"){e(t,g);return}l.push(e);if(!c){c=!0;var o=function(){h=!0,t.removeEventListener("DOMContentLoaded",o,!1);for(var e=0,n=l.length;e<n;e++)l[e].call(t,g);l=null};t.addEventListener("DOMContentLoaded",o,!1)}return}if(typeof e=="string")try{r=t.querySelector(e)}catch(u){throw new Error("Popcorn.js Error: Invalid media element selector: "+e)}this.media=r||e,i=this.media.nodeName&&this.media.nodeName.toLowerCase()||"video",this[i]=this.media,this.options=g.extend({},n)||{},this.id=this.options.id||g.guid(i);if(g.byId(this.id))throw new Error("Popcorn.js Error: Cannot use duplicate ID ("+this.id+")");this.isDestroyed=!1,this.data={running:{cue:[]},timeUpdate:g.nop,disabled:{},events:{},hooks:{},history:[],state:{volume:this.media.volume},trackRefs:{},trackEvents:new b(this)},g.instances.push(this);var a=function(){s.media.currentTime<0&&(s.media.currentTime=0),s.media.removeEventListener("loadedmetadata",a,!1);var e,t,n,r,i,o;e=s.media.duration,t=e!=e?Number.MAX_VALUE:e+1,g.addTrackEvent(s,{start:t,end:t}),s.isDestroyed||(s.data.durationChange=function(){var e=s.media.duration,t=e+1,n=s.data.trackEvents.byStart,r=s.data.trackEvents.byEnd;n.pop(),r.pop();for(var i=r.length-1;i>0;i--)r[i].end>e&&s.removeTrackEvent(r[i]._id);for(var o=0;o<n.length;o++)n[o].end>e&&s.removeTrackEvent(n[o]._id);s.data.trackEvents.byEnd.push({start:t,end:t}),s.data.trackEvents.byStart.push({start:t,end:t})},s.media.addEventListener("durationchange",s.data.durationChange,!1)),s.options.frameAnimation?(s.data.timeUpdate=function(){g.timeUpdate(s,{}),g.forEach(g.manifest,function(e,t){n=s.data.running[t];if(n){i=n.length;for(var u=0;u<i;u++)r=n[u],o=r._natives,o&&o.frame&&o.frame.call(s,{},r,s.currentTime())}}),s.emit("timeupdate"),!s.isDestroyed&&d(s.data.timeUpdate)},!s.isDestroyed&&d(s.data.timeUpdate)):(s.data.timeUpdate=function(e){g.timeUpdate(s,e)},s.isDestroyed||s.media.addEventListener("timeupdate",s.data.timeUpdate,!1))};return s.media.addEventListener("error",function(){s.error=s.media.error},!1),s.media.readyState>=1?a():s.media.addEventListener("loadedmetadata",a,!1),this}},g.p.init.prototype=g.p,g.byId=function(e){var t=g.instances,n=t.length,r=0;for(;r<n;r++)if(t[r].id===e)return t[r];return null},g.forEach=function(e,t,n){if(!e||!t)return{};n=n||this;var r,i;if(s&&e.forEach===s)return e.forEach(t,n);if(a.call(e)==="[object NodeList]"){for(r=0,i=e.length;r<i;r++)t.call(n,e[r],r,e);return e}for(r in e)u.call(e,r)&&t.call(n,e[r],r,e);return e},g.extend=function(e){var t=e,n=o.call(arguments,1);return g.forEach(n,function(e){for(var n in e)t[n]=e[n]}),t},g.extend(g,{noConflict:function(t){return t&&(e.Popcorn=f),g},error:function(e){throw new Error(e)},guid:function(e){return g.guid.counter++,(e?e:"")+(+(new Date)+g.guid.counter)},sizeOf:function(e){var t=0;for(var n in e)t++;return t},isArray:Array.isArray||function(e){return a.call(e)==="[object Array]"},nop:function(){},position:function(n){if(!n.parentNode)return null;var r=n.getBoundingClientRect(),i={},s=n.ownerDocument,o=t.documentElement,u=t.body,a,f,l,c,h,p;a=o.clientTop||u.clientTop||0,f=o.clientLeft||u.clientLeft||0,l=e.pageYOffset&&o.scrollTop||u.scrollTop,c=e.pageXOffset&&o.scrollLeft||u.scrollLeft,h=Math.ceil(r.top+l-a),p=Math.ceil(r.left+c-f);for(var d in r)i[d]=Math.round(r[d]);return g.extend({},i,{top:h,left:p})},disable:function(e,t){if(e.data.disabled[t])return;e.data.disabled[t]=!0;if(t in g.registryByName&&e.data.running[t])for(var n=e.data.running[t].length-1,r;n>=0;n--)r=e.data.running[t][n],r._natives.end.call(e,null,r),e.emit("trackend",g.extend({},r,{plugin:r.type,type:"trackend"}));return e},enable:function(e,t){if(!e.data.disabled[t])return;e.data.disabled[t]=!1;if(t in g.registryByName&&e.data.running[t])for(var n=e.data.running[t].length-1,r;n>=0;n--)r=e.data.running[t][n],r._natives.start.call(e,null,r),e.emit("trackstart",g.extend({},r,{plugin:r.type,type:"trackstart",track:r}));return e},destroy:function(e){var t=e.data.events,n=e.data.trackEvents,r,i,s,o;for(i in t){r=t[i];for(s in r)delete r[s];t[i]=null}for(o in g.registryByName)g.removePlugin(e,o);n.byStart.length=0,n.byEnd.length=0,e.isDestroyed||(e.data.timeUpdate&&e.media.removeEventListener("timeupdate",e.data.timeUpdate,!1),e.isDestroyed=!0),g.instances.splice(g.instances.indexOf(e),1)}}),g.guid.counter=1,g.extend(g.p,function(){var e="load play pause currentTime playbackRate volume duration preload playbackRate autoplay loop controls muted buffered readyState seeking paused played seekable ended",t={};return g.forEach(e.split(/\s+/g),function(e){t[e]=function(t){var n;return typeof this.media[e]=="function"?(t!=null&&/play|pause/.test(e)&&(this.media.currentTime=g.util.toSeconds(t)),this.media[e](),this):t!=null?(n=this.media[e],this.media[e]=t,n!==t&&this.emit("attrchange",{attribute:e,previousValue:n,currentValue:t}),this):this.media[e]}}),t}()),g.forEach("enable disable".split(" "),function(e){g.p[e]=function(t){return g[e](this,t)}}),g.extend(g.p,{roundTime:function(){return Math.round(this.media.currentTime)},exec:function(e,t,n){var r=arguments.length,i="trackadded",s,o,u;try{o=g.util.toSeconds(e)}catch(a){}typeof o=="number"&&(e=o);if(typeof e=="number"&&r===2)n=t,t=e,e=g.guid("cue");else if(r===1)t=-1;else{s=this.getTrackEvent(e);if(s)this.data.trackEvents.remove(e),y.end(this,s),g.removeTrackEvent.ref(this,e),i="cuechange",typeof e=="string"&&r===2&&(typeof t=="number"&&(n=s._natives.start),typeof t=="function"&&(n=t,t=s.start));else if(r>=2){if(typeof t=="string"){try{o=g.util.toSeconds(t)}catch(a){}t=o}typeof t=="number"&&(n=n||g.nop()),typeof t=="function"&&(n=t,t=-1)}}return u={id:e,start:t,end:t+1,_running:!1,_natives:{start:n||g.nop,end:g.nop,type:"cue"}},s&&(u=g.extend(s,u)),i==="cuechange"?(u._id=u.id||u._id||g.guid(u._natives.type),this.data.trackEvents.add(u),y.start(this,u),this.timeUpdate(this,null,!0),g.addTrackEvent.ref(this,u),this.emit(i,g.extend({},u,{id:e,type:i,previousValue:{time:s.start,fn:s._natives.start},currentValue:{time:t,fn:n||g.nop},track:s}))):g.addTrackEvent(this,u),this},mute:function(e){var t=e==null||e===!0?"muted":"unmuted";return t==="unmuted"&&(this.media.muted=!1,this.media.volume=this.data.state.volume),t==="muted"&&(this.data.state.volume=this.media.volume,this.media.muted=!0),this.emit(t),this},unmute:function(e){return this.mute(e==null?!1:!e)},position:function(){return g.position(this.media)},toggle:function(e){return g[this.data.disabled[e]?"enable":"disable"](this,e)},defaults:function(e,t){return g.isArray(e)?(g.forEach(e,function(e){for(var t in e)this.defaults(t,e[t])},this),this):(this.options.defaults||(this.options.defaults={}),this.options.defaults[e]||(this.options.defaults[e]={}),g.extend(this.options.defaults[e],t),this)}}),g.Events={UIEvents:"blur focus focusin focusout load resize scroll unload",MouseEvents:"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave click dblclick",Events:"loadstart progress suspend emptied stalled play pause error loadedmetadata loadeddata waiting playing canplay canplaythrough seeking seeked timeupdate ended ratechange durationchange volumechange"},g.Events.Natives=g.Events.UIEvents+" "+g.Events.MouseEvents+" "+g.Events.Events,p.events.apiTypes=["UIEvents","MouseEvents","Events"],function(e,t){var n=p.events.apiTypes,r=e.Natives.split(/\s+/g),i=0,s=r.length,o;for(;i<s;i++)t.hash[r[i]]=!0;n.forEach(function(n,r){t.apis[n]={};var i=e[n].split(/\s+/g),s=i.length,o=0;for(;o<s;o++)t.apis[n][i[o]]=!0})}(g.Events,p.events),g.events={isNative:function(e){return!!p.events.hash[e]},getInterface:function(e){if(!g.events.isNative(e))return!1;var t=p.events,n=t.apiTypes,r=t.apis,i=0,s=n.length,o,u;for(;i<s;i++){u=n[i];if(r[u][e]){o=u;break}}return o},all:g.Events.Natives.split(/\s+/g),fn:{trigger:function(n,r){var i,s,o,u=this.data.events[n];if(u){i=g.events.getInterface(n);if(i)return s=t.createEvent(i),s.initEvent(n,!0,!0,e,1),this.media.dispatchEvent(s),this;o=u.slice();while(o.length)o.shift().call(this,r)}return this},listen:function(e,t){var n=this,r=!0,i=g.events.hooks[e],s=e,o,u;if(typeof t!="function")throw new Error("Popcorn.js Error: Listener is not a function");return this.data.events[e]||(this.data.events[e]=[],r=!1),i&&(i.add&&i.add.call(this,{},t),i.bind&&(e=i.bind),i.handler&&(u=t,t=function(t){i.handler.call(n,t,u)}),r=!0,this.data.events[e]||(this.data.events[e]=[],r=!1)),this.data.events[e].push(t),!r&&g.events.all.indexOf(e)>-1&&this.media.addEventListener(e,function(t){if(n.data.events[e]){o=n.data.events[e].slice();while(o.length)o.shift().call(n,t)}},!1),this},unlisten:function(e,t){var n,r=this.data.events[e];if(!r)return;if(typeof t=="string"){for(var i=0;i<r.length;i++)r[i].name===t&&r.splice(i--,1);return this}if(typeof t=="function"){while(n!==-1)n=r.indexOf(t),n!==-1&&r.splice(n,1);return this}return this.data.events[e]=null,this}},hooks:{canplayall:{bind:"canplaythrough",add:function(e,t){var n=!1;this.media.readyState&&(setTimeout(function(){t.call(this,e)}.bind(this),0),n=!0),this.data.hooks.canplayall={fired:n}},handler:function(t,n){this.data.hooks.canplayall.fired||(n.call(this,t),this.data.hooks.canplayall.fired=!0)}}}},g.forEach([["trigger","emit"],["listen","on"],["unlisten","off"]],function(e){g.p[e[0]]=g.p[e[1]]=g.events.fn[e[0]]}),y.start=function(e,t){t.end>e.media.currentTime&&t.start<=e.media.currentTime&&!t._running&&(t._running=!0,e.data.running[t._natives.type].push(t),e.data.disabled[t._natives.type]||(t._natives.start.call(e,null,t),e.emit("trackstart",g.extend({},t,{plugin:t._natives.type,type:"trackstart",track:t}))))},y.end=function(e,t){var n;(t.end<=e.media.currentTime||t.start>e.media.currentTime)&&t._running&&(n=e.data.running[t._natives.type],t._running=!1,n.splice(n.indexOf(t),1),e.data.disabled[t._natives.type]||(t._natives.end.call(e,null,t),e.emit("trackend",g.extend({},t,{plugin:t._natives.type,type:"trackend",track:t}))))},b.prototype.where=function(e){return(this.parent.getTrackEvents()||[]).filter(function(t){var n,r;if(!e)return!0;for(n in e){r=e[n];if(w(t,n,r)||w(t._natives,n,r))return!0}return!1})},b.prototype.add=function(e){var t=this.byStart,n=this.byEnd,r,i;e&&e._id&&this.parent.data.history.push(e._id),e.start=g.util.toSeconds(e.start,this.parent.options.framerate),e.end=g.util.toSeconds(e.end,this.parent.options.framerate);for(r=t.length-1;r>=0;r--)if(e.start>=t[r].start){t.splice(r+1,0,e);break}for(i=n.length-1;i>=0;i--)if(e.end>n[i].end){n.splice(i+1,0,e);break}r<=this.parent.data.trackEvents.startIndex&&e.start<=this.parent.data.trackEvents.previousUpdateTime&&this.parent.data.trackEvents.startIndex++,i<=this.parent.data.trackEvents.endIndex&&e.end<this.parent.data.trackEvents.previousUpdateTime&&this.parent.data.trackEvents.endIndex++,this.count++},b.prototype.remove=function(e,t){e instanceof y&&(e=e.id);if(typeof e=="object")return this.where(e).forEach(function(e){this.removeTrackEvent(e._id)},this.parent),this;var n,r,i,s,o,u=this.byStart.length,a=0,f=0,l=[],c=[],h=[],p=[],d={};t=t||{};while(--u>-1)n=this.byStart[a],r=this.byEnd[a],n._id||(l.push(n),c.push(r)),n._id&&(n._id!==e&&l.push(n),r._id!==e&&c.push(r),n._id===e&&(f=a,o=n)),a++;u=this.animating.length,a=0;if(u)while(--u>-1)i=this.animating[a],i._id||h.push(i),i._id&&i._id!==e&&h.push(i),a++;f<=this.startIndex&&this.startIndex--,f<=this.endIndex&&this.endIndex--,this.byStart=l,this.byEnd=c,this.animating=h,this.count--,s=this.parent.data.history.length;for(var v=0;v<s;v++)this.parent.data.history[v]!==e&&p.push(this.parent.data.history[v]);this.parent.data.history=p},g.addTrackEvent=function(e,t){var n;if(t instanceof y)return;t=new y(t),t&&t._natives&&t._natives.type&&e.options.defaults&&e.options.defaults[t._natives.type]&&(n=g.extend({},t),g.extend(t,e.options.defaults[t._natives.type],n)),t._natives&&(t._id=t.id||t._id||g.guid(t._natives.type),t._natives._setup&&(t._natives._setup.call(e,t),e.emit("tracksetup",g.extend({},t,{plugin:t._natives.type,type:"tracksetup",track:t})))),e.data.trackEvents.add(t),y.start(e,t),this.timeUpdate(e,null,!0),t._id&&g.addTrackEvent.ref(e,t),e.emit("trackadded",g.extend({},t,t._natives?{plugin:t._natives.type}:{},{type:"trackadded",track:t}))},g.addTrackEvent.ref=function(e,t){return e.data.trackRefs[t._id]=t,e},g.removeTrackEvent=function(e,t){var n=e.getTrackEvent(t);if(!n)return;n._natives._teardown&&n._natives._teardown.call(e,n),e.data.trackEvents.remove(t),g.removeTrackEvent.ref(e,t),n._natives&&e.emit("trackremoved",g.extend({},n,{plugin:n._natives.type,type:"trackremoved",track:n}))},g.removeTrackEvent.ref=function(e,t){return delete e.data.trackRefs[t],e},g.getTrackEvents=function(e){var t=[],n=e.data.trackEvents.byStart,r=n.length,i=0,s;for(;i<r;i++)s=n[i],s._id&&t.push(s);return t},g.getTrackEvents.ref=function(e){return e.data.trackRefs},g.getTrackEvent=function(e,t){return e.data.trackRefs[t]},g.getTrackEvent.ref=function(e,t){return e.data.trackRefs[t]},g.getLastTrackEventId=function(e){return e.data.history[e.data.history.length-1]},g.timeUpdate=function(e,t){var n=e.media.currentTime,r=e.data.trackEvents.previousUpdateTime,i=e.data.trackEvents,s=i.endIndex,o=i.startIndex,u=i.byStart.length,a=i.byEnd.length,f=g.registryByName,l="trackstart",c="trackend",h,p,d,v,m,y;if(r<=n){while(i.byEnd[s]&&i.byEnd[s].end<=n){h=i.byEnd[s],v=h._natives,m=v&&v.type;if(!!v&&!f[m]&&!e[m]){g.removeTrackEvent(e,h._id);return}h._running===!0&&(h._running=!1,y=e.data.running[m],y.splice(y.indexOf(h),1),e.data.disabled[m]||(v.end.call(e,t,h),e.emit(c,g.extend({},h,{plugin:m,type:c,track:h})))),s++}while(i.byStart[o]&&i.byStart[o].start<=n){p=i.byStart[o],v=p._natives,m=v&&v.type;if(!!v&&!f[m]&&!e[m]){g.removeTrackEvent(e,p._id);return}p.end>n&&p._running===!1&&(p._running=!0,e.data.running[m].push(p),e.data.disabled[m]||(v.start.call(e,t,p),e.emit(l,g.extend({},p,{plugin:m,type:l,track:p})))),o++}}else if(r>n){while(i.byStart[o]&&i.byStart[o].start>n){p=i.byStart[o],v=p._natives,m=v&&v.type;if(!!v&&!f[m]&&!e[m]){g.removeTrackEvent(e,p._id);return}p._running===!0&&(p._running=!1,y=e.data.running[m],y.splice(y.indexOf(p),1),e.data.disabled[m]||(v.end.call(e,t,p),e.emit(c,g.extend({},p,{plugin:m,type:c,track:p})))),o--}while(i.byEnd[s]&&i.byEnd[s].end>n){h=i.byEnd[s],v=h._natives,m=v&&v.type;if(!!v&&!f[m]&&!e[m]){g.removeTrackEvent(e,h._id);return}h.start<=n&&h._running===!1&&(h._running=!0,e.data.running[m].push(h),e.data.disabled[m]||(v.start.call(e,t,h),e.emit(l,g.extend({},h,{plugin:m,type:l,track:h})))),s--}}i.endIndex=s,i.startIndex=o,i.previousUpdateTime=n,i.byStart.length<u&&i.startIndex--,i.byEnd.length<a&&i.endIndex--},g.extend(g.p,{getTrackEvents:function(){return g.getTrackEvents.call(null,this)},getTrackEvent:function(e){return g.getTrackEvent.call(null,this,e)},getLastTrackEventId:function(){return g.getLastTrackEventId.call(null,this)},removeTrackEvent:function(e){return g.removeTrackEvent.call(null,this,e),this},removePlugin:function(e){return g.removePlugin.call(null,this,e),this},timeUpdate:function(e){return g.timeUpdate.call(null,this,e),this},destroy:function(){return g.destroy.call(null,this),this}}),g.manifest={},g.registry=[],g.registryByName={},g.plugin=function(e,t,n){if(g.protect.natives.indexOf(e.toLowerCase())>=0){g.error("'"+e+"' is a protected function name");return}var r=typeof t=="function",i=["start","end","type","manifest"],s=["_setup","_teardown","start","end","frame"],a={},f,l=function(e,t){return e=e||g.nop,t=t||g.nop,function(){e.apply(this,arguments),t.apply(this,arguments)}};g.manifest[e]=n=n||t.manifest||{},s.forEach(function(n){t[n]=S(t[n]||g.nop,e)});var c=function(t,r){if(!r)return this;if(r.ranges&&g.isArray(r.ranges))return g.forEach(r.ranges,function(t){var n=g.extend({},r,t);delete n.ranges,this[e](n)},this),this;var a=r._natives={},f="",c,h;return g.extend(a,t),r._natives.type=r._natives.plugin=e,r._running=!1,a.start=a.start||a["in"],a.end=a.end||a.out,r.once&&(a.end=l(a.end,function(){this.removeTrackEvent(r._id)})),a._teardown=l(function(){var e=o.call(arguments),t=this.data.running[a.type];e.unshift(null),e[1]._running&&t.splice(t.indexOf(r),1)&&a.end.apply(this,e),e[1]._running=!1,this.emit("trackend",g.extend({},r,{plugin:a.type,type:"trackend",track:g.getTrackEvent(this,r.id||r._id)}))},a._teardown),a._teardown=l(a._teardown,function(){this.emit("trackteardown",g.extend({},r,{plugin:e,type:"trackteardown",track:g.getTrackEvent(this,r.id||r._id)}))}),r.compose=r.compose||[],typeof r.compose=="string"&&(r.compose=r.compose.split(" ")),r.effect=r.effect||[],typeof r.effect=="string"&&(r.effect=r.effect.split(" ")),r.compose=r.compose.concat(r.effect),r.compose.forEach(function(e){f=g.compositions[e]||{},s.forEach(function(e){a[e]=l(a[e],f[e])})}),r._natives.manifest=n,"start"in r||(r.start=r["in"]||0),!r.end&&r.end!==0&&(r.end=r.out||Number.MAX_VALUE),u.call(r,"toString")||(r.toString=function(){var t=["start: "+r.start,"end: "+r.end,"id: "+(r.id||r._id)];return r.target!=null&&t.push("target: "+r.target),e+" ( "+t.join(", ")+" )"}),r.target||(h="options"in n&&n.options,r.target=h&&"target"in h&&h.target),!r._id&&r._natives&&(r._id=g.guid(r._natives.type)),r instanceof y?(r._natives&&(r._id=r.id||r._id||g.guid(r._natives.type),r._natives._setup&&(r._natives._setup.call(this,r),this.emit("tracksetup",g.extend({},r,{plugin:r._natives.type,type:"tracksetup",track:r})))),this.data.trackEvents.add(r),y.start(this,r),this.timeUpdate(this,null,!0),r._id&&g.addTrackEvent.ref(this,r)):g.addTrackEvent(this,r),g.forEach(t,function(e,t){i.indexOf(t)===-1&&this.on(t,e)},this),this};g.p[e]=a[e]=function(n,i){var s=arguments.length,o,a,f,l,h;if(n&&!i)i=n,n=null;else{o=this.getTrackEvent(n);if(!!o)return h=i,l=E(o,h),o._natives._update?(this.data.trackEvents.remove(o),u.call(i,"start")&&(o.start=i.start),u.call(i,"end")&&(o.end=i.end),y.end(this,o),r&&t.call(this,o),o._natives._update.call(this,o,i),this.data.trackEvents.add(o),y.start(this,o),o._natives.type!=="cue"&&this.emit("trackchange",{id:o.id,type:"trackchange",previousValue:l,currentValue:h,track:o}),this):(g.extend(o,i),this.data.trackEvents.remove(n),o._natives._teardown&&o._natives._teardown.call(this,o),g.removeTrackEvent.ref(this,n),r?c.call(this,t.call(this,o),o):(o._id=o.id||o._id||g.guid(o._natives.type),o._natives&&o._natives._setup&&(o._natives._setup.call(this,o),this.emit("tracksetup",g.extend({},o,{plugin:o._natives.type,type:"tracksetup",track:o}))),this.data.trackEvents.add(o),y.start(this,o),this.timeUpdate(this,null,!0),g.addTrackEvent.ref(this,o)),this.emit("trackchange",{id:o.id,type:"trackchange",previousValue:l,currentValue:o,track:o}),this);i.id=n}return this.data.running[e]=this.data.running[e]||[],a=this.options.defaults&&this.options.defaults[e]||{},f=g.extend({},a,i),c.call(this,r?t.call(this,f):t,f),this},n&&g.extend(t,{manifest:n});var h={fn:a[e],definition:t,base:t,parents:[],name:e};return g.registry.push(g.extend(a,h,{type:e})),g.registryByName[e]=h,a},g.plugin.errors=[],g.plugin.debug=g.version==="@VERSION",g.removePlugin=function(e,t){if(!t){t=e,e=g.p;if(g.protect.natives.indexOf(t.toLowerCase())>=0){g.error("'"+t+"' is a protected function name");return}var n=g.registry.length,r;for(r=0;r<n;r++)if(g.registry[r].name===t){g.registry.splice(r,1),delete g.registryByName[t],delete g.manifest[t],delete e[t];return}}var i=e.data.trackEvents.byStart,s=e.data.trackEvents.byEnd,o=e.data.trackEvents.animating,u,a;for(u=0,a=i.length;u<a;u++)i[u]&&i[u]._natives&&i[u]._natives.type===t&&(i[u]._natives._teardown&&i[u]._natives._teardown.call(e,i[u]),i.splice(u,1),u--,a--,e.data.trackEvents.startIndex<=u&&(e.data.trackEvents.startIndex--,e.data.trackEvents.endIndex--)),s[u]&&s[u]._natives&&s[u]._natives.type===t&&s.splice(u,1);for(u=0,a=o.length;u<a;u++)o[u]&&o[u]._natives&&o[u]._natives.type===t&&(o.splice(u,1),u--,a--)},g.compositions={},g.compose=function(e,t,n){g.manifest[e]=n=n||t.manifest||{},g.compositions[e]=t},g.plugin.effect=g.effect=g.compose;var x=/^(?:\.|#|\[)/;g.dom={debug:!1,find:function(e,n){var r=null;n=n||t;if(e){if(!x.test(e)){r=t.getElementById(e);if(r!==null)return r}try{r=n.querySelector(e)}catch(i){if(g.dom.debug)throw new Error(i)}}return r}};var T=/\?/,N={ajax:null,url:"",data:"",dataType:"",success:g.nop,type:"GET",async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8"};g.xhr=function(e){var t;e.dataType=e.dataType&&e.dataType.toLowerCase()||null;if(!(!e.dataType||e.dataType!=="jsonp"&&e.dataType!=="script")){g.xhr.getJSONP(e.url,e.success,e.dataType==="script");return}t=g.extend({},N,e),t.ajax=new XMLHttpRequest;if(t.ajax)return t.type==="GET"&&t.data&&(t.url+=(T.test(t.url)?"&":"?")+t.data,t.data=null),t.ajax.open(t.type,t.url,t.async),t.type==="POST"&&t.ajax.setRequestHeader("Content-Type",t.contentType),t.ajax.send(t.data||null),g.xhr.httpData(t)},g.xhr.httpData=function(e){var t,n=null,r,i=null;return e.ajax.onreadystatechange=function(){if(e.ajax.readyState===4){try{n=JSON.parse(e.ajax.responseText)}catch(s){}t={xml:e.ajax.responseXML,text:e.ajax.responseText,json:n};if(!t.xml||!t.xml.documentElement){t.xml=null;try{r=new DOMParser,i=r.parseFromString(e.ajax.responseText,"text/xml"),i.getElementsByTagName("parsererror").length||(t.xml=i)}catch(s){}}e.dataType&&(t=t[e.dataType]),e.success.call(e.ajax,t)}},t},g.xhr.getJSONP=function(e,n,r){var i=t.head||t.getElementsByTagName("head")[0]||t.documentElement,s=t.createElement("script"),o=!1,u=[],a=/(=)\?(?=&|$)|\?\?/,f,l,c,h,p;r||(p=e.match(/(callback=[^&]*)/),p!==null&&p.length?(l=p[1].split("=")[1],l==="?"&&(l="jsonp"),h=g.guid(l),e=e.replace(/(callback=[^&]*)/,"callback="+h)):(h=g.guid("jsonp"),a.test(e)&&(e=e.replace(a,"$1"+h)),u=e.split(/\?(.+)?/),e=u[0]+"?",u[1]&&(e+=u[1]+"&"),e+="callback="+h),window[h]=function(e){n&&n(e),o=!0}),s.addEventListener("load",function(){r&&n&&n(),o&&delete window[h],i.removeChild(s)},!1),s.addEventListener("error",function(e){n&&n({error:e}),r||delete window[h],i.removeChild(s)},!1),s.src=e,i.insertBefore(s,i.firstChild);return},g.getJSONP=g.xhr.getJSONP,g.getScript=g.xhr.getScript=function(e,t){return g.xhr.getJSONP(e,t,!0)},g.util={toSeconds:function(e,t){var n=/^([0-9]+:){0,2}[0-9]+([.;][0-9]+)?$/,r="Invalid time format",i,s,o,u,a,f;return typeof e=="number"?e:(typeof e=="string"&&!n.test(e)&&g.error(r),i=e.split(":"),s=i.length-1,o=i[s],o.indexOf(";")>-1&&(a=o.split(";"),f=0,t&&typeof t=="number"&&(f=parseFloat(a[1],10)/t),i[s]=parseInt(a[0],10)+f),u=i[0],{1:parseFloat(u,10),2:parseInt(u,10)*60+parseFloat(i[1],10),3:parseInt(u,10)*3600+parseInt(i[1],10)*60+parseFloat(i[2],10)}[i.length||1])}},g.p.cue=g.p.exec,g.protect={natives:v(g.p).map(function(e){return e.toLowerCase()})},g.forEach({listen:"on",unlisten:"off",trigger:"emit",exec:"cue"},function(e,t){var n=g.p[t];g.p[t]=function(){return typeof console!="undefined"&&console.warn&&(console.warn("Deprecated method '"+t+"', "+(e==null?"do not use.":"use '"+e+"' instead.")),g.p[t]=n),g.p[e].apply(this,[].slice.call(arguments))}}),e.Popcorn=g}(window,window.document),function(e,t){function r(e){var t=typeof e=="string"?e:[e.language,e.region].join("-"),n=t.split("-");return{iso6391:t,language:n[0]||"",region:n[1]||""}}var n=e.navigator,i=r(n.userLanguage||n.language);t.locale={get:function(){return i},set:function(e){return i=r(e),t.locale.broadcast(),i},broadcast:function(e){var n=t.instances,r=n.length,i=0,s;e=e||"locale:changed";for(;i<r;i++)s=n[i],e in s.data.events&&s.trigger(e)}}}(this,this.Popcorn),function(e){var t=function(t,n){return t=t||e.nop,n=n||e.nop,function(){t.apply(this,arguments),n.apply(this,arguments)}},n=/^(#([\w\-\_\.]+))$/;e.player=function(n,r){if(e[n])return;r=r||{};var i=function(n,i,s){s=s||{};var o=new Date/1e3,u=o,a=0,f=0,l=1,c=!1,h={},p=typeof n=="string"?e.dom.find(n):n,d={},v,m;Object.prototype.__defineGetter__||(d=p||document.createElement("div"));for(var g in p){if(g in d)continue;typeof p[g]=="object"?d[g]=p[g]:typeof p[g]=="function"?d[g]=function(e){return"length"in p[e]&&!p[e].call?p[e]:function(){return p[e].apply(p,arguments)}}(g):e.player.defineProperty(d,g,{get:function(e){return function(){return p[e]}}(g),set:e.nop,configurable:!0})}var y=function(){o=new Date/1e3,d.paused||(d.currentTime=d.currentTime+(o-u),d.dispatchEvent("timeupdate"),v=setTimeout(y,10)),u=o};return d.play=function(){this.paused=!1,d.readyState>=4&&(u=new Date/1e3,d.dispatchEvent("play"),y())},d.pause=function(){this.paused=!0,d.dispatchEvent("pause")},e.player.defineProperty(d,"currentTime",{get:function(){return a},set:function(e){return a=+e,d.dispatchEvent("timeupdate"),a},configurable:!0}),e.player.defineProperty(d,"volume",{get:function(){return l},set:function(e){return l=+e,d.dispatchEvent("volumechange"),l},configurable:!0}),e.player.defineProperty(d,"muted",{get:function(){return c},set:function(e){return c=+e,d.dispatchEvent("volumechange"),c},configurable:!0}),e.player.defineProperty(d,"readyState",{get:function(){return f},set:function(e){return f=e,f},configurable:!0}),d.addEventListener=function(e,t){return h[e]||(h[e]=[]),h[e].push(t),t},d.removeEventListener=function(e,t){var n,r=h[e];if(!r)return;for(n=h[e].length-1;n>=0;n--)t===r[n]&&r.splice(n,1);return t},d.dispatchEvent=function(t){var n,r=this,i,s=t.type;s||(s=t,i=e.events.getInterface(s),i&&(n=document.createEvent(i),n.initEvent(s,!0,!0,window,1)));if(h[s])for(var o=h[s].length-1;o>=0;o--)h[s][o].call(r,n,r)},d.src=i||"",d.duration=0,d.paused=!0,d.ended=0,s&&s.events&&e.forEach(s.events,function(e,t){d.addEventListener(t,e,!1)}),r._canPlayType(p.nodeName,i)!==!1?r._setup?r._setup.call(d,s):(d.readyState=4,d.dispatchEvent("loadedmetadata"),d.dispatchEvent("loadeddata"),d.dispatchEvent("canplaythrough")):setTimeout(function(){d.dispatchEvent("error")},0),m=new e.p.init(d,s),r._teardown&&(m.destroy=t(m.destroy,function(){r._teardown.call(d,s)})),m};i.canPlayType=r._canPlayType=r._canPlayType||e.nop,e[n]=e.player.registry[n]=i},e.player.registry={},e.player.defineProperty=Object.defineProperty||function(t,n,r){t.__defineGetter__(n,r.get||e.nop),t.__defineSetter__(n,r.set||e.nop)},e.player.playerQueue=function(){var e=[],t=!1;return{next:function(){t=!1,e.shift(),e[0]&&e[0]()},add:function(n){e.push(function(){t=!0,n&&n()}),!t&&e[0]()}}},e.smart=function(t,n,r){var i=typeof t=="string"?e.dom.find(t):t,s,o,u,a,f,l,c,h="HTMLVimeoVideoElement HTMLSoundCloudAudioElement HTMLNullVideoElement".split(" ");if(!i){e.error("Specified target `"+t+"` was not found.");return}n=typeof n=="string"?[n]:n;for(s=0,c=n.length;s<c;s++){o=n[s];for(u=0;u<h.length;u++){f=e[h[u]];if(f&&f._canPlaySrc(o)==="probably")return a=f(i),l=e(a,r),setTimeout(function(){a.src=o},0),l}for(var p in e.player.registry)if(e.player.registry.hasOwnProperty(p)&&e.player.registry[p].canPlayType(i.nodeName,o))return e[p](i,o,r)}var d,v=e.guid("popcorn-video-");d='<video id="'+v+'" preload=auto autobuffer>';for(s=0,c=n.length;s<c;s++)d+='<source src="'+n[s]+'">';return d+="</video>",i.innerHTML=d,r&&r.events&&r.events.error&&i.addEventListener("error",r.events.error,!1),e("#"+v,r)}}(Popcorn),function(e,t){var n=e.document,r=e.location,i=/:\/\//,s=r.href.replace(r.href.split("/").slice(-1)[0],""),o=function(e,t,n){e=e||0,t=(t||e||0)+1,n=n||1;var r=Math.ceil((t-e)/n)||0,i=0,s=[];s.length=r;while(i<r)s[i++]=e,e+=n;return s};t.sequence=function(e,n){return new t.sequence.init(e,n)},t.sequence.init=function(e,r){this.parent=n.getElementById(e),this.seqId=t.guid("__sequenced"),this.queue=[],this.playlist=[],this.inOuts={ofVideos:[],ofClips:[]},this.dims={width:0,height:0},this.active=0,this.cycling=!1,this.playing=!1,this.times={last:0},this.events={};var o=this,u=0;return t.forEach(r,function(r,u){var a=n.createElement("video");a.preload="auto",a.controls=!0,a.style.display=u&&"none"||"",a.id=o.seqId+"-"+u,o.queue.push(a);var f=r["in"],l=r.out;o.inOuts.ofVideos.push({"in":f!==undefined&&f||1,out:l!==undefined&&l||0}),o.inOuts.ofVideos[u].out=o.inOuts.ofVideos[u].out||o.inOuts.ofVideos[u]["in"]+2,a.src=i.test(r.src)?r.src:s+r.src,a.setAttribute("data-sequence-owner",e),a.setAttribute("data-sequence-guid",o.seqId),a.setAttribute("data-sequence-id",u),a.setAttribute("data-sequence-clip",[o.inOuts.ofVideos[u]["in"],o.inOuts.ofVideos[u].out].join(":")),o.parent.appendChild(a),o.playlist.push(t("#"+a.id))}),o.inOuts.ofVideos.forEach(function(e){var t=e.out-e["in"],n={"in":u,out:u+t};o.inOuts.ofClips.push(n),u=n.out+1}),t.forEach(this.queue,function(e,n){function r(t){return n||(o.dims.width=e.videoWidth,o.dims.height=e.videoHeight),e.currentTime=o.inOuts.ofVideos[n]["in"]-.5,e.removeEventListener("canplaythrough",r,!1),!0}e.addEventListener("canplaythrough",r,!1),e.addEventListener("play",function(e){o.playing=!0},!1),e.addEventListener("pause",function(e){o.playing=!1},!1),e.addEventListener("timeupdate",function(n){var r=n.srcElement||n.target,i=+(r.dataset&&r.dataset.sequenceId||r.getAttribute("data-sequence-id")),s=Math.floor(e.currentTime);o.times.last!==s&&i===o.active&&(o.times.last=s,s===o.inOuts.ofVideos[i].out&&t.sequence.cycle.call(o,i))},!1)}),this},t.sequence.init.prototype=t.sequence.prototype,t.sequence.cycle=function(e){this.queue||t.error("Popcorn.sequence.cycle is not a public method");var n=this.queue,r=this.inOuts.ofVideos,i=n[e],s=0,o,u,a,f;return n[e+1]&&(s=e+1),n[e+1]?(o=n[s],u=r[s],t.extend(o,{width:this.dims.width,height:this.dims.height}),a=this.playlist[s],f=this.playlist[e],i.pause(),this.active=s,this.times.last=u["in"]-1,a.currentTime(u["in"]),a[s?"play":"pause"](),this.trigger("cycle",{position:{previous:e,current:s}}),s&&(i.style.display="none",o.style.display=""),this.cycling=!1):(s=0,this.playlist[e].pause()),this};var u=["timeupdate","play","pause"];t.extend(t.sequence.prototype,{eq:function(e){return this.playlist[e]},remove:function(){this.parent.innerHTML=null},clip:function(e){return this.inOuts.ofVideos[e]},duration:function(){var e=0,t=this.inOuts.ofClips,n=0;for(;n<t.length;n++)e+=t[n].out-t[n]["in"]+1;return e-1},play:function(){return this.playlist[this.active].play(),this},exec:function(e,n){var r=this.active;return this.inOuts.ofClips.forEach(function(t,n){e>=t["in"]&&e<=t.out&&(r=n)}),e+=this.inOuts.ofVideos[r]["in"]-this.inOuts.ofClips[r]["in"],t.addTrackEvent(this.playlist[r],{start:e-1,end:e,_running:!1,_natives:{start:n||t.nop,end:t.nop,type:"exec"}}),this},listen:function(e,n){var r=this,i=this.playlist,s=i.length,o=0,a;return n||(n=t.nop),t.Events.Natives.indexOf(e)>-1?t.forEach(i,function(t){t.listen(e,function(i){i.active=r,u.indexOf(e)>-1?n.call(t,i):++o===s&&n.call(t,i)})}):(this.events[e]||(this.events[e]={}),a=n.name||t.guid("__"+e),this.events[e][a]=n),this},unlisten:function(e,t){},trigger:function(e,n){var r=this;if(t.Events.Natives.indexOf(e)>-1)return;return this.events[e]&&t.forEach(this.events[e],function(t,i){t.call(r,{type:e},n)}),this}}),t.forEach(t.manifest,function(e,n){t.sequence.prototype[n]=function(e){var r={},i=[],s,u,a,f,l,c,h,p,d;for(s=0;s<this.inOuts.ofClips.length;s++)u=this.inOuts.ofClips[s],a=o(u["in"],u.out),f=a.indexOf(e.start),l=a.indexOf(e.end),f>-1&&(r[s]=t.extend({},u,{start:a[f],clipIdx:f})),l>-1&&(r[s]=t.extend({},u,{end:a[l],clipIdx:l}));c=Object.keys(r).map(function(e){return+e}),i=o(c[0],c[1]);for(s=0;s<i.length;s++){var v={},m=i[s],g=r[m];g?(h=this.inOuts.ofVideos[m],p=g.clipIdx,d=o(h["in"],h.out),g.start&&(v.start=d[p],v.end=d[d.length-1]),g.end&&(v.start=d[0],v.end=d[p])):(v.start=this.inOuts.ofVideos[m]["in"],v.end=this.inOuts.ofVideos[m].out),this.playlist[m][n](t.extend({},e,v))}return this}})}(this,Popcorn),function(e){document.addEventListener("DOMContentLoaded",function(){var t="data-timeline-sources",n=document.querySelectorAll("["+t+"]");e.forEach(n,function(r,i){var s=n[i],o=!1,u,a,f;s.id||(s.id=e.guid("__popcorn")),s.nodeType&&s.nodeType===1&&(f=e("#"+s.id),u=(s.getAttribute(t)||"").split(","),u[0]&&e.forEach(u,function(e){a=e.split("!"),a.length===1&&(a=e.match(/(.*)[\/\\]([^\/\\]+\.\w+)$/)[2].split("."),a[0]="parse"+a[1].toUpperCase(),a[1]=e),u[0]&&f[a[0]]&&f[a[0]](a[1])}),!f.autoplay()||f.play())})},!1)}(Popcorn),function(e){var t=Array.prototype,n=Object.prototype,r=t.forEach,i=t.slice,s=n.hasOwnProperty,o=n.toString;e.parsers={},e.parser=function(t,n,r){if(e.protect.natives.indexOf(t.toLowerCase())>=0){e.error("'"+t+"' is a protected function name");return}typeof n=="function"&&!r&&(r=n,n="");if(typeof r!="function"||typeof n!="string")return;var i=e.events.all,o,u={};return o=function(t,i,o){if(!t)return this;typeof i!="function"&&!o&&(o=i,i=null);var u=this;return e.xhr({url:t,dataType:n,success:function(e){var t=r(e,o),n,a,f,l=0;n=t.data||[],a=n.length,f=null;if(!a)return;for(;l<a;l++){f=n[l];for(var c in f)s.call(f,c)&&!!u[c]&&u[c](f[c])}i&&i()}}),this},u[t]=o,e.extend(e.p,u),u}}(Popcorn),function(e,t){function n(e){var t=n.options,r=t.parser[t.strictMode?"strict":"loose"].exec(e),i={},s=14;while(s--)i[t.key[s]]=r[s]||"";return i[t.q.name]={},i[t.key[12]].replace(t.q.parser,function(e,n,r){n&&(i[t.q.name][n]=r)}),i}function i(){var i={},s={},o;return Object.prototype.__defineGetter__||(i=t.createElement("div")),i._util={type:"HTML5",TIMEUPDATE_MS:250,MIN_WIDTH:300,MIN_HEIGHT:150,isAttributeSet:function(e){return typeof e=="string"||e===!0},parseUri:n},i.addEventListener=function(e,n,r){t.addEventListener(this._eventNamespace+e,n,r)},i.removeEventListener=function(e,n,r){t.removeEventListener(this._eventNamespace+e,n,r)},i.dispatchEvent=function(e){var n=t.createEvent("CustomEvent"),r={type:e,target:this.parentNode,data:null};n.initCustomEvent(this._eventNamespace+e,!1,!1,r),t.dispatchEvent(n)},i.load=e.nop,i.canPlayType=function(e){return""},i.getBoundingClientRect=function(){return o.getBoundingClientRect()},i.NETWORK_EMPTY=0,i.NETWORK_IDLE=1,i.NETWORK_LOADING=2,i.NETWORK_NO_SOURCE=3,i.HAVE_NOTHING=0,i.HAVE_METADATA=1,i.HAVE_CURRENT_DATA=2,i.HAVE_FUTURE_DATA=3,i.HAVE_ENOUGH_DATA=4,Object.defineProperties(i,{currentSrc:{get:function(){return this.src!==undefined?this.src:""},configurable:!0},parentNode:{get:function(){return o},set:function(e){o=e},configurable:!0},preload:{get:function(){return"auto"},set:e.nop,configurable:!0},controls:{get:function(){return!0},set:e.nop,configurable:!0},poster:{get:function(){return""},set:e.nop,configurable:!0},crossorigin:{get:function(){return""},configurable:!0},played:{get:function(){return r},configurable:!0},seekable:{get:function(){return r},configurable:!0},buffered:{get:function(){return r},configurable:!0},defaultMuted:{get:function(){return!1},configurable:!0},defaultPlaybackRate:{get:function(){return 1},configurable:!0},style:{get:function(){return this.parentNode.style},configurable:!0},id:{get:function(){return this.parentNode.id},configurable:!0}}),i}n.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var r={length:0,start:e.nop,end:e.nop};window.MediaError=window.MediaError||function(){function e(e,t){this.code=e||null,this.message=t||""}return e.MEDIA_ERR_NONE_ACTIVE=0,e.MEDIA_ERR_ABORTED=1,e.MEDIA_ERR_NETWORK=2,e.MEDIA_ERR_DECODE=3,e.MEDIA_ERR_NONE_SUPPORTED=4,e}(),e._MediaElementProto=i}(Popcorn,window.document),function(e,t,n){function o(e){function s(t,n){var i=JSON.stringify({method:t,value:n});if(!e.contentWindow)return;e.contentWindow.postMessage(i,r)}var n=this,r=e.src.split("?")[0],i=0;r.substr(0,2)==="//"&&(r=t.location.protocol+r);var o="play pause paused seekTo unload getCurrentTime getDuration getVideoEmbedCode getVideoHeight getVideoWidth getVideoUrl getColor setColor setLoop getVolume setVolume addEventListener".split(" ");o.forEach(function(e){n[e]=function(t){s(e,t)}})}function u(u){function w(e){m.unshift(e)}function E(e){d.addEventListener("loadProgress"),d.addEventListener("playProgress"),d.addEventListener("play"),d.addEventListener("pause"),d.addEventListener("finish"),d.addEventListener("seek"),d.getDuration(),c.networkState=a.NETWORK_LOADING,a.dispatchEvent("loadstart"),a.dispatchEvent("progress")}function S(e){var t=c.duration;if(t!==e){c.duration=e,a.dispatchEvent("durationchange");if(isNaN(t)){c.networkState=a.NETWORK_IDLE,c.readyState=a.HAVE_METADATA,a.dispatchEvent("loadedmetadata"),a.dispatchEvent("loadeddata"),c.readyState=a.HAVE_FUTURE_DATA,a.dispatchEvent("canplay"),c.readyState=a.HAVE_ENOUGH_DATA,a.dispatchEvent("canplaythrough"),c.autoplay&&a.play();var n=m.length;while(n--)m[n](),delete m[n]}}}function x(){h||w(function(){x()}),d.getDuration()}function T(){if(!h||!d)return;clearInterval(y),d.pause(),t.removeEventListener("message",P,!1),f.removeChild(l),l=n.createElement("iframe")}function N(e){if(!h){w(function(){N(e)});return}C(),d.seekTo(e)}function C(){c.seeking=!0,a.dispatchEvent("seeking")}function k(){c.seeking=!1,a.dispatchEvent("timeupdate"),a.dispatchEvent("seeked"),a.dispatchEvent("canplay"),a.dispatchEvent("canplaythrough")}function L(){c.paused=!0,v||(v=!0,clearInterval(g),a.dispatchEvent("pause"))}function A(){a.dispatchEvent("timeupdate")}function O(){c.ended&&N(0),y||(y=setInterval(H,r),c.loop&&a.dispatchEvent("play")),g=setInterval(A,a._util.TIMEUPDATE_MS),c.paused=!1,v&&(v=!1,c.loop||a.dispatchEvent("play"),a.dispatchEvent("playing"))}function M(){c.loop?(N(0),a.play()):(c.ended=!0,a.dispatchEvent("ended"))}function _(e){var t=c.currentTime=e;t!==b&&a.dispatchEvent("timeupdate"),b=c.currentTime}function D(e){if(e.origin!==s)return;var n;try{n=JSON.parse(e.data)}catch(r){console.warn(r)}if(n.player_id!=p)return;switch(n.event){case"ready":d=new o(l),d.addEventListener("loadProgress"),d.addEventListener("pause"),d.setVolume(0),d.play();break;case"loadProgress":var i=parseFloat(n.data.duration);i>0&&!h&&(h=!0,d.pause());break;case"pause":d.setVolume(1),t.removeEventListener("message",D,!1),t.addEventListener("message",P,!1),E()}}function P(e){if(e.origin!==s)return;var t;try{t=JSON.parse(e.data)}catch(n){console.warn(n)}if(t.player_id!=p)return;switch(t.method){case"getCurrentTime":_(parseFloat(t.value));break;case"getDuration":S(parseFloat(t.value));break;case"getVolume":j(parseFloat(t.value))}switch(t.event){case"loadProgress":a.dispatchEvent("progress"),S(parseFloat(t.data.duration));break;case"playProgress":_(parseFloat(t.data.seconds));break;case"play":O();break;case"pause":L();break;case"finish":M();break;case"seek":_(parseFloat(t.data.seconds)),k()}}function H(){d.getCurrentTime()}function B(e){if(!a._canPlaySrc(e)){c.error={name:"MediaError",message:"Media Source Not Supported",code:MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED},a.dispatchEvent("error");return}c.src=e,h&&T(),h=!1;var n=a._util.parseUri(e),r=n.queryKey,i,o=["api=1","player_id="+p,"title=0","byline=0","portrait=0"];c.loop=r.loop==="1"||c.loop,delete r.loop,c.autoplay=r.autoplay==="1"||c.autoplay,delete r.autoplay,n=s+"/video/"+/\d+$/.exec(n.path)+"?";for(i in r)r.hasOwnProperty(i)&&o.push(encodeURIComponent(i)+"="+encodeURIComponent(r[i]));n+=o.join("&"),l.id=p,l.style.width="100%",l.style.height="100%",l.frameBorder=0,l.webkitAllowFullScreen=!0,l.mozAllowFullScreen=!0,l.allowFullScreen=!0,f.appendChild(l),l.src=n,t.addEventListener("message",D,!1)}function j(e){c.volume!==e&&(c.volume=e,a.dispatchEvent("volumechange"))}function F(e){c.volume=e;if(!h){w(function(){F(e)});return}d.setVolume(e),a.dispatchEvent("volumechange")}function I(){return c.muted>0?c.muted:c.volume}function q(e){if(!h){c.muted=e?1:0,w(function(){q(e)});return}e?(c.muted=c.volume,F(0)):(c.muted=0,F(c.muted))}function R(){return c.muted>0}if(!t.postMessage)throw"ERROR: HTMLVimeoVideoElement requires window.postMessage";var a=new e._MediaElementProto,f=typeof u=="string"?e.dom.find(u):u,l=n.createElement("iframe"),c={src:i,networkState:a.NETWORK_EMPTY,readyState:a.HAVE_NOTHING,seeking:!1,autoplay:i,preload:i,controls:!1,loop:!1,poster:i,volume:1,muted:0,currentTime:0,duration:NaN,ended:!1,paused:!0,error:null},h=!1,p=e.guid(),d,v=!0,m=[],g,y,b=0;return a._eventNamespace=e.guid("HTMLVimeoVideoElement::"),a.parentNode=f,a._util.type="Vimeo",a.play=function(){c.paused=!1;if(!h){w(function(){a.play()});return}d.play()},a.pause=function(){c.paused=!0;if(!h){w(function(){a.pause()});return}d.pause()},Object.defineProperties(a,{src:{get:function(){return c.src},set:function(e){e&&e!==c.src&&B(e)}},autoplay:{get:function(){return c.autoplay},set:function(e){c.autoplay=a._util.isAttributeSet(e)}},loop:{get:function(){return c.loop},set:function(e){c.loop=a._util.isAttributeSet(e)}},width:{get:function(){return a.parentNode.offsetWidth}},height:{get:function(){return a.parentNode.offsetHeight}},currentTime:{get:function(){return c.currentTime},set:function(e){N(e)}},duration:{get:function(){return c.duration}},ended:{get:function(){return c.ended}},paused:{get:function(){return c.paused}},seeking:{get:function(){return c.seeking}},readyState:{get:function(){return c.readyState}},networkState:{get:function(){return c.networkState}},volume:{get:function(){return I()},set:function(e){if(e<0||e>1)throw"Volume value must be between 0.0 and 1.0";F(e)}},muted:{get:function(){return R()},set:function(e){q(a._util.isAttributeSet(e))}},error:{get:function(){return c.error}}}),a._canPlaySrc=e.HTMLVimeoVideoElement._canPlaySrc,a.canPlayType=e.HTMLVimeoVideoElement.canPlayType,a}var r=16,i="",s="https://player.vimeo.com";e.HTMLVimeoVideoElement=function(e){return new u(e)},e.HTMLVimeoVideoElement._canPlaySrc=function(e){return/player.vimeo.com\/video\/\d+/.test(e)||/vimeo.com\/\d+/.test(e)?"probably":i},e.HTMLVimeoVideoElement.canPlayType=function(e){return e==="video/x-vimeo"?"probably":i}}(Popcorn,window,document),function(e,t,n){function l(){var e;if(YT.loaded){u=!0;while(f.length)e=f.shift(),e()}else setTimeout(l,250)}function c(){var e;return a||(t.YT?l():(e=n.createElement("script"),e.addEventListener("load",l,!1),e.src="https://www.youtube.com/iframe_api",n.head.appendChild(e)),a=!0),u}function h(e){f.push(e)}function p(u){function N(e){b.push(e)}function C(){g.pauseVideo(),P("play",C),D("play",V)}function k(){D("pause",J),P("pause",k)}function L(e){var t=function(){g.isMuted()?(D("play",_),g.playVideo()):setTimeout(t,0)};d=!0,g.mute(),t()}function A(e){var t={name:"MediaError"};switch(e.data){case 2:t.message="Invalid video parameter.",t.code=MediaError.MEDIA_ERR_ABORTED;break;case 5:t.message="The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.",t.code=MediaError.MEDIA_ERR_DECODE;case 100:t.message="Video not found.",t.code=MediaError.MEDIA_ERR_NETWORK;break;case 101:case 150:t.message="Video not usable.",t.code=MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED;break;default:t.message="Unknown error.",t.code=5}p.error=t,a.dispatchEvent("error")}function O(){D("play",V),D("pause",J);if(p.autoplay||!p.paused)P("play",O),p.paused=!1,N(function(){p.paused||V()});p.muted||g.unMute(),p.readyState=a.HAVE_METADATA,a.dispatchEvent("loadedmetadata"),x=setInterval(q,r),a.dispatchEvent("loadeddata"),p.readyState=a.HAVE_FUTURE_DATA,a.dispatchEvent("canplay"),v=!0,E=setInterval(R,50);while(b.length)b[0](),b.shift();p.readyState=a.HAVE_ENOUGH_DATA,a.dispatchEvent("canplaythrough")}function M(){P("pause",M);if(g.getCurrentTime()>0){setTimeout(M,0);return}p.autoplay||!p.paused?(D("play",O),g.playVideo()):O()}function _(){P("play",_);if(g.getCurrentTime()===0){setTimeout(_,0);return}D("pause",M),g.seekTo(0),g.pauseVideo()}function D(e,t){a.addEventListener("youtube-"+e,t,!1)}function P(e,t){a.removeEventListener("youtube-"+e,t,!1)}function H(e){a.dispatchEvent("youtube-"+e)}function B(){p.networkState=a.NETWORK_LOADING;var e=g.getDuration();p.duration!==e&&(p.duration=e,a.dispatchEvent("durationchange")),a.dispatchEvent("waiting")}function j(e){switch(e.data){case YT.PlayerState.ENDED:H("ended");break;case YT.PlayerState.PLAYING:H("play");break;case YT.PlayerState.PAUSED:g.getDuration()!==g.getCurrentTime()&&H("pause");break;case YT.PlayerState.BUFFERING:H("buffering");break;case YT.PlayerState.CUED:}e.data!==YT.PlayerState.BUFFERING&&w===YT.PlayerState.BUFFERING&&$(),w=e.data}function F(){if(!d||!g)return;P("buffering",B),P("ended",K),P("play",V),P("pause",J),J(),v=!1,m=!1,p.currentTime=0,b=[],clearInterval(x),clearInterval(E),g.stopVideo(),g.clearVideo(),g.destroy(),l=n.createElement("div")}function I(e){if(!a._canPlaySrc(e)){p.error={name:"MediaError",message:"Media Source Not Supported",code:MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED},a.dispatchEvent("error");return}p.src=e;if(!c()){h(function(){I(e)});return}if(d){if(!v){N(function(){I(e)});return}F()}f.appendChild(l);var n=a._util.parseUri(e).queryKey;delete n.v,p.autoplay=n.autoplay==="1"||p.autoplay,delete n.autoplay,p.loop=n.loop==="1"||p.loop,delete n.loop,n.rel=n.rel||0,n.modestbranding=n.modestbranding||1,n.iv_load_policy=n.iv_load_policy||3,n.disablekb=n.disablekb||1,n.showinfo=n.showinfo||0;var r=t.location.protocol==="file:"?"*":t.location.protocol+"//"+t.location.host;n.origin=n.origin||r,n.controls=n.controls||p.controls?2:0,p.controls=n.controls,n.wmode=n.wmode||"opaque",n.html5!==0&&(n.html5=1),e=s.exec(e)[1],g=new YT.Player(l,{width:"100%",height:"100%",wmode:n.wmode,videoId:e,playerVars:n,events:{onReady:L,onError:A,onStateChange:j}}),p.networkState=a.NETWORK_LOADING,a.dispatchEvent("loadstart"),a.dispatchEvent("progress")}function q(){var e=g.getCurrentTime();p.seeking?o(e-p.currentTime)<1&&X():(o(p.currentTime-e)>r&&(W(),X()),p.currentTime=e)}function R(){var e=g.getVideoLoadedFraction();e&&S!==e&&(S=e,$())}function U(e){if(e===p.currentTime)return;p.currentTime=e;if(!v){N(function(){W(),g.seekTo(e)});return}W(),g.seekTo(e)}function z(){a.dispatchEvent("timeupdate")}function W(){D("pause",k),P("pause",J),p.seeking=!0,a.dispatchEvent("seeking")}function X(){p.ended=!1,p.seeking=!1,a.dispatchEvent("timeupdate"),a.dispatchEvent("seeked"),a.dispatchEvent("canplay"),a.dispatchEvent("canplaythrough")}function V(){p.ended&&(U(0),p.ended=!1),T=setInterval(z,a._util.TIMEUPDATE_MS),p.paused=!1;if(y){y=!1;if(p.loop&&!m||!p.loop)m=!0,a.dispatchEvent("play");a.dispatchEvent("playing")}}function $(){a.dispatchEvent("progress")}function J(){p.paused=!0,y||(y=!0,clearInterval(T),a.dispatchEvent("pause"))}function K(){p.loop?(U(0),a.play()):(p.ended=!0,J(),D("play",C),P("play",V),a.dispatchEvent("timeupdate"),a.dispatchEvent("ended"))}function Q(e){p.muted=e;if(!v){N(function(){Q(p.muted)});return}g[e?"mute":"unMute"](),a.dispatchEvent("volumechange")}function G(){return p.muted}if(!t.postMessage)throw"ERROR: HTMLYouTubeVideoElement requires window.postMessage";var a=new e._MediaElementProto,f=typeof u=="string"?n.querySelector(u):u,l=n.createElement("div"),p={src:i,networkState:a.NETWORK_EMPTY,readyState:a.HAVE_NOTHING,seeking:!1,autoplay:i,preload:i,controls:!1,loop:!1,poster:i,volume:1,muted:!1,currentTime:0,duration:NaN,ended:!1,paused:!0,error:null},d=!1,v=!1,m=!1,g,y=!0,b=[],w=-1,E,S=0,x,T;return a._eventNamespace=e.guid("HTMLYouTubeVideoElement::"),a.parentNode=f,a._util.type="YouTube",D("buffering",B),D("ended",K),a.play=function(){p.paused=!1;if(!v){N(function(){a.play()});return}g.playVideo()},a.pause=function(){p.paused=!0;if(!v){N(function(){a.pause()});return}k(),g.pauseVideo()},Object.defineProperties(a,{src:{get:function(){return p.src},set:function(e){e&&e!==p.src&&I(e)}},autoplay:{get:function(){return p.autoplay},set:function(e){p.autoplay=a._util.isAttributeSet(e)}},loop:{get:function(){return p.loop},set:function(e){p.loop=a._util.isAttributeSet(e)}},width:{get:function(){return a.parentNode.offsetWidth}},height:{get:function(){return a.parentNode.offsetHeight}},currentTime:{get:function(){return p.currentTime},set:function(e){U(e)}},duration:{get:function(){return p.duration}},ended:{get:function(){return p.ended}},paused:{get:function(){return p.paused}},seeking:{get:function(){return p.seeking}},readyState:{get:function(){return p.readyState}},networkState:{get:function(){return p.networkState}},volume:{get:function(){return p.volume},set:function(e){if(e<0||e>1)throw"Volume value must be between 0.0 and 1.0";p.volume=e;if(!v){N(function(){a.volume=e});return}g.setVolume(p.volume*100),a.dispatchEvent("volumechange")}},muted:{get:function(){return G()},set:function(e){Q(a._util.isAttributeSet(e))}},error:{get:function(){return p.error}},buffered:{get:function(){var e={start:function(e){if(e===0)return 0;throw"INDEX_SIZE_ERR: DOM Exception 1"},end:function(e){if(e===0)return p.duration?p.duration*S:0;throw"INDEX_SIZE_ERR: DOM Exception 1"},length:1};return e},configurable:!0}}),a._canPlaySrc=e.HTMLYouTubeVideoElement._canPlaySrc,a.canPlayType=e.HTMLYouTubeVideoElement.canPlayType,a}var r=10,i="",s=/^.*(?:\/|v=)(.{11})/,o=Math.abs,u=!1,a=!1,f=[];e.HTMLYouTubeVideoElement=function(e){return new p(e)},e.HTMLYouTubeVideoElement._canPlaySrc=function(e){return/(?:http:\/\/www\.|http:\/\/|www\.|\.|^)(youtu).*(?:\/|v=)(.{11})/.test(e)?"probably":i},e.HTMLYouTubeVideoElement.canPlayType=function(e){return e==="video/x-youtube"?"probably":i}}(Popcorn,window,document),function(e,t){function n(e){return"maybe"}function r(e,r){var i=typeof e=="string"?t.querySelector(e):e,s=t.createElement(r);return i.appendChild(s),s._canPlaySrc=n,s}e.HTMLVideoElement=function(e){return r(e,"video")},e.HTMLVideoElement._canPlaySrc=n,e.HTMLAudioElement=function(e){return r(e,"audio")},e.HTMLAudioElement._canPlaySrc=n}(Popcorn,window.document),function(e,t,n){function u(){i=!0;var e=o.length;while(e--)o[e](),delete o[e]}function a(){t.jwplayer?u():setTimeout(a,100)}function f(){if(!s){if(!t.jwplayer){var e=n.createElement("script");e.src="https://jwpsrv.com/library/zaIF4JI9EeK2FSIACpYGxA.js";var r=n.getElementsByTagName("script")[0];r.parentNode.insertBefore(e,r)}s=!0,a()}return i}function l(e){o.unshift(e)}function c(i){function S(e){g.unshift(e)}function x(){var e=v.getDuration();if(e==-1||e==undefined)setTimeout(x,0);else{u.duration=e,s.dispatchEvent("durationchange"),a=!0,u.readyState=s.HAVE_METADATA,s.dispatchEvent("loadedmetadata"),s.dispatchEvent("loadeddata"),u.readyState=s.HAVE_FUTURE_DATA,s.dispatchEvent("canplay"),p=!0;var t=0;while(g.length)g[t](),g.shift();u.readyState=s.HAVE_ENOUGH_DATA,s.dispatchEvent("canplaythrough")}}function T(){x()}function N(){c?c=!1:E?(E=!1,T()):I()}function C(){w?(w=!1,u.autoplay||!u.paused?(u.paused=!1,S(j),T()):(E=!0,h=!0,v.pause(!0))):h?(h=!1,c=!0,v.pause(!0)):j()}function k(){u.seeking&&B()}function L(){v.onPause(N),v.onTime(function(){!u.ended&&!u.seeking&&(u.currentTime=v.getPosition(),s.dispatchEvent("timeupdate"))}),v.onSeek(k),v.onPlay(function(){u.ended||C()}),v.onBufferChange(F),v.onComplete(q),v.play(!0)}function A(){return v.getDuration()}function O(e){var t={name:"MediaError"};t.message=e.message,t.code=e.code||5,u.error=t,s.dispatchEvent("error")}function M(){if(!a||!v)return;v.destroy()}function _(e){if(!s._canPlaySrc(e)){u.error={name:"MediaError",message:"Media Source Not Supported",code:MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED},s.dispatchEvent("error");return}var t=s._util.parseUri(e).queryKey;u.controls=t.controls=t.controls||u.controls,u.src=e;if(!f()){l(function(){_(e)});return}a&&M();var n={width:"100%",height:"100%",autostart:u.autoplay,controls:u.controls};typeof e=="string"?n.file=e:n.sources=e,jwplayer(o.id).setup(n),v=jwplayer(o.id),v.onReady(L),v.onError(O),jwplayer.utils.log=function(e,t){typeof console!="undefined"&&typeof console.log!="undefined"&&(t?console.log(e,t):console.log(e)),e==="No suitable players found and fallback enabled"&&O({message:e,code:4})},u.networkState=s.NETWORK_LOADING,s.dispatchEvent("loadstart"),s.dispatchEvent("progress")}function D(){return u.currentTime}function P(e){u.currentTime=e;if(!p){S(function(){H(),v.seek(e)});return}H(),v.seek(e)}function H(){u.seeking=!0,u.paused&&(h=!0),s.dispatchEvent("seeking")}function B(){u.ended=!1,u.seeking=!1,s.dispatchEvent("timeupdate"),s.dispatchEvent("seeked"),s.dispatchEvent("canplay"),s.dispatchEvent("canplaythrough")}function j(){u.paused=!1;if(a&&m){m=!1;if(u.loop&&!d||!u.loop)d=!0,s.dispatchEvent("play");s.dispatchEvent("playing")}}function F(){s.dispatchEvent("progress")}function I(){u.paused=!0,m||(m=!0,s.dispatchEvent("pause"))}function q(){u.loop?P(0):(u.ended=!0,I(),s.dispatchEvent("timeupdate"),s.dispatchEvent("ended"))}function R(e){u.volume=e;if(!p){S(function(){R(u.volume)});return}v.setVolume(u.volume*100),s.dispatchEvent("volumechange")}function U(e){u.muted=e;if(!p){S(function(){U(u.muted)});return}v.setMute(e),s.dispatchEvent("volumechange")}function z(){return u.muted}if(!t.postMessage)throw"ERROR: HTMLJWPlayerVideoElement requires window.postMessage";var s=new e._MediaElementProto,o=typeof i=="string"?n.querySelector(i):i,u={src:r,networkState:s.NETWORK_EMPTY,readyState:s.HAVE_NOTHING,seeking:!1,autoplay:r,preload:r,controls:!1,loop:!1,poster:r,volume:1,muted:!1,currentTime:0,duration:NaN,ended:!1,paused:!0,error:null},a=!1,c=!1,h=!1,p=!1,d=!1,v,m=!0,g=[],y=-1,b=0,w=!0,E=!1;return s._eventNamespace=e.guid("HTMLJWPlayerVideoElement::"),s.parentNode=o,s._util.type="JWPlayer",s.play=function(){s.dispatchEvent("play"),u.paused=!1;if(!p){S(function(){s.play()});return}u.ended&&(P(0),u.ended=!1),v.play(!0)},s.pause=function(){u.paused=!0;if(!p){S(function(){s.pause()});return}v.pause(!0)},Object.defineProperties(s,{src:{get:function(){return u.src},set:function(e){e&&e!==u.src&&_(e)}},autoplay:{get:function(){return u.autoplay},set:function(e){u.autoplay=s._util.isAttributeSet(e)}},loop:{get:function(){return u.loop},set:function(e){u.loop=s._util.isAttributeSet(e)}},width:{get:function(){return s.parentNode.offsetWidth}},height:{get:function(){return s.parentNode.offsetHeight}},currentTime:{get:function(){return D()},set:function(e){P(e)}},duration:{get:function(){return A()}},ended:{get:function(){return u.ended}},paused:{get:function(){return u.paused}},seeking:{get:function(){return u.seeking}},readyState:{get:function(){return u.readyState}},networkState:{get:function(){return u.networkState}},volume:{get:function(){return u.volume},set:function(e){if(e<0||e>1)throw"Volume value must be between 0.0 and 1.0";R(e)}},muted:{get:function(){return u.muted},set:function(e){U(s._util.isAttributeSet(e))}},error:{get:function(){return u.error}},buffered:{get:function(){var e={start:function(e){if(e===0)return 0;throw"INDEX_SIZE_ERR: DOM Exception 1"},end:function(e){var t;if(e===0)return t=A(),t?t*(v.getBuffer()/100):0;throw"INDEX_SIZE_ERR: DOM Exception 1"},length:1};return e}}}),s._canPlaySrc=e.HTMLJWPlayerVideoElement._canPlaySrc,s.canPlayType=e.HTMLJWPlayerVideoElement.canPlayType,s}var r="",i=!1,s=!1,o=[];e.HTMLJWPlayerVideoElement=function(e){return new c(e)},e.HTMLJWPlayerVideoElement._canPlaySrc=function(e){if(typeof e!="string")return"probably";if(/.+\.+/g.exec(e))return"probably"},e.HTMLJWPlayerVideoElement.canPlayType=function(e){return"probably"}}(Popcorn,window,document),function(e,t){function o(t){this.startTime=0,this.currentTime=t.currentTime||0,this.duration=t.duration||NaN,this.playInterval=null,this.paused=!0,this.defaultPlaybackRate=1,this.playbackRate=1,this.ended=t.endedCallback||e.nop}function u(e){e.currentTime+=(Date.now()-e.startTime)/(1e3/e.playbackRate),e.startTime=Date.now(),e.currentTime>=e.duration&&(e.pause(e.duration),e.ended()),e.currentTime<0&&e.pause(0)}function a(n){function d(e){h.push(e)}function v(){var e;f=!0,c.networkState=r.NETWORK_IDLE,c.readyState=r.HAVE_METADATA,r.dispatchEvent("loadedmetadata"),r.dispatchEvent("loadeddata"),c.readyState=r.HAVE_FUTURE_DATA,r.dispatchEvent("canplay"),c.readyState=r.HAVE_ENOUGH_DATA,r.dispatchEvent("canplaythrough");while(h.length)e=h.shift(),e();c.autoplay&&r.play()}function m(){return l?l.duration:NaN}function g(){if(!f||!l)return;l.pause(),l=null,u.removeChild(a),a=t.createElement("div")}function y(e){if(!r._canPlaySrc(e)){c.error={name:"MediaError",message:"Media Source Not Supported",code:MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED},r.dispatchEvent("error");return}c.src=e,f&&g(),a.width=c.width,a.height=c.height,u.appendChild(a);var t=s.exec(e),n=+t[1],i=+t[2];l=new o({currentTime:n,duration:i,endedCallback:C}),r.dispatchEvent("loadstart"),r.dispatchEvent("progress"),r.dispatchEvent("durationchange"),v()}function b(){return f?l.currentTime:0}function w(e){if(e===b())return;if(!f){d(function(){w(e)});return}S(),l.seekTo(e),x()}function E(){r.dispatchEvent("timeupdate")}function S(e){c.seeking=!0,r.dispatchEvent("seeking")}function x(){c.ended=!1,c.seeking=!1,r.dispatchEvent("timeupdate"),r.dispatchEvent("seeked"),r.dispatchEvent("canplay"),r.dispatchEvent("canplaythrough")}function T(){c.paused===1?(c.paused=!1,r.dispatchEvent("play"),r.dispatchEvent("playing")):(c.ended&&(w(0),c.ended=!1),c.paused&&(c.paused=!1,c.loop||r.dispatchEvent("play"),r.dispatchEvent("playing"))),p=setInterval(E,r._util.TIMEUPDATE_MS)}function N(){c.paused=!0,clearInterval(p),r.dispatchEvent("pause")}function C(){c.loop?(w(0),r.play()):(c.ended=!0,N(),r.dispatchEvent("timeupdate"),r.dispatchEvent("ended"))}function k(e){c.volume=e,r.dispatchEvent("volumechange")}function L(){return c.volume}function A(e){c.muted=e,r.dispatchEvent("volumechange")}function O(){return c.muted}var r=new e._MediaElementProto,u=typeof n=="string"?t.querySelector(n):n,a=t.createElement("div"),f=!1,l,c={src:i,networkState:r.NETWORK_EMPTY,readyState:r.HAVE_NOTHING,autoplay:i,preload:i,controls:i,loop:!1,poster:i,volume:1,muted:!1,width:u.width|0?u.width:r._util.MIN_WIDTH,height:u.height|0?u.height:r._util.MIN_HEIGHT,seeking:!1,ended:!1,paused:1,error:null},h=[],p;return r._eventNamespace=e.guid("HTMLNullVideoElement::"),r.parentNode=u,r._util.type="NullVideo",r.play=function(){if(!f){d(function(){r.play()});return}l.play(),c.paused&&T()},r.pause=function(){if(!f){d(function(){r.pause()});return}l.pause(),c.paused||N()},Object.defineProperties(r,{src:{get:function(){return c.src},set:function(e){e&&e!==c.src&&y(e)}},autoplay:{get:function(){return c.autoplay},set:function(e){c.autoplay=r._util.isAttributeSet(e)}},loop:{get:function(){return c.loop},set:function(e){c.loop=r._util.isAttributeSet(e)}},width:{get:function(){return a.width},set:function(e){a.width=e,c.width=a.width}},height:{get:function(){return a.height},set:function(e){a.height=e,c.height=a.height}},currentTime:{get:function(){return b()},set:function(e){w(e)}},duration:{get:function(){return m()}},ended:{get:function(){return c.ended}},paused:{get:function(){return c.paused}},seeking:{get:function(){return c.seeking}},readyState:{get:function(){return c.readyState}},networkState:{get:function(){return c.networkState}},volume:{get:function(){return L()},set:function(e){if(e<0||e>1)throw"Volume value must be between 0.0 and 1.0";k(e)}},muted:{get:function(){return O()},set:function(e){A(r._util.isAttributeSet(e))}},playbackRate:{get:function(){return l.playbackRate},set:function(e){l.playbackRate=e,r.dispatchEvent("ratechange")}},error:{get:function(){return c.error}}}),r._canPlaySrc=e.HTMLNullVideoElement._canPlaySrc,r.canPlayType=e.HTMLNullVideoElement.canPlayType,r}var n=16,r=n/1e3,i="",s=/#t=(\d+\.?\d*)?,?(\d+\.?\d*)/;o.prototype={play:function(){var e=this;this.paused&&(this.paused=!1,this.startTime=Date.now(),this.playInterval=setInterval(function(){u(e)},n))},pause:function(){this.paused||(this.paused=!0,clearInterval(this.playInterval))},seekTo:function(e){e=e<0?0:e,e=e>this.duration?this.duration:e,this.currentTime=e}},e.HTMLNullVideoElement=function(e){return new a(e)},e.HTMLNullVideoElement._canPlaySrc=function(e){return s.test(e)?"probably":i},e.HTMLNullVideoElement.canPlayType=function(e){return e==="video/x-nullvideo"?"probably":i}}(Popcorn,document),function(e,t,n){function a(){return o||(e.getScript("https://w.soundcloud.com/player/api.js",function(){e.getScript("https://connect.soundcloud.com/sdk.js",function(){s=!0,SC.initialize({client_id:"PRaNFlda6Bhf5utPjUsptg"});var e=u.length;while(e--)u[e](),delete u[e]})}),o=!0),s}function f(e){u.unshift(e)}function l(s){function b(e){v.unshift(e)}function w(){d.bind(SC.Widget.Events.LOAD_PROGRESS,function(e){D({type:"loadProgress",data:e.currentPosition/1e3})}),d.bind(SC.Widget.Events.PLAY_PROGRESS,function(e){D({type:"playProgress",data:e.currentPosition/1e3})}),d.bind(SC.Widget.Events.PLAY,function(e){D({type:"play"})}),d.bind(SC.Widget.Events.PAUSE,function(e){D({type:"pause"})}),d.bind(SC.Widget.Events.SEEK,function(e){d.getPosition(function(e){var t=e/1e3;if(c.seeking){Math.floor(t)!==Math.floor(c.currentTime)?d.seekTo(c.currentTime*1e3):k();return}D({type:"seek",data:t})})}),d.bind(SC.Widget.Events.FINISH,function(){D({type:"finish"})}),h=!0,d.getDuration(S)}function E(e){d.bind(SC.Widget.Events.PLAY_PROGRESS,function(e){d.setVolume(0),e.currentPosition>0&&(d.unbind(SC.Widget.Events.PLAY_PROGRESS),d.bind(SC.Widget.Events.PAUSE,function(){d.unbind(SC.Widget.Events.PAUSE),d.setVolume(1),d.bind(SC.Widget.Events.SEEK,function(){d.unbind(SC.Widget.Events.SEEK),w()}),d.seekTo(0)}),d.pause())}),d.play()}function S(e){e/=1e3;var t=c.duration;if(t!==e){c.duration=e,o.dispatchEvent("durationchange");if(isNaN(t)){c.networkState=o.NETWORK_IDLE,c.readyState=o.HAVE_METADATA,o.dispatchEvent("loadedmetadata"),o.dispatchEvent("loadeddata"),c.readyState=o.HAVE_FUTURE_DATA,o.dispatchEvent("canplay"),c.readyState=o.HAVE_ENOUGH_DATA,o.dispatchEvent("canplaythrough");var n=v.length;while(n--)v[n](),delete v[n];c.paused&&c.autoplay&&o.play()}}}function x(){h||b(function(){x()}),d.getDuration(S)}function T(){if(!h||!d)return;clearInterval(g),d.pause(),d.unbind(SC.Widget.Events.READY),d.unbind(SC.Widget.Events.LOAD_PROGRESS),d.unbind(SC.Widget.Events.PLAY_PROGRESS),d.unbind(SC.Widget.Events.PLAY),d.unbind(SC.Widget.Events.PAUSE),d.unbind(SC.Widget.Events.SEEK),d.unbind(SC.Widget.Events.FINISH),u.removeChild(l),l=n.createElement("iframe")}function N(e){function t(){C(),d.seekTo(e)}c.currentTime=e,e*=1e3;if(!h){addMediaReadyCallback(t);return}t()}function C(){c.seeking=!0,o.dispatchEvent("seeking")}function k(){c.ended=!1,c.seeking=!1,o.dispatchEvent("timeupdate"),o.dispatchEvent("seeked"),o.dispatchEvent("canplay"),o.dispatchEvent("canplaythrough")}function L(){c.paused=!0,p||(p=!0,clearInterval(m),o.dispatchEvent("pause"))}function A(){o.dispatchEvent("timeupdate")}function O(){g||(g=setInterval(P,r),c.loop&&o.dispatchEvent("play")),m=setInterval(A,o._util.TIMEUPDATE_MS),c.paused=!1,p&&(p=!1,c.loop||o.dispatchEvent("play"),o.dispatchEvent("playing"))}function M(){c.loop?(N(0),o.play()):(c.ended=!0,o.pause(),L(),o.dispatchEvent("timeupdate"),o.dispatchEvent("ended"))}function _(e){c.currentTime=e,e!==y&&o.dispatchEvent("timeupdate"),y=e}function D(e){switch(e.type){case"loadProgress":o.dispatchEvent("progress");break;case"playProgress":_(e.data);break;case"play":O();break;case"pause":L();break;case"finish":M();break;case"seek":_(e.data)}}function P(){if(c.ended)return;d.getPosition(function(e){_(e/1e3)})}function H(t){if(!o._canPlaySrc(t)){c.error={name:"MediaError",message:"Media Source Not Supported",code:MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED},o.dispatchEvent("error");return}c.src=t,h&&T();if(!a()){f(function(){H(t)});return}h=!1,SC.get("/resolve",{url:t},function(t){var n;t.errors&&(n={name:"MediaError"},t.errors[0]&&t.errors[0].error_message==="404 - Not Found"&&(n.message="Video not found.",n.code=MediaError.MEDIA_ERR_NETWORK),c.error=n,o.dispatchEvent("error")),l.id=e.guid("soundcloud-"),l.width=c.width,l.height=c.height,l.frameBorder=0,l.webkitAllowFullScreen=!0,l.mozAllowFullScreen=!0,l.allowFullScreen=!0,q(c.controls),u.appendChild(l),l.onload=function(){l.onload=null,d=SC.Widget(l),d.bind(SC.Widget.Events.READY,E),c.networkState=o.NETWORK_LOADING,o.dispatchEvent("loadstart"),o.dispatchEvent("progress")},l.src="https://w.soundcloud.com/player/?url="+t.uri+"&show_artwork=false"+"&buying=false"+"&liking=false"+"&sharing=false"+"&download=false"+"&show_comments=false"+"&show_user=false"+"&single_active=false"})}function B(e){c.volume=e;if(!h){b(function(){B(e)});return}d.setVolume(e),o.dispatchEvent("volumechange")}function j(){return c.muted>0?c.muted:c.volume}function F(e){if(!h){c.muted=e?1:0,b(function(){F(e)});return}e?(c.muted=c.volume,B(0)):(c.muted=0,B(c.muted))}function I(){return c.muted>0}function q(e){h?(l.style.position="absolute",l.style.visibility=e?"visible":"hidden"):(l.style.opacity=e?"1":"0",l.style.pointerEvents=e?"auto":"none"),c.controls=e}if(!t.postMessage)throw"ERROR: HTMLSoundCloudAudioElement requires window.postMessage";var o=new e._MediaElementProto,u=typeof s=="string"?e.dom.find(s):s,l=n.createElement("iframe"),c={src:i,networkState:o.NETWORK_EMPTY,readyState:o.HAVE_NOTHING,seeking:!1,autoplay:i,preload:i,controls:!1,loop:!1,poster:i,volume:1,muted:0,currentTime:0,duration:NaN,ended:!1,paused:!0,width:u.width|0?u.width:o._util.MIN_WIDTH,height:u.height|0?u.height:o._util.MIN_HEIGHT,error:null},h=!1,p=!0,d,v=[],m,g,y=0;return o._eventNamespace=e.guid("HTMLSoundCloudAudioElement::"),o.parentNode=u,o._util.type="SoundCloud",o.play=function(){c.paused=!1;if(!h){b(function(){o.play()});return}c.ended&&N(0),d.play()},o.pause=function(){c.paused=!0;if(!h){b(function(){o.pause()});return}d.pause()},Object.defineProperties(o,{src:{get:function(){return c.src},set:function(e){e&&e!==c.src&&H(e)}},autoplay:{get:function(){return c.autoplay},set:function(e){c.autoplay=o._util.isAttributeSet(e)}},loop:{get:function(){return c.loop},set:function(e){c.loop=o._util.isAttributeSet(e)}},width:{get:function(){return l.width},set:function(e){l.width=e,c.width=l.width}},height:{get:function(){return l.height},set:function(e){l.height=e,c.height=l.height}},currentTime:{get:function(){return c.currentTime},set:function(e){N(e)}},duration:{get:function(){return c.duration}},ended:{get:function(){return c.ended}},paused:{get:function(){return c.paused}},seeking:{get:function(){return c.seeking}},readyState:{get:function(){return c.readyState}},networkState:{get:function(){return c.networkState}},volume:{get:function(){return j()},set:function(e){if(e<0||e>1)throw"Volume value must be between 0.0 and 1.0";B(e)}},muted:{get:function(){return I()},set:function(e){F(o._util.isAttributeSet(e))}},error:{get:function(){return c.error}},controls:{get:function(){return c.controls},set:function(e){q(!!e)}}}),o._canPlaySrc=e.HTMLSoundCloudAudioElement._canPlaySrc,o.canPlayType=e.HTMLSoundCloudAudioElement.canPlayType,o}var r=16,i="",s=!1,o=!1,u=[];e.HTMLSoundCloudAudioElement=function(e){return new l(e)},e.HTMLSoundCloudAudioElement._canPlaySrc=function(e){return/(?:https?:\/\/www\.|https?:\/\/|www\.|\.|^)(soundcloud)/.test(e)?"probably":i},e.HTMLSoundCloudAudioElement.canPlayType=function(e){return e==="audio/x-soundcloud"?"probably":i}}(Popcorn,window,document),function(e){var t=1,n=!1;e.plugin("googlefeed",function(r){var s=function(){var t=!1,r=0,i=document.getElementsByTagName("link"),s=i.length,o=document.head||document.getElementsByTagName("head")[0],u=document.createElement("link"),a="//www.google.com/uds/solutions/dynamicfeed/gfdynamicfeedcontrol.";window.GFdynamicFeedControl?n=!0:e.getScript(a+"js",function(){n=!0});for(;r<s;r++)i[r].href===a+"css"&&(t=!0);t||(u.type="text/css",u.rel="stylesheet",u.href=a+"css",o.insertBefore(u,o.firstChild))};window.google?s():e.getScript("//www.google.com/jsapi",function(){google.load("feeds","1",{callback:function(){s()}})});var o=document.createElement("div"),u=document.getElementById(r.target),a=function(){n?r.feed=new GFdynamicFeedControl(r.url,o,{vertical:r.orientation.toLowerCase()==="vertical"?!0:!1,horizontal:r.orientation.toLowerCase()==="horizontal"?!0:!1,title:r.title=r.title||"Blog"}):setTimeout(function(){a()},5)};if(!r.orientation||r.orientation.toLowerCase()!=="vertical"&&r.orientation.toLowerCase()!=="horizontal")r.orientation="vertical";return o.style.display="none",o.id="_feed"+t,o.style.width="100%",o.style.height="100%",t++,u&&u.appendChild(o),a(),r.toString=function(){return r.url||r._natives.manifest.options.url["default"]},{start:function(e,t){o.setAttribute("style","display:inline")},end:function(e,t){o.setAttribute("style","display:none")},_teardown:function(e){document.getElementById(e.target)&&document.getElementById(e.target).removeChild(o),delete e.feed}}},{about:{name:"Popcorn Google Feed Plugin",version:"0.1",author:"David Seifried",website:"dseifried.wordpress.com"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},target:"feed-container",url:{elem:"input",type:"url",label:"Feed URL","default":"http://planet.mozilla.org/rss20.xml"},title:{elem:"input",type:"text",label:"Title","default":"Planet Mozilla",optional:!0},orientation:{elem:"select",options:["Vertical","Horizontal"],label:"Orientation","default":"Vertical",optional:!0}}})}(Popcorn),document.addEventListener("click",function(e){var t=e.target;(t.nodeName==="A"||t.parentNode&&t.parentNode.nodeName==="A")&&Popcorn.instances.forEach(function(e){e.options.pauseOnLinkClicked&&e.pause()})},!1),function(e){function r(e,t){if(e.map){e.map.div.style.display=t;return}setTimeout(function(){r(e,t)},10)}var t,n=1;e.plugin("openmap",function(t){var s,o,u,a,f,l,c,h,p=document.getElementById(t.target);return s=document.createElement("div"),s.id="openmapdiv"+n,s.style.width="100%",s.style.height="100%",n++,p&&p.appendChild(s),h=function(){if(!window.OpenLayers||!window.OpenLayers.Layer.Stamen)setTimeout(function(){h()},50);else{t.location?(location=new OpenLayers.LonLat(0,0),e.getJSONP("//tinygeocoder.com/create-api.php?q="+t.location+"&callback=jsonp",function(e){o=new OpenLayers.LonLat(e[1],e[0])})):o=new OpenLayers.LonLat(t.lng,t.lat),t.type=t.type||"ROADMAP";switch(t.type){case"SATELLITE":t.map=new OpenLayers.Map({div:s,maxResolution:.28125,tileSize:new OpenLayers.Size(512,512)});var n=new OpenLayers.Layer.WorldWind("LANDSAT","//worldwind25.arc.nasa.gov/tile/tile.aspx",2.25,4,{T:"105"});t.map.addLayer(n),a=new OpenLayers.Projection("EPSG:4326"),u=new OpenLayers.Projection("EPSG:4326");break;case"TERRAIN":a=new OpenLayers.Projection("EPSG:4326"),u=new OpenLayers.Projection("EPSG:4326"),t.map=new OpenLayers.Map({div:s,projection:u});var r=new OpenLayers.Layer.WMS("USGS Terraserver","//terraserver-usa.org/ogcmap.ashx?",{layers:"DRG"});t.map.addLayer(r);break;case"STAMEN-TONER":case"STAMEN-WATERCOLOR":case"STAMEN-TERRAIN":var i=t.type.replace("STAMEN-","").toLowerCase(),f=new OpenLayers.Layer.Stamen(i);a=new OpenLayers.Projection("EPSG:4326"),u=new OpenLayers.Projection("EPSG:900913"),o=o.transform(a,u),t.map=new OpenLayers.Map({div:s,projection:u,displayProjection:a,controls:[new OpenLayers.Control.Navigation,new OpenLayers.Control.PanPanel,new OpenLayers.Control.ZoomPanel]}),t.map.addLayer(f);break;default:u=new OpenLayers.Projection("EPSG:900913"),a=new OpenLayers.Projection("EPSG:4326"),o=o.transform(a,u),t.map=new OpenLayers.Map({div:s,projection:u,displayProjection:a});var l=new OpenLayers.Layer.OSM;t.map.addLayer(l)}t.map&&(t.map.setCenter(o,t.zoom||10),t.map.div.style.display="none")}},h(),{_setup:function(t){window.OpenLayers||e.getScript("//openlayers.org/api/OpenLayers.js",function(){e.getScript("//maps.stamen.com/js/tile.stamen.js")});var n=function(){if(!t.map)setTimeout(function(){n()},13);else{t.zoom=t.zoom||2,t.zoom&&typeof t.zoom!="number"&&(t.zoom=+t.zoom),t.map.setCenter(o,t.zoom);if(t.markers){var r=OpenLayers.Util.extend({},OpenLayers.Feature.Vector.style["default"]),i=function(e){clickedFeature=e.feature;if(!clickedFeature.attributes.text)return;c=new OpenLayers.Popup.FramedCloud("featurePopup",clickedFeature.geometry.getBounds().getCenterLonLat(),new OpenLayers.Size(120,250),clickedFeature.attributes.text,null,!0,function(e){l.unselect(this.feature)}),clickedFeature.popup=c,c.feature=clickedFeature,t.map.addPopup(c)},s=function(e){feature=e.feature,feature.popup&&(c.feature=null,t.map.removePopup(feature.popup),feature.popup.destroy(),feature.popup=null)},h=function(t){e.getJSONP("//tinygeocoder.com/create-api.php?q="+t.location+"&callback=jsonp",function(e){var n=(new OpenLayers.Geometry.Point(e[1],e[0])).transform(a,u),i=OpenLayers.Util.extend({},r);if(!t.size||isNaN(t.size))t.size=14;i.pointRadius=t.size,i.graphicOpacity=1,i.externalGraphic=t.icon;var s=new OpenLayers.Feature.Vector(n,null,i);t.text&&(s.attributes={text:t.text}),f.addFeatures([s])})};f=new OpenLayers.Layer.Vector("Point Layer",{style:r}),t.map.addLayer(f);for(var p=0,d=t.markers.length;p<d;p++){var v=t.markers[p];v.text&&(l||(l=new OpenLayers.Control.SelectFeature(f),t.map.addControl(l),l.activate(),f.events.on({featureselected:i,featureunselected:s})));if(v.location){var m=h;m(v)}else{var g=(new OpenLayers.Geometry.Point(v.lng,v.lat)).transform(a,u),y=OpenLayers.Util.extend({},r);if(!v.size||isNaN(v.size))v.size=14;y.pointRadius=v.size,y.graphicOpacity=1,y.externalGraphic=v.icon;var b=new OpenLayers.Feature.Vector(g,null,y);v.text&&(b.attributes={text:v.text}),f.addFeatures([b])}}}}};n()},start:function(e,t){r(t,"block")},end:function(e,t){r(t,"none")},_teardown:function(e){p&&p.removeChild(s),s=map=o=u=a=f=l=c=null}}},{about:{name:"Popcorn OpenMap Plugin",version:"0.3",author:"@mapmeld",website:"mapadelsur.blogspot.com"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},target:"map-container",type:{elem:"select",options:["ROADMAP","SATELLITE","TERRAIN"],label:"Map Type",optional:!0},zoom:{elem:"input",type:"number",label:"Zoom","default":2},lat:{elem:"input",type:"text",label:"Lat",optional:!0},lng:{elem:"input",type:"text",label:"Lng",optional:!0},location:{elem:"input",type:"text",label:"Location","default":"Toronto, Ontario, Canada"},markers:{elem:"input",type:"text",label:"List Markers",optional:!0}}})}(Popcorn),function(e,t){var n={};e.plugin("documentcloud",{manifest:{about:{name:"Popcorn Document Cloud Plugin",version:"0.1",author:"@humphd, @ChrisDeCairos",website:"http://vocamus.net/dave"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},target:"documentcloud-container",width:{elem:"input",type:"text",label:"Width",optional:!0},height:{elem:"input",type:"text",label:"Height",optional:!0},src:{elem:"input",type:"url",label:"PDF URL","default":"http://www.documentcloud.org/documents/70050-urbina-day-1-in-progress.html"},preload:{elem:"input",type:"checkbox",label:"Preload","default":!0},page:{elem:"input",type:"number",label:"Page Number",optional:!0},aid:{elem:"input",type:"number",label:"Annotation Id",optional:!0}}},_setup:function(r){function o(){function E(e){r._key=e.api.getId(),r._changeView=function(e){r.aid?e.pageSet.showAnnotation(e.api.getAnnotation(r.aid)):e.api.setCurrentPage(r.page)}}function S(t){var s=!1;return e.forEach(i.viewers,function(e,o){if(e.api.getSchema().canonicalURL===t){var u;E(e),u=n[r._key],r._containerId=u.id,u.num+=1,s=!0,i.loaded=!0}}),s}function x(){var e={num:1,id:r._containerId};n[r._key]=e,i.loaded=!0}i.loaded=!1;var o=r.url.replace(/\.html$/,".js"),u=r.target,a=t.getElementById(u),f=t.createElement("div"),l=e.position(a),c=r.width||l.width,h=r.height||l.height,p=r.sidebar||!0,d=r.text||!0,v=r.pdf||!0,m=r.showAnnotations||!0,g=r.zoom||700,y=r.search||!0,b=r.page,w;if(!S(r.url)){f.id=r._containerId=e.guid(u),w="#"+f.id,a.appendChild(f),s.trigger("documentready");var T=r.page||r.aid?function(e){E(e),r._changeView(e),f.style.visibility="hidden",e.elements.pages.hide(),x()}:function(e){E(e),x(),f.style.visibility="hidden",e.elements.pages.hide()};i.load(o,{width:c,height:h,sidebar:p,text:d,pdf:v,showAnnotations:m,zoom:g,search:y,container:w,afterLoad:T})}}function u(){window.DV.loaded?o():setTimeout(u,25)}var i=window.DV=window.DV||{},s=this;if(!i.loading){i.loading=!0,i.recordHit="//www.documentcloud.org/pixel.gif";var a=t.createElement("link"),f=t.getElementsByTagName("head")[0];a.rel="stylesheet",a.type="text/css",a.media="screen",a.href="//s3.documentcloud.org/viewer/viewer-datauri.css",f.appendChild(a),i.loaded=!1,e.getScript("http://s3.documentcloud.org/viewer/viewer.js",function(){i.loading=!1,o()})}else u();r.toString=function(){return r.src||r._natives.manifest.options.src["default"]}},start:function(e,n){var r=t.getElementById(n._containerId),i=DV.viewers[n._key];(n.page||n.aid)&&i&&n._changeView(i),r&&i&&(r.style.visibility="visible",i.elements.pages.show())},end:function(e,n){var r=t.getElementById(n._containerId);r&&DV.viewers[n._key]&&(r.style.visibility="hidden",DV.viewers[n._key].elements.pages.hide())},_teardown:function(e){var r=t.getElementById(e._containerId),i=e._key;if(i&&DV.viewers[i]&&--n[i].num===0){DV.viewers[i].api.unload();while(r.hasChildNodes())r.removeChild(r.lastChild);r.parentNode.removeChild(r)}}})}(Popcorn,window.document),function(e){var t={},n=0,r=function(e){t[e]=document.createElement("div");var n=document.getElementById(e);return n&&n.appendChild(t[e]),t[e].style.height="100%",t[e].style.position="relative",t[e]},i=document.createElement("span"),s=["webkit","Moz","ms","O",""],o=["Transform","TransitionDuration","TransitionTimingFunction"],u={},a;document.getElementsByTagName("head")[0].appendChild(i);for(var f=0,l=o.length;f<l;f++)for(var c=0,h=s.length;c<h;c++){a=s[c]+o[f];if(a in i.style){u[o[f].toLowerCase()]=a;break}}document.getElementsByTagName("head")[0].appendChild(i),e.plugin("wordriver",{manifest:{about:{name:"Popcorn WordRiver Plugin"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},target:"wordriver-container",text:{elem:"input",type:"text",label:"Text","default":"Popcorn.js"},color:{elem:"input",type:"text",label:"Color","default":"Green",optional:!0}}},_setup:function(e){e._duration=e.end-e.start,e._container=t[e.target]||r(e.target),e.word=document.createElement("span"),e.word.style.position="absolute",e.word.style.whiteSpace="nowrap",e.word.style.opacity=0,e.word.style.MozTransitionProperty="opacity, -moz-transform",e.word.style.webkitTransitionProperty="opacity, -webkit-transform",e.word.style.OTransitionProperty="opacity, -o-transform",e.word.style.transitionProperty="opacity, transform",e.word.style[u.transitionduration]="1s, "+e._duration+"s",e.word.style[u.transitiontimingfunction]="linear",e.word.innerHTML=e.text,e.word.style.color=e.color||"black"},start:function(e,t){t._container.appendChild(t.word),t.word.style[u.transform]="",t.word.style.fontSize=~~(30+20*Math.random())+"px",n%=t._container.offsetWidth-t.word.offsetWidth,t.word.style.left=n+"px",n+=t.word.offsetWidth+10,t.word.style[u.transform]="translateY("+(t._container.offsetHeight-t.word.offsetHeight)+"px)",t.word.style.opacity=1,setTimeout(function(){t.word.style.opacity=0},(t.end-t.start-1||1)*1e3)},end:function(e,t){t.word.style.opacity=0},_teardown:function(e){var n=document.getElementById(e.target);e.word.parentNode&&e._container.removeChild(e.word),t[e.target]&&!t[e.target].childElementCount&&n&&n.removeChild(t[e.target])&&delete t[e.target]}})}(Popcorn),function(e){function n(e,n){return String(e).replace(/&(?!\w+;)|[<>"']/g,function(e){return t[e]||e})}function r(e){return e.replace(/\r?\n/gm,"<br>")}function i(e,t){var n=e.container=document.createElement("div"),r=n.style,i=e.media,s=function(){var t=e.position();r.fontSize="18px",r.width=i.offsetWidth+"px",r.top=t.top+i.offsetHeight-n.offsetHeight-40+"px",r.left=t.left+"px",setTimeout(s,10)};return n.id=t||"",r.position="absolute",r.color="white",r.textShadow="black 2px 2px 6px",r.fontWeight="bold",r.textAlign="center",s(),e.media.parentNode.appendChild(n),n}var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};e.plugin("text",{manifest:{about:{name:"Popcorn Text Plugin",version:"0.1",author:"@humphd"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},text:{elem:"input",type:"text",label:"Text","default":"Popcorn.js"},escape:{elem:"input",type:"checkbox",label:"Escape"},multiline:{elem:"input",type:"checkbox",label:"Multiline"}}},_setup:function(t){var s,o,u=t._container=document.createElement("div");u.style.display="none",t.target?(s=e.dom.find(t.target),s?["VIDEO","AUDIO"].indexOf(s.nodeName)>-1&&(s=i(this,t.target+"-overlay")):s=i(this,t.target)):this.container?s=this.container:s=i(this),t._target=s,o=t.escape?n(t.text):t.text,o=t.multiline?r(o):o,u.innerHTML=o||"",s.appendChild(u),t.toString=function(){return t.text||t._natives.manifest.options.text["default"]}},start:function(e,t){t._container.style.display="inline"},end:function(e,t){t._container.style.display="none"},_teardown:function(e){var t=e._target;t&&t.removeChild(e._container)}})}(Popcorn),function(e){var t=1;e.plugin("timeline",function(e){var n=document.getElementById(e.target),r=document.createElement("div"),s,o=!0;return n&&!n.firstChild?(n.appendChild(s=document.createElement("div")),s.style.width="inherit",s.style.height="inherit",s.style.overflow="auto"):s=n.firstChild,r.style.display="none",r.id="timelineDiv"+t,e.direction=e.direction||"up",e.direction.toLowerCase()==="down"&&(o=!1),n&&s&&(o?s.insertBefore(r,s.firstChild):s.appendChild(r)),t++,r.innerHTML="<p><span id='big' style='font-size:24px; line-height: 130%;' >"+e.title+"</span><br />"+"<span id='mid' style='font-size: 16px;'>"+e.text+"</span><br />"+e.innerHTML,{start:function(e,t){r.style.display="block",t.direction==="down"&&(s.scrollTop=s.scrollHeight)},end:function(e,t){r.style.display="none"},_teardown:function(e){s&&r&&s.removeChild(r)&&!s.firstChild&&n.removeChild(s)}}},{about:{name:"Popcorn Timeline Plugin",version:"0.1",author:"David Seifried @dcseifried",website:"dseifried.wordpress.com"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},target:"feed-container",title:{elem:"input",type:"text",label:"Title"},text:{elem:"input",type:"text",label:"Text"},innerHTML:{elem:"input",type:"text",label:"HTML Code",optional:!0},direction:{elem:"select",options:["DOWN","UP"],label:"Direction",optional:!0}}})}(Popcorn),function(e){e.plugin("code",function(t){var n=!1,r=this,i=function(){var e=function(e){return function(t,i){var s=function(){n&&t.call(r,i),n&&e(s)};s()}};return window.webkitRequestAnimationFrame?e(window.webkitRequestAnimationFrame):window.mozRequestAnimationFrame?e(window.mozRequestAnimationFrame):e(function(e){window.setTimeout(e,16)})}();if(!t.onStart||typeof t.onStart!="function")t.onStart=e.nop;return t.onEnd&&typeof t.onEnd!="function"&&(t.onEnd=undefined),t.onFrame&&typeof t.onFrame!="function"&&(t.onFrame=undefined),{start:function(e,t){t.onStart.call(r,t),t.onFrame&&(n=!0,i(t.onFrame,t))},end:function(e,t){t.onFrame&&(n=!1),t.onEnd&&t.onEnd.call(r,t)}}},{about:{name:"Popcorn Code Plugin",version:"0.1",author:"David Humphrey (@humphd)",website:"http://vocamus.net/dave"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},onStart:{elem:"input",type:"function",label:"onStart"},onFrame:{elem:"input",type:"function",label:"onFrame",optional:!0},onEnd:{elem:"input",type:"function",label:"onEnd"}}})}(Popcorn),function(e,t){var n="http://popcornjs.org/code/modules/player/popcorn.player.js",r=/(?:http:\/\/www\.|http:\/\/|www\.|\.|^)(youtu|vimeo|soundcloud|baseplayer)/,i,s={},o={vimeo:!1,youtube:!1,soundcloud:!1,module:!1};Object.defineProperty(s,i,{get:function(){return o[i]},set:function(e){o[i]=e}}),e.plugin("mediaspawner",{manifest:{about:{name:"Popcorn Media Spawner Plugin",version:"0.1",author:"Matthew Schranz, @mjschranz",website:"mschranz.wordpress.com"},options:{source:{elem:"input",type:"text",label:"Media Source","default":"http://www.youtube.com/watch?v=CXDstfD9eJ0"},caption:{elem:"input",type:"text",label:"Media Caption","default":"Popcorn Popping",optional:!0},target:"mediaspawner-container",start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},autoplay:{elem:"input",type:"checkbox",label:"Autoplay Video",optional:!0},width:{elem:"input",type:"number",label:"Media Width","default":400,units:"px",optional:!0},height:{elem:"input",type:"number",label:"Media Height","default":200,units:"px",optional:!0}}},_setup:function(t){function l(){function n(){o!=="HTML5"&&!window.Popcorn[o]?setTimeout(function(){n()},300):(t.id=t._container.id,t._container.style.width=t.width+"px",t._container.style.height=t.height+"px",t.popcorn=e.smart("#"+t.id,t.source),o==="HTML5"&&t.popcorn.controls(!0),t._container.style.width="0px",t._container.style.height="0px",t._container.style.visibility="hidden",t._container.style.overflow="hidden")}o!=="HTML5"&&!window.Popcorn[o]&&!s[o]?(s[o]=!0,e.getScript("http://popcornjs.org/code/players/"+o+"/popcorn."+o+".js",function(){n()})):n()}function c(){window.Popcorn.player?l():setTimeout(function(){c()},300)}var i=document.getElementById(t.target)||{},o,u,a,f;f=r.exec(t.source),f?(o=f[1],o==="youtu"&&(o="youtube")):o="HTML5",t._type=o,t._container=document.createElement("div"),u=t._container,u.id="mediaSpawnerdiv-"+e.guid(),t.width=t.width||400,t.height=t.height||200,t.caption&&(a=document.createElement("div"),a.innerHTML=t.caption,a.style.display="none",t._capCont=a,u.appendChild(a)),i&&i.appendChild(u),!window.Popcorn.player&&!s.module?(s.module=!0,e.getScript(n,c)):c(),t.toString=function(){return t.source||t._natives.manifest.options.source["default"]}},start:function(e,t){t._capCont&&(t._capCont.style.display=""),t._container.style.width=t.width+"px",t._container.style.height=t.height+"px",t._container.style.visibility="visible",t._container.style.overflow="visible",t.autoplay&&t.popcorn.play()},end:function(e,t){t._capCont&&(t._capCont.style.display="none"),t._container.style.width="0px",t._container.style.height="0px",t._container.style.visibility="hidden",t._container.style.overflow="hidden",t.popcorn.pause()},_teardown:function(e){e.popcorn&&e.popcorn.destory&&e.popcorn.destroy(),document.getElementById(e.target)&&document.getElementById(e.target).removeChild(e._container)}})}(Popcorn,this),function(e){var t=0,n=function(t,n){var r=t.container=document.createElement("div"),i=r.style,s=t.media,o=function(){var e=t.position();i.fontSize="18px",i.width=s.offsetWidth+"px",i.top=e.top+s.offsetHeight-r.offsetHeight-40+"px",i.left=e.left+"px",setTimeout(o,10)};return r.id=n||e.guid(),i.position="absolute",i.color="white",i.textShadow="black 2px 2px 6px",i.fontWeight="bold",i.textAlign="center",o(),t.media.parentNode.appendChild(r),r};e.plugin("subtitle",{manifest:{about:{name:"Popcorn Subtitle Plugin",version:"0.1",author:"Scott Downe",website:"http://scottdowne.wordpress.com/"},options:{start:{elem:"input",type:"text",label:"Start"},end:{elem:"input",type:"text",label:"End"},target:"subtitle-container",text:{elem:"input",type:"text",label:"Text"}}},_setup:function(e){var r=document.createElement("div");r.id="subtitle-"+t++,r.style.display="none",!this.container&&(!e.target||e.target==="subtitle-container")&&n(this),e.target&&e.target!=="subtitle-container"?e.container=document.getElementById(e.target)||n(this,e.target):e.container=this.container,document.getElementById(e.container.id)&&document.getElementById(e.container.id).appendChild(r),e.innerContainer=r,e.showSubtitle=function(){e.innerContainer.innerHTML=e.text||""}},start:function(e,t){t.innerContainer.style.display="inline",t.showSubtitle(t,t.text)},end:function(e,t){t.innerContainer.style.display="none",t.innerContainer.innerHTML=""},_teardown:function(e){e.container.removeChild(e.innerContainer)}})}(Popcorn),function(e){e.plugin("webpage",{manifest:{about:{name:"Popcorn Webpage Plugin",version:"0.1",author:"@annasob",website:"annasob.wordpress.com"},options:{id:{elem:"input",type:"text",label:"Id",optional:!0},start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},src:{elem:"input",type:"url",label:"Webpage URL","default":"http://mozillapopcorn.org"},target:"iframe-container"}},_setup:function(e){var t=document.getElementById(e.target);e.src=e.src.replace(/^(https?:)?(\/\/)?/,"//"),e._iframe=document.createElement("iframe"),e._iframe.setAttribute("width","100%"),e._iframe.setAttribute("height","100%"),e._iframe.id=e.id,e._iframe.src=e.src,e._iframe.style.display="none",t&&t.appendChild(e._iframe)},start:function(e,t){t._iframe.src=t.src,t._iframe.style.display="inline"},end:function(e,t){t._iframe.style.display="none"},_teardown:function(e){document.getElementById(e.target)&&document.getElementById(e.target).removeChild(e._iframe)}})}(Popcorn);var t;(function(e){e.plugin("wikipedia",{manifest:{about:{name:"Popcorn Wikipedia Plugin",version:"0.1",author:"@annasob",website:"annasob.wordpress.com"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},lang:{elem:"input",type:"text",label:"Language","default":"english",optional:!0},src:{elem:"input",type:"url",label:"Wikipedia URL","default":"http://en.wikipedia.org/wiki/Cat"},title:{elem:"input",type:"text",label:"Title","default":"Cats",optional:!0},numberofwords:{elem:"input",type:"number",label:"Number of Words","default":"200",optional:!0},target:"wikipedia-container"}},_setup:function(t){var n,r=e.guid();t.lang||(t.lang="en"),t.numberofwords=t.numberofwords||200,window["wikiCallback"+r]=function(e){t._link=document.createElement("a"),t._link.setAttribute("href",t.src),t._link.setAttribute("target","_blank"),t._link.innerHTML=t.title||e.parse.displaytitle,t._desc=document.createElement("p"),n=e.parse.text["*"].substr(e.parse.text["*"].indexOf("<p>")),n=n.replace(/((<(.|\n)+?>)|(\((.*?)\) )|(\[(.*?)\]))/g,""),n=n.split(" "),t._desc.innerHTML=n.slice(0,n.length>=t.numberofwords?t.numberofwords:n.length).join(" ")+" ...",t._fired=!0},t.src&&e.getScript("//"+t.lang+".wikipedia.org/w/api.php?action=parse&props=text&redirects&page="+t.src.slice(t.src.lastIndexOf("/")+1)+"&format=json&callback=wikiCallback"+r),t.toString=function(){return t.src||t._natives.manifest.options.src["default"]}},start:function(e,t){var n=function(){t._fired?t._link&&t._desc&&document.getElementById(t.target)&&(document.getElementById(t.target).appendChild(t._link),document.getElementById(t.target).appendChild(t._desc),t._added=!0):setTimeout(function(){n()},13)};n()},end:function(e,t){t._added&&(document.getElementById(t.target).removeChild(t._link),document.getElementById(t.target).removeChild(t._desc))},_teardown:function(e){e._added&&(e._link.parentNode&&document.getElementById(e.target).removeChild(e._link),e._desc.parentNode&&document.getElementById(e.target).removeChild(e._desc),delete e.target)}})})(Popcorn);var n;(function(e){function u(e,t,n){var r=e.type?e.type.toUpperCase():"HYBRID",i;if(r==="STAMEN-WATERCOLOR"||r==="STAMEN-TERRAIN"||r==="STAMEN-TONER")i=r.replace("STAMEN-","").toLowerCase();var s=new google.maps.Map(n,{mapTypeId:i?i:google.maps.MapTypeId[r],mapTypeControlOptions:{mapTypeIds:[]}});return i&&s.mapTypes.set(i,new google.maps.StamenMapType(i)),s.getDiv().style.display="none",s}var t=1,r=!1,i=!1,s,o;n=function(t){typeof google!="undefined"&&google.maps&&google.maps.Geocoder&&google.maps.LatLng?(s=new google.maps.Geocoder,e.getScript("//maps.stamen.com/js/tile.stamen.js",function(){i=!0})):setTimeout(function(){n(t)},1)},o=function(){document.body?(r=!0,e.getScript("//maps.google.com/maps/api/js?sensor=false&callback=googleCallback")):setTimeout(function(){o()},1)},e.plugin("googlemap",function(e){var n,a,f,l=document.getElementById(e.target);e.type=e.type||"ROADMAP",e.zoom=e.zoom||1,e.lat=e.lat||0,e.lng=e.lng||0,r||o(),n=document.createElement("div"),n.id="actualmap"+t,n.style.width=e.width||"100%",e.height?n.style.height=e.height:l&&l.clientHeight?n.style.height=l.clientHeight+"px":n.style.height="100%",t++,l&&l.appendChild(n);var c=function(){i?n&&(e.location?s.geocode({address:e.location},function(t,r){n&&r===google.maps.GeocoderStatus.OK&&(e.lat=t[0].geometry.location.lat(),e.lng=t[0].geometry.location.lng(),f=new google.maps.LatLng(e.lat,e.lng),a=u(e,f,n))}):(f=new google.maps.LatLng(e.lat,e.lng),a=u(e,f,n))):setTimeout(function(){c()},5)};return c(),e.toString=function(){return e.location||(e.lat&&e.lng?e.lat+", "+e.lng:e._natives.manifest.options.location["default"])},{start:function(e,t){var r=this,i,s=function(){if(a){t._map=a,a.getDiv().style.display="block",google.maps.event.trigger(a,"resize"),a.setCenter(f),t.zoom&&typeof t.zoom!="number"&&(t.zoom=+t.zoom),a.setZoom(t.zoom),t.heading&&typeof t.heading!="number"&&(t.heading=+t.heading),t.pitch&&typeof t.pitch!="number"&&(t.pitch=+t.pitch);if(t.type==="STREETVIEW"){a.setStreetView(i=new google.maps.StreetViewPanorama(n,{position:f,pov:{heading:t.heading=t.heading||0,pitch:t.pitch=t.pitch||0,zoom:t.zoom}}));var e=function(n,i){var s=google.maps.geometry.spherical.computeHeading;setTimeout(function(){var i=r.media.currentTime;if(typeof t.tween=="object"){for(var a=0,f=n.length;a<f;a++){var l=n[a];i>=l.interval*(a+1)/1e3&&(i<=l.interval*(a+2)/1e3||i>=l.interval*f/1e3)&&(d.setPosition(new google.maps.LatLng(l.position.lat,l.position.lng)),d.setPov({heading:l.pov.heading||s(l,n[a+1])||0,zoom:l.pov.zoom||0,pitch:l.pov.pitch||0}))}e(n,n[0].interval)}else{for(var c=0,h=n.length;c<h;c++){var p=t.interval;i>=p*(c+1)/1e3&&(i<=p*(c+2)/1e3||i>=p*h/1e3)&&(o.setPov({heading:s(n[c],n[c+1])||0,zoom:t.zoom,pitch:t.pitch||0}),o.setPosition(u[c]))}e(u,t.interval)}},i)};if(t.location&&typeof t.tween=="string"){var o=i,u=[],l=new google.maps.DirectionsService,c=new google.maps.DirectionsRenderer(o),h={origin:t.location,destination:t.tween,travelMode:google.maps.TravelMode.DRIVING};l.route(h,function(e,t){t==google.maps.DirectionsStatus.OK&&(c.setDirections(e),p(e,r))});var p=function(n,r){var i=n.routes[0].overview_path;for(var s=0,o=i.length;s<o;s++)u.push(new google.maps.LatLng(i[s].lat(),i[s].lng()));t.interval=t.interval||1e3,e(u,10)}}else if(typeof t.tween=="object"){var d=i;for(var v=0,m=t.tween.length;v<m;v++)t.tween[v].interval=t.tween[v].interval||1e3,e(t.tween,10)}}t.onmaploaded&&t.onmaploaded(t,a)}else setTimeout(function(){s()},13)};s()},end:function(e,t){a&&(a.getDiv().style.display="none")},_teardown:function(e){var t=document.getElementById(e.target);t&&t.removeChild(n),n=a=f=null,e._map=null}}},{about:{name:"Popcorn Google Map Plugin",version:"0.1",author:"@annasob",website:"annasob.wordpress.com"},options:{start:{elem:"input",type:"start",label:"Start"},end:{elem:"input",type:"start",label:"End"},target:"map-container",type:{elem:"select",options:["ROADMAP","SATELLITE","STREETVIEW","HYBRID","TERRAIN","STAMEN-WATERCOLOR","STAMEN-TERRAIN","STAMEN-TONER"],label:"Map Type",optional:!0},zoom:{elem:"input",type:"text",label:"Zoom","default":0,optional:!0},lat:{elem:"input",type:"text",label:"Lat",optional:!0},lng:{elem:"input",type:"text",label:"Lng",optional:!0},location:{elem:"input",type:"text",label:"Location","default":"Toronto, Ontario, Canada"},heading:{elem:"input",type:"text",label:"Heading","default":0,optional:!0},pitch:{elem:"input",type:"text",label:"Pitch","default":1,optional:!0}}})})(Popcorn),function(e){e.plugin("footnote",{manifest:{about:{name:"Popcorn Footnote Plugin",version:"0.2",author:"@annasob, @rwaldron",website:"annasob.wordpress.com"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},text:{elem:"input",type:"text",label:"Text"},target:"footnote-container"}},_setup:function(t){var n=e.dom.find(t.target);t._container=document.createElement("div"),t._container.style.display="none",t._container.innerHTML=t.text,n.appendChild(t._container)},start:function(e,t){t._container.style.display="inline"},end:function(e,t){t._container.style.display="none"},_teardown:function(t){var n=e.dom.find(t.target);n&&n.removeChild(t._container)}})}(Popcorn),function(e){var t=0;e.plugin("flickr",function(n){var r,i=document.getElementById(n.target),s,o,u,a,f=n.numberofimages||4,l=n.height||"50px",c=n.width||"50px",h=n.padding||"5px",p=n.border||"0px";r=document.createElement("div"),r.id="flickr"+t,r.style.width="100%",r.style.height="100%",r.style.display="none",t++,i&&i.appendChild(r);var d=function(){s?setTimeout(function(){d()},5):(o="http://api.flickr.com/services/rest/?method=flickr.people.findByUsername&",o+="username="+n.username+"&api_key="+n.apikey+"&format=json&jsoncallback=flickr",e.getJSONP(o,function(e){s=e.user.nsid,v()}))},v=function(){o="http://api.flickr.com/services/feeds/photos_public.gne?",s&&(o+="id="+s+"&"),n.tags&&(o+="tags="+n.tags+"&"),o+="lang=en-us&format=json&jsoncallback=flickr",e.xhr.getJSONP(o,function(t){var n=document.createElement("div");n.innerHTML="<p style='padding:"+h+";'>"+t.title+"<p/>",e.forEach(t.items,function(e,t){if(!(t<f))return!1;u=document.createElement("a"),u.setAttribute("href",e.link),u.setAttribute("target","_blank"),a=document.createElement("img"),a.setAttribute("src",e.media.m),a.setAttribute("height",l),a.setAttribute("width",c),a.setAttribute("style","border:"+p+";padding:"+h),u.appendChild(a),n.appendChild(u)}),r.appendChild(n)})};return n.username&&n.apikey?d():(s=n.userid,v()),n.toString=function(){return n.tags||n.username||"Flickr"},{start:function(e,t){r.style.display="inline"},end:function(e,t){r.style.display="none"},_teardown:function(e){document.getElementById(e.target)&&document.getElementById(e.target).removeChild(r)}}},{about:{name:"Popcorn Flickr Plugin",version:"0.2",author:"Scott Downe, Steven Weerdenburg, Annasob",website:"http://scottdowne.wordpress.com/"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},userid:{elem:"input",type:"text",label:"User ID",optional:!0},tags:{elem:"input",type:"text",label:"Tags"},username:{elem:"input",type:"text",label:"Username",optional:!0},apikey:{elem:"input",type:"text",label:"API Key",optional:!0},target:"flickr-container",height:{elem:"input",type:"text",label:"Height","default":"50px",optional:!0},width:{elem:"input",type:"text",label:"Width","default":"50px",optional:!0},padding:{elem:"input",type:"text",label:"Padding",optional:!0},border:{elem:"input",type:"text",label:"Border","default":"5px",optional:!0},numberofimages:{elem:"input",type:"number","default":4,label:"Number of Images"}}})}(Popcorn),function(e){function r(e){function o(){var t=e.getBoundingClientRect(),n=i.getBoundingClientRect();n.left!==t.left&&(i.style.left=t.left+"px"),n.top!==t.top&&(i.style.top=t.top+"px")}var r=-1,i=document.createElement("div"),s=getComputedStyle(e).zIndex;return i.setAttribute("data-popcorn-helper-container",!0),i.style.position="absolute",isNaN(s)?i.style.zIndex=t:i.style.zIndex=s+1,document.body.appendChild(i),{element:i,start:function(){r=setInterval(o,n)},stop:function(){clearInterval(r),r=-1},destroy:function(){document.body.removeChild(i),r!==-1&&clearInterval(r)}}}var t=2e3,n=10;e.plugin("image",{manifest:{about:{name:"Popcorn image Plugin",version:"0.1",author:"Scott Downe",website:"http://scottdowne.wordpress.com/"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},src:{elem:"input",type:"url",label:"Image URL","default":"http://mozillapopcorn.org/wp-content/themes/popcorn/images/for_developers.png"},href:{elem:"input",type:"url",label:"Link","default":"http://mozillapopcorn.org/wp-content/themes/popcorn/images/for_developers.png",optional:!0},target:"image-container",text:{elem:"input",type:"text",label:"Caption","default":"Popcorn.js",optional:!0}}},_setup:function(t){var n=document.createElement("img"),i=document.getElementById(t.target);t.anchor=document.createElement("a"),t.anchor.style.position="relative",t.anchor.style.textDecoration="none",t.anchor.style.display="none",i&&(["VIDEO","AUDIO"].indexOf(i.nodeName)>-1?(t.trackedContainer=r(i),t.trackedContainer.element.appendChild(t.anchor)):i.appendChild(t.anchor)),n.addEventListener("load",function(){n.style.borderStyle="none",t.anchor.href=t.href||t.src||"#",t.anchor.target="_blank";var r,s;n.style.height=i.style.height,n.style.width=i.style.width,t.anchor.appendChild(n),t.text&&(r=n.height/12+"px",s=document.createElement("div"),e.extend(s.style,{color:"black",fontSize:r,fontWeight:"bold",position:"relative",textAlign:"center",width:n.style.width||n.width+"px",zIndex:"10"}),s.innerHTML=t.text||"",s.style.top=(n.style.height.replace("px","")||n.height)/2-s.offsetHeight/2+"px",t.anchor.insertBefore(s,n))},!1),n.src=t.src,t.toString=function(){var e=t.src||t._natives.manifest.options.src["default"],n=e.replace(/.*\//g,"");return n.length?n:e}},start:function(e,t){t.anchor.style.display="inline",t.trackedContainer&&t.trackedContainer.start()},end:function(e,t){t.anchor.style.display="none",t.trackedContainer&&t.trackedContainer.stop()},_teardown:function(e){e.trackedContainer?e.trackedContainer.destroy():e.anchor.parentNode&&e.anchor.parentNode.removeChild(e.anchor)}})}(Popcorn),function(e){e.plugin("mustache",function(t){var n,r,i,s;e.getScript("http://mustache.github.com/extras/mustache.js");var o=!!t.dynamic,u=typeof t.template,a=typeof t.data,f=document.getElementById(t.target);return t.container=f||document.createElement("div"),u==="function"?o?i=t.template:s=t.template(t):u==="string"?s=t.template:s="",a==="function"?o?n=t.data:r=t.data(t):a==="string"?r=JSON.parse(t.data):a==="object"?r=t.data:r="",{start:function(e,t){var o=function(){if(!window.Mustache)setTimeout(function(){o()},10);else{n&&(r=n(t)),i&&(s=i(t));var e=Mustache.to_html(s,r).replace(/^\s*/mg,"");t.container.innerHTML=e}};o()},end:function(e,t){t.container.innerHTML=""},_teardown:function(e){n=r=i=s=null}}},{about:{name:"Popcorn Mustache Plugin",version:"0.1",author:"David Humphrey (@humphd)",website:"http://vocamus.net/dave"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},target:"mustache-container",template:{elem:"input",type:"text",label:"Template"},data:{elem:"input",type:"text",label:"Data"},dynamic:{elem:"input",type:"checkbox",label:"Dynamic","default":!0}}})}(Popcorn),function(e){function t(e,t){var n={};return n[e]=t,n}function n(e){var t=e.split(":");try{var n=t[2].split(",");return n.length===1&&(n=t[2].split(".")),parseFloat(t[0],10)*3600+parseFloat(t[1],10)*60+parseFloat(n[0],10)+parseFloat(n[1],10)/1e3}catch(r){return 0}}function r(e,t){var n=t;while(!e[n])n++;return n}function i(e){var t=e.length-1;while(t>=0&&!e[t])t--;return t}e.parser("parseSRT",function(e,s){var o={title:"",remote:"",data:[]},u=[],a=0,f=0,l,c,h,p,d;l=e.text.split(/(?:\r\n|\r|\n)/gm),p=i(l)+1;for(a=0;a<p;a++){d={},h=[],a=r(l,a),d.id=parseInt(l[a++],10),c=l[a++].split(/[\t ]*-->[\t ]*/),d.start=n(c[0]),f=c[1].indexOf(" "),f!==-1&&(c[1]=c[1].substr(0,f)),d.end=n(c[1]);while(a<p&&l[a])h.push(l[a++]);d.text=h.join("\\N").replace(/\{(\\[\w]+\(?([\w\d]+,?)+\)?)+\}/gi,""),d.text=d.text.replace(/</g,"&lt;").replace(/>/g,"&gt;"),d.text=d.text.replace(/&lt;(\/?(font|b|u|i|s))((\s+(\w|\w[\w\-]*\w)(\s*=\s*(?:\".*?\"|'.*?'|[^'\">\s]+))?)+\s*|\s*)(\/?)&gt;/gi,"<$1$3$7>"),d.text=d.text.replace(/\\N/gi,"<br />"),s&&s.target&&(d.target=s.target),u.push(t("subtitle",d))}return o.data=u,o})}(Popcorn),function(e){e.parser("parseXML","XML",function(t){var n={title:"",remote:"",data:[]},r={},i=function(e){var t=e.split(":");if(t.length===1)return parseFloat(t[0],10);if(t.length===2)return parseFloat(t[0],10)+parseFloat(t[1]/12,10);if(t.length===3)return parseInt(t[0]*60,10)+parseFloat(t[1],10)+parseFloat(t[2]/12,10);if(t.length===4)return parseInt(t[0]*3600,10)+parseInt(t[1]*60,10)+parseFloat(t[2],10)+parseFloat(t[3]/12,10)},s=function(e){var t={};for(var n=0,s=e.length;n<s;n++){var o=e.item(n).nodeName,u=e.item(n).nodeValue,a=r[u];if(o==="in")t.start=i(u);else if(o==="out")t.end=i(u);else if(o==="resourceid")for(var f in a)a.hasOwnProperty(f)&&!t[f]&&f!=="id"&&(t[f]=a[f]);else t[o]=u}return t},o=function(e,t){var n={};return n[e]=t,n},u=function(t,i,a){var f={};e.extend(f,i,s(t.attributes),{text:t.textContent||t.text});var l=t.childNodes;if(l.length<1||l.length===1&&l[0].nodeType===3)a?r[f.id]=f:n.data.push(o(t.nodeName,f));else for(var c=0;c<l.length;c++)l[c].nodeType===1&&u(l[c],f,a)},a=t.documentElement.childNodes;for(var f=0,l=a.length;f<l;f++)a[f].nodeType===1&&(a[f].nodeName==="manifest"?u(a[f],{},!0):u(a[f],{},!1));return n})}(Popcorn),function(e){function r(e,t,n){var u=e.firstChild,a=i(e,n),f=[],l;while(u)u.nodeType===1&&(u.nodeName==="p"?f.push(s(u,t,a)):u.nodeName==="div"&&(l=o(u.getAttribute("begin")),l<0&&(l=t),f.push.apply(f,r(u,l,a)))),u=u.nextSibling;return f}function i(e,t){var n=e.getAttribute("region");return n!==null?n:t||""}function s(e,r,s){var u={};return u.text=(e.textContent||e.text).replace(t,"").replace(n,"<br />"),u.id=e.getAttribute("xml:id")||e.getAttribute("id"),u.start=o(e.getAttribute("begin"),r),u.end=o(e.getAttribute("end"),r),u.target=i(e,s),u.end<0&&(u.end=o(e.getAttribute("duration"),0),u.end>=0?u.end+=u.start:u.end=Number.MAX_VALUE),{subtitle:u}}function o(t,n){var r;if(!t)return-1;try{return e.util.toSeconds(t)}catch(i){return r=u(t),parseFloat(t.substring(0,r))*a(t.substring(r))+(n||0)}}function u(e){var t=e.length-1;while(t>=0&&e[t]<="9"&&e[t]>="0")t--;return t}function a(e){return{h:3600,m:60,s:1,ms:.001}[e]||-1}var t=/^[\s]+|[\s]+$/gm,n=/(?:\r\n|\r|\n)/gm;e.parser("parseTTML",function(e){var t={title:"",remote:"",data:[]},n;if(!e.xml||!e.xml.documentElement)return t;n=e.xml.documentElement.firstChild;if(!n)return t;while(n.nodeName!=="body")n=n.nextSibling;return n&&(t.data=r(n,0)),t})}(Popcorn),function(e){e.parser("parseJSON","JSON",function(t){var n={title:"",remote:"",data:[]},r={},i=t;return e.forEach(i.data,function(e,t){n.data.push(e)}),n})}(Popcorn),function(e){function t(e){var t=e.split(":"),n=e.length,r;if(n!==12&&n!==9)throw"Bad cue";n=t.length-1;try{r=parseInt(t[n-1],10)*60+parseFloat(t[n],10),n===2&&(r+=parseInt(t[0],10)*3600)}catch(i){throw"Bad cue"}return r}function n(e,t){var n={};return n[e]=t,n}function r(e){var n,r,i={},s=/-->/,o=/[\t ]+/;if(!e||e.indexOf("-->")===-1)throw"Bad cue";n=e.replace(s," --> ").split(o);if(n.length<2)throw"Bad cue";return i.id=e,i.start=t(n[0]),i.end=t(n[2]),i}function i(e,t,n){while(n<t&&!e[n])n++;return n}function s(e,t,n){while(n<t&&e[n])n++;return n}e.parser("parseVTT",function(e){var t={title:"",remote:"",data:[]},o=[],u=0,a=0,f,l,c,h=/(?:\r\n|\r|\n)/gm;f=e.text.split(h),a=f.length;if(a===0||f[0]!=="WEBVTT")return t;u++;while(u<a){l=[];try{u=i(f,a,u),c=r(f[u++]);while(u<a&&f[u])l.push(f[u++]);c.text=l.join("<br />"),o.push(n("subtitle",c))}catch(p){u=s(f,a,u)}}return t.data=o,t})}(Popcorn),function(e){e.parser("parseTTXT",function(e){var t={title:"",remote:"",data:[]},n=function(e){var t=e.split(":"),n=0;try{return parseFloat(t[0],10)*60*60+parseFloat(t[1],10)*60+parseFloat(t[2],10)}catch(r){n=0}return n},r=function(e,t){var n={};return n[e]=t,n},i=e.xml.lastChild.lastChild,s=Number.MAX_VALUE,o=[];while(i){if(i.nodeType===1&&i.nodeName==="TextSample"){var u={};u.start=n(i.getAttribute("sampleTime")),u.text=i.getAttribute("text"),u.text&&(u.end=s-.001,o.push(r("subtitle",u))),s=u.start}i=i.previousSibling}return t.data=o.reverse(),t})}(Popcorn),function(e){e.parser("parseSBV",function(e){var t={title:"",remote:"",data:[]},n=[],r,i=0,s=0,o=0,u=function(e){var t=e.split(":"),n=t.length-1,r;try{r=parseInt(t[n-1],10)*60+parseFloat(t[n],10),n===2&&(r+=parseInt(t[0],10)*3600)}catch(i){throw"Bad cue"}return r},a=function(e,t){var n={};return n[e]=t,n};r=e.text.split(/(?:\r\n|\r|\n)/gm),s=r.length;while(i<s){var f={},l=[],c=r[i++].split(",");try{f.start=u(c[0]),f.end=u(c[1]);while(i<s&&r[i])l.push(r[i++]);f.text=l.join("<br />"),n.push(a("subtitle",f))}catch(h){while(i<s&&r[i])i++}while(i<s&&!r[i])i++}return t.data=n,t})}(Popcorn),function(e){function t(e,t){var i=e.substr(10).split(","),s=/\{(\\[\w]+\(?([\w\d]+,?)+\)?)+\}/gi,o=/\\N/gi,u;u={start:n(i[t.start]),end:n(i[t.end])};if(u.start===-1||u.end===-1)throw"Invalid time";return u.text=r(i,t.text).replace(s,"").replace(o,"<br />"),u}function n(e){var t=e.split(":");return e.length!==10||t.length<3?-1:parseInt(t[0],10)*3600+parseInt(t[1],10)*60+parseFloat(t[2],10)}function r(e,t){var n=e.length,r=[],i=t;for(;i<n;i++)r.push(e[i]);return r.join(",")}function i(e,t){var n={};return n[e]=t,n}function s(e){var t=e.substr(8).split(", "),n={},r,i;for(i=0,r=t.length;i<r;i++)t[i]==="Start"?n.start=i:t[i]==="End"?n.end=i:t[i]==="Text"&&(n.text=i);return n}e.parser("parseSSA",function(e){var n={title:"",remote:"",data:[]},r=/(?:\r\n|\r|\n)/gm,o=[],u,a,f=0,l;u=e.text.split(r),l=u.length;while(f<l&&u[f]!=="[Events]")f++;a=s(u[++f]);while(++f<l&&u[f]&&u[f][0]!=="[")try{o.push(i("subtitle",t(u[f],a)))}catch(c){}return n.data=o,n})}(Popcorn),function(e,t){t.player("vimeo",{_canPlayType:function(e,n){return typeof n=="string"&&t.HTMLVimeoVideoElement._canPlaySrc(n)}}),t.vimeo=function(e,n,r){typeof console!="undefined"&&console.warn&&console.warn("Deprecated player 'vimeo'. Please use Popcorn.HTMLVimeoVideoElement directly.");var i=t.HTMLVimeoVideoElement(e),s=t(i,r);return setTimeout(function(){i.src=n},0),s}}(window,Popcorn),function(e,t){var n=function(e,n){return typeof n=="string"&&t.HTMLYouTubeVideoElement._canPlaySrc(n)};t.player("youtube",{_canPlayType:n}),t.youtube=function(e,n,r){typeof console!="undefined"&&console.warn&&console.warn("Deprecated player 'youtube'. Please use Popcorn.HTMLYouTubeVideoElement directly.");var i=t.HTMLYouTubeVideoElement(e),s=t(i,r);return setTimeout(function(){i.src=n},0),s},t.youtube.canPlayType=n}(window,Popcorn),function(e,t){t.player("soundcloud",{_canPlayType:function(e,n){return typeof n=="string"&&t.HTMLSoundCloudAudioElement._canPlaySrc(n)&&e.toLowerCase()!=="audio"}}),t.soundcloud=function(e,n,r){typeof console!="undefined"&&console.warn&&console.warn("Deprecated player 'soundcloud'. Please use Popcorn.HTMLSoundCloudAudioElement directly.");var i=t.HTMLSoundCloudAudioElement(e),s=t(i,r);return setTimeout(function(){i.src=n},0),s}}(window,Popcorn),function(e){var t=function(t,n){var r=0,i=0,s;e.forEach(n.classes,function(e,t){s=[],e==="parent"?s[0]=document.querySelectorAll("#"+n.target)[0].parentNode:s=document.querySelectorAll("#"+n.target+" "+e);for(r=0,i=s.length;r<i;r++)s[r].classList.toggle(t)})};e.compose("applyclass",{manifest:{about:{name:"Popcorn applyclass Effect",version:"0.1",author:"@scottdowne",website:"scottdowne.wordpress.com"},options:{}},_setup:function(e){e.classes={},e.applyclass=e.applyclass||"";var t=e.applyclass.replace(/\s/g,"").split(","),n=[],r=0,i=t.length;for(;r<i;r++)n=t[r].split(":"),n[0]&&(e.classes[n[0]]=n[1]||"")},start:t,end:t})}(Popcorn),e.define("vendor/popcorn/popcorn-complete",function(){}),e.define("zeega_dir/plugins/media-player/media-player",["zeega","libs/modernizr","vendor/popcorn/popcorn-complete"],function(e){var t={Views:{}};return t.Views.Player=e.Backbone.View.extend({className:"media-player-container",defaults:{control_mode:"none",control_fade:!0,media_target:null,controls_target:null,autoplay:!1,cue_in:0,cue_out:null,volume:.5,fade_in:0,fade_out:0},initialize:function(e){var t,n,r,i;i=null,this.model!==undefined&&(t=_.extend({},this.model.toJSON()),r=_.defaults(_.extend(t.attr,this.options),this.defaults),this.model.get("uri")!==undefined?n=this.getFormat(t.attribution_uri):t.attr&&t.attr.uri?(n=this.getFormat(t.attr.attribution_uri),r.id=this.model.id):console.log("I dont know what kind of media this is:("),this.format=n,this.settings=r,this.settings.model=i),this.model.on("pause_play",this.playPause,this)},render:function(){this.$el.css({width:"100%",height:"100%"});var e=this.templates[this.format]?this.format:"defaulttemplate";return this.$el.html(_.template(this.templates[e](),this.settings)),this.controls=new t.Views.Player.Controls[this.settings.control_mode]({model:this.model,detached_controls:!_.isNull(this.settings.controls_target)}),_.isNull(this.settings.controls_target)?this.$el.append(this.controls.render().el):$(this.settings.controls_target).html(this.controls.render().el),this},placePlayer:function(){var e=this,t=this.model.get("type");if(!this.isVideoLoaded){switch(this.format){case"html5":t=="Audio"&&Modernizr.audio.mp3===""||t=="Video"&&Modernizr.audio.h264===""?this.useFlash():this.useHTML5();break;case"flashvideo":this.useFlash();break;case"youtube":this.useYoutube();break;case"vimeo":this.useVimeo();break;default:console.log("none set")}this.initPopcornEvents(),this.isVideoLoaded=!0}},initPopcornEvents:function(){this.popcorn&&(this.popcorn.on("canplay",function(){this.private_onCanPlay(),this.onCanplay()}.bind(this)),this.popcorn.on("timeupdate",function(){this.private_onTimeUpdate()}.bind(this)),this.popcorn.on("ended",function(){this.onEnded()}.bind(this)))},addPopcornToControls:function(){this.controls&&this.popcorn&&this.settings.control_mode!="none"&&this.controls.addPopcorn(this.popcorn)},useHTML5:function(){var e=this,t="#media-player-html5-"+this.model.id,n=this.model;this.popcorn=Popcorn(t),this.addPopcornToControls(),this.setVolume(0),this.popcorn.on("canplay",function(){e.settings.fade_in===0&&e.setVolume(e.settings.volume),e.settings.cue_in!==0?(this.on("seeked",function(){n.can_play=!0,n.trigger("visual_ready",e.model.id)}),e.setCurrentTime(e.settings.cue_in)):(n.can_play=!0,n.trigger("visual_ready",e.model.id))})},useYoutube:function(){var e=this,t="#media-player-"+this.model.id,n=this.model.get("attr").attribution_uri,r=this.model;this.popcorn=Popcorn.youtube(t,n,{volume:this.settings.volume*100,cue_in:this.settings.cue_in}),this.addPopcornToControls(),this.setVolume(0),this.popcorn.on("canplaythrough",function(){e.popcorn.play(),e.popcorn.pause(),r.can_play=!0,r.trigger("visual_ready",e.model.id),r.get("attr").fade_in===0&&e.popcorn.volume(r.get("attr").volume)})},useFlash:function(){var e=this,t="#media-player-"+this.model.id,n=this.model.get("attr").uri,r=this.model;this.popcorn=Popcorn.flashvideo(t,n,{volume:this.settings.volume,cue_in:this.settings.cue_in}),this.popcorn.on("loadeddata",function(){r.can_play=!0,r.trigger("visual_ready",e.model.id),r.get("attr").fade_in===0&&e.popcorn.volume(r.get("attr").volume)})},useVimeo:function(){this.popcorn=Popcorn.vimeo("#media-player-"+this.model.id,this.get("url")),this.popcorn.on("loadeddata",function(){_this.trigger("video_canPlay"),_this.popcorn.currentTime(_this.get("cue_in"))})},private_onCanPlay:function(){this.model.set("duration",this.popcorn.duration()),this.model.get("cue_out")===null&&this.model.set("cue_out",this.popcorn.duration())},onCanplay:function(){this.settings.autoplay&&this.popcorn&&this.popcorn.play()},_onEnded:function(){this.model.trigger("media_ended",this.model.toJSON())},setVolume:function(e){var t;t=isNaN(+(t=e<0?0:e>1?1:e))?0:t,this.popcorn.volume(t)},getVolume:function(){return this.popcorn.volume()},setCurrentTime:function(e){_.isNumber(e)&&this.popcorn.currentTime(e)},getCurrentTime:function(){return this.popcorn.currentTime()},private_onTimeUpdate:function(){var e=this.settings.cue_out;e===0&&(this.settings.cue_out=e=his.getDuration()),e!==null&&this.popcorn.currentTime()>=e&&(this.pause(),this.popcorn.currentTime(this.settings.cue_in))},getDuration:function(){return this.popcorn.duration()},play:function(){this.popcorn&&this.popcorn.paused()&&this.popcorn.play()},pause:function(){this.popcorn&&!this.popcorn.paused()&&this.popcorn.pause()},playPause:function(){this.popcorn&&(this.popcorn.paused()?this.popcorn.play():this.popcorn.pause())},destroy:function(){this.popcorn&&!this.popcorn.isDestroyed&&(this.popcorn.pause(),Popcorn.destroy(this.popcorn))},getFormat:function(e){var t="html5";return e.match(/http:\/\/(?:youtu\.be\/|(?:[a-z]{2,3}\.)?youtube\.com\/watch(?:\?|#\!)v=)([\w\-]{11}).*/gi)&&(t="youtube"),e.match(/^http:\/\/(?:www\.)?vimeo.com\/(.*)/)&&(t="vimeo"),/Firefox/.test(navigator.userAgent)&&t==="html5"&&(t="flashvideo"),t},templates:{html5:function(){return html="<div id='media-player-<%= id %>' class='media-container'><video id='media-player-html5-<%= id %>' class='media-element media-type-<%= media_type %>' src='<%= uri %>'></video></div>",html},flashvideo:function(){return html="<div id='media-player-<%= id %>' class='media-container' style='width:100%;height:100%;'></div>",html},defaulttemplate:function(){return html="<div id='media-player-<%= id %>' class='media-container' style='width:100%;height:100%;'></div>",html}}}),t.Views.Player.Controls=t.Views.Player.Controls||{},t.Views.Player.Controls.none=e.Backbone.View.extend({className:"controls playback-controls controls-none",item_mode:!1,initialize:function(){this.options.detached_controls&&this.$el.addClass("playback-layer-controls"),this.model.get("uri")&&(this.item_mode=!0),this.init()},init:function(){}}),t.Views.Player.Controls.simple=t.Views.Player.Controls.none.extend({className:"controls playback-controls controls-simple",addPopcorn:function(e){this.popcorn=e,this.initPopcornEvents()},initPopcornEvents:function(){var e=this;this.popcorn.on("canplay",function(){e.onCanPlay()}),this.popcorn.on("canplaythrough",function(){e.onCanPlay()}),this.popcorn.on("ended",function(){e.onEnded()}),this.popcorn.on("playing",function(){e.onPlaying()}),this.popcorn.on("pause",function(){e.onPause()})},render:function(){return this.$el.html(this.getTemplate()),this},events:{click:"playPause",mouseover:"onMouseover",mouseout:"onMouseout"},onCanPlay:function(){this.updatePlayPauseIcon(),this.updateCues()},updateCues:function(){var e=this.item_mode,t=this.model.get("attr");this.cueIn=e?this.model.get("cue_in"):t.cue_in,this.cueOut=e?this.model.get("cue_out"):t.cue_out,this.cueOut||(this.cueOut=this.duration)},playPause:function(){return this.popcorn&&(this.popcorn.paused()?this.popcorn.play():this.popcorn.pause(),this.updatePlayPauseIcon()),!1},updatePlayPauseIcon:function(){this.popcorn&&this.$el.find(".pause-play i").removeClass(this.popcorn.paused()?"icon-pause":"icon-play").addClass(this.popcorn.paused()?"icon-play":"icon-pause")},onPlaying:function(){this.model.get("control_fade")&&this.setFadeTimeout(),this.updatePlayPauseIcon(),this.updatePlayPauseIcon()},setFadeTimeout:function(){this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){this.fadeOutControls(),clearTimeout(this.timer)}.bind(this),3500)},onMouseover:function(){this.model.get("control_fade")&&!this.popcorn.paused()&&(this.timer&&clearTimeout(this.timer),this.fadeInControls())},onMouseout:function(){this.model.get("control_fade")&&!this.popcorn.paused()&&this.setFadeTimeout()},fadeOutControls:function(){var e=this.$el.find(".player-control-inner");e.is(":visible")&&!this.popcorn.paused()&&e.fadeOut("slow")},fadeInControls:function(){var e=this.$el.find(".player-control-inner");e.is(":hidden")&&e.fadeIn("fast")},onPause:function(){this.timer&&clearTimeout(this.timer),this.fadeInControls(),this.updatePlayPauseIcon()},onEnded:function(){this.$el.find(".pause-play i").addClass("icon-play").removeClass("icon-pause")},getTemplate:function(){var e="<div class='player-control-inner'><a href='#' class='pause-play pull-left'><i class='icon-pause icon-white'></i></a></div>";return e}}),t.Views.Player.Controls.standard=t.Views.Player.Controls.simple.extend({isSeeking:!1,className:"controls playback-controls controls-standard",addPopcorn:function(e){this.popcorn=e,this.initPopcornEvents()},initPopcornEvents:function(){var e=this;this.popcorn.on("canplay",function(){e.onCanPlay()}),this.popcorn.on("canplaythrough",function(){e.onCanPlay()}),this.popcorn.on("ended",function(){e.onEnded()}),this.popcorn.on("playing",function(){e.onPlaying()}),this.popcorn.on("pause",function(){e.onPause()}),this.popcorn.on("timeupdate",function(){e.updateElapsed()})},events:{"click .pause-play":"playPause",mouseover:"onMouseover",mouseout:"onMouseout"},onCanPlay:function(){this.updateDuration(),this.updateCues(),this.updatePlayPauseIcon(),this.initScrubber()},initScrubber:function(){var e=this;this.$(".media-scrubber").slider({range:"min",min:0,max:this.duration,slide:function(t,n){e.scrub(n.value)},stop:function(t,n){e.seek(n.value)}})},updateDuration:function(){this.duration=this.popcorn.duration(),this.$(".media-time-duration").html(convertTime(this.duration))},updateElapsed:function(){var e=this.popcorn.currentTime();console.log("update",e),this.$(".media-time-elapsed").html(convertTime(e)),this.$(".media-scrubber").slider("value",e)},scrub:function(e){var t=this;this.isSeeking=!0},seek:function(e){var t=!this.popcorn.paused();t&&this.popcorn.pause(),e<this.cueIn?e=this.cueIn:e>this.cueOut&&(e=this.cueOut),this.$el.find(".media-scrubber").slider("value",e),this.popcorn.currentTime(e),t&&this.popcorn.play()},getTemplate:function(){var e="<div class='player-control-inner'><div class='media-scrubber'></div><div class='control-panel-inner'><a href='#' class='pause-play pull-left'><i class='icon-pause icon-white'></i></a><div class='pull-right'><span class='media-time-elapsed'>0:00</span> / <span class='media-time-duration'>0:00</span></div></div></div>";return e}}),t.Views.Player.Controls.editor=t.Views.Player.Controls.standard.extend({className:"controls playback-controls controls-editor",initPopcornEvents:function(){var e=this;this.popcorn.on("canplay",function(){e.onCanPlay()}),this.popcorn.on("canplaythrough",function(){e.onCanPlay()}),this.popcorn.on("ended",function(){e.onEnded()}),this.popcorn.on("timeupdate",function(){e.updateElapsed()}),this.popcorn.on("playing",function(){e.onPlaying()}),this.popcorn.on("pause",function(){e.onPause()})},events:{"click .pause-play":"playPause",mouseover:"onMouseover",mouseout:"onMouseout","mousedown .progress-outer":"scrub"},onCanPlay:function(){this.updateDuration(),this.updateCues(),this.updatePlayPauseIcon(),this.initScrubber(),this.initCropTool()},updateDuration:function(){this.duration=this.popcorn.duration(),this.$el.find(".media-time-duration").html(convertTime(this.duration))},updateElapsed:function(){var e=this.popcorn.currentTime();this.$(".media-time-elapsed").html(convertTime(e)),this.$(".media-scrubber").slider("value",e),e>=this.cueOut&&this.popcorn.pause()},initCropTool:function(){var e=this;this.$el.find(".crop-time-left .time").text(convertTime(this.cueIn)),this.$el.find(".crop-time-right .time").text(convertTime(this.cueOut)),this.$el.find(".crop-slider").slider({range:!0,min:0,max:e.duration,values:[e.cueIn,e.cueOut],slide:function(t,n){e.onCropSlide(t,n)},stop:function(t,n){e.onCropStop(t,n)}}),this.$el.find(".crop-time-left .time").unbind("keypress").keypress(function(t){var n;if(!(t.which>=48&&t.which<=58||t.which==13))return!1;if(t.which==13)return n=e.convertToSeconds($(this).text()),n===!1?$(this).text(convertTime(e.model.get("cue_in"))):(n=n<0?0:n,n=n>e.model.get("cue_out")?e.model.get("cue_out"):n,$(this).text(convertTime(n)),e.$el.find(".crop-slider").slider("values",0,n),e.cueIn=n,e.model.update({cue_in:n}),e.seek(n)),this.blur(),!1}),this.$el.find(".crop-time-right .time").unbind("keypress").keypress(function(t){var n;if(!(t.which>=48&&t.which<=58||t.which==13))return!1;if(t.which==13)return n=e.convertToSeconds($(this).text()),n===!1?$(this).text(convertTime(e.model.get("cue_out"))):(n=n>e.duration?e.duration:n,n=n<e.model.get("cue_in")?e.model.get("cue_in"):n,$(this).text(convertTime(n)),e.$el.find(".crop-slider").slider("values",1,n),e.cueOut=n,e.seek(Math.max(n-5,e.cueIn)),e.model.update({cue_out:n})),this.blur(),!1}),$(".time").mousedown(function(){$(this).focus()})},convertToSeconds:function(e){var t=e.split(/:/),n=!1,r=0;return _.each(t.reverse(),function(e,t){var i;if(e.length>2)return n=!0,!1;i=parseInt(e,10);if(!_.isNumber(i))return n=!0,!1;t?r+=i*t*60:r+=i}),n?!1:r},onCropSlide:function(e,t){this.$el.find(".crop-time-left .time").html(convertTime(t.values[0])),this.$el.find(".crop-time-right .time").html(convertTime(t.values[1]))},onCropStop:function(e,t){this.cueIn=t.values[0],this.cueOut=t.values[1],this.item_mode||this.model.update({cue_in:t.values[0],cue_out:t.values[1]}),this.popcorn.pause(),this.seek(t.values[0])},getTemplate:function(){var e="<div class='player-control-inner'><div class='crop-wrapper'><div class='crop-time-values clearfix'><span class='crop-time-left'>in [<span class='time' contenteditable='true'>0:00</span>]</span><span class='crop-time-right'>out [<span class='time' contenteditable='true'>0:00</span>]</span></div><div class='crop-slider'></div></div><div class='media-scrubber'></div><div class='control-panel-inner'><a href='#' class='pause-play pull-left'><i class='icon-play icon-white'></i></a><div class='pull-right'><span class='media-time-elapsed'>0:00</span> / <span class='media-time-duration'>0:00</span></div></div></div>";return e}}),t}),e.define("zeega_dir/plugins/layers/video/video",["zeega","zeega_dir/plugins/layers/_layer/_layer","zeega_dir/plugins/media-player/media-player"],function(e,t,n){var r=e.module();return r.Video=t.extend({layerType:"Video",defaultAttributes:{title:"Video Layer",url:"none",left:0,top:0,height:100,width:100,volume:.5,cue_in:0,cue_out:null,fade_in:0,fade_out:0,dissolve:!1,loop:!1,opacity:1,dimension:1.5,citation:!0}}),r.Video.Visual=t.Visual.extend({template:"plugins/video",ended:!1,playbackCount:0,init:function(){},onPlay:function(){this.ended=!1,this.mediaPlayer.play()},onPause:function(){this.mediaPlayer.pause()},onExit:function(){this.mediaPlayer.pause()},verifyReady:function(){if(this.mediaPlayer_loaded!==!0){var e=this;this.mediaPlayer=new n.Views.Player({model:this.model,control_mode:"none",media_target:"#visual-element-"+this.id}),this.$el.append(this.mediaPlayer.el),this.mediaPlayer.render(),this.mediaPlayer.placePlayer(),this.mediaPlayer.popcorn.listen("timeupdate",function(){e.onTimeUpdate()}),this.model.on("media_ended",function(){e.onEnded()}),this.mediaPlayer_loaded=!0}else this.mediaPlayer.pause()},onTimeUpdate:function(){if(!this.ended){var e,t,n,r,i,s;e=this.getAttr("cue_in"),t=this.getAttr("cue_out"),n=this.getAttr("fade_in"),r=this.getAttr("fade_out"),i=this.getAttr("volume"),t===0||t===null?s=this.mediaPlayer.getDuration():s=t;var o=this.mediaPlayer.getCurrentTime(),u=parseFloat(e)+parseFloat(n),a=s-parseFloat(r);n>0&&o<u?this.mediaPlayer.setVolume(i*(1-(u-o)/n*((u-o)/n))):n>0&&o>a||Math.abs(i-this.mediaPlayer.getVolume())>.01&&this.mediaPlayer.setVolume(i);var f={cue_in:this.getAttr("cue_in"),cue_out:this.getAttr("cue_out"),id:this.model.id,media_type:this.getAttr("media_type"),layer_type:this.getAttr("layer_type"),current_time:this.mediaPlayer.getCurrentTime(),duration:this.mediaPlayer.getDuration()};this.model.status.emit("media_timeupdate",f),this.mediaPlayer.getCurrentTime()>=s&&this.onEnded()}},onEnded:function(){this.playbackCount++,this.model.trigger("playback_ended",this.model.toJSON()),this.getAttr("loop")?(this.mediaPlayer.currentTime(this.getAttr("cue_in")),this.mediaPlayer.play()):this.ended=!0}}),r.Youtube=r.Video.extend(),r.Youtube.Visual=r.Video.Visual.extend(),r.Vimeo=r.Video.extend(),r.Vimeo.Visual=r.Video.Visual.extend(),r}),e.define("zeega_dir/plugins/layers/audio/audio",["zeega","zeega_dir/plugins/layers/_layer/_layer","zeega_dir/plugins/layers/video/video"],function(e,t,n){var r=e.module();return r.Audio=t.extend({layerType:"Audio",defaultAttributes:{title:"Audio Layer",url:"none",left:0,top:0,height:0,width:0,volume:.5,cue_in:0,cue_out:null,fade_in:0,fade_out:0,opacity:0,citation:!0}}),r.Audio.Visual=n.Video.Visual.extend({template:"plugins/audio"}),r}),e.define("zeega_dir/plugins/layers/rectangle/rectangle",["zeega","zeega_dir/plugins/layers/_layer/_layer"],function(e,t){var n=e.module();return n.Rectangle=t.extend({layerType:"Rectangle",defaultAttributes:{citation:!1,default_controls:!1,height:50,left:25,linkable:!1,opacity:1,opacity_hover:1,title:"Rectangle Layer",top:25,width:50}}),n.Rectangle.Visual=t.Visual.extend({template:"plugins/rectangle",serialize:function(){return this.model.toJSON()},beforePlayerRender:function(){var e={"background-color":this.getAttr("backgroundColor"),height:this.getAttr("height")+"%",opacity:this.getAttr("opacity")};this.$el.css(e)}}),n}),e.define("zeega_dir/plugins/layers/text/text",["zeega","zeega_dir/plugins/layers/_layer/_layer"],function(e,t){var n=e.module();return n.Text=t.extend({layerType:"Text",defaultAttributes:{citation:!1,default_controls:!0,left:30,opacity:1,title:"Text Layer",top:40,width:25}}),n.Text.Visual=t.Visual.extend({template:"plugins/text",serialize:function(){return this.model.toJSON()},onRender:function(){this.$el.css({color:this.model.get("attr").color,fontSize:this.model.get("attr").fontSize+"%"})}}),n}),e.define("zeega_dir/plugins/layers/popup/popup",["zeega","zeega_dir/plugins/layers/_layer/_layer","zeega_dir/plugins/media-player/media-player"],function(e,t,n){var r=e.module();r.Popup=t.extend({layerType:"Popup",defaultAttributes:{citation:!1,default_controls:!0,left:30,opacity:1,pauses_player:!0,title:"Popup Layer",top:40,width:25}}),r.Popup.Visual=t.Visual.extend({template:"plugins/popup",serialize:function(){return this.model.toJSON()},events:{"click .ZEEGA-popup-click-target":"popLayer"},popLayer:function(){this.model.get("attr").popup_content&&(this.popup=new i({model:this.model,template:"plugins/popup-"+this.model.get("attr").popup_content.media_type.toLowerCase()}),this.model.status.get("project").Layout.$el.append(this.popup.el),this.popup.render(),this.model.on("popup_remove",this.popupClosed,this),this.model.status.get("project").pause())},popupClosed:function(){this.model.status.get("project").play()},onExit:function(){this.popup&&this.popup.removePopup()}});var i=t.LayoutView.extend({className:"ZEEGA-popup-overlay",serialize:function(){return this.model.toJSON()},afterRender:function(){if(this.model.get("attr").popup_content.media_type=="Video"){var t=_.extend({},this.model.toJSON().attr.popup_content,{attr:this.model.toJSON().attr.popup_content}),r=new e.Backbone.Model(t);this.mediaPlayer=new n.Views.Player({model:r,control_mode:"none"}),this.$(".popup-video").append(this.mediaPlayer.el),this.mediaPlayer.render(),this.mediaPlayer.placePlayer(),r.on("visual_ready",function(){this.mediaPlayer.play()}.bind(this))}},events:{click:"closeOverlay","click a":"closeOverlay"},closeOverlay:function(){return this.removePopup(),this.model.trigger("popup_remove"),!1},removePopup:function(){this.mediaPlayer&&this.mediaPlayer.destroy(),this.remove()}});return r}),e.define("zeega_dir/plugins/layers/_all",["zeega_dir/plugins/layers/image/image","zeega_dir/plugins/layers/link/link","zeega_dir/plugins/layers/slideshow/slideshow","zeega_dir/plugins/layers/video/video","zeega_dir/plugins/layers/audio/audio","zeega_dir/plugins/layers/rectangle/rectangle","zeega_dir/plugins/layers/text/text","zeega_dir/plugins/layers/popup/popup"],function(e,t,n,r,i,s,o,u){var a={};return _.extend(a,e,t,n,r,i,s,o,u)}),e.define("zeega_dir/player/layer",["zeega","zeega_dir/plugins/layers/_all"],function(e,t){var n=e.module(),r=e.Backbone.Model.extend({ready:!1,state:"waiting",defaults:{mode:"player"},initialize:function(){var e=t[this.get("type")];if(e){var n=this;this.layerClass=new e,this.set(_.defaults(this.toJSON(),this.layerClass.defaults)),this.visualElement=new e.Visual({model:this,attributes:function(){return _.extend({},_.result(this,"domAttributes"),{id:"visual-element-"+n.id,"data-layer_id":n.id})}}),this.on("visual_ready",this.onVisualReady,this),this.on("visual_error",this.onVisualError,this)}else this.ready=!0,this.state="error",console.log("could not find valid layer type: ",this.get("type"))},render:function(){this.visualElement?this.state=="waiting"?(this.state="loading",this.status.emit("layer_loading",this.toJSON()),this.visualElement.player_onPreload()):this.state=="ready"&&this.visualElement.play():console.log("***    The layer "+this.get("type")+" is missing. ): ",this.id)},onVisualReady:function(){this.ready=!0,this.state="ready",this.trigger("layer_ready",this.toJSON())},onVisualError:function(){this.ready=!0,this.state="error",this.trigger("layer_error",this.toJSON())},updateZIndex:function(e){this.visualElement.updateZIndex(e)},pause:function(){this.visualElement.player_onPause()},play:function(){this.visualElement.player_onPlay()},exit:function(){this.layerClass&&this.visualElement.player_onExit()},remove:function(){this.layerClass&&this.visualElement.remove()},destroy:function(){this.state!="waiting"&&this.state!="destroyed"&&(this.state="destroyed")}});return n.Collection=e.Backbone.Collection.extend({model:r}),n}),e.define("zeega_dir/player/frame",["zeega","zeega_dir/player/layer"],function(e,t){var n=e.module(),r=e.Backbone.Model.extend({ready:!1,state:"waiting",hasPlayed:!1,elapsed:0,renderOnReady:null,defaults:{attr:{advance:0},common_layers:{},layers:[],link_to:[],link_from:[],preload_frames:[],_next:null,_prev:null},getNext:function(){return this.get("_next")},getPrev:function(){return this.get("_prev")},setConnections:function(){var e=this.get("_prev"),t=this.get("_next");this.set("connections",e&t?"lr":e?"l":t?"r":"none")},preload:function(){this.ready||this.layers.each(function(e){if(e.state==="waiting"||e.state==="loading")e.on("layer_ready",this.onLayerReady,this),e.render()},this)},render:function(e){var t;this.ready?(t=this.get("common_layers")[e]||[],this.layers.each(function(e){_.include(t,e.id)||e.render()}),this.status.set("current_frame",this.id),advance=this.get("attr").advance,advance&&this.startTimer(advance),!this.get("_next")&&this.get("link_to").length===0&&this.status.emit("deadend_frame",_.extend({},this.toJSON()))):this.renderOnReady=e,this.layers.each(function(e,t){e.updateZIndex(t)})},onLayerReady:function(e){this.status.emit("layer_ready",e),this.isFrameReady()&&!this.ready&&this.onFrameReady();var t=this.layers.map(function(e){return e.state})},onFrameReady:function(){var e={frame:this.toJSON(),layers:this.layers.toJSON()};this.ready=!0,this.state="ready",this.status.emit("frame_ready",e),_.isNull(this.renderOnReady)||(this.status.emit("can_play",e),this.render(this.renderOnReady),this.renderOnReady=null)},getLayerStates:function(){var e=_.toArray(this.layers);return["ready","waiting","loading","destroyed","error"].reduce(function(t,n){var r=e.filter(function(e){return e.state===n});return t[n]=r.map(function(e){return e.attributes}),t},{})},isFrameReady:function(){var e=this.getLayerStates();return e.ready.length+e.error.length===this.layers.length?!0:!1},pause:function(){this.timer&&(clearTimeout(this.timer),this.elapsed+=(new Date).getTime()-this.status.playTimestamp),this.layers.each(function(e){e.pause()})},play:function(){var e;this.layers.each(function(e){e.play()}),e=this.get("attr").advance,e&&this.startTimer(e-this.elapsed)},startTimer:function(e){this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){this.relay.set({current_frame:this.get("_next")})}.bind(this),e)},exit:function(e){var t=this.get("common_layers")[e]||[];this.elapsed=0,this.timer&&clearTimeout(this.timer),this.layers.each(function(e){_.include(t,e.id)||e.exit()})},unrender:function(e){},destroy:function(){this.state!=="waiting"&&this.state!=="destroyed"&&(this.layers.each(function(e){e.destroy()}),this.state="destroyed")}});return n.Collection=e.Backbone.Collection.extend({model:r,load:function(n,r,i){var s=this,o=new t.Collection(r);sequenceCollection=new e.Backbone.Collection(n),this.each(function(e){var r=[];e.layers=new t.Collection,e.relay=s.relay,e.status=s.status,_.each(e.get("layers"),function(t){e.layers.add(o.get(t))}),sequenceCollection.each(function(t,r){var i=t.get("frames"),s=t.get("advance_to"),o=i.indexOf(e.id),u=null,a=null;o>-1&&(o>0&&i.length>1?u=i[o-1]:r>0&&n[r-1].advance_to,o<i.length-1&&i.length>1?a=i[o+1]:s&&sequenceCollection.get(s)&&(a=sequenceCollection.get(s).get("frames")[0]),e.set({_prev:u,_next:a,_sequence:t.id}),e.setConnections())});var i=e.layers.where({type:"Link"}),u=[],a=[];_.each(i,function(t){t.get("attr").from_frame==e.id?u.push(t.get("attr").to_frame):(e.layers.remove(t),a.push(t.get("attr").from_frame))}),e.set({link_to:u,link_from:a}),e.layers.each(function(e){e.relay=s.relay,e.status=s.status})}),this.each(function(e){var t,n,r=["_prev","_next","link_to","link_from"].map(function(t){return e.get(t)});t=_.uniq(_.compact(_.union.apply(null,r))),n=t.reduce(function(t,n){return t[n]=_.intersection(e.layers.pluck("id"),this.get(n).layers.pluck("id")),t}.bind(s),{}),e.set({common_layers:n})}),this.each(function(e){var t=sequenceCollection.get(e.get("_sequence"))?sequenceCollection.get(e.get("_sequence")).get("advance_to"):!1,n=e.get("_next"),r=e.get("_prev"),s=[e.id,n,r];for(var o=0;o<i-1;o++){n=n?this.get(n).get("_next"):null,r=r?this.get(r).get("_next"):null;if(!n&&!r)break;s.push(n,r)}s=s.filter(Boolean),t&&sequenceCollection.get(t)&&s.push(sequenceCollection.get(t).get("frames")[0]),e.set("preload_frames",_.union(s,e.get("link_to"),e.get("link_from")))}.bind(this))}}),n}),e.define("zeega_dir/parsers/zeega-project",["lodash"],function(){var e="zeega-project",t={};return t[e]={name:e},t[e].validate=function(e){return e.sequences&&e.frames&&e.layers?!0:!1},t[e].parse=function(e,t){return e},t}),e.define("zeega_dir/parsers/zeega-project-published",["lodash"],function(){var e="zeega-project-published",t={};return t[e]={name:e},t[e].validate=function(e){return e.items&&e.items[0].media_type=="project"?!0:!1},t[e].parse=function(e,t){return e.items[0].text},t}),e.define("zeega_dir/parsers/zeega-collection",["lodash"],function(){function r(e,t){var n,r,u=[],a=[];_.each(e.items,function(e){e.layer_type=="Image"?u.push(e):(e.layer_type=="Audio"||e.media_type=="Video")&&a.push(e)}),u.length&&(r=o(u,t.layerOptions.slideshow.start,t.layerOptions.slideshow.start_id,t.layerOptions.slideshow.bleed));var f=i(a);r&&f.push(r),a.length?n=s(a,r?[r.id]:[]):n=[{id:1,layers:[1],attr:{advance:0}}];var l={id:0,title:"collection",persistent_layers:r?[r.id]:[],frames:_.pluck(n,"id")};return _.extend(e.items[0],{sequences:[l],frames:n,layers:f})}function i(e){var t={width:100,top:0,left:0,loop:!1};return _.map(e,function(e){return{attr:_.defaults(e,t),type:e.layer_type,id:e.id}})}function s(e,t){return _.map(e,function(e){var n=e.media_type=="Video"?[e.id]:_.compact([e.id].concat(t));return{id:e.id,layers:n,attr:{advance:0}}})}function o(e,t,n,r){var i={keyboard:!1,width:100,top:0,left:0},s=_.map(e,function(e){return{attr:e,type:e.layer_type,id:e.id}});return{attr:_.defaults({slides:s},i),start_slide:parseInt(t,10)||0,start_slide_id:parseInt(n,10)||null,slides_bleed:r,type:"SlideShow",id:1}}var e="zeega-collection",t={};t[e]={name:e},t[e].validate=function(e){return e.items&&e.items[0]&&e.items[0].child_items?!0:!1},t[e].parse=function(e,t){var i={};return t.layerOptions&&t.layerOptions.slideshow&&t.layerOptions.slideshow.display&&e.items.length>0?i=r(e,t):i=n(e,t),i};var n=function(e,t){var n=i(e.items),r=s(e.items),o={id:0,title:"collection",persistent_layers:[],frames:_.pluck(r,"id")};return _.extend(e.items[0],{sequences:[o],frames:r,layers:n})};return t}),e.define("zeega_dir/parsers/zeega-dynamic-collection",function(){}),e.define("zeega_dir/parsers/flickr",["lodash"],function(){function n(e){var t={width:100,top:0,left:0};return _.map(e,function(e){return e.uri=e.media.m,{attr:_.defaults(e,t),type:"Image",id:e.link}})}function r(e,t){return _.map(e,function(e){return{id:e.link,layers:_.compact([e.link].concat(t)),attr:{advance:0}}})}var e="flickr",t={};return t[e]={name:e},t[e].validate=function(e){return e.generator&&e.generator=="http://www.flickr.com/"?!0:!1},t[e].parse=function(e,t){var i=n(e.items),s=r(e.items),o={id:0,title:"flickr collection",persistent_layers:[],frames:_.pluck(s,"id")};return _.extend(e,{sequences:[o],frames:s,layers:i})},t}),e.define("zeega_dir/parsers/youtube",["lodash"],function(){function n(e){var t=0,n=0,r=e.length;for(;n<r;n++)t+=e.charCodeAt(n);return t}function r(e){var t={width:100,top:0,left:0,media_type:"Video",layer_type:"Youtube"};return _.map(e,function(e){return{attr:_.extend(_.defaults(e,t),{attribution_uri:"http://www.youtube.com/watch?v="+e.media$group.yt$videoid.$t}),type:"Video",id:e.media$group.yt$videoid.$t,attribution_uri:"http://www.youtube.com/watch?v="+e.media$group.yt$videoid.$t,uri:e.media$group.yt$videoid.$t}})}function i(e,t){return _.map(e,function(e){var n=e.media$group.yt$videoid.$t;return{id:n,layers:_.compact([n].concat(t)),attr:{advance:0}}})}var e="youtube",t={};return t[e]={name:e},t[e].validate=function(e){return e.generator&&e.generator=="http://gdata.youtube.com/"?!0:!0},t[e].parse=function(e,t){var n=r(e.feed.entry),s=i(e.feed.entry),o={id:0,title:"youtube playlist",persistent_layers:[],frames:_.pluck(s,"id")},u=_.extend(e,{sequences:[o],frames:s,layers:n});return u},t}),e.define("zeega_dir/parsers/_all",["zeega_dir/parsers/zeega-project","zeega_dir/parsers/zeega-project-published","zeega_dir/parsers/zeega-collection","zeega_dir/parsers/zeega-dynamic-collection","zeega_dir/parsers/flickr","zeega_dir/parsers/youtube"],function(e,t,n,r,i,s){var o={};return _.extend(o,e,t,n,r,i,s)}),e.define("modules/player/relay",["zeega"],function(e){var t={};return t.Model=e.Backbone.Model.extend({defaults:{current_frame:null,current_frame_model:null}}),t}),e.define("modules/player/status",["zeega"],function(e){var t={};return t.Model=e.Backbone.Model.extend({silent:!1,projectTimerstamp:null,frameTimestamp:null,pauseTimestamp:null,defaults:{previous_frame:null,previous_frame_model:null,current_frame:null,current_frame_model:null,current_sequence:null,current_sequence_model:null,current_layers:[],frameHistory:[],sequenceHistory:[]},initialize:function(){this.initTimer=_.once(this._initProjectTimer),this.get("project").on("play",this.onPlay,this),this.get("project").on("pause",this.onPause,this),this.on("change:current_frame",this.onChangeFrame,this)},onChangeFrame:function(e){var t,n,r,i,s=this.get("current_frame"),o=this.get("current_frame_model");this.pauseTimestamp=null,this.initTimer(),this.frameTimestamp=(new Date).getTime(),s&&this.put({previous_frame:s,previous_frame_model:o}),t=this.get("project").get("frames").get(s),n=t.get("_sequence"),r=this.get("frameHistory"),r.push(t.id),this.put({current_frame_model:t,frameHistory:r}),this.emit("frame_rendered",_.extend({},t.toJSON(),{layers:t.layers.toJSON()})),this.get("current_sequence")!=n&&(i=this.get("sequenceHistory"),i.push(n),this.set({current_sequence:n,current_sequence_model:this.get("project").get("sequences").get(n),sequenceHistory:i}),this.emit("sequence_enter",_.extend({},this.get("current_sequence_model").toJSON())))},emit:function(e,t){this.silent||this.get("project").trigger(e,t)},_initProjectTimer:function(){this.projectTimerstamp=(new Date).getTime()},onPlay:function(){this.playTimestamp=(new Date).getTime()},onPause:function(){this.pauseTimestamp=(new Date).getTime()}}),t}),e.define("modules/player/player-layout",["zeega"],function(e){var t={};return t.Layout=e.Backbone.Layout.extend({fetch:function(t){var n;return t="app/templates/layouts/"+t+".html",JST[t]?JST[t]:(n=this.async(),$.ajax({url:e.root+t}).then(function(e){n(JST[t]=_.template(e))}))},template:"player-layout",className:"ZEEGA-player",initialize:function(){var e=this.model.get("divId"),t=_.debounce(function(){this.resizeWindow()}.bind(this),300);$(window).resize(t)},serialize:function(){return this.model.toJSON()},afterRender:function(){this.$(".ZEEGA-player-window").css(this.getWindowSize()),this.setControls()},setControls:function(){var e=this.model.get("next"),t=this.model.get("prev"),n=this;e&&e.length&&$(e).click(function(){return n.model.cueNext(),!1}),t&&t.length&&$(t).click(function(){return n.model.cuePrev(),!1})},resizeWindow:function(){var t=this.getWindowSize();this.$(".ZEEGA-player-window").animate(t),this.model.trigger("window_resized",t),e.trigger("resize_window",t)},getWindowSize:function(){var e={},t=this.model.get("window_ratio")||4/3,n=$(this.model.get("target")).find(".ZEEGA-player").width(),r=$(this.model.get("target")).find(".ZEEGA-player").height(),i=n/r;return this.model.get("window_fit")?i>t?(e.width=n,e.height=n/t):(e.width=r*t,e.height=r):i>t?(e.width=r*t,e.height=r):(e.width=n,e.height=n/t),e.fontSize=e.width/520+"em",e.width+="px",e.height+="px",e}}),t}),e.define("modules/player/player",["zeega","modules/player/data","zeega_dir/player/frame","zeega_dir/player/layer","zeega_dir/parsers/_all","modules/player/relay","modules/player/status","modules/player/player-layout"],function(e,t,n,r,i,s,o,u){return Player=e.Backbone.Model.extend({ready:!1,state:"paused",relay:null,status:null,Layout:null,defaults:{data:null,frames:null,layers:null,layerOptions:{},preloadRadius:2,sequences:null,parser:null,autoplay:!0,collectionMode:"standard",fadeIn:500,fadeOut:500,keyboard:!0,next:null,prev:null,startFrame:null,target:null,url:null},initialize:function(e){this.relay=new s.Model,this.status=new o.Model({project:this}),this.data=new t.Model(e),this.data.url=e.url,this._setTarget(),this._load(e)},_load:function(t){var n=new e.Backbone.Model;if(t.url)n.url=t.url,n.fetch().success(function(e){this._detectAndParseData(e)}.bind(this)).error(function(){throw new Error("Ajax load fail")});else{if(!t.data)throw new TypeError("`url` expected non null");this._detectAndParseData(t.data)}},_setTarget:function(){this.put({target:$(this.get("target")||document.body)})},_detectAndParseData:function(e){var t;_.each(i,function(n){if(n.validate(e))return console.log("parsed using: "+n.name),this.parser=n.name,t=n.parse(e,this.toJSON()),!1}.bind(this));if(t===undefined)throw new Error("Valid parser not found");this.data.set(t),this._parseProjectData(t),this._listen()},_parseProjectData:function(t){var r,i,s,o;s=this.data.get("layers"),i=new n.Collection(this.data.get("frames")),r=new e.Backbone.Collection(this.data.get("sequences")),_.each(s,function(e){e._target=this.get("target")}.bind(this)),i.relay=this.relay,i.status=this.status,i.load(this.data.get("sequences"),s,this.get("preloadRadius"),_),(this.get("startFrame")===null||i.get(this.get("startFrame"))===undefined)&&this.put({startFrame:r.at(0).get("frames")[0]}),this.put({frames:i,sequences:r}),this._render(),this.status.emit("data_loaded",_.extend({},this.data.toJSON()))},_listen:function(){this.on("cue_frame",this.cueFrame,this),this.relay.on("change:current_frame",this._remote_cueFrame,this)},_remote_cueFrame:function(e,t){this.cueFrame(t)},_render:function(){var e=this.get("target");this.Layout=new u.Layout({model:this,attributes:{id:"ZEEGA-player-"+this.data.id,"data-projectID":this.id}}),e.is("body")||e.css("position","relative"),e.append(this.Layout.el),this.Layout.render(),_.delay(function(){this._onRendered()}.bind(this),100)},_fadeIn:function(){this.Layout.$el.fadeTo("fast",1)},_onRendered:function(){this.ready=!0,this._initEvents(),this.status.emit("ready",this),this.preloadFramesFrom(this.get("startFrame")),this.get("autoplay")&&this.play()},_initEvents:function(){var e=this;this.get("keyboard")&&$(window).keyup(function(t){switch(t.which){case 37:e.cuePrev();break;case 39:e.cueNext();break;case 32:e.playPause()}})},play:function(){var e=this.status.get("current_frame"),t=this.get("startFrame"),n,r;if(!this.ready)this.render();else if(this.state=="paused"){this._fadeIn(),e&&(this.state="playing",this.status.emit("play",this),this.status.get("current_frame_model").play()),n=e===null,r=t===null;if(n&&r)this.cueFrame(this.get("sequences")[0].frames[0]);else if(n&&!r&&this.get("frames").get(t))this.cueFrame(t);else if(!!n)throw new Error("Valid parser not found")}},pause:function(){this.state=="playing"&&(this.state="paused",this.status.get("current_frame_model").pause(),this.status.emit("pause"))},playPause:function(){this.state=="paused"?this.play():this.pause()},cueNext:function(e){this.cueFrame(this.status.get("current_frame_model").get("_next"),e)},cuePrev:function(e){this.cueFrame(this.status.get("current_frame_model").get("_prev"),e)},cueFrame:function(e,t){t=t||0,e!==undefined&&this.get("frames").get(e)!==undefined&&(t>0?_.delay(function(){this._goToFrame(e)}.bind(this),t):this._goToFrame(e))},_goToFrame:function(e){var t;this.preloadFramesFrom(e),this.status.get("current_frame")&&(this.status.get("current_frame_model").exit(e),t=this.status.get("current_frame_model").id),this.status.set("current_frame",e),this.relay.put("current_frame",e),this.status.get("current_frame_model").render(t),this.state!=="playing"&&(this.state="playing",this.status.emit("play",this))},cueNextSequence:function(){var e=this.status.get("current_sequence_model").get("advance_to");e&&this.get("sequences").get(e)&&this.cueFrame(this.get("sequences").get(e).get("frames")[0])},cuePrevSequence:function(){var e=this.status.get("sequenceHistory"),t;e.pop(),this.status.set("sequenceHistory",e),t=e[e.length-1],t&&this.cueFrame(this.get("sequences").get(t).get("frames")[0])},preloadFramesFrom:function(e){var t=this,n=this.get("frames").get(e);_.each(n.get("preload_frames"),function(e){t.get("frames").get(e).preload()})},getProjectData:function(){var e=this.get("frames").map(function(e){return _.extend({},e.toJSON(),{layers:e.layers.toJSON()})});return _.extend({},this.toJSON(),{frames:e})},getFrameData:function(){return this.status.get("current_frame")?_.extend({},this.status.get("current_frame_model").toJSON(),{layers:this.status.get("current_frame_model").layers.toJSON()}):!1},getProjectTree:function(){return!1},destroy:function(){var e=this;this.Layout.$el.fadeOut(this.get("fadeOut"),function(){e.get("frames").each(function(e){e.destroy()}),e.status.emit("player_destroyed")})},fitWindow:function(){this.Layout.resizeWindow()}}),e.player=Player,e}),e.require(["modules/player/player"],function(e){window.Zeega=e,$(window).trigger("zeega_ready")}),e.define("main",function(){})}(),define("zeegaplayer",function(){}),function(e,t){function ct(e){return new ht(e)}function ht(e){if(e&&e._wrapped)return e;this._wrapped=e}function St(e,t,n){t||(t=0);var r=e.length,i=r-t>=(n||30),s=i?{}:e;if(i){var o,u=t-1;while(++u<r)o=e[u]+"",(A.call(s,o)?s[o]:s[o]=[]).push(e[u])}return function(e){if(i){var n=e+"";return A.call(s,n)&&_n(s[n],e)>-1}return _n(s,e,t)>-1}}function xt(){var e,t,n,r=-1,i=arguments.length,s={bottom:"",exit:"",init:"",top:"",arrayBranch:{beforeLoop:""},objectBranch:{beforeLoop:""}};while(++r<i){e=arguments[r];for(t in e)n=(n=e[t])==null?"":n,/beforeLoop|inLoop/.test(t)?(typeof n=="string"&&(n={array:n,object:n}),s.arrayBranch[t]=n.array,s.objectBranch[t]=n.object):s[t]=n}var o=s.args,a=/^[^,]+/.exec(o)[0];s.firstArg=a,s.hasDontEnumBug=K,s.isKeysFast=it,s.noArgsEnum=G,s.shadowed=T,s.useHas=s.useHas!==!1,s.useStrict=s.useStrict!==!1,"noCharByIndex"in s||(s.noCharByIndex=et),s.exit||(s.exit="if (!"+a+") return result");if(a!="collection"||!s.arrayBranch.inLoop)s.arrayBranch=null;var f=Function("arrayLikeClasses, ArrayProto, bind, compareAscending, concat, forIn, hasOwnProperty, identity, indexOf, isArguments, isArray, isFunction, isPlainObject, iteratorBind, objectClass, objectTypes, nativeKeys, propertyIsEnumerable, slice, stringClass, toString","var callee = function("+o+") {\n"+pt(s)+"\n};\n"+"return callee");return f(ot,u,Kn,Tt,L,Ut,A,ur,_n,Pt,Ht,Bt,Lt,At,W,ft,j,M,_,V,D)}function Tt(e,n){var r=e.index,i=n.index;return e=e.criteria,n=n.criteria,e===t?1:n===t?-1:e<n?-1:e>n?1:r<i?-1:1}function Nt(e,t){return k[t]}function Ct(e){return"\\"+lt[e]}function kt(e){return at[e]}function Lt(e,t){var n=!1;if(!e||typeof e!="object"||!t&&Pt(e))return n;var r=e.constructor;return(!tt||typeof e.toString=="function"||typeof (e+"")!="string")&&(!Bt(r)||r instanceof r)?Q?(Ut(e,function(t,r){return n=!A.call(e,r),!1}),n===!1):(Ut(e,function(e,t){n=t}),n===!1||A.call(e,n)):n}function At(e,t){return function(n,r,i){return e.call(t,n,r,i)}}function Ot(){}function Mt(e,t){if(e&&d.test(t))return"<e%-"+t+"%>";var n=k.length;return k[n]="' +\n__e("+t+") +\n'",C+n}function _t(e,t,n,r){if(r){var i=k.length;return k[i]="';\n"+r+";\n__p += '",C+i}return t?Mt(null,t):Dt(null,n)}function Dt(e,t){if(e&&d.test(t))return"<e%="+t+"%>";var n=k.length;return k[n]="' +\n((__t = ("+t+")) == null ? '' : __t) +\n'",C+n}function Pt(e){return D.call(e)==F}function Bt(e){return typeof e=="function"}function Ft(e,t,n,r,i){if(e==null)return e;n&&(t=!1),i||(i={value:null}),i.value==null&&(i.value=!!(a.clone||l.clone||c.clone));var s=ft[typeof e];if((s||i.value)&&e.clone&&Bt(e.clone))return i.value=null,e.clone(t);if(s){var o=D.call(e);if(!ut[o]||Y&&Pt(e))return e;var u=o==I;s=u||(o==W?Lt(e,!0):s)}if(!s||!t)return s?u?_.call(e):Rt({},e):e;var f=e.constructor;switch(o){case q:return new f(e==1);case R:return new f(+e);case z:case V:return new f(e);case X:return f(e.source,y.exec(e))}r||(r=[]);var h=r.length;while(h--)if(r[h].source==e)return r[h].value;h=e.length;var p=u?f(h):{};r.push({value:p,source:e});if(u){var d=-1;while(++d<h)p[d]=Ft(e[d],t,null,r,i)}else zt(e,function(e,n){p[n]=Ft(e,t,null,r,i)});return p}function Xt(e,t){return e?A.call(e,t):!1}function Vt(e){return e===!0||e===!1||D.call(e)==q}function $t(e){return D.call(e)==R}function Jt(e){return e?e.nodeType===1:!1}function Qt(e,t,n,r){if(e==null||t==null)return e===t;r||(r={value:null}),r.value==null&&(r.value=!!(a.isEqual||l.isEqual||c.isEqual));if(ft[typeof e]||ft[typeof t]||r.value){e._chain&&(e=e._wrapped),t._chain&&(t=t._wrapped);if(e.isEqual&&Bt(e.isEqual))return r.value=null,e.isEqual(t);if(t.isEqual&&Bt(t.isEqual))return r.value=null,t.isEqual(e)}if(e===t)return e!==0||1/e==1/t;var i=D.call(e);if(i!=D.call(t))return!1;switch(i){case q:case R:return+e==+t;case z:return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case X:case V:return e==t+""}var s=ot[i];if(Y&&!s&&(s=Pt(e))&&!Pt(t))return!1;if(!s&&(i!=W||tt&&(typeof e.toString!="function"&&typeof (e+"")=="string"||typeof t.toString!="function"&&typeof (t+"")=="string")))return!1;n||(n=[]);var o=n.length;while(o--)if(n[o]==e)return!0;var u=-1,f=!0,h=0;n.push(e);if(s){h=e.length,f=h==t.length;if(f)while(h--)if(!(f=Qt(e[h],t[h],n,r)))break;return f}var p=e.constructor,d=t.constructor;if(p!=d&&!(Bt(p)&&p instanceof p&&Bt(d)&&d instanceof d))return!1;for(var v in e)if(A.call(e,v)){h++;if(!A.call(t,v)||!Qt(e[v],t[v],n,r))return!1}for(v in t)if(A.call(t,v)&&!(h--))return!1;if(K)while(++u<7){v=T[u];if(A.call(e,v)&&(!A.call(t,v)||!Qt(e[v],t[v],n,r)))return!1}return!0}function Gt(e){return B(e)&&D.call(e)==z}function Yt(e){return e?ft[typeof e]:!1}function Zt(e){return D.call(e)==z&&e!=+e}function en(e){return e===null}function tn(e){return D.call(e)==z}function nn(e){return D.call(e)==X}function rn(e){return D.call(e)==V}function sn(e){return e===t}function an(e){var t={};if(!e)return t;var n,r=0,i=L.apply(u,arguments),s=i.length;while(++r<s)n=i[r],n in e&&(t[n]=e[n]);return t}function fn(e){if(!e)return 0;var t=D.call(e),n=e.length;return ot[t]||Y&&Pt(e)||t==W&&n>-1&&n===n>>>0&&Bt(e.splice)?n:on(e).length}function Sn(e,t,n,r){if(!e)return n;var i=e.length,s=arguments.length<3;r&&(t=At(t,r));if(i>-1&&i===i>>>0){var o=et&&D.call(e)==V?e.split(""):e;i&&s&&(n=o[--i]);while(i--)n=t(n,o[i],i,e);return n}var u,a=on(e);i=a.length,i&&s&&(n=e[a[--i]]);while(i--)u=a[i],n=t(n,e[u],u,e);return n}function Cn(e){if(!e)return[];if(e.toArray&&Bt(e.toArray))return e.toArray();var t=e.length;return t>-1&&t===t>>>0?(Z?D.call(e)==V:typeof e=="string")?e.split(""):_.call(e):ln(e)}function Ln(e){var t=[];if(!e)return t;var n=-1,r=e.length;while(++n<r)e[n]&&t.push(e[n]);return t}function An(e){var t=[];if(!e)return t;var n=-1,r=e.length,i=L.apply(t,arguments),s=St(i,r);while(++n<r)s(e[n])||t.push(e[n]);return t}function On(e,t,n){if(e)return t==null||n?e[0]:_.call(e,0,t)}function Mn(e,t){var n=[];if(!e)return n;var r,i=-1,s=e.length;while(++i<s)r=e[i],Ht(r)?O.apply(n,t?r:Mn(r)):n.push(r);return n}function _n(e,t,n){if(!e)return-1;var r=-1,i=e.length;if(n){if(typeof n!="number")return r=Un(e,t),e[r]===t?r:-1;r=(n<0?Math.max(0,i+n):n)-1}while(++r<i)if(e[r]===t)return r;return-1}function Dn(e,t,n){return e?_.call(e,0,-(t==null||n?1:t)):[]}function Pn(e){var t=[];if(!e)return t;var n,r=-1,i=e.length,s=_.call(arguments,1),o=[];while(++r<i)n=e[r],_n(t,n)<0&&pn(s,function(e,t){return(o[t]||(o[t]=St(e)))(n)})&&t.push(n);return t}function Hn(e,t,n){if(e){var r=e.length;return t==null||n?e[r-1]:_.call(e,-t||r)}}function Bn(e,t,n){if(!e)return-1;var r=e.length;n&&typeof n=="number"&&(r=(n<0?Math.max(0,r+n):Math.min(n,r-1))+1);while(r--)if(e[r]===t)return r;return-1}function jn(e,t,n){var r=-Infinity,i=r;if(!e)return i;var s,o=-1,u=e.length;if(!t){while(++o<u)e[o]>i&&(i=e[o]);return i}n&&(t=At(t,n));while(++o<u)s=t(e[o],o,e),s>r&&(r=s,i=e[o]);return i}function Fn(e,t,n){var r=Infinity,i=r;if(!e)return i;var s,o=-1,u=e.length;if(!t){while(++o<u)e[o]<i&&(i=e[o]);return i}n&&(t=At(t,n));while(++o<u)s=t(e[o],o,e),s<r&&(r=s,i=e[o]);return i}function In(e,t,n){e=+e||0,n=+n||1,t==null&&(t=e,e=0);var r=-1,i=Math.max(0,Math.ceil((t-e)/n)),s=Array(i);while(++r<i)s[r]=e,e+=n;return s}function qn(e,t,n){return e?_.call(e,t==null||n?1:t):[]}function Rn(e){if(!e)return[];var t,n=-1,r=e.length,i=Array(r);while(++n<r)t=Math.floor(Math.random()*(n+1)),i[n]=i[t],i[t]=e[n];return i}function Un(e,t,n,r){if(!e)return 0;var i,s=0,o=e.length;if(n){r&&(n=Kn(n,r)),t=n(t);while(s<o)i=s+o>>>1,n(e[i])<t?s=i+1:o=i}else while(s<o)i=s+o>>>1,e[i]<t?s=i+1:o=i;return s}function zn(){var e=-1,t=[],n=L.apply(t,arguments),r=n.length;while(++e<r)_n(t,n[e])<0&&t.push(n[e]);return t}function Wn(e,t,n,r){var i=[];if(!e)return i;var s,o=-1,u=e.length,a=[];typeof t=="function"&&(r=n,n=t,t=!1),n?r&&(n=At(n,r)):n=ur;while(++o<u){s=n(e[o],o,e);if(t?!o||a[a.length-1]!==s:_n(a,s)<0)a.push(s),i.push(e[o])}return i}function Xn(e){var t=[];if(!e)return t;var n=-1,r=e.length,i=St(arguments,1,20);while(++n<r)i(e[n])||t.push(e[n]);return t}function Vn(e){if(!e)return[];var t=-1,n=jn(wn(arguments,"length")),r=Array(n);while(++t<n)r[t]=wn(arguments,t);return r}function $n(e,t){if(!e)return{};var n=-1,r=e.length,i={};t||(t=[]);while(++n<r)i[e[n]]=t[n];return i}function Jn(e,t){return e<1?t():function(){if(--e<1)return t.apply(this,arguments)}}function Kn(e,t){function s(){var o=arguments,u=t;r||(e=t[n]),i.length&&(o=o.length?i.concat(_.call(o)):i);if(this instanceof s){Ot.prototype=e.prototype,u=new Ot;var a=e.apply(u,o);return a&&ft[typeof a]?a:u}return e.apply(u,o)}var n,r=Bt(e);if(!r)n=t,t=e;else if(rt||P&&arguments.length>2)return P.call.apply(P,arguments);var i=_.call(arguments,2);return s}function Gn(){var e=arguments;return function(){var t=arguments,n=e.length;while(n--)t=[e[n].apply(this,t)];return t[0]}}function Yn(e,t,n){function u(){o=null,n||e.apply(s,r)}var r,i,s,o;return function(){var a=n&&!o;return r=arguments,s=this,$(o),o=J(u,t),a&&(i=e.apply(s,r)),i}}function Zn(e,n){var r=_.call(arguments,2);return J(function(){return e.apply(t,r)},n)}function er(e){var n=_.call(arguments,1);return J(function(){return e.apply(t,n)},1)}function tr(e,t){var n={};return function(){var r=t?t.apply(this,arguments):arguments[0];return A.call(n,r)?n[r]:n[r]=e.apply(this,arguments)}}function nr(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}}function rr(e){var t=_.call(arguments,1),n=t.length;return function(){var r,i=arguments;return i.length&&(t.length=n,O.apply(t,i)),r=t.length==1?e.call(this,t[0]):e.apply(this,t),t.length=n,r}}function ir(e,t){function u(){o=new Date,s=null,e.apply(i,n)}var n,r,i,s,o=0;return function(){var a=new Date,f=t-(a-o);return n=arguments,i=this,f<=0?(o=a,r=e.apply(i,n)):s||(s=J(u,f)),r}}function sr(e,t){return function(){var n=[e];return arguments.length&&O.apply(n,arguments),t.apply(this,n)}}function or(e){return e==null?"":(e+"").replace(S,kt)}function ur(e){return e}function ar(e){mn(Wt(e),function(t){var n=ct[t]=e[t];ht.prototype[t]=function(){var e=[this._wrapped];arguments.length&&O.apply(e,arguments);var t=n.apply(ct,e);return this._chain&&(t=new ht(t),t._chain=!0),t}})}function fr(){return e._=p,this}function lr(e,t){if(!e)return null;var n=e[t];return Bt(n)?e[t]():n}function cr(e,t,o){o||(o={}),e+="";var u,a,f=o.escape,l=o.evaluate,c=o.interpolate,h=ct.templateSettings,p=o.variable||h.variable,d=p;f==null&&(f=h.escape),l==null&&(l=h.evaluate||!1),c==null&&(c=h.interpolate),f&&(e=e.replace(f,Mt)),c&&(e=e.replace(c,Dt)),l!=n&&(n=l,s=RegExp("<e%-([\\s\\S]+?)%>|<e%=([\\s\\S]+?)%>"+(l?"|"+l.source:""),"g")),u=k.length,e=e.replace(s,_t),u=u!=k.length,e="__p += '"+e.replace(x,Ct).replace(E,Nt)+"';\n",k.length=0,d||(p=r||"obj",u?e="with ("+p+") {\n"+e+"\n}\n":(p!=r&&(r=p,i=RegExp("(\\(\\s*)"+p+"\\."+p+"\\b","g")),e=e.replace(b,"$&"+p+".").replace(i,"$1__d"))),e=(u?e.replace(v,""):e).replace(m,"$1").replace(g,"$1;"),e="function("+p+") {\n"+(d?"":p+" || ("+p+" = {});\n")+"var __t, __p = '', __e = _.escape"+(u?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":(d?"":", __d = "+p+"."+p+" || "+p)+";\n")+e+"return __p\n}",st&&(e+="\n//@ sourceURL=/lodash/template/source["+N++ +"]");try{a=Function("_","return "+e)(ct)}catch(y){a=function(){throw y}}return t?a(t):(a.source=e,a)}function hr(e,t,n){var r=-1;if(n)while(++r<e)t.call(n,r);else while(++r<e)t(r)}function pr(e){var t=h++;return e?e+t:t}function dr(e){return e=new ht(e),e._chain=!0,e}function vr(e,t){return t(e),e}function mr(){return this._chain=!0,this}function gr(){return this._wrapped}var n,r,i,s,o=typeof exports=="object"&&exports&&(typeof global=="object"&&global&&global==global.global&&(e=global),exports),u=Array.prototype,a=Boolean.prototype,f=Object.prototype,l=Number.prototype,c=String.prototype,h=0,p=e._,d=/[-+=!~*%&^<>|{(\/]|\[\D|\b(?:delete|in|instanceof|new|typeof|void)\b/,v=/\b__p \+= '';/g,m=/\b(__p \+=) '' \+/g,g=/(__e\(.*?\)|\b__t\)) \+\n'';/g,y=/\w*$/,b=/(?:__e|__t = )\(\s*(?![\d\s"']|this\.)/g,w=RegExp("^"+(f.valueOf+"").replace(/[.*+?^=!:${}()|[\]\/\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),E=/__token__(\d+)/g,S=/[&<"']/g,x=/['\n\r\t\u2028\u2029\\]/g,T=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],N=0,C="__token__",k=[],L=u.concat,A=f.hasOwnProperty,O=u.push,M=f.propertyIsEnumerable,_=u.slice,D=f.toString,P=w.test(P=_.bind)&&P,H=w.test(H=Array.isArray)&&H,B=e.isFinite,j=w.test(j=Object.keys)&&j,F="[object Arguments]",I="[object Array]",q="[object Boolean]",R="[object Date]",U="[object Function]",z="[object Number]",W="[object Object]",X="[object RegExp]",V="[object String]",$=e.clearTimeout,J=e.setTimeout,K,Q,G=!0;(function(){function t(){this.x=1}var e=[];t.prototype={valueOf:1,y:1};for(var n in new t)e.push(n);for(n in arguments)G=!n;K=(e+"").length<4,Q=e[0]!="x"})(1);var Y=!Pt(arguments),Z=_.call("x")[0]!="x",et="x"[0]+Object("x")[0]!="xx";try{var tt=({toString:0}+"",D.call(e.document||0)==W)}catch(nt){}var rt=P&&/\n|Opera/.test(P+D.call(e.opera)),it=j&&/^.+$|true/.test(j+!!e.attachEvent);try{var st=(Function("//@cc_on !")(),!0)}catch(nt){}var ot={};ot[q]=ot[R]=ot[U]=ot[z]=ot[W]=ot[X]=!1,ot[F]=ot[I]=ot[V]=!0;var ut={};ut[F]=ut[U]=!1,ut[I]=ut[q]=ut[R]=ut[z]=ut[W]=ut[X]=ut[V]=!0;var at={"&":"&amp;","<":"&lt;",'"':"&quot;","'":"&#x27;"},ft={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,"undefined":!1,unknown:!0},lt={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"};ct.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,variable:""};var pt=cr("<% if (useStrict) { %>'use strict';\n<% } %>var index, value, iteratee = <%= firstArg %>, result<% if (init) { %> = <%= init %><% } %>;\n<%= exit %>;\n<%= top %>;\n<% if (arrayBranch) { %>var length = iteratee.length; index = -1;  <% if (objectBranch) { %>\nif (length > -1 && length === length >>> 0) {<% } %>  <% if (noCharByIndex) { %>\n  if (toString.call(iteratee) == stringClass) {\n    iteratee = iteratee.split('')\n  }  <% } %>\n  <%= arrayBranch.beforeLoop %>;\n  while (++index < length) {\n    value = iteratee[index];\n    <%= arrayBranch.inLoop %>\n  }  <% if (objectBranch) { %>\n}<% } %><% } %><% if (objectBranch) { %>  <% if (arrayBranch) { %>\nelse {  <%  } else if (noArgsEnum) { %>\n  var length = iteratee.length; index = -1;\n  if (length && isArguments(iteratee)) {\n    while (++index < length) {\n      value = iteratee[index += ''];\n      <%= objectBranch.inLoop %>\n    }\n  } else {  <% } %>  <% if (!hasDontEnumBug) { %>\n  var skipProto = typeof iteratee == 'function' && \n    propertyIsEnumerable.call(iteratee, 'prototype');\n  <% } %>  <% if (isKeysFast && useHas) { %>\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iteratee] ? nativeKeys(iteratee) : [],\n      length = ownProps.length;\n\n  <%= objectBranch.beforeLoop %>;\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n    <% if (!hasDontEnumBug) { %>if (!(skipProto && index == 'prototype')) {\n  <% } %>    value = iteratee[index];\n    <%= objectBranch.inLoop %>\n    <% if (!hasDontEnumBug) { %>}\n<% } %>  }  <% } else { %>\n  <%= objectBranch.beforeLoop %>;\n  for (index in iteratee) {    <% if (hasDontEnumBug) { %>\n    <%   if (useHas) { %>if (hasOwnProperty.call(iteratee, index)) {\n  <% } %>    value = iteratee[index];\n    <%= objectBranch.inLoop %>;\n    <%   if (useHas) { %>}<% } %>    <% } else { %>\n    if (!(skipProto && index == 'prototype')<% if (useHas) { %> &&\n        hasOwnProperty.call(iteratee, index)<% } %>) {\n      value = iteratee[index];\n      <%= objectBranch.inLoop %>\n    }    <% } %>\n  }  <% } %>  <% if (hasDontEnumBug) { %>\n\n  var ctor = iteratee.constructor;\n    <% for (var k = 0; k < 7; k++) { %>\n  index = '<%= shadowed[k] %>';\n  if (<%      if (shadowed[k] == 'constructor') {        %>!(ctor && ctor.prototype === iteratee) && <%      } %>hasOwnProperty.call(iteratee, index)) {\n    value = iteratee[index];\n    <%= objectBranch.inLoop %>\n  }    <% } %>  <% } %>  <% if (arrayBranch || noArgsEnum) { %>\n}<% } %><% } %>\n<%= bottom %>;\nreturn result"),dt={args:"collection, callback, thisArg",init:"collection",top:"if (!callback) {\n  callback = identity\n}\nelse if (thisArg) {\n  callback = iteratorBind(callback, thisArg)\n}",inLoop:"if (callback(value, index, collection) === false) return result"},vt={init:"{}",top:"var prop;\nif (typeof callback != 'function') {\n  var valueProp = callback;\n  callback = function(value) { return value[valueProp] }\n}\nelse if (thisArg) {\n  callback = iteratorBind(callback, thisArg)\n}",inLoop:"prop = callback(value, index, collection);\n(hasOwnProperty.call(result, prop) ? result[prop]++ : result[prop] = 1)"},mt={init:"true",inLoop:"if (!callback(value, index, collection)) return !result"},gt={useHas:!1,useStrict:!1,args:"object",init:"object",top:"for (var argsIndex = 1, argsLength = arguments.length; argsIndex < argsLength; argsIndex++) {\n  if (iteratee = arguments[argsIndex]) {",inLoop:"result[index] = value",bottom:"  }\n}"},yt={init:"[]",inLoop:"callback(value, index, collection) && result.push(value)"},bt={top:"if (thisArg) callback = iteratorBind(callback, thisArg)"},wt={inLoop:{object:dt.inLoop}},Et={init:"",exit:"if (!collection) return []",beforeLoop:{array:"result = Array(length)",object:"result = "+(it?"Array(length)":"[]")},inLoop:{array:"result[index] = callback(value, index, collection)",object:"result"+(it?"[ownIndex] = ":".push")+"(callback(value, index, collection))"}};Y&&(Pt=function(e){return!!e&&!!A.call(e,"callee")});var Ht=H||function(e){return D.call(e)==I};Bt(/x/)&&(Bt=function(e){return D.call(e)==U});var jt=xt({args:"object",init:"[]",inLoop:"result.push(index)"}),It=xt(gt,{inLoop:"if (result[index] == null) "+gt.inLoop}),qt=xt({useHas:!1,args:"object",init:"{}",top:"var props = concat.apply(ArrayProto, arguments)",inLoop:"if (indexOf(props, index) < 0) result[index] = value"}),Rt=xt(gt),Ut=xt(dt,bt,wt,{useHas:!1}),zt=xt(dt,bt,wt),Wt=xt({useHas:!1,args:"object",init:"[]",inLoop:"if (isFunction(value)) result.push(index)",bottom:"result.sort()"}),Kt=xt({args:"value",init:"true",top:"var className = toString.call(value),\n    length = value.length;\nif (arrayLikeClasses[className]"+(Y?" || isArguments(value)":"")+" ||\n"+"  (className == objectClass && length > -1 && length === length >>> 0 &&\n"+"  isFunction(value.splice))"+") return !length",inLoop:{object:"return false"}}),on=j?function(e){var t=typeof e;return t=="function"&&M.call(e,"prototype")?jt(e):e&&ft[t]?j(e):[]}:jt,un=xt(gt,{args:"object, source, indicator, stack",top:"var destValue, found, isArr, stackLength, recursive = indicator == isPlainObject;\nif (!recursive) stack = [];\nfor (var argsIndex = 1, argsLength = recursive ? 2 : arguments.length; argsIndex < argsLength; argsIndex++) {\n  if (iteratee = arguments[argsIndex]) {",inLoop:"if (value && ((isArr = isArray(value)) || isPlainObject(value))) {\n  found = false; stackLength = stack.length;\n  while (stackLength--) {\n    if (found = stack[stackLength].source == value) break\n  }\n  if (found) {\n    result[index] = stack[stackLength].value\n  } else {\n    destValue = (destValue = result[index]) && isArr\n      ? (isArray(destValue) ? destValue : [])\n      : (isPlainObject(destValue) ? destValue : {});\n    stack.push({ value: destValue, source: value });\n    result[index] = callee(destValue, value, isPlainObject, stack)\n  }\n} else if (value != null) {\n  result[index] = value\n}"}),ln=xt({args:"object",init:"[]",inLoop:"result.push(value)"}),cn=xt({args:"collection, target",init:"false",noCharByIndex:!1,beforeLoop:{array:"if (toString.call(iteratee) == stringClass) return collection.indexOf(target) > -1"},inLoop:"if (value === target) return true"}),hn=xt(dt,vt),pn=xt(dt,mt),dn=xt(dt,yt),vn=xt(dt,bt,{init:"",inLoop:"if (callback(value, index, collection)) return value"}),mn=xt(dt,bt),gn=xt(dt,vt,{inLoop:"prop = callback(value, index, collection);\n(hasOwnProperty.call(result, prop) ? result[prop] : result[prop] = []).push(value)"}),yn=xt(Et,{args:"collection, methodName",top:"var args = slice.call(arguments, 2),\n    isFunc = typeof methodName == 'function'",inLoop:{array:"result[index] = (isFunc ? methodName : value[methodName]).apply(value, args)",object:"result"+(it?"[ownIndex] = ":".push")+"((isFunc ? methodName : value[methodName]).apply(value, args))"}}),bn=xt(dt,Et),wn=xt(Et,{args:"collection, property",inLoop:{array:"result[index] = value[property]",object:"result"+(it?"[ownIndex] = ":".push")+"(value[property])"}}),En=xt({args:"collection, callback, accumulator, thisArg",init:"accumulator",top:"var noaccum = arguments.length < 3;\nif (thisArg) callback = iteratorBind(callback, thisArg)",beforeLoop:{array:"if (noaccum) result = collection[++index]"},inLoop:{array:"result = callback(result, value, index, collection)",object:"result = noaccum\n  ? (noaccum = false, value)\n  : callback(result, value, index, collection)"}}),xn=xt(dt,yt,{inLoop:"!"+yt.inLoop}),Tn=xt(dt,mt,{init:"false",inLoop:mt.inLoop.replace("!","")}),Nn=xt(dt,vt,Et,{inLoop:{array:"result[index] = {\n  criteria: callback(value, index, collection),\n  index: index,\n  value: value\n}",object:"result"+(it?"[ownIndex] = ":".push")+"({\n"+"  criteria: callback(value, index, collection),\n"+"  index: index,\n"+"  value: value\n"+"})"},bottom:"result.sort(compareAscending);\nlength = result.length;\nwhile (length--) {\n  result[length] = result[length].value\n}"}),kn=xt(yt,{args:"collection, properties",top:"var pass, prop, propIndex, props = [];\nforIn(properties, function(value, prop) { props.push(prop) });\nvar propsLength = props.length",inLoop:"for (pass = true, propIndex = 0; propIndex < propsLength; propIndex++) {\n  prop = props[propIndex];\n  if (!(pass = value[prop] === properties[prop])) break\n}\nif (pass) result.push(value)"}),Qn=xt({useHas:!1,useStrict:!1,args:"object",init:"object",top:"var funcs = arguments,\n    length = funcs.length;\nif (length > 1) {\n  for (var index = 1; index < length; index++) {\n    result[funcs[index]] = bind(result[funcs[index]], result)\n  }\n  return result\n}",inLoop:"if (isFunction(result[index])) {\n  result[index] = bind(result[index], result)\n}"});ct.VERSION="0.5.2",ct.after=Jn,ct.bind=Kn,ct.bindAll=Qn,ct.chain=dr,ct.clone=Ft,ct.compact=Ln,ct.compose=Gn,ct.contains=cn,ct.countBy=hn,ct.debounce=Yn,ct.defaults=It,ct.defer=er,ct.delay=Zn,ct.difference=An,ct.drop=qt,ct.escape=or,ct.every=pn,ct.extend=Rt,ct.filter=dn,ct.find=vn,ct.first=On,ct.flatten=Mn,ct.forEach=mn,ct.forIn=Ut,ct.forOwn=zt,ct.functions=Wt,ct.groupBy=gn,ct.has=Xt,ct.identity=ur,ct.indexOf=_n,ct.initial=Dn,ct.intersection=Pn,ct.invoke=yn,ct.isArguments=Pt,ct.isArray=Ht,ct.isBoolean=Vt,ct.isDate=$t,ct.isElement=Jt,ct.isEmpty=Kt,ct.isEqual=Qt,ct.isFinite=Gt,ct.isFunction=Bt,ct.isNaN=Zt,ct.isNull=en,ct.isNumber=tn,ct.isObject=Yt,ct.isRegExp=nn,ct.isString=rn,ct.isUndefined=sn,ct.keys=on,ct.last=Hn,ct.lastIndexOf=Bn,ct.map=bn,ct.max=jn,ct.memoize=tr,ct.merge=un,ct.min=Fn,ct.mixin=ar,ct.noConflict=fr,ct.once=nr,ct.partial=rr,ct.pick=an,ct.pluck=wn,ct.range=In,ct.reduce=En,ct.reduceRight=Sn,ct.reject=xn,ct.rest=qn,ct.result=lr,ct.shuffle=Rn,ct.size=fn,ct.some=Tn,ct.sortBy=Nn,ct.sortedIndex=Un,ct.tap=vr,ct.template=cr,ct.throttle=ir,ct.times=hr,ct.toArray=Cn,ct.union=zn,ct.uniq=Wn,ct.uniqueId=pr,ct.values=ln,ct.where=kn,ct.without=Xn,ct.wrap=sr,ct.zip=Vn,ct.zipObject=$n,ct.all=pn,ct.any=Tn,ct.collect=bn,ct.detect=vn,ct.each=mn,ct.foldl=En,ct.foldr=Sn,ct.head=On,ct.include=cn,ct.inject=En,ct.methods=Wt,ct.select=dn,ct.tail=qn,ct.take=On,ct.unique=Wn,ct._iteratorTemplate=pt,ct._shimKeys=jt,ht.prototype=ct.prototype,ar(ct),ht.prototype.chain=mr,ht.prototype.value=gr,mn(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=u[e];ht.prototype[e]=function(){var e=this._wrapped;return t.apply(e,arguments),e.length===0&&delete e[0],this._chain&&(e=new ht(e),e._chain=!0),e}}),mn(["concat","join","slice"],function(e){var t=u[e];ht.prototype[e]=function(){var e=this._wrapped,n=t.apply(e,arguments);return this._chain&&(n=new ht(n),n._chain=!0),n}}),typeof define=="function"&&typeof define.amd=="object"&&define.amd?(e._=ct,define("lodash",[],function(){return ct})):o?typeof module=="object"&&module&&module.exports==o?(module.exports=ct)._=ct:o._=ct:e._=ct}(this),function(){var e=this,t=e.Backbone,n=Array.prototype.slice,r=Array.prototype.splice,i;typeof exports!="undefined"?i=exports:i=e.Backbone={},i.VERSION="0.9.2";var s=e._;!s&&typeof require!="undefined"&&(s=require("underscore"));var o=e.jQuery||e.Zepto||e.ender;i.setDomLibrary=function(e){o=e},i.noConflict=function(){return e.Backbone=t,this},i.emulateHTTP=!1,i.emulateJSON=!1;var u=/\s+/,a=i.Events={on:function(e,t,n){var r,i,s,o,a;if(!t)return this;e=e.split(u),r=this._callbacks||(this._callbacks={});while(i=e.shift())a=r[i],s=a?a.tail:{},s.next=o={},s.context=n,s.callback=t,r[i]={tail:o,next:a?a.next:s};return this},off:function(e,t,n){var r,i,o,a,f,l;if(!(i=this._callbacks))return;if(!(e||t||n))return delete this._callbacks,this;e=e?e.split(u):s.keys(i);while(r=e.shift()){o=i[r],delete i[r];if(!o||!t&&!n)continue;a=o.tail;while((o=o.next)!==a)f=o.callback,l=o.context,(t&&f!==t||n&&l!==n)&&this.on(r,f,l)}return this},trigger:function(e){var t,r,i,s,o,a,f;if(!(i=this._callbacks))return this;a=i.all,e=e.split(u),f=n.call(arguments,1);while(t=e.shift()){if(r=i[t]){s=r.tail;while((r=r.next)!==s)r.callback.apply(r.context||this,f)}if(r=a){s=r.tail,o=[t].concat(f);while((r=r.next)!==s)r.callback.apply(r.context||this,o)}}return this}};a.bind=a.on,a.unbind=a.off;var f=i.Model=function(e,t){var n;e||(e={}),t&&t.parse&&(e=this.parse(e));if(n=C(this,"defaults"))e=s.extend({},n,e);t&&t.collection&&(this.collection=t.collection),this.attributes={},this._escapedAttributes={},this.cid=s.uniqueId("c"),this.changed={},this._silent={},this._pending={},this.set(e,{silent:!0}),this.changed={},this._silent={},this._pending={},this._previousAttributes=s.clone(this.attributes),this.initialize.apply(this,arguments)};s.extend(f.prototype,a,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return s.clone(this.attributes)},get:function(e){return this.attributes[e]},escape:function(e){var t;if(t=this._escapedAttributes[e])return t;var n=this.get(e);return this._escapedAttributes[e]=s.escape(n==null?"":""+n)},has:function(e){return this.get(e)!=null},set:function(e,t,n){var r,i,o;s.isObject(e)||e==null?(r=e,n=t):(r={},r[e]=t),n||(n={});if(!r)return this;r instanceof f&&(r=r.attributes);if(n.unset)for(i in r)r[i]=void 0;if(!this._validate(r,n))return!1;this.idAttribute in r&&(this.id=r[this.idAttribute]);var u=n.changes={},a=this.attributes,l=this._escapedAttributes,c=this._previousAttributes||{};for(i in r){o=r[i];if(!s.isEqual(a[i],o)||n.unset&&s.has(a,i))delete l[i],(n.silent?this._silent:u)[i]=!0;n.unset?delete a[i]:a[i]=o,!s.isEqual(c[i],o)||s.has(a,i)!=s.has(c,i)?(this.changed[i]=o,n.silent||(this._pending[i]=!0)):(delete this.changed[i],delete this._pending[i])}return n.silent||this.change(n),this},unset:function(e,t){return(t||(t={})).unset=!0,this.set(e,null,t)},clear:function(e){return(e||(e={})).unset=!0,this.set(s.clone(this.attributes),e)},fetch:function(e){e=e?s.clone(e):{};var t=this,n=e.success;return e.success=function(r,i,s){if(!t.set(t.parse(r,s),e))return!1;n&&n(t,r)},e.error=i.wrapError(e.error,t,e),(this.sync||i.sync).call(this,"read",this,e)},save:function(e,t,n){var r,o;s.isObject(e)||e==null?(r=e,n=t):(r={},r[e]=t),n=n?s.clone(n):{};if(n.wait){if(!this._validate(r,n))return!1;o=s.clone(this.attributes)}var u=s.extend({},n,{silent:!0});if(r&&!this.set(r,n.wait?u:n))return!1;var a=this,f=n.success;n.success=function(e,t,i){var o=a.parse(e,i);n.wait&&(delete n.wait,o=s.extend(r||{},o));if(!a.set(o,n))return!1;f?f(a,e):a.trigger("sync",a,e,n)},n.error=i.wrapError(n.error,a,n);var l=this.isNew()?"create":"update",c=(this.sync||i.sync).call(this,l,this,n);return n.wait&&this.set(o,u),c},destroy:function(e){e=e?s.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};if(this.isNew())return r(),!1;e.success=function(i){e.wait&&r(),n?n(t,i):t.trigger("sync",t,i,e)},e.error=i.wrapError(e.error,t,e);var o=(this.sync||i.sync).call(this,"delete",this,e);return e.wait||r(),o},url:function(){var e=C(this,"urlRoot")||C(this.collection,"url")||k();return this.isNew()?e:e+(e.charAt(e.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(e){e||(e={});var t=this._changing;this._changing=!0;for(var n in this._silent)this._pending[n]=!0;var r=s.extend({},e.changes,this._silent);this._silent={};for(var n in r)this.trigger("change:"+n,this,this.get(n),e);if(t)return this;while(!s.isEmpty(this._pending)){this._pending={},this.trigger("change",this,e);for(var n in this.changed){if(this._pending[n]||this._silent[n])continue;delete this.changed[n]}this._previousAttributes=s.clone(this.attributes)}return this._changing=!1,this},hasChanged:function(e){return arguments.length?s.has(this.changed,e):!s.isEmpty(this.changed)},changedAttributes:function(e){if(!e)return this.hasChanged()?s.clone(this.changed):!1;var t,n=!1,r=this._previousAttributes;for(var i in e){if(s.isEqual(r[i],t=e[i]))continue;(n||(n={}))[i]=t}return n},previous:function(e){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return s.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(e,t){if(t.silent||!this.validate)return!0;e=s.extend({},this.attributes,e);var n=this.validate(e,t);return n?(t&&t.error?t.error(this,n,t):this.trigger("error",this,n,t),!1):!0}});var l=i.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,{silent:!0,parse:t.parse})};s.extend(l.prototype,a,{model:f,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},add:function(e,t){var n,i,o,u,a,f,l={},c={},h=[];t||(t={}),e=s.isArray(e)?e.slice():[e];for(n=0,o=e.length;n<o;n++){if(!(u=e[n]=this._prepareModel(e[n],t)))throw new Error("Can't add an invalid model to a collection");a=u.cid,f=u.id;if(l[a]||this._byCid[a]||f!=null&&(c[f]||this._byId[f])){h.push(n);continue}l[a]=c[f]=u}n=h.length;while(n--)e.splice(h[n],1);for(n=0,o=e.length;n<o;n++)(u=e[n]).on("all",this._onModelEvent,this),this._byCid[u.cid]=u,u.id!=null&&(this._byId[u.id]=u);this.length+=o,i=t.at!=null?t.at:this.models.length,r.apply(this.models,[i,0].concat(e)),this.comparator&&this.sort({silent:!0});if(t.silent)return this;for(n=0,o=this.models.length;n<o;n++){if(!l[(u=this.models[n]).cid])continue;t.index=n,u.trigger("add",u,this,t)}return this},remove:function(e,t){var n,r,i,o;t||(t={}),e=s.isArray(e)?e.slice():[e];for(n=0,r=e.length;n<r;n++){o=this.getByCid(e[n])||this.get(e[n]);if(!o)continue;delete this._byId[o.id],delete this._byCid[o.cid],i=this.indexOf(o),this.models.splice(i,1),this.length--,t.silent||(t.index=i,o.trigger("remove",o,this,t)),this._removeReference(o)}return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,t),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,s.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},get:function(e){return e==null?void 0:this._byId[e.id!=null?e.id:e]},getByCid:function(e){return e&&this._byCid[e.cid||e]},at:function(e){return this.models[e]},where:function(e){return s.isEmpty(e)?[]:this.filter(function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},sort:function(e){e||(e={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");var t=s.bind(this.comparator,this);return this.comparator.length==1?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("reset",this,e),this},pluck:function(e){return s.map(this.models,function(t){return t.get(e)})},reset:function(e,t){e||(e=[]),t||(t={});for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return this._reset(),this.add(e,s.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},fetch:function(e){e=e?s.clone(e):{},e.parse===undefined&&(e.parse=!0);var t=this,n=e.success;return e.success=function(r,i,s){t[e.add?"add":"reset"](t.parse(r,s),e),n&&n(t,r)},e.error=i.wrapError(e.error,t,e),(this.sync||i.sync).call(this,"read",this,e)},create:function(e,t){var n=this;t=t?s.clone(t):{},e=this._prepareModel(e,t);if(!e)return!1;t.wait||n.add(e,t);var r=t.success;return t.success=function(i,s,o){t.wait&&n.add(i,t),r?r(i,s):i.trigger("sync",e,s,t)},e.save(null,t),e},parse:function(e,t){return e},chain:function(){return s(this.models).chain()},_reset:function(e){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(e,t){t||(t={});if(e instanceof f)e.collection||(e.collection=this);else{var n=e;t.collection=this,e=new this.model(n,t),e._validate(e.attributes,t)||(e=!1)}return e},_removeReference:function(e){this==e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e=="add"||e=="remove")&&n!=this)return;e=="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],this._byId[t.id]=t),this.trigger.apply(this,arguments)}});var c=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];s.each(c,function(e){l.prototype[e]=function(){return s[e].apply(s,[this.models].concat(s.toArray(arguments)))}});var h=i.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},p=/:\w+/g,d=/\*\w+/g,v=/[-[\]{}()+?.,\\^$|#\s]/g;s.extend(h.prototype,a,{initialize:function(){},route:function(e,t,n){return i.history||(i.history=new m),s.isRegExp(e)||(e=this._routeToRegExp(e)),n||(n=this[t]),i.history.route(e,s.bind(function(r){var s=this._extractParameters(e,r);n&&n.apply(this,s),this.trigger.apply(this,["route:"+t].concat(s)),i.history.trigger("route",this,t,s)},this)),this},navigate:function(e,t){i.history.navigate(e,t)},_bindRoutes:function(){if(!this.routes)return;var e=[];for(var t in this.routes)e.unshift([t,this.routes[t]]);for(var n=0,r=e.length;n<r;n++)this.route(e[n][0],e[n][1],this[e[n][1]])},_routeToRegExp:function(e){return e=e.replace(v,"\\$&").replace(p,"([^/]+)").replace(d,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var m=i.History=function(){this.handlers=[],s.bindAll(this,"checkUrl")},g=/^[#\/]/,y=/msie [\w.]+/;m.started=!1,s.extend(m.prototype,a,{interval:50,getHash:function(e){var t=e?e.location:window.location,n=t.href.match(/#(.*)$/);return n?n[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||t){e=window.location.pathname;var n=window.location.search;n&&(e+=n)}else e=this.getHash();return e.indexOf(this.options.root)||(e=e.substr(this.options.root.length)),e.replace(g,"")},start:function(e){if(m.started)throw new Error("Backbone.history has already been started");m.started=!0,this.options=s.extend({},{root:"/"},this.options,e),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var t=this.getFragment(),n=document.documentMode,r=y.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);r&&(this.iframe=o('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?o(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?o(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=window.location,u=i.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!u)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&u&&i.hash&&(this.fragment=this.getHash().replace(g,""),window.history.replaceState({},document.title,i.protocol+"//"+i.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){o(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),m.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t==this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t==this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=s.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0});return n},navigate:function(e,t){if(!m.started)return!1;if(!t||t===!0)t={trigger:t};var n=(e||"").replace(g,"");if(this.fragment==n)return;this._hasPushState?(n.indexOf(this.options.root)!=0&&(n=this.options.root+n),this.fragment=n,window.history[t.replace?"replaceState":"pushState"]({},document.title,n)):this._wantsHashChange?(this.fragment=n,this._updateHash(window.location,n,t.replace),this.iframe&&n!=this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,n,t.replace))):window.location.assign(this.options.root+e),t.trigger&&this.loadUrl(e)},_updateHash:function(e,t,n){n?e.replace(e.toString().replace(/(javascript:|#).*$/,"")+"#"+t):e.hash=t}});var b=i.View=function(e){this.cid=s.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,E=["model","collection","el","id","attributes","className","tagName"];s.extend(b.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(e,t,n){var r=document.createElement(e);return t&&o(r).attr(t),n&&o(r).html(n),r},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof o?e:o(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=C(this,"events")))return;this.undelegateEvents();for(var t in e){var n=e[t];s.isFunction(n)||(n=this[e[t]]);if(!n)throw new Error('Method "'+e[t]+'" does not exist');var r=t.match(w),i=r[1],o=r[2];n=s.bind(n,this),i+=".delegateEvents"+this.cid,o===""?this.$el.bind(i,n):this.$el.delegate(o,i,n)}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=s.extend({},this.options,e));for(var t=0,n=E.length;t<n;t++){var r=E[t];e[r]&&(this[r]=e[r])}this.options=e},_ensureElement:function(){if(!this.el){var e=C(this,"attributes")||{};this.id&&(e.id=this.id),this.className&&(e["class"]=this.className),this.setElement(this.make(this.tagName,e),!1)}else this.setElement(this.el,!1)}});var S=function(e,t){var n=N(this,e,t);return n.extend=this.extend,n};f.extend=l.extend=h.extend=b.extend=S;var x={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};i.sync=function(e,t,n){var r=x[e];n||(n={});var u={type:r,dataType:"json"};return n.url||(u.url=C(t,"url")||k()),!n.data&&t&&(e=="create"||e=="update")&&(u.contentType="application/json",u.data=JSON.stringify(t.toJSON())),i.emulateJSON&&(u.contentType="application/x-www-form-urlencoded",u.data=u.data?{model:u.data}:{}),i.emulateHTTP&&(r==="PUT"||r==="DELETE")&&(i.emulateJSON&&(u.data._method=r),u.type="POST",u.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r)}),u.type!=="GET"&&!i.emulateJSON&&(u.processData=!1),o.ajax(s.extend(u,n))},i.wrapError=function(e,t,n){return function(r,i){i=r===t?i:r,e?e(t,i,n):t.trigger("error",t,i,n)}};var T=function(){},N=function(e,t,n){var r;return t&&t.hasOwnProperty("constructor")?r=t.constructor:r=function(){e.apply(this,arguments)},s.extend(r,e),T.prototype=e.prototype,r.prototype=new T,t&&s.extend(r.prototype,t),n&&s.extend(r,n),r.prototype.constructor=r,r.__super__=e.prototype,r},C=function(e,t){return!e||!e[t]?null:s.isFunction(e[t])?e[t]():e[t]},k=function(){throw new Error('A "url" property or function must be specified')}}.call(this),define("backbone",["lodash"],function(e){return function(){var t,n;return t||e.Backbone}}(this)),function(e){var t,n=e.Backbone,r=e._,i=e.$,s=n.View.prototype._configure,o=n.View.prototype.render,u=n.View.extend({constructor:function(t){t=t||{},u.setupView(this,t),n.View.call(this,t)},swapLayout:function(e){return e.views=r.defaults({},this.views,e.views),e.setElement(this.el),e},insertView:function(e,t){return t?this.setView(e,t,!0):this.setView(e,!0)},insertViews:function(e){return r.each(e,function(t,n){e[n]=[].concat(t)}),this.setViews(e)},getView:function(e){return this.getViews(e).first().value()},getViews:function(e){var t=r.chain(this.views).map(function(e){return[].concat(e)},this).flatten().value();return r.chain(r.filter(t,e?e:r.identity))},setView:function(e,t,n){var i,s,o=this;return r.isString(e)||(n=t,t=e,e=""),this.views=this.views||{},!n&&this.views[e]&&(r.isArray(this.views[e])?r.each(this.views[e],function(e){e.remove()}):this.views[e].remove()),s=t._options(),t.__manager__||u.setupView(t,s),t.render=function(i){function l(){(!n||t.keep||!f.hasRendered)&&s.partial(o.el,e,t.el,n),t.delegateEvents(),f.handler&&(f.handler.resolveWith(t,[t.el]),delete f.handler),a.resolveWith(t,[t.el]),r.isFunction(i)&&i.call(t,t.el)}var a=s.deferred(),f=t.__manager__;return f.viewDeferred=a,t._removeView(),u.prototype.render.call(t).then(l),a.promise()},t.__manager__.parent=o,t.__manager__.selector=e,n?(i=this.views[e]=this.views[e]||[],r.isArray(this.views[e])||(i=this.views[e]=[this.views[e]]),r.indexOf(i,t)>-1?t:(i.push(t),t.__manager__.append=!0,t)):this.views[e]=t},setViews:function(e){return r.each(e,function(e,t){if(r.isArray(e))return r.each(e,function(e){this.insertView(t,e)},this);this.setView(t,e)},this),this},render:function(e){var t=this,n=this._options(),i=n.deferred();return this.__manager__.renderDeferred?(this.__manager__.callback=e,this.__manager__.renderDeferred):(this._render(u._viewRender).fetch.then(function(){t.__manager__.renderDeferred=i;var e=r.map(t.views,function(e){function i(e,t){if(!e.length)return t();var n=e.shift();n.render(function(){i(e,t)})}var t;return r.isArray(e)?(t=n.deferred(),i(r.clone(e),function(){t.resolve()}),t.promise()):e.render()});n.when(e).then(function(){i.resolveWith(t,[t.el])})}),i.then(function(){r.isFunction(e)&&e.call(t,t.el),t.__manager__.handler&&(t.__manager__.handler.resolveWith(t,[t.el]),delete t.__manager__.handler),r.isFunction(t.__manager__.callback)&&(t.__manager__.callback.call(t,t.el),delete t.__manager__.callback),delete t.__manager__.renderDeferred}))},remove:function(){return u.cleanViews(this),this._remove.apply(this,arguments)},_options:function(){return r.extend({},this,u.prototype.options,this.options)}},{_cache:{},_makeAsync:function(e,t){var n=e.deferred();return n.async=function(){return n._isAsync=!0,t},n},_viewRender:function(e){function o(n,r){u.cache(t,r),r&&s.html(e.el,s.render(r,n)),i.fetch.resolveWith(e,[e.el])}var t,n,i,s=e._options();return{render:function(a){var f=e.__manager__,l=e.template||s.template;return e.serialize&&(s.serialize=e.serialize),!a&&r.isFunction(s.serialize)?a=s.serialize.call(e):!a&&r.isObject(s.serialize)&&(a=s.serialize),i=u._makeAsync(s,r.bind(o,e,a)),i.fetch=s.deferred(),f.handler=i,r.isString(l)&&(t=f.prefix+l),(n=u.cache(t))?(o(a,n,t),i):(r.isString(l)?n=s.fetch.call(i,f.prefix+l):l!=null&&(n=s.fetch.call(i,l)),i._isAsync||o(a,n),i)}}},cleanViews:function(e){r.each([].concat(e),function(e){e.unbind(),e.views&&r.each(e.views,function(e){u.cleanViews(e)}),r.isFunction(e.cleanup)&&e.cleanup.call(e)})},cache:function(e,t){if(e in this._cache)return this._cache[e];if(e!=null&&t!=null)return this._cache[e]=t},configure:function(e){r.extend(u.prototype.options,e),e.manage&&(n.View.prototype.manage=!0)},setupView:function(e,i){var s,o,a=n.LayoutManager.prototype,f=r.pick(e,t);if(e.__manager__)return;r.defaults(e,{views:{},__manager__:{},_options:u.prototype._options,_removeView:u._removeView}),e instanceof n.Layout?e.__manager__.prefix=e._options().paths.layout||"":e.__manager__.prefix=e._options().paths.template||"",i=e.options=r.defaults(i||{},e.options,a.options),o=r.pick(i,["events"].concat(r.values(i.events))),r.extend(e,o),delete f.render,r.extend(i,f),e._remove=n.View.prototype.remove,e._render=function(e){var t,n=this._options().beforeRender,s=this._options().afterRender;return this._removeView(),r.isFunction(n)&&n.call(this,this),this.trigger("beforeRender",this),t=e(this).render(),t.then(function(){var e=this,t=e.__manager__,n=t.parent,o=function(){e.delegateEvents(),e.__manager__.hasRendered=!0,r.isFunction(s)&&s.call(e,e),e.trigger("afterRender",e)},u=function(e){var t=e.__manager__;return t.parent&&!t.hasRendered?u(t.parent):e};if(!n)return o.call(e);if(n.__manager__.hasRendered)return i.when([t.viewDeferred,n.__manager__.viewDeferred]).then(function(){o.call(e)});n=u(e),n.on("afterRender",function(){n.off(null,null,e),o.call(e)},e)}),t},e.render=u.prototype.render,e.remove!==a.remove&&(e._remove=e.remove,e.remove=a.remove),s=i.views||e.views,r.keys(s).length&&e.setViews(s),e.template&&(i.template=e.template,delete e.template)},_removeView:function(e){e=e||this,e.getViews().each(function(e){var t=e.__manager__,n=r.isBoolean(e.keep)?e.keep:e.options.keep;if(!n&&t.append===!0&&t.hasRendered){e.remove();if(r.isArray(t.parent.views[t.selector]))return t.parent.getView(function(e,n){e.__manager__.selector===t.selector&&t.parent.views[t.selector].splice(n,1)});delete t.parent[t.selector]}})}});r.each(["get","set","insert"],function(e){var t=n.View.prototype,r=u.prototype;t[e+"View"]=r[e+"View"],t[e+"Views"]=r[e+"Views"]}),n.Layout=n.LayoutManager=u,n.LayoutView=n.View.extend({manage:!0}),n.View.prototype._configure=function(){var e=s.apply(this,arguments);return this.manage&&u.setupView(this),e},u.prototype.options={paths:{},deferred:function(){return i.Deferred()},fetch:function(e){return r.template(i(e).html())},partial:function(e,t,n,r){var s=t?i(e).find(t):i(e);return s.length?(this[r?"append":"html"](s,n),!0):!1},html:function(e,t){i(e).html(t)},append:function(e,t){i(e).append(t)},when:function(e){return i.when.apply(null,e)},render:function(e,t){return e(t)}},t=r.keys(u.prototype.options)}(this),define("plugins/backbone.layoutmanager",function(){}),define("app",["lodash","backbone","plugins/backbone.layoutmanager"],function(e,t){var n={root:"/",players:new t.Model},r=window.JST=window.JST||{};return t.LayoutManager.configure({manage:!0,paths:{layout:"app/templates/layouts/",template:"app/templates/"},fetch:function(t){var i;return t+=".html",r[t]?r[t]:(i=this.async(),$.ajax({url:n.root+t}).then(function(n){i(r[t]=e.template(n))}))}}),e.extend(n,{module:function(t){return e.extend({Views:{}},t)},useLayout:function(n,r){if(this.layout&&this.layout.options.template===n)return this.layout;this.layout&&this.layout.remove();var i=new t.Layout(e.extend({template:n,className:"layout "+n,id:"layout"},r));return $("#main").empty().append(i.el),i.render(),this.layout=i,i}},t.Events)}),define("modules/state",["app","backbone"],function(e,t){var n={};return n=t.Model.extend({defaults:{base_rendered:!1,first_visit:!0},initialize:function(){this.checkFirstVisit()},checkFirstVisit:function(){localStorage.visited=="true"?this.set("first_visit",!1):localStorage.visited=!0}}),n}),define("modules/loader",["app","backbone"],function(e,t){var n={};return n.View=t.View.extend({DELAY:3e3,layerCount:0,layersReady:0,className:"ZEEGA-loader-overlay",template:"bgbloader",initialize:function(){var t=this;_.bindAll(this,"render"),e.bgImages=new n.ImagesCollection(69796),e.bgImages.fetch().success(function(){t.preloadStartImg(),t.preloadEndImg()}),e.state.get("first_visit")||(this.DELAY=0),this.model.on("layer_loading",this.onLayerLoading,this),this.model.on("layer_ready",this.onLayerReady,this),this.model.on("data_loaded",this.onDataLoaded,this)},afterRender:function(){this.bgImageReady&&this.$(".ZEEGA-loader-bg:animated").length===0&&this.$(".ZEEGA-loader-bg").animate({opacity:.5},500)},preloadStartImg:function(){var t=$("<img />"),n=Math.floor(Math.random()*e.bgImages.length),r=this;this.rndImgUrl=e.bgImages.at(n).get("uri"),t.attr("src",this.rndImgUrl).on("load",function(){r.bgImageReady=!0,r.render()})},preloadEndImg:function(){var t=Math.floor(Math.random()*e.bgImages.length),n=e.bgImages.at(t).get("uri"),r=$("<img />");r.attr("src",n),e.endImageUrl=n},serialize:function(){return this.bgImageReady?{rndImgUrl:this.rndImgUrl}:{rndImgUrl:""}},onDataLoaded:function(){this.render()},onLayerLoading:function(e){this.layerCount++},onLayerReady:function(e){this.layersReady++,this.$(".logo-splat").stop().animate({height:this.layersReady/this.layerCount*100+"%"}),this.layersReady==this.layerCount&&this.onCanPlay()},onCanPlay:function(){var e=this;_.delay(function(){e.$(".loader-content").fadeOut(500,function(){_.delay(function(){e.$el.fadeOut(500,function(){e.remove()})},500)}),e.model.play()},this.DELAY)},events:{"click .fullscreen":"goFullscreen"},goFullscreen:function(){return docElm=document.getElementById("body-main"),docElm.requestFullscreen?docElm.requestFullscreen():docElm.mozRequestFullScreen?docElm.mozRequestFullScreen():docElm.webkitRequestFullScreen&&docElm.webkitRequestFullScreen(),this.$("#project-fullscreen-toggle i").removeClass("icon-resize-full").addClass("icon-resize-small"),!1}}),n.ImagesCollection=t.Collection.extend({initialize:function(e){this.zeegaId=e},url:function(){return localStorage.api+"/items/"+this.zeegaId+"/items"},parse:function(e){return e.items}}),n}),define("modules/controls",["app","backbone"],function(e,t){var n={};return n.View=t.View.extend({template:"controls",className:"ZEEGA-player-controls",initialize:function(){this.model.on("frame_rendered",this.updateArrowState,this)},events:{"click .next-arrow":"skip","click .prev-arrow":"skipBack","mouseenter .prev-arrow":"mouseenterPrev","mouseenter .next-arrow":"mouseenterNext","mouseout .prev-arrow":"mouseoutPrev","mouseout .next-arrow":"mouseoutNext"},mouseenterNext:function(){this.$(".arrow-text").addClass("next")},mouseoutNext:function(){this.$(".arrow-text").removeClass("next")},mouseenterPrev:function(){this.$(".arrow-text").addClass("prev")},mouseoutPrev:function(){this.$(".arrow-text").removeClass("prev")},skip:function(){if(this.model.status.attributes.current_frame_model.get("_prev")===null&&this.model.status.attributes.current_frame!=27708&&this.model.status.attributes.current_frame!=28506){var e=this.model.status.attributes.current_frame_model.layers.models[0].get("attr").cue_in+this.model.status.attributes.current_frame_model.get("attr").advance/1e3;this.model.status.attributes.current_frame_model.layers.models[0].visualElement.mediaPlayer.setCurrentTime(e),this.model.cueNext()}else this.model.cueNextSequence()},skipBack:function(){this.model.cuePrevSequence();var e=this.model.status.attributes.current_frame_model,t=e.layers.models[0],n=t.visualElement.mediaPlayer;n.setCurrentTime(t.get("attr").cue_in)}}),n}),define("modules/share",["app","backbone"],function(e,t){var n={};return n.View=t.View.extend({template:"share",className:"BGB-overlay",events:{"click .close-modal":"close"},close:function(){this.model.play(),this.remove()}}),n}),define("modules/titles",["app","backbone","modules/share"],function(e,t,n){var r={};return r.View=t.View.extend({visible:!0,template:"titles",className:"BGB-player-titles",seqTitle:"",titlebarHeight:84,titlebarHidden:!0,serialize:function(){return _.extend({title:""},{title:this.seqTitle,seqTitle:this.seqDescription})},initialize:function(){var e=this;_.bindAll(this,"showTitlebar","hideTitlebar","showOnHover"),this.model.on("frame_rendered",this.render,this),this.model.on("data_loaded",this.render,this),this.model.on("sequence_enter",_.after(2,function(){this.showTitlebar(7e3)}),this),this.model.on("sequence_enter",this.getSequenceTitle,this),this.model.on("media_timeupdate",this.onTimeupdate,this),$("body").on("mousemove",_.debounce(this.showOnHover,100))},events:{"click .share":"share","click .fullscreen":"fullscreen","click .play-pause":"playPause"},share:function(){return this.model.pause(),this.shareView||(this.shareView=new n.View({model:this.model})),$("body").append(this.shareView.el),this.shareView.render(),!1},fullscreen:function(){return docElm=document.getElementById("body-main"),docElm.requestFullscreen?docElm.requestFullscreen():docElm.mozRequestFullScreen?docElm.mozRequestFullScreen():docElm.webkitRequestFullScreen&&docElm.webkitRequestFullScreen(),this.$("#project-fullscreen-toggle i").removeClass("icon-resize-full").addClass("icon-resize-small"),!1},afterRender:function(){this.titlebarHeight=this.$el.height()},onTimeupdate:function(e){var t,n;e.cue_in&&e.cue_out?(n=e.cue_out-e.cue_in,t=e.current_time-e.cue_in):e.cue_out?(n=e.cue_out,t=e.current_time):(n=e.duration,t=e.current_time),this.$(".elapsed-bar").css("width",t/n*100+"%"),this.$(".time-elapsed").text(this._convertTime(t)),this.$(".time-duration").text(this._convertTime(n))},_convertTime:function(e){var t=Math.floor(e/60),n=Math.floor(e%60);return n<10&&(n="0"+n),t+":"+n},showOnHover:function(e){this.hideTimerRunning||(e.pageY>window.innerHeight-this.titlebarHeight&&this.titlebarHidden?this.showTitlebar():e.pageY<window.innerHeight-this.titlebarHeight&&!this.titlebarHidden&&this.hideTitlebar())},showTitlebar:function(e){this.titlebarHidden=!1,this.hideTimerRunning&&(clearTimeout(this.hideTimer),this.hideTimerRunning=!1),this.$el.stop().animate({bottom:0},500),e&&(this.hideTimer=setTimeout(this.hideTitlebar,e),this.hideTimerRunning=!0)},hideTitlebar:function(){this.titlebarHidden=!0,this.hideTimerRunning=!1,this.$el.stop().animate({bottom:this.titlebarHeight*-1},500)},getSequenceTitle:function(e){this.seqTitle=e.title?e.title:"",this.seqDescription=e.description?e.description:"",this.render()},playPause:function(){e.player.playPause(),this.$(".play-pause").toggleClass("play")}}),r}),define("modules/collection-popup",["app","backbone"],function(e,t){var n={};n.View=t.View.extend({template:"zeega-popup",className:"ZEEGA-popup",events:{"click .continue-arrow":"continueSequence","click .continue":"closeCaption","click .skip":"continueSequence"},initialize:function(){this.collectionModel=new r({id:this.options.collection_id}),this.collectionModel.fetch().success(function(e){this.$(".popup-title").text(this.collectionModel.get("title"))}.bind(this))},serialize:function(){return{id:this.options.collection_id,name:"",caption:this.options.caption||""}},afterRender:function(){this.initPlayer()},initPlayer:function(){this.player=new Zeega.player({target:this.$(".ZEEGA-popup-project-target"),autoplay:!0,layerOptions:{slideshow:{display:!0,bleed:!1}},url:localStorage.api+"/items/"+this.options.collection_id+"/items"}),this.player.on("all",function(e,t){e!="media_timeupdate"&&console.log("    zeega popup event:",e,t)})},continueSequence:function(){e.player.cueNext()},skipGallery:function(){this.dispose(),this.closeCaption()},dispose:function(){var e=this;this.player.destroy()},closeCaption:function(){return this.$(".caption").fadeOut(function(){$(this).remove()}),!1}});var r=t.Model.extend({url:function(){return localStorage.api+"/items/"+this.id},parse:function(e){return e.items[0]}});return n}),define("modules/bgb-end",["app","backbone"],function(e,t){var n={};return n.View=t.View.extend({template:"bgb-end",className:"BGB-end",serialize:function(){return{rndImgUrl:e.endImageUrl}}}),n}),define("modules/ui",["app","backbone","modules/loader","modules/controls","modules/titles","modules/collection-popup","modules/bgb-end"],function(e,t,n,r,i,s,o){var u={},a=3e3;return u.Layout=t.LayoutView.extend({el:"#main",template:"ui-base",initialize:function(){e.player.on("frame_rendered",this.checkForCollectionFrame,this),e.player.on("frame_rendered",this.updateContinue,this),e.player.on("deadend_frame",this.showBGBEnd,this),this.loader=new n.View({model:e.player}),this.controls=new r.View({model:e.player}),this.titles=new i.View({model:e.player}),this.insertView(this.loader),this.insertView(this.controls),this.insertView(this.titles),this.render()},afterRender:function(){e.state.set("base_rendered",!0)},updateContinue:function(e){e.attr.advance?this.$(".continue-arrow").removeClass("show"):this.$(".continue-arrow").addClass("show")},checkForCollectionFrame:function(e){this.popup&&(this.popup.player.on("player_destroyed",function(){this.popup.remove(),this.popup=null},this),this.popup.dispose()),e.id==28729?(this.popup=new s.View({collection_id:67060,caption:"In the oil patch, there are lots of pickups. And lots of pickup truck stickers. This gallery shows a sampling of those for sale on the sticker bus and those spotted on trucks and cars. Warning: Some are lewd and crude. <span class='emphasis'>Viewer discretion advised.</span>"}),this.insertView(this.popup),this.popup.render()):e.id==31018?(this.popup=new s.View({collection_id:67034}),this.insertView(this.popup),this.popup.render()):e.id==30928?this.controls.remove():e.id==31358&&this.showBGBEnd()},showBGBEnd:function(){this.ending||(this.ending=new o.View,this.insertView(this.ending),this.ending.render())},events:{"mouseenter .bgb-logo":"onMouseOverLogo","mouseout .bgb-logo":"onMouseOutLogo"},onMouseOverLogo:function(){this.$(".bgb-logo img").attr("src","assets/img/bgblogo-hover.png")},onMouseOutLogo:function(){this.$(".bgb-logo img").attr("src","assets/img/bgblogo.png")}}),u}),define("modules/controller",["app","backbone","modules/state","modules/ui"],function(e,t,n,r){var i={};return i.Model=t.Model.extend({initialize:function(){this.initPlayer(),e.state=new n,e.layout=new r.Layout},initPlayer:function(){var t=new Zeega.player({window_fit:!0,autoplay:!1,keyboard:!0,preloadRadius:5,startFrame:27708,url:localStorage.api+"/items/69795"});t.on("frame_rendered window_resized",this.updateYoutubeSize,this),e.player=t},updateYoutubeSize:function(){_.delay(function(){var e=window.innerHeight*(16/9),t=(window.innerWidth-e)/2;$(".ZEEGA-player .visual-element-video").css({height:window.innerHeight,width:e,left:t})},0)}}),i}),define("router",["app","modules/controller","zeegaplayer"],function(e,t){var n=Backbone.Router.extend({routes:{"":"base","project/:project_id":"goToProject","p/:project_id":"goToProject","project/:project_id/frame/:frame_id":"goToProjectFrame","p/:project_id/f/:frame_id":"goToProjectFrame"},base:function(){i()},goToProject:function(t){i(),e.state.set("project_id",t)},goToProjectFrame:function(t,n){i(),e.state.set({project_id:t,frame_id:n})}}),r=function(){new t.Model},i=_.once(r);return n}),window.Modernizr=function(e,t,n){function L(e){a.cssText=e}function A(e,t){return L(h.join(e+";")+(t||""))}function O(e,t){return typeof e===t}function M(e,t){return!!~(""+e).indexOf(t)}function _(e,t,r){for(var i in e){var s=t[e[i]];if(s!==n)return r===!1?e[i]:O(s,"function")?s.bind(r||t):s}return!1}function D(){i.input=function(n){for(var r=0,i=n.length;r<i;r++)b[n[r]]=n[r]in f;return b.list&&(b.list=!!t.createElement("datalist")&&!!e.HTMLDataListElement),b}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),i.inputtypes=function(e){for(var r=0,i,o,u,a=e.length;r<a;r++)f.setAttribute("type",o=e[r]),i=f.type!=="text",i&&(f.value=l,f.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(o)&&f.style.WebkitAppearance!==n?(s.appendChild(f),u=t.defaultView,i=u.getComputedStyle&&u.getComputedStyle(f,null).WebkitAppearance!=="textfield"&&f.offsetHeight!==0,s.removeChild(f)):/^(search|tel)$/.test(o)||(/^(url|email)$/.test(o)?i=f.checkValidity&&f.checkValidity()===!1:i=f.value!=l)),y[e[r]]=!!i;return y}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var r="2.6.2",i={},s=t.documentElement,o="modernizr",u=t.createElement(o),a=u.style,f=t.createElement("input"),l=":)",c={}.toString,h=" -webkit- -moz- -o- -ms- ".split(" "),p="Webkit Moz O ms",d=p.split(" "),v=p.toLowerCase().split(" "),m={svg:"http://www.w3.org/2000/svg"},g={},y={},b={},w=[],E=w.slice,S,x=function(e,n,r,i){var u,a,f,l,c=t.createElement("div"),h=t.body,p=h||t.createElement("body");if(parseInt(r,10))while(r--)f=t.createElement("div"),f.id=i?i[r]:o+(r+1),c.appendChild(f);return u=["&#173;",'<style id="s',o,'">',e,"</style>"].join(""),c.id=o,(h?c:p).innerHTML+=u,p.appendChild(c),h||(p.style.background="",p.style.overflow="hidden",l=s.style.overflow,s.style.overflow="hidden",s.appendChild(p)),a=n(c,e),h?c.parentNode.removeChild(c):(p.parentNode.removeChild(p),s.style.overflow=l),!!a},T=function(t){var n=e.matchMedia||e.msMatchMedia;if(n)return n(t).matches;var r;return x("@media "+t+" { #"+o+" { position: absolute; } }",function(t){r=(e.getComputedStyle?getComputedStyle(t,null):t.currentStyle)["position"]=="absolute"}),r},N=function(){function r(r,i){i=i||t.createElement(e[r]||"div"),r="on"+r;var s=r in i;return s||(i.setAttribute||(i=t.createElement("div")),i.setAttribute&&i.removeAttribute&&(i.setAttribute(r,""),s=O(i[r],"function"),O(i[r],"undefined")||(i[r]=n),i.removeAttribute(r))),i=null,s}var e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return r}(),C={}.hasOwnProperty,k;!O(C,"undefined")&&!O(C.call,"undefined")?k=function(e,t){return C.call(e,t)}:k=function(e,t){return t in e&&O(e.constructor.prototype[t],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(t){var n=this;if(typeof n!="function")throw new TypeError;var r=E.call(arguments,1),i=function(){if(this instanceof i){var e=function(){};e.prototype=n.prototype;var s=new e,o=n.apply(s,r.concat(E.call(arguments)));return Object(o)===o?o:s}return n.apply(t,r.concat(E.call(arguments)))};return i}),g.canvas=function(){var e=t.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")},g.canvastext=function(){return!!i.canvas&&!!O(t.createElement("canvas").getContext("2d").fillText,"function")},g.webgl=function(){return!!e.WebGLRenderingContext},g.touch=function(){var n;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?n=!0:x(["@media (",h.join("touch-enabled),("),o,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(e){n=e.offsetTop===9}),n},g.geolocation=function(){return"geolocation"in navigator},g.postmessage=function(){return!!e.postMessage},g.websqldatabase=function(){return!!e.openDatabase},g.hashchange=function(){return N("hashchange",e)&&(t.documentMode===n||t.documentMode>7)},g.history=function(){return!!e.history&&!!history.pushState},g.draganddrop=function(){var e=t.createElement("div");return"draggable"in e||"ondragstart"in e&&"ondrop"in e},g.websockets=function(){return"WebSocket"in e||"MozWebSocket"in e},g.video=function(){var e=t.createElement("video"),n=!1;try{if(n=!!e.canPlayType)n=new Boolean(n),n.ogg=e.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),n.h264=e.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),n.webm=e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")}catch(r){}return n},g.audio=function(){var e=t.createElement("audio"),n=!1;try{if(n=!!e.canPlayType)n=new Boolean(n),n.ogg=e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),n.mp3=e.canPlayType("audio/mpeg;").replace(/^no$/,""),n.wav=e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),n.m4a=(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,"")}catch(r){}return n},g.localstorage=function(){try{return localStorage.setItem(o,o),localStorage.removeItem(o),!0}catch(e){return!1}},g.sessionstorage=function(){try{return sessionStorage.setItem(o,o),sessionStorage.removeItem(o),!0}catch(e){return!1}},g.webworkers=function(){return!!e.Worker},g.applicationcache=function(){return!!e.applicationCache},g.svg=function(){return!!t.createElementNS&&!!t.createElementNS(m.svg,"svg").createSVGRect},g.inlinesvg=function(){var e=t.createElement("div");return e.innerHTML="<svg/>",(e.firstChild&&e.firstChild.namespaceURI)==m.svg},g.smil=function(){return!!t.createElementNS&&/SVGAnimate/.test(c.call(t.createElementNS(m.svg,"animate")))},g.svgclippaths=function(){return!!t.createElementNS&&/SVGClipPath/.test(c.call(t.createElementNS(m.svg,"clipPath")))};for(var P in g)k(g,P)&&(S=P.toLowerCase(),i[S]=g[P](),w.push((i[S]?"":"no-")+S));return i.input||D(),i.addTest=function(e,t){if(typeof e=="object")for(var r in e)k(e,r)&&i.addTest(r,e[r]);else{e=e.toLowerCase();if(i[e]!==n)return i;t=typeof t=="function"?t():t,typeof enableClasses!="undefined"&&enableClasses&&(s.className+=" "+(t?"":"no-")+e),i[e]=t}return i},L(""),u=f=null,function(e,t){function l(e,t){var n=e.createElement("p"),r=e.getElementsByTagName("head")[0]||e.documentElement;return n.innerHTML="x<style>"+t+"</style>",r.insertBefore(n.lastChild,r.firstChild)}function c(){var e=g.elements;return typeof e=="string"?e.split(" "):e}function h(e){var t=a[e[o]];return t||(t={},u++,e[o]=u,a[u]=t),t}function p(e,n,s){n||(n=t);if(f)return n.createElement(e);s||(s=h(n));var o;return s.cache[e]?o=s.cache[e].cloneNode():i.test(e)?o=(s.cache[e]=s.createElem(e)).cloneNode():o=s.createElem(e),o.canHaveChildren&&!r.test(e)?s.frag.appendChild(o):o}function d(e,n){e||(e=t);if(f)return e.createDocumentFragment();n=n||h(e);var r=n.frag.cloneNode(),i=0,s=c(),o=s.length;for(;i<o;i++)r.createElement(s[i]);return r}function v(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(n){return g.shivMethods?p(n,e,t):t.createElem(n)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+c().join().replace(/\w+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(g,t.frag)}function m(e){e||(e=t);var n=h(e);return g.shivCSS&&!s&&!n.hasCSS&&(n.hasCSS=!!l(e,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),f||v(e,n),e}var n=e.html5||{},r=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,i=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,s,o="_html5shiv",u=0,a={},f;(function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",s="hidden"in e,f=e.childNodes.length==1||function(){t.createElement("a");var e=t.createDocumentFragment();return typeof e.cloneNode=="undefined"||typeof e.createDocumentFragment=="undefined"||typeof e.createElement=="undefined"}()}catch(n){s=!0,f=!0}})();var g={elements:n.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:n.shivCSS!==!1,supportsUnknownElements:f,shivMethods:n.shivMethods!==!1,type:"default",shivDocument:m,createElement:p,createDocumentFragment:d};e.html5=g,m(t)}(this,t),i._version=r,i._prefixes=h,i._domPrefixes=v,i._cssomPrefixes=d,i.mq=T,i.hasEvent=N,i.testStyles=x,i}(this,this.document),define("modernizr",function(e){return function(){var t,n;return t||e.Modernizr}}(this)),require(["app","router","modernizr"],function(e,t,n){n.canvas||(window.location.pathname="old-browser.html"),e.router=new t,Backbone.history.start({pushState:!1,root:e.root}),$(document).on("click","a:not([data-bypass])",function(t){var n={prop:$(this).prop("href"),attr:$(this).attr("href")},r=location.protocol+"//"+location.host+e.root;n.prop&&n.prop.slice(0,r.length)===r&&(t.preventDefault(),Backbone.history.navigate(n.attr,!0))})}),define("main",function(){}),require.config({deps:["zeegaplayer","main"],paths:{libs:"../assets/js/libs",plugins:"../assets/js/plugins",vendor:"../assets/vendor",lodash:"../assets/js/libs/lodash",backbone:"../assets/js/libs/backbone",zeega:"../assets/js/zeega",zeegaplayer:"../assets/vendor/zeegaplayer/dist/debug/zeega",modernizr:"../assets/js/libs/modernizr"},shim:{backbone:{deps:["lodash"],exports:"Backbone"},"plugins/backbone.layoutmanager":["backbone"],zeegaplayer:["backbone"],modernizr:{exports:"Modernizr"}}}),define("config",function(){});