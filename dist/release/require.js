var requirejs,require,define;(function(e){function a(e,t){var n,r,i,o,u,a,f,l,c,h,p=t&&t.split("/"),d=s.map,v=d&&d["*"]||{};if(e&&e.charAt(0)==="."&&t){p=p.slice(0,p.length-1),e=p.concat(e.split("/"));for(l=0;l<e.length;l+=1){h=e[l];if(h===".")e.splice(l,1),l-=1;else if(h===".."){if(l===1&&(e[2]===".."||e[0]===".."))return!0;l>0&&(e.splice(l-1,2),l-=2)}}e=e.join("/")}if((p||v)&&d){n=e.split("/");for(l=n.length;l>0;l-=1){r=n.slice(0,l).join("/");if(p)for(c=p.length;c>0;c-=1){i=d[p.slice(0,c).join("/")];if(i){i=i[r];if(i){o=i,u=l;break}}}if(o)break;!a&&v&&v[r]&&(a=v[r],f=l)}!o&&a&&(o=a,u=f),o&&(n.splice(0,u,o),e=n.join("/"))}return e}function f(t,r){return function(){return n.apply(e,u.call(arguments,0).concat([t,r]))}}function l(e){return function(t){return a(t,e)}}function c(e){return function(t){r[e]=t}}function h(n){if(i.hasOwnProperty(n)){var s=i[n];delete i[n],o[n]=!0,t.apply(e,s)}if(!r.hasOwnProperty(n))throw new Error("No "+n);return r[n]}function p(e,t){var n,r,i=e.indexOf("!");return i!==-1?(n=a(e.slice(0,i),t),e=e.slice(i+1),r=h(n),r&&r.normalize?e=r.normalize(e,l(t)):e=a(e,t)):e=a(e,t),{f:n?n+"!"+e:e,n:e,p:r}}function d(e){return function(){return s&&s.config&&s.config[e]||{}}}var t,n,r={},i={},s={},o={},u=[].slice;t=function(t,n,s,u){var a,l,v,m,g,y=[],b;u=u||t;if(typeof s=="function"){n=!n.length&&s.length?["require","exports","module"]:n;for(g=0;g<n.length;g+=1){m=p(n[g],u),l=m.f;if(l==="require")y[g]=f(t);else if(l==="exports")y[g]=r[t]={},b=!0;else if(l==="module")a=y[g]={id:t,uri:"",exports:r[t],config:d(t)};else if(r.hasOwnProperty(l)||i.hasOwnProperty(l))y[g]=h(l);else if(m.p)m.p.load(m.n,f(u,!0),c(l),{}),y[g]=r[l];else if(!o[l])throw new Error(t+" missing "+l)}v=s.apply(r[t],y);if(t)if(a&&a.exports!==e&&a.exports!==r[t])r[t]=a.exports;else if(v!==e||!b)r[t]=v}else t&&(r[t]=s)},requirejs=require=n=function(r,i,o,u,a){return typeof r=="string"?h(p(r,i).f):(r.splice||(s=r,i.splice?(r=i,i=o,o=null):r=e),i=i||function(){},typeof o=="function"&&(o=u,u=a),u?t(e,r,i,o):setTimeout(function(){t(e,r,i,o)},15),n)},n.config=function(e){return s=e,n},define=function(e,t,n){t.splice||(n=t,t=[]),i[e]=[e,t,n]},define.amd={jQuery:!0}})(),this.JST=this.JST||{},this.JST["app/templates/bgb-end.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="<div class='END-inner-wrapper'>\n  <div class='headline'>\n    THANKS FOR WATCHING<br/>ROUGH RIDE\n  </div>\n\n  <div class='end-actions'>\n    <a href='http://blackgoldboom.com' target='blank' class='visit-link'>VISIT THE FULL SITE FOR<br/>MORE STORIES</a>\n    <a class='share-icons' target='blank' href='http://twitter.com/share?text=Check%20out%20Black%20Gold%20Boom&url=http://www.blackgoldboom.org/'><img src='assets/img/twitter-large.png'/></a>\n        \n    <a class='share-icons' target='blank' href='http://www.facebook.com/sharer.php?u=http://www.blackgoldboom.com/'><img src='assets/img/facebook-large.png'/></a>\n    <a class='share-icons' target='blank' href='mailto:your-friend@example.com?subject=Black%20Gold%20Boom!&body=http://www.blackgoldboom.com/'><img src='assets/img/email-large.png'/></a>\n  </div>\n</div>\n<div class='END-footer'>\n  Brought to you by Prairie Public, Zeega, and Localore, a national initiative produced by AIR, with financial support from the Corporation for Public Broadcasting, the Wyncote Foundation, the John D. and Catherine T. MacArthur Foundation, and the National Endowment for the Arts.\n</div>\n<div class=\"END-bg\" style=\"background: url("+rndImgUrl+'); background-position: 50% 50%; background-repeat: no-repeat no-repeat; background-attachment: fixed; -webkit-background-size: cover; -moz-background-size: cover; -o-background-size: cover; background-size: cover;"></div>\n';return __p},this.JST["app/templates/bgbloader.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+='<div class="loader-content">\n	<div class="logo">\n		<div class="logo-splat"></div>\n        <div class="logo-splat-under"></div>\n	</div>\n	<div class="intro-text">\n		<p>Rumble. Screech. Bam.</p>\n		<p>For the next 20 minutes or so, you\'ll see and hear stories from North Dakota oil country.</p>\n		<p>This interactive documentary has 9 chapters, each with its own video. Plus there are songs, data and tips from people working there.</p>\n		<p>Let\'s go.</p>\n		<div class=\'fullscreen-loader\'>\n			GET THE BEST EXPERIENCE IN\n			<a href=\'#\' class=\'fullscreen\'> <img src="assets/img/fullscreen-icon.png" width="12" height="12"> FULL SCREEN</strong>\n		</div>\n	</div>\n</div>\n<div class="loader-logo-shelf">\n	<a href="http://www.prairiepublic.org/" target="_blank"><img src="assets/img/logos/logo-prarie-public.png"  width="86" height="66" alt="Prarie Public"></a>\n	<a href="http://2belowzero.org/" target="_blank"><img src="assets/img/logos/logo-2-below-zero.png" width="71" height="62" alt="2 below zero"></a>\n	<a href="http://www.airmediaworks.org/" target="_blank"><img src="assets/img/logos/logo-air.png" width="61" height="39" alt="AIR"></a>\n	<a href="http://airmediaworks.org/localore" target="_blank"><img src="assets/img/logos/logo-localore.png" width="153" height="34" alt="Localore"></a>\n	<a href="http://zeega.org/" target="_blank"><img src="assets/img/logos/logo-zeega.png" width="101" height="31" alt="Zeega"></a>\n</div>\n<div class="ZEEGA-loader-bg" style="background: url('+rndImgUrl+'); background-position: 50% 50%; background-repeat: no-repeat no-repeat; background-attachment: fixed; -webkit-background-size: cover; -moz-background-size: cover; -o-background-size: cover; background-size: cover;"></div>';return __p},this.JST["app/templates/controls.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="<div class=\"nav-box\">\n    <a class='prev-arrow'></a>\n    <a class='next-arrow'></a>\n    <div class='arrow-text'></div>\n</div>";return __p},this.JST["app/templates/share.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="  <div class='overlay-wrapper'>\n    <div class='BGB-overlay-title'><h2>SHARE BLACK GOLD BOOM'S ROUGH RIDE</h2></div>\n    <a href='#' class='close-modal'><h3>close</h3></a>\n\n\n    <div class='BGB-overlay-content-wrapper-plain clearfix'>\n\n      <a class='share-icons' target='blank' href='http://twitter.com/share?text=Check%20out%20Black%20Gold%20Boom&url=http://roughride.blackgoldboom.com/'><img src='assets/img/twitter-large.png'/></a>\n        \n      <a class='share-icons' target='blank' href='http://www.facebook.com/sharer.php?u=http://roughride.blackgoldboom.com/'><img src='assets/img/facebook-large.png'/></a>\n      <a class='share-icons' target='blank' href='mailto:your-friend@example.com?subject=Black%20Gold%20Boom!&body=http://roughride.blackgoldboom.com/'><img src='assets/img/email-large.png'/></a>\n      <br/>\n\n    </div>\n  </div>";return __p},this.JST["app/templates/titles.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="<a href='#' class='play-pause'></a>\n<div class='title-bar-above'>\n  <div class='title-level'>\n    <h1>"+title+"</h1>\n    <div class='elapsed'>\n      <span class='time-elapsed'>1:23</span> / <span class='time-duration'>4:56</span>\n    </div>\n  </div>\n  <h2>"+seqTitle+"</h2>\n  <div class='aux-controls'>\n    <div class=''><a href='#' class='share'>SHARE</a></div>\n    <div class=''><a href='#' class='fullscreen'>FULLSCREEN</a></div>\n  </div>\n</div>\n<div class='elapsed-bar-wrapper'>\n  <div class='elapsed-bar'></div>\n</div>";return __p},this.JST["app/templates/ui-base.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+='<a href="http://blackgoldboom.com/" target="_blank" class="bgb-logo" title="View more stories on blackgoldboom.com">\n    <img src="assets/img/bgblogo.png" width="85" height="92" alt="Black Gold Boom">\n</a>\n<div class="block-clickthrough"></div>\n<span class="bottom-credit">powered by <a href="http://zeega.org" target="_blank">zeega</a></span>';return __p},this.JST["app/templates/zeega-popup.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="<h1 class='popup-title'>"+name+'</h1>\n<div id="ZEEGA-popup-'+id+'" class="ZEEGA-popup-project-target"></div>\n',caption!=""&&(__p+="\n  <div class='caption'>\n    "+caption+'\n    <div class=\'actions\'>\n      <a href="#" class="continue">Ok, let me see</a>\n      <a href="#" class="skip">Skip the gallery</a>\n    </div>\n  </div>\n'),__p+="";return __p},function(e,t){function n(e){return new r(e)}function r(e){if(e&&e._wrapped)return e;this._wrapped=e}function i(e,t,n){t||(t=0);var r=e.length,i=r-t>=(n||30),s=i?{}:e;if(i){var o,u=t-1;while(++u<r)o=e[u]+"",(Yt.call(s,o)?s[o]:s[o]=[]).push(e[u])}return function(e){if(i){var n=e+"";return Yt.call(s,n)&&q(s[n],e)>-1}return q(s,e,t)>-1}}function s(){var e,t,n,r=-1,i=arguments.length,s={bottom:"",exit:"",init:"",top:"",arrayBranch:{beforeLoop:""},objectBranch:{beforeLoop:""}};while(++r<i){e=arguments[r];for(t in e)n=(n=e[t])==null?"":n,/beforeLoop|inLoop/.test(t)?(typeof n=="string"&&(n={array:n,object:n}),s.arrayBranch[t]=n.array,s.objectBranch[t]=n.object):s[t]=n}var u=s.args,a=/^[^,]+/.exec(u)[0];s.firstArg=a,s.hasDontEnumBug=bn,s.isKeysFast=Ln,s.noArgsEnum=En,s.shadowed=$t,s.useHas=s.useHas!==!1,s.useStrict=s.useStrict!==!1,"noCharByIndex"in s||(s.noCharByIndex=Tn),s.exit||(s.exit="if (!"+a+") return result");if(a!="collection"||!s.arrayBranch.inLoop)s.arrayBranch=null;var f=Function("arrayLikeClasses, ArrayProto, bind, compareAscending, concat, forIn, hasOwnProperty, identity, indexOf, isArguments, isArray, isFunction, isPlainObject, iteratorBind, objectClass, objectTypes, nativeKeys, propertyIsEnumerable, slice, stringClass, toString","var callee = function("+u+") {\n"+Hn(s)+"\n};\n"+"return callee");return f(On,Ot,rt,o,Gt,Kn,Yt,dt,q,m,Wn,g,l,c,dn,Dn,un,en,tn,mn,nn)}function o(e,n){var r=e.index,i=n.index;return e=e.criteria,n=n.criteria,e===t?1:n===t?-1:e<n?-1:e>n?1:r<i?-1:1}function u(e,t){return Qt[t]}function a(e){return"\\"+Pn[e]}function f(e){return _n[e]}function l(e,t){var n=!1;if(!e||typeof e!="object"||!t&&m(e))return n;var r=e.constructor;return(!Nn||typeof e.toString=="function"||typeof (e+"")!="string")&&(!g(r)||r instanceof r)?wn?(Kn(e,function(t,r){return n=!Yt.call(e,r),!1}),n===!1):(Kn(e,function(e,t){n=t}),n===!1||Yt.call(e,n)):n}function c(e,t){return function(n,r,i){return e.call(t,n,r,i)}}function h(){}function p(e,t){if(e&&jt.test(t))return"<e%-"+t+"%>";var n=Qt.length;return Qt[n]="' +\n__e("+t+") +\n'",Kt+n}function d(e,t,n,r){if(r){var i=Qt.length;return Qt[i]="';\n"+r+";\n__p += '",Kt+i}return t?p(null,t):v(null,n)}function v(e,t){if(e&&jt.test(t))return"<e%="+t+"%>";var n=Qt.length;return Qt[n]="' +\n((__t = ("+t+")) == null ? '' : __t) +\n'",Kt+n}function m(e){return nn.call(e)==an}function g(e){return typeof e=="function"}function y(e,t,n,r,i){if(e==null)return e;n&&(t=!1),i||(i={value:null}),i.value==null&&(i.value=!!(Mt.clone||Dt.clone||Pt.clone));var s=Dn[typeof e];if((s||i.value)&&e.clone&&g(e.clone))return i.value=null,e.clone(t);if(s){var o=nn.call(e);if(!Mn[o]||Sn&&m(e))return e;var u=o==fn;s=u||(o==dn?l(e,!0):s)}if(!s||!t)return s?u?tn.call(e):Jn({},e):e;var a=e.constructor;switch(o){case ln:return new a(e==1);case cn:return new a(+e);case pn:case mn:return new a(e);case vn:return a(e.source,Rt.exec(e))}r||(r=[]);var f=r.length;while(f--)if(r[f].source==e)return r[f].value;f=e.length;var c=u?a(f):{};r.push({value:c,source:e});if(u){var h=-1;while(++h<f)c[h]=y(e[h],t,null,r,i)}else Qn(e,function(e,n){c[n]=y(e,t,null,r,i)});return c}function b(e,t){return e?Yt.call(e,t):!1}function w(e){return e===!0||e===!1||nn.call(e)==ln}function E(e){return nn.call(e)==cn}function S(e){return e?e.nodeType===1:!1}function x(e,t,n,r){if(e==null||t==null)return e===t;r||(r={value:null}),r.value==null&&(r.value=!!(Mt.isEqual||Dt.isEqual||Pt.isEqual));if(Dn[typeof e]||Dn[typeof t]||r.value){e._chain&&(e=e._wrapped),t._chain&&(t=t._wrapped);if(e.isEqual&&g(e.isEqual))return r.value=null,e.isEqual(t);if(t.isEqual&&g(t.isEqual))return r.value=null,t.isEqual(e)}if(e===t)return e!==0||1/e==1/t;var i=nn.call(e);if(i!=nn.call(t))return!1;switch(i){case ln:case cn:return+e==+t;case pn:return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case vn:case mn:return e==t+""}var s=On[i];if(Sn&&!s&&(s=m(e))&&!m(t))return!1;if(!s&&(i!=dn||Nn&&(typeof e.toString!="function"&&typeof (e+"")=="string"||typeof t.toString!="function"&&typeof (t+"")=="string")))return!1;n||(n=[]);var o=n.length;while(o--)if(n[o]==e)return!0;var u=-1,a=!0,f=0;n.push(e);if(s){f=e.length,a=f==t.length;if(a)while(f--)if(!(a=x(e[f],t[f],n,r)))break;return a}var l=e.constructor,c=t.constructor;if(l!=c&&!(g(l)&&l instanceof l&&g(c)&&c instanceof c))return!1;for(var h in e)if(Yt.call(e,h)){f++;if(!Yt.call(t,h)||!x(e[h],t[h],n,r))return!1}for(h in t)if(Yt.call(t,h)&&!(f--))return!1;if(bn)while(++u<7){h=$t[u];if(Yt.call(e,h)&&(!Yt.call(t,h)||!x(e[h],t[h],n,r)))return!1}return!0}function T(e){return on(e)&&nn.call(e)==pn}function N(e){return e?Dn[typeof e]:!1}function C(e){return nn.call(e)==pn&&e!=+e}function k(e){return e===null}function L(e){return nn.call(e)==pn}function A(e){return nn.call(e)==vn}function O(e){return nn.call(e)==mn}function M(e){return e===t}function _(e){var t={};if(!e)return t;var n,r=0,i=Gt.apply(Ot,arguments),s=i.length;while(++r<s)n=i[r],n in e&&(t[n]=e[n]);return t}function D(e){if(!e)return 0;var t=nn.call(e),n=e.length;return On[t]||Sn&&m(e)||t==dn&&n>-1&&n===n>>>0&&g(e.splice)?n:Zn(e).length}function P(e,t,n,r){if(!e)return n;var i=e.length,s=arguments.length<3;r&&(t=c(t,r));if(i>-1&&i===i>>>0){var o=Tn&&nn.call(e)==mn?e.split(""):e;i&&s&&(n=o[--i]);while(i--)n=t(n,o[i],i,e);return n}var u,a=Zn(e);i=a.length,i&&s&&(n=e[a[--i]]);while(i--)u=a[i],n=t(n,e[u],u,e);return n}function H(e){if(!e)return[];if(e.toArray&&g(e.toArray))return e.toArray();var t=e.length;return t>-1&&t===t>>>0?(xn?nn.call(e)==mn:typeof e=="string")?e.split(""):tn.call(e):tr(e)}function B(e){var t=[];if(!e)return t;var n=-1,r=e.length;while(++n<r)e[n]&&t.push(e[n]);return t}function j(e){var t=[];if(!e)return t;var n=-1,r=e.length,s=Gt.apply(t,arguments),o=i(s,r);while(++n<r)o(e[n])||t.push(e[n]);return t}function F(e,t,n){if(e)return t==null||n?e[0]:tn.call(e,0,t)}function I(e,t){var n=[];if(!e)return n;var r,i=-1,s=e.length;while(++i<s)r=e[i],Wn(r)?Zt.apply(n,t?r:I(r)):n.push(r);return n}function q(e,t,n){if(!e)return-1;var r=-1,i=e.length;if(n){if(typeof n!="number")return r=Q(e,t),e[r]===t?r:-1;r=(n<0?Math.max(0,i+n):n)-1}while(++r<i)if(e[r]===t)return r;return-1}function R(e,t,n){return e?tn.call(e,0,-(t==null||n?1:t)):[]}function U(e){var t=[];if(!e)return t;var n,r=-1,s=e.length,o=tn.call(arguments,1),u=[];while(++r<s)n=e[r],q(t,n)<0&&ir(o,function(e,t){return(u[t]||(u[t]=i(e)))(n)})&&t.push(n);return t}function z(e,t,n){if(e){var r=e.length;return t==null||n?e[r-1]:tn.call(e,-t||r)}}function W(e,t,n){if(!e)return-1;var r=e.length;n&&typeof n=="number"&&(r=(n<0?Math.max(0,r+n):Math.min(n,r-1))+1);while(r--)if(e[r]===t)return r;return-1}function X(e,t,n){var r=-Infinity,i=r;if(!e)return i;var s,o=-1,u=e.length;if(!t){while(++o<u)e[o]>i&&(i=e[o]);return i}n&&(t=c(t,n));while(++o<u)s=t(e[o],o,e),s>r&&(r=s,i=e[o]);return i}function V(e,t,n){var r=Infinity,i=r;if(!e)return i;var s,o=-1,u=e.length;if(!t){while(++o<u)e[o]<i&&(i=e[o]);return i}n&&(t=c(t,n));while(++o<u)s=t(e[o],o,e),s<r&&(r=s,i=e[o]);return i}function $(e,t,n){e=+e||0,n=+n||1,t==null&&(t=e,e=0);var r=-1,i=Math.max(0,Math.ceil((t-e)/n)),s=Array(i);while(++r<i)s[r]=e,e+=n;return s}function J(e,t,n){return e?tn.call(e,t==null||n?1:t):[]}function K(e){if(!e)return[];var t,n=-1,r=e.length,i=Array(r);while(++n<r)t=Math.floor(Math.random()*(n+1)),i[n]=i[t],i[t]=e[n];return i}function Q(e,t,n,r){if(!e)return 0;var i,s=0,o=e.length;if(n){r&&(n=rt(n,r)),t=n(t);while(s<o)i=s+o>>>1,n(e[i])<t?s=i+1:o=i}else while(s<o)i=s+o>>>1,e[i]<t?s=i+1:o=i;return s}function G(){var e=-1,t=[],n=Gt.apply(t,arguments),r=n.length;while(++e<r)q(t,n[e])<0&&t.push(n[e]);return t}function Y(e,t,n,r){var i=[];if(!e)return i;var s,o=-1,u=e.length,a=[];typeof t=="function"&&(r=n,n=t,t=!1),n?r&&(n=c(n,r)):n=dt;while(++o<u){s=n(e[o],o,e);if(t?!o||a[a.length-1]!==s:q(a,s)<0)a.push(s),i.push(e[o])}return i}function Z(e){var t=[];if(!e)return t;var n=-1,r=e.length,s=i(arguments,1,20);while(++n<r)s(e[n])||t.push(e[n]);return t}function et(e){if(!e)return[];var t=-1,n=X(cr(arguments,"length")),r=Array(n);while(++t<n)r[t]=cr(arguments,t);return r}function tt(e,t){if(!e)return{};var n=-1,r=e.length,i={};t||(t=[]);while(++n<r)i[e[n]]=t[n];return i}function nt(e,t){return e<1?t():function(){if(--e<1)return t.apply(this,arguments)}}function rt(e,t){function n(){var o=arguments,u=t;i||(e=t[r]),s.length&&(o=o.length?s.concat(tn.call(o)):s);if(this instanceof n){h.prototype=e.prototype,u=new h;var a=e.apply(u,o);return a&&Dn[typeof a]?a:u}return e.apply(u,o)}var r,i=g(e);if(!i)r=t,t=e;else if(kn||rn&&arguments.length>2)return rn.call.apply(rn,arguments);var s=tn.call(arguments,2);return n}function it(){var e=arguments;return function(){var t=arguments,n=e.length;while(n--)t=[e[n].apply(this,t)];return t[0]}}function st(e,t,n){function r(){u=null,n||e.apply(o,i)}var i,s,o,u;return function(){var a=n&&!u;return i=arguments,o=this,gn(u),u=yn(r,t),a&&(s=e.apply(o,i)),s}}function ot(e,n){var r=tn.call(arguments,2);return yn(function(){return e.apply(t,r)},n)}function ut(e){var n=tn.call(arguments,1);return yn(function(){return e.apply(t,n)},1)}function at(e,t){var n={};return function(){var r=t?t.apply(this,arguments):arguments[0];return Yt.call(n,r)?n[r]:n[r]=e.apply(this,arguments)}}function ft(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}}function lt(e){var t=tn.call(arguments,1),n=t.length;return function(){var r,i=arguments;return i.length&&(t.length=n,Zt.apply(t,i)),r=t.length==1?e.call(this,t[0]):e.apply(this,t),t.length=n,r}}function ct(e,t){function n(){u=new Date,o=null,e.apply(s,r)}var r,i,s,o,u=0;return function(){var a=new Date,f=t-(a-u);return r=arguments,s=this,f<=0?(u=a,i=e.apply(s,r)):o||(o=yn(n,f)),i}}function ht(e,t){return function(){var n=[e];return arguments.length&&Zt.apply(n,arguments),t.apply(this,n)}}function pt(e){return e==null?"":(e+"").replace(Xt,f)}function dt(e){return e}function vt(e){ur(Gn(e),function(t){var i=n[t]=e[t];r.prototype[t]=function(){var e=[this._wrapped];arguments.length&&Zt.apply(e,arguments);var t=i.apply(n,e);return this._chain&&(t=new r(t),t._chain=!0),t}})}function mt(){return e._=Bt,this}function gt(e,t){if(!e)return null;var n=e[t];return g(n)?e[t]():n}function yt(e,t,r){r||(r={}),e+="";var i,s,o=r.escape,f=r.evaluate,l=r.interpolate,c=n.templateSettings,h=r.variable||c.variable,m=h;o==null&&(o=c.escape),f==null&&(f=c.evaluate||!1),l==null&&(l=c.interpolate),o&&(e=e.replace(o,p)),l&&(e=e.replace(l,v)),f!=Nt&&(Nt=f,Lt=RegExp("<e%-([\\s\\S]+?)%>|<e%=([\\s\\S]+?)%>"+(f?"|"+f.source:""),"g")),i=Qt.length,e=e.replace(Lt,d),i=i!=Qt.length,e="__p += '"+e.replace(Vt,a).replace(Wt,u)+"';\n",Qt.length=0,m||(h=Ct||"obj",i?e="with ("+h+") {\n"+e+"\n}\n":(h!=Ct&&(Ct=h,kt=RegExp("(\\(\\s*)"+h+"\\."+h+"\\b","g")),e=e.replace(Ut,"$&"+h+".").replace(kt,"$1__d"))),e=(i?e.replace(Ft,""):e).replace(It,"$1").replace(qt,"$1;"),e="function("+h+") {\n"+(m?"":h+" || ("+h+" = {});\n")+"var __t, __p = '', __e = _.escape"+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":(m?"":", __d = "+h+"."+h+" || "+h)+";\n")+e+"return __p\n}",An&&(e+="\n//@ sourceURL=/lodash/template/source["+Jt++ +"]");try{s=Function("_","return "+e)(n)}catch(g){s=function(){throw g}}return t?s(t):(s.source=e,s)}function bt(e,t,n){var r=-1;if(n)while(++r<e)t.call(n,r);else while(++r<e)t(r)}function wt(e){var t=Ht++;return e?e+t:t}function Et(e){return e=new r(e),e._chain=!0,e}function St(e,t){return t(e),e}function xt(){return this._chain=!0,this}function Tt(){return this._wrapped}var Nt,Ct,kt,Lt,At=typeof exports=="object"&&exports&&(typeof global=="object"&&global&&global==global.global&&(e=global),exports),Ot=Array.prototype,Mt=Boolean.prototype,_t=Object.prototype,Dt=Number.prototype,Pt=String.prototype,Ht=0,Bt=e._,jt=/[-+=!~*%&^<>|{(\/]|\[\D|\b(?:delete|in|instanceof|new|typeof|void)\b/,Ft=/\b__p \+= '';/g,It=/\b(__p \+=) '' \+/g,qt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Rt=/\w*$/,Ut=/(?:__e|__t = )\(\s*(?![\d\s"']|this\.)/g,zt=RegExp("^"+(_t.valueOf+"").replace(/[.*+?^=!:${}()|[\]\/\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),Wt=/__token__(\d+)/g,Xt=/[&<"']/g,Vt=/['\n\r\t\u2028\u2029\\]/g,$t=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Jt=0,Kt="__token__",Qt=[],Gt=Ot.concat,Yt=_t.hasOwnProperty,Zt=Ot.push,en=_t.propertyIsEnumerable,tn=Ot.slice,nn=_t.toString,rn=zt.test(rn=tn.bind)&&rn,sn=zt.test(sn=Array.isArray)&&sn,on=e.isFinite,un=zt.test(un=Object.keys)&&un,an="[object Arguments]",fn="[object Array]",ln="[object Boolean]",cn="[object Date]",hn="[object Function]",pn="[object Number]",dn="[object Object]",vn="[object RegExp]",mn="[object String]",gn=e.clearTimeout,yn=e.setTimeout,bn,wn,En=!0;(function(){function e(){this.x=1}var t=[];e.prototype={valueOf:1,y:1};for(var n in new e)t.push(n);for(n in arguments)En=!n;bn=(t+"").length<4,wn=t[0]!="x"})(1);var Sn=!m(arguments),xn=tn.call("x")[0]!="x",Tn="x"[0]+Object("x")[0]!="xx";try{var Nn=({toString:0}+"",nn.call(e.document||0)==dn)}catch(Cn){}var kn=rn&&/\n|Opera/.test(rn+nn.call(e.opera)),Ln=un&&/^.+$|true/.test(un+!!e.attachEvent);try{var An=(Function("//@cc_on !")(),!0)}catch(Cn){}var On={};On[ln]=On[cn]=On[hn]=On[pn]=On[dn]=On[vn]=!1,On[an]=On[fn]=On[mn]=!0;var Mn={};Mn[an]=Mn[hn]=!1,Mn[fn]=Mn[ln]=Mn[cn]=Mn[pn]=Mn[dn]=Mn[vn]=Mn[mn]=!0;var _n={"&":"&amp;","<":"&lt;",'"':"&quot;","'":"&#x27;"},Dn={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,"undefined":!1,unknown:!0},Pn={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"};n.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,variable:""};var Hn=yt("<% if (useStrict) { %>'use strict';\n<% } %>var index, value, iteratee = <%= firstArg %>, result<% if (init) { %> = <%= init %><% } %>;\n<%= exit %>;\n<%= top %>;\n<% if (arrayBranch) { %>var length = iteratee.length; index = -1;  <% if (objectBranch) { %>\nif (length > -1 && length === length >>> 0) {<% } %>  <% if (noCharByIndex) { %>\n  if (toString.call(iteratee) == stringClass) {\n    iteratee = iteratee.split('')\n  }  <% } %>\n  <%= arrayBranch.beforeLoop %>;\n  while (++index < length) {\n    value = iteratee[index];\n    <%= arrayBranch.inLoop %>\n  }  <% if (objectBranch) { %>\n}<% } %><% } %><% if (objectBranch) { %>  <% if (arrayBranch) { %>\nelse {  <%  } else if (noArgsEnum) { %>\n  var length = iteratee.length; index = -1;\n  if (length && isArguments(iteratee)) {\n    while (++index < length) {\n      value = iteratee[index += ''];\n      <%= objectBranch.inLoop %>\n    }\n  } else {  <% } %>  <% if (!hasDontEnumBug) { %>\n  var skipProto = typeof iteratee == 'function' && \n    propertyIsEnumerable.call(iteratee, 'prototype');\n  <% } %>  <% if (isKeysFast && useHas) { %>\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iteratee] ? nativeKeys(iteratee) : [],\n      length = ownProps.length;\n\n  <%= objectBranch.beforeLoop %>;\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n    <% if (!hasDontEnumBug) { %>if (!(skipProto && index == 'prototype')) {\n  <% } %>    value = iteratee[index];\n    <%= objectBranch.inLoop %>\n    <% if (!hasDontEnumBug) { %>}\n<% } %>  }  <% } else { %>\n  <%= objectBranch.beforeLoop %>;\n  for (index in iteratee) {    <% if (hasDontEnumBug) { %>\n    <%   if (useHas) { %>if (hasOwnProperty.call(iteratee, index)) {\n  <% } %>    value = iteratee[index];\n    <%= objectBranch.inLoop %>;\n    <%   if (useHas) { %>}<% } %>    <% } else { %>\n    if (!(skipProto && index == 'prototype')<% if (useHas) { %> &&\n        hasOwnProperty.call(iteratee, index)<% } %>) {\n      value = iteratee[index];\n      <%= objectBranch.inLoop %>\n    }    <% } %>\n  }  <% } %>  <% if (hasDontEnumBug) { %>\n\n  var ctor = iteratee.constructor;\n    <% for (var k = 0; k < 7; k++) { %>\n  index = '<%= shadowed[k] %>';\n  if (<%      if (shadowed[k] == 'constructor') {        %>!(ctor && ctor.prototype === iteratee) && <%      } %>hasOwnProperty.call(iteratee, index)) {\n    value = iteratee[index];\n    <%= objectBranch.inLoop %>\n  }    <% } %>  <% } %>  <% if (arrayBranch || noArgsEnum) { %>\n}<% } %><% } %>\n<%= bottom %>;\nreturn result"),Bn={args:"collection, callback, thisArg",init:"collection",top:"if (!callback) {\n  callback = identity\n}\nelse if (thisArg) {\n  callback = iteratorBind(callback, thisArg)\n}",inLoop:"if (callback(value, index, collection) === false) return result"},jn={init:"{}",top:"var prop;\nif (typeof callback != 'function') {\n  var valueProp = callback;\n  callback = function(value) { return value[valueProp] }\n}\nelse if (thisArg) {\n  callback = iteratorBind(callback, thisArg)\n}",inLoop:"prop = callback(value, index, collection);\n(hasOwnProperty.call(result, prop) ? result[prop]++ : result[prop] = 1)"},Fn={init:"true",inLoop:"if (!callback(value, index, collection)) return !result"},In={useHas:!1,useStrict:!1,args:"object",init:"object",top:"for (var argsIndex = 1, argsLength = arguments.length; argsIndex < argsLength; argsIndex++) {\n  if (iteratee = arguments[argsIndex]) {",inLoop:"result[index] = value",bottom:"  }\n}"},qn={init:"[]",inLoop:"callback(value, index, collection) && result.push(value)"},Rn={top:"if (thisArg) callback = iteratorBind(callback, thisArg)"},Un={inLoop:{object:Bn.inLoop}},zn={init:"",exit:"if (!collection) return []",beforeLoop:{array:"result = Array(length)",object:"result = "+(Ln?"Array(length)":"[]")},inLoop:{array:"result[index] = callback(value, index, collection)",object:"result"+(Ln?"[ownIndex] = ":".push")+"(callback(value, index, collection))"}};Sn&&(m=function(e){return!!e&&!!Yt.call(e,"callee")});var Wn=sn||function(e){return nn.call(e)==fn};g(/x/)&&(g=function(e){return nn.call(e)==hn});var Xn=s({args:"object",init:"[]",inLoop:"result.push(index)"}),Vn=s(In,{inLoop:"if (result[index] == null) "+In.inLoop}),$n=s({useHas:!1,args:"object",init:"{}",top:"var props = concat.apply(ArrayProto, arguments)",inLoop:"if (indexOf(props, index) < 0) result[index] = value"}),Jn=s(In),Kn=s(Bn,Rn,Un,{useHas:!1}),Qn=s(Bn,Rn,Un),Gn=s({useHas:!1,args:"object",init:"[]",inLoop:"if (isFunction(value)) result.push(index)",bottom:"result.sort()"}),Yn=s({args:"value",init:"true",top:"var className = toString.call(value),\n    length = value.length;\nif (arrayLikeClasses[className]"+(Sn?" || isArguments(value)":"")+" ||\n"+"  (className == objectClass && length > -1 && length === length >>> 0 &&\n"+"  isFunction(value.splice))"+") return !length",inLoop:{object:"return false"}}),Zn=un?function(e){var t=typeof e;return t=="function"&&en.call(e,"prototype")?Xn(e):e&&Dn[t]?un(e):[]}:Xn,er=s(In,{args:"object, source, indicator, stack",top:"var destValue, found, isArr, stackLength, recursive = indicator == isPlainObject;\nif (!recursive) stack = [];\nfor (var argsIndex = 1, argsLength = recursive ? 2 : arguments.length; argsIndex < argsLength; argsIndex++) {\n  if (iteratee = arguments[argsIndex]) {",inLoop:"if (value && ((isArr = isArray(value)) || isPlainObject(value))) {\n  found = false; stackLength = stack.length;\n  while (stackLength--) {\n    if (found = stack[stackLength].source == value) break\n  }\n  if (found) {\n    result[index] = stack[stackLength].value\n  } else {\n    destValue = (destValue = result[index]) && isArr\n      ? (isArray(destValue) ? destValue : [])\n      : (isPlainObject(destValue) ? destValue : {});\n    stack.push({ value: destValue, source: value });\n    result[index] = callee(destValue, value, isPlainObject, stack)\n  }\n} else if (value != null) {\n  result[index] = value\n}"}),tr=s({args:"object",init:"[]",inLoop:"result.push(value)"}),nr=s({args:"collection, target",init:"false",noCharByIndex:!1,beforeLoop:{array:"if (toString.call(iteratee) == stringClass) return collection.indexOf(target) > -1"},inLoop:"if (value === target) return true"}),rr=s(Bn,jn),ir=s(Bn,Fn),sr=s(Bn,qn),or=s(Bn,Rn,{init:"",inLoop:"if (callback(value, index, collection)) return value"}),ur=s(Bn,Rn),ar=s(Bn,jn,{inLoop:"prop = callback(value, index, collection);\n(hasOwnProperty.call(result, prop) ? result[prop] : result[prop] = []).push(value)"}),fr=s(zn,{args:"collection, methodName",top:"var args = slice.call(arguments, 2),\n    isFunc = typeof methodName == 'function'",inLoop:{array:"result[index] = (isFunc ? methodName : value[methodName]).apply(value, args)",object:"result"+(Ln?"[ownIndex] = ":".push")+"((isFunc ? methodName : value[methodName]).apply(value, args))"}}),lr=s(Bn,zn),cr=s(zn,{args:"collection, property",inLoop:{array:"result[index] = value[property]",object:"result"+(Ln?"[ownIndex] = ":".push")+"(value[property])"}}),hr=s({args:"collection, callback, accumulator, thisArg",init:"accumulator",top:"var noaccum = arguments.length < 3;\nif (thisArg) callback = iteratorBind(callback, thisArg)",beforeLoop:{array:"if (noaccum) result = collection[++index]"},inLoop:{array:"result = callback(result, value, index, collection)",object:"result = noaccum\n  ? (noaccum = false, value)\n  : callback(result, value, index, collection)"}}),pr=s(Bn,qn,{inLoop:"!"+qn.inLoop}),dr=s(Bn,Fn,{init:"false",inLoop:Fn.inLoop.replace("!","")}),vr=s(Bn,jn,zn,{inLoop:{array:"result[index] = {\n  criteria: callback(value, index, collection),\n  index: index,\n  value: value\n}",object:"result"+(Ln?"[ownIndex] = ":".push")+"({\n"+"  criteria: callback(value, index, collection),\n"+"  index: index,\n"+"  value: value\n"+"})"},bottom:"result.sort(compareAscending);\nlength = result.length;\nwhile (length--) {\n  result[length] = result[length].value\n}"}),mr=s(qn,{args:"collection, properties",top:"var pass, prop, propIndex, props = [];\nforIn(properties, function(value, prop) { props.push(prop) });\nvar propsLength = props.length",inLoop:"for (pass = true, propIndex = 0; propIndex < propsLength; propIndex++) {\n  prop = props[propIndex];\n  if (!(pass = value[prop] === properties[prop])) break\n}\nif (pass) result.push(value)"}),gr=s({useHas:!1,useStrict:!1,args:"object",init:"object",top:"var funcs = arguments,\n    length = funcs.length;\nif (length > 1) {\n  for (var index = 1; index < length; index++) {\n    result[funcs[index]] = bind(result[funcs[index]], result)\n  }\n  return result\n}",inLoop:"if (isFunction(result[index])) {\n  result[index] = bind(result[index], result)\n}"});n.VERSION="0.5.2",n.after=nt,n.bind=rt,n.bindAll=gr,n.chain=Et,n.clone=y,n.compact=B,n.compose=it,n.contains=nr,n.countBy=rr,n.debounce=st,n.defaults=Vn,n.defer=ut,n.delay=ot,n.difference=j,n.drop=$n,n.escape=pt,n.every=ir,n.extend=Jn,n.filter=sr,n.find=or,n.first=F,n.flatten=I,n.forEach=ur,n.forIn=Kn,n.forOwn=Qn,n.functions=Gn,n.groupBy=ar,n.has=b,n.identity=dt,n.indexOf=q,n.initial=R,n.intersection=U,n.invoke=fr,n.isArguments=m,n.isArray=Wn,n.isBoolean=w,n.isDate=E,n.isElement=S,n.isEmpty=Yn,n.isEqual=x,n.isFinite=T,n.isFunction=g,n.isNaN=C,n.isNull=k,n.isNumber=L,n.isObject=N,n.isRegExp=A,n.isString=O,n.isUndefined=M,n.keys=Zn,n.last=z,n.lastIndexOf=W,n.map=lr,n.max=X,n.memoize=at,n.merge=er,n.min=V,n.mixin=vt,n.noConflict=mt,n.once=ft,n.partial=lt,n.pick=_,n.pluck=cr,n.range=$,n.reduce=hr,n.reduceRight=P,n.reject=pr,n.rest=J,n.result=gt,n.shuffle=K,n.size=D,n.some=dr,n.sortBy=vr,n.sortedIndex=Q,n.tap=St,n.template=yt,n.throttle=ct,n.times=bt,n.toArray=H,n.union=G,n.uniq=Y,n.uniqueId=wt,n.values=tr,n.where=mr,n.without=Z,n.wrap=ht,n.zip=et,n.zipObject=tt,n.all=ir,n.any=dr,n.collect=lr,n.detect=or,n.each=ur,n.foldl=hr,n.foldr=P,n.head=F,n.include=nr,n.inject=hr,n.methods=Gn,n.select=sr,n.tail=J,n.take=F,n.unique=Y,n._iteratorTemplate=Hn,n._shimKeys=Xn,r.prototype=n.prototype,vt(n),r.prototype.chain=xt,r.prototype.value=Tt,ur(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=Ot[e];r.prototype[e]=function(){var e=this._wrapped;return t.apply(e,arguments),e.length===0&&delete e[0],this._chain&&(e=new r(e),e._chain=!0),e}}),ur(["concat","join","slice"],function(e){var t=Ot[e];r.prototype[e]=function(){var e=this._wrapped,n=t.apply(e,arguments);return this._chain&&(n=new r(n),n._chain=!0),n}}),typeof define=="function"&&typeof define.amd=="object"&&define.amd?(e._=n,define("lodash",[],function(){return n})):At?typeof module=="object"&&module&&module.exports==At?(module.exports=n)._=n:At._=n:e._=n}(this),function(){var e=this,t=e.Backbone,n=Array.prototype.slice,r=Array.prototype.splice,i;typeof exports!="undefined"?i=exports:i=e.Backbone={},i.VERSION="0.9.2";var s=e._;!s&&typeof require!="undefined"&&(s=require("underscore"));var o=e.jQuery||e.Zepto||e.ender;i.setDomLibrary=function(e){o=e},i.noConflict=function(){return e.Backbone=t,this},i.emulateHTTP=!1,i.emulateJSON=!1;var u=/\s+/,a=i.Events={on:function(e,t,n){var r,i,s,o,a;if(!t)return this;e=e.split(u),r=this._callbacks||(this._callbacks={});while(i=e.shift())a=r[i],s=a?a.tail:{},s.next=o={},s.context=n,s.callback=t,r[i]={tail:o,next:a?a.next:s};return this},off:function(e,t,n){var r,i,o,a,f,l;if(!(i=this._callbacks))return;if(!(e||t||n))return delete this._callbacks,this;e=e?e.split(u):s.keys(i);while(r=e.shift()){o=i[r],delete i[r];if(!o||!t&&!n)continue;a=o.tail;while((o=o.next)!==a)f=o.callback,l=o.context,(t&&f!==t||n&&l!==n)&&this.on(r,f,l)}return this},trigger:function(e){var t,r,i,s,o,a,f;if(!(i=this._callbacks))return this;a=i.all,e=e.split(u),f=n.call(arguments,1);while(t=e.shift()){if(r=i[t]){s=r.tail;while((r=r.next)!==s)r.callback.apply(r.context||this,f)}if(r=a){s=r.tail,o=[t].concat(f);while((r=r.next)!==s)r.callback.apply(r.context||this,o)}}return this}};a.bind=a.on,a.unbind=a.off;var f=i.Model=function(e,t){var n;e||(e={}),t&&t.parse&&(e=this.parse(e));if(n=C(this,"defaults"))e=s.extend({},n,e);t&&t.collection&&(this.collection=t.collection),this.attributes={},this._escapedAttributes={},this.cid=s.uniqueId("c"),this.changed={},this._silent={},this._pending={},this.set(e,{silent:!0}),this.changed={},this._silent={},this._pending={},this._previousAttributes=s.clone(this.attributes),this.initialize.apply(this,arguments)};s.extend(f.prototype,a,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return s.clone(this.attributes)},get:function(e){return this.attributes[e]},escape:function(e){var t;if(t=this._escapedAttributes[e])return t;var n=this.get(e);return this._escapedAttributes[e]=s.escape(n==null?"":""+n)},has:function(e){return this.get(e)!=null},set:function(e,t,n){var r,i,o;s.isObject(e)||e==null?(r=e,n=t):(r={},r[e]=t),n||(n={});if(!r)return this;r instanceof f&&(r=r.attributes);if(n.unset)for(i in r)r[i]=void 0;if(!this._validate(r,n))return!1;this.idAttribute in r&&(this.id=r[this.idAttribute]);var u=n.changes={},a=this.attributes,l=this._escapedAttributes,c=this._previousAttributes||{};for(i in r){o=r[i];if(!s.isEqual(a[i],o)||n.unset&&s.has(a,i))delete l[i],(n.silent?this._silent:u)[i]=!0;n.unset?delete a[i]:a[i]=o,!s.isEqual(c[i],o)||s.has(a,i)!=s.has(c,i)?(this.changed[i]=o,n.silent||(this._pending[i]=!0)):(delete this.changed[i],delete this._pending[i])}return n.silent||this.change(n),this},unset:function(e,t){return(t||(t={})).unset=!0,this.set(e,null,t)},clear:function(e){return(e||(e={})).unset=!0,this.set(s.clone(this.attributes),e)},fetch:function(e){e=e?s.clone(e):{};var t=this,n=e.success;return e.success=function(r,i,s){if(!t.set(t.parse(r,s),e))return!1;n&&n(t,r)},e.error=i.wrapError(e.error,t,e),(this.sync||i.sync).call(this,"read",this,e)},save:function(e,t,n){var r,o;s.isObject(e)||e==null?(r=e,n=t):(r={},r[e]=t),n=n?s.clone(n):{};if(n.wait){if(!this._validate(r,n))return!1;o=s.clone(this.attributes)}var u=s.extend({},n,{silent:!0});if(r&&!this.set(r,n.wait?u:n))return!1;var a=this,f=n.success;n.success=function(e,t,i){var o=a.parse(e,i);n.wait&&(delete n.wait,o=s.extend(r||{},o));if(!a.set(o,n))return!1;f?f(a,e):a.trigger("sync",a,e,n)},n.error=i.wrapError(n.error,a,n);var l=this.isNew()?"create":"update",c=(this.sync||i.sync).call(this,l,this,n);return n.wait&&this.set(o,u),c},destroy:function(e){e=e?s.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};if(this.isNew())return r(),!1;e.success=function(i){e.wait&&r(),n?n(t,i):t.trigger("sync",t,i,e)},e.error=i.wrapError(e.error,t,e);var o=(this.sync||i.sync).call(this,"delete",this,e);return e.wait||r(),o},url:function(){var e=C(this,"urlRoot")||C(this.collection,"url")||k();return this.isNew()?e:e+(e.charAt(e.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(e){e||(e={});var t=this._changing;this._changing=!0;for(var n in this._silent)this._pending[n]=!0;var r=s.extend({},e.changes,this._silent);this._silent={};for(var n in r)this.trigger("change:"+n,this,this.get(n),e);if(t)return this;while(!s.isEmpty(this._pending)){this._pending={},this.trigger("change",this,e);for(var n in this.changed){if(this._pending[n]||this._silent[n])continue;delete this.changed[n]}this._previousAttributes=s.clone(this.attributes)}return this._changing=!1,this},hasChanged:function(e){return arguments.length?s.has(this.changed,e):!s.isEmpty(this.changed)},changedAttributes:function(e){if(!e)return this.hasChanged()?s.clone(this.changed):!1;var t,n=!1,r=this._previousAttributes;for(var i in e){if(s.isEqual(r[i],t=e[i]))continue;(n||(n={}))[i]=t}return n},previous:function(e){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return s.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(e,t){if(t.silent||!this.validate)return!0;e=s.extend({},this.attributes,e);var n=this.validate(e,t);return n?(t&&t.error?t.error(this,n,t):this.trigger("error",this,n,t),!1):!0}});var l=i.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,{silent:!0,parse:t.parse})};s.extend(l.prototype,a,{model:f,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},add:function(e,t){var n,i,o,u,a,f,l={},c={},h=[];t||(t={}),e=s.isArray(e)?e.slice():[e];for(n=0,o=e.length;n<o;n++){if(!(u=e[n]=this._prepareModel(e[n],t)))throw new Error("Can't add an invalid model to a collection");a=u.cid,f=u.id;if(l[a]||this._byCid[a]||f!=null&&(c[f]||this._byId[f])){h.push(n);continue}l[a]=c[f]=u}n=h.length;while(n--)e.splice(h[n],1);for(n=0,o=e.length;n<o;n++)(u=e[n]).on("all",this._onModelEvent,this),this._byCid[u.cid]=u,u.id!=null&&(this._byId[u.id]=u);this.length+=o,i=t.at!=null?t.at:this.models.length,r.apply(this.models,[i,0].concat(e)),this.comparator&&this.sort({silent:!0});if(t.silent)return this;for(n=0,o=this.models.length;n<o;n++){if(!l[(u=this.models[n]).cid])continue;t.index=n,u.trigger("add",u,this,t)}return this},remove:function(e,t){var n,r,i,o;t||(t={}),e=s.isArray(e)?e.slice():[e];for(n=0,r=e.length;n<r;n++){o=this.getByCid(e[n])||this.get(e[n]);if(!o)continue;delete this._byId[o.id],delete this._byCid[o.cid],i=this.indexOf(o),this.models.splice(i,1),this.length--,t.silent||(t.index=i,o.trigger("remove",o,this,t)),this._removeReference(o)}return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,t),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,s.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},get:function(e){return e==null?void 0:this._byId[e.id!=null?e.id:e]},getByCid:function(e){return e&&this._byCid[e.cid||e]},at:function(e){return this.models[e]},where:function(e){return s.isEmpty(e)?[]:this.filter(function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},sort:function(e){e||(e={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");var t=s.bind(this.comparator,this);return this.comparator.length==1?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("reset",this,e),this},pluck:function(e){return s.map(this.models,function(t){return t.get(e)})},reset:function(e,t){e||(e=[]),t||(t={});for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return this._reset(),this.add(e,s.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},fetch:function(e){e=e?s.clone(e):{},e.parse===undefined&&(e.parse=!0);var t=this,n=e.success;return e.success=function(r,i,s){t[e.add?"add":"reset"](t.parse(r,s),e),n&&n(t,r)},e.error=i.wrapError(e.error,t,e),(this.sync||i.sync).call(this,"read",this,e)},create:function(e,t){var n=this;t=t?s.clone(t):{},e=this._prepareModel(e,t);if(!e)return!1;t.wait||n.add(e,t);var r=t.success;return t.success=function(i,s,o){t.wait&&n.add(i,t),r?r(i,s):i.trigger("sync",e,s,t)},e.save(null,t),e},parse:function(e,t){return e},chain:function(){return s(this.models).chain()},_reset:function(e){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(e,t){t||(t={});if(e instanceof f)e.collection||(e.collection=this);else{var n=e;t.collection=this,e=new this.model(n,t),e._validate(e.attributes,t)||(e=!1)}return e},_removeReference:function(e){this==e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e=="add"||e=="remove")&&n!=this)return;e=="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],this._byId[t.id]=t),this.trigger.apply(this,arguments)}});var c=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];s.each(c,function(e){l.prototype[e]=function(){return s[e].apply(s,[this.models].concat(s.toArray(arguments)))}});var h=i.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},p=/:\w+/g,d=/\*\w+/g,v=/[-[\]{}()+?.,\\^$|#\s]/g;s.extend(h.prototype,a,{initialize:function(){},route:function(e,t,n){return i.history||(i.history=new m),s.isRegExp(e)||(e=this._routeToRegExp(e)),n||(n=this[t]),i.history.route(e,s.bind(function(r){var s=this._extractParameters(e,r);n&&n.apply(this,s),this.trigger.apply(this,["route:"+t].concat(s)),i.history.trigger("route",this,t,s)},this)),this},navigate:function(e,t){i.history.navigate(e,t)},_bindRoutes:function(){if(!this.routes)return;var e=[];for(var t in this.routes)e.unshift([t,this.routes[t]]);for(var n=0,r=e.length;n<r;n++)this.route(e[n][0],e[n][1],this[e[n][1]])},_routeToRegExp:function(e){return e=e.replace(v,"\\$&").replace(p,"([^/]+)").replace(d,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var m=i.History=function(){this.handlers=[],s.bindAll(this,"checkUrl")},g=/^[#\/]/,y=/msie [\w.]+/;m.started=!1,s.extend(m.prototype,a,{interval:50,getHash:function(e){var t=e?e.location:window.location,n=t.href.match(/#(.*)$/);return n?n[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||t){e=window.location.pathname;var n=window.location.search;n&&(e+=n)}else e=this.getHash();return e.indexOf(this.options.root)||(e=e.substr(this.options.root.length)),e.replace(g,"")},start:function(e){if(m.started)throw new Error("Backbone.history has already been started");m.started=!0,this.options=s.extend({},{root:"/"},this.options,e),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var t=this.getFragment(),n=document.documentMode,r=y.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);r&&(this.iframe=o('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?o(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?o(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=window.location,u=i.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!u)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&u&&i.hash&&(this.fragment=this.getHash().replace(g,""),window.history.replaceState({},document.title,i.protocol+"//"+i.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){o(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),m.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t==this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t==this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=s.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0});return n},navigate:function(e,t){if(!m.started)return!1;if(!t||t===!0)t={trigger:t};var n=(e||"").replace(g,"");if(this.fragment==n)return;this._hasPushState?(n.indexOf(this.options.root)!=0&&(n=this.options.root+n),this.fragment=n,window.history[t.replace?"replaceState":"pushState"]({},document.title,n)):this._wantsHashChange?(this.fragment=n,this._updateHash(window.location,n,t.replace),this.iframe&&n!=this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,n,t.replace))):window.location.assign(this.options.root+e),t.trigger&&this.loadUrl(e)},_updateHash:function(e,t,n){n?e.replace(e.toString().replace(/(javascript:|#).*$/,"")+"#"+t):e.hash=t}});var b=i.View=function(e){this.cid=s.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,E=["model","collection","el","id","attributes","className","tagName"];s.extend(b.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(e,t,n){var r=document.createElement(e);return t&&o(r).attr(t),n&&o(r).html(n),r},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof o?e:o(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=C(this,"events")))return;this.undelegateEvents();for(var t in e){var n=e[t];s.isFunction(n)||(n=this[e[t]]);if(!n)throw new Error('Method "'+e[t]+'" does not exist');var r=t.match(w),i=r[1],o=r[2];n=s.bind(n,this),i+=".delegateEvents"+this.cid,o===""?this.$el.bind(i,n):this.$el.delegate(o,i,n)}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=s.extend({},this.options,e));for(var t=0,n=E.length;t<n;t++){var r=E[t];e[r]&&(this[r]=e[r])}this.options=e},_ensureElement:function(){if(!this.el){var e=C(this,"attributes")||{};this.id&&(e.id=this.id),this.className&&(e["class"]=this.className),this.setElement(this.make(this.tagName,e),!1)}else this.setElement(this.el,!1)}});var S=function(e,t){var n=N(this,e,t);return n.extend=this.extend,n};f.extend=l.extend=h.extend=b.extend=S;var x={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};i.sync=function(e,t,n){var r=x[e];n||(n={});var u={type:r,dataType:"json"};return n.url||(u.url=C(t,"url")||k()),!n.data&&t&&(e=="create"||e=="update")&&(u.contentType="application/json",u.data=JSON.stringify(t.toJSON())),i.emulateJSON&&(u.contentType="application/x-www-form-urlencoded",u.data=u.data?{model:u.data}:{}),i.emulateHTTP&&(r==="PUT"||r==="DELETE")&&(i.emulateJSON&&(u.data._method=r),u.type="POST",u.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r)}),u.type!=="GET"&&!i.emulateJSON&&(u.processData=!1),o.ajax(s.extend(u,n))},i.wrapError=function(e,t,n){return function(r,i){i=r===t?i:r,e?e(t,i,n):t.trigger("error",t,i,n)}};var T=function(){},N=function(e,t,n){var r;return t&&t.hasOwnProperty("constructor")?r=t.constructor:r=function(){e.apply(this,arguments)},s.extend(r,e),T.prototype=e.prototype,r.prototype=new T,t&&s.extend(r.prototype,t),n&&s.extend(r,n),r.prototype.constructor=r,r.__super__=e.prototype,r},C=function(e,t){return!e||!e[t]?null:s.isFunction(e[t])?e[t]():e[t]},k=function(){throw new Error('A "url" property or function must be specified')}}.call(this),define("backbone",["lodash"],function(e){return function(){return e.Backbone}}(this)),this.JST=this.JST||{},this.JST["app/templates/layouts/player-layout.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="<div class='ZEEGA-player-window'></div>";return __p},this.JST["app/templates/plugins/audio.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="";return __p},this.JST["app/templates/plugins/image.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+='<img src="'+attr.uri+"\" width='100%' />";return __p},this.JST["app/templates/plugins/link.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="<a href='#' class='ZEEGA-link-inner'>\n  ",mode=="editor"&&!_.isNull(attr.to_frame)&&(__p+='\n    <i class="icon-share go-to-sequence"></i>\n  '),__p+="\n</a>";return __p},this.JST["app/templates/plugins/popup-image.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="<div class='ZEEGA-popup-click-content popup-image' style=\"\n  background: url("+attr.popup_content.uri+') no-repeat center center;\n  -webkit-background-size: contain;\n  -moz-background-size: contain;\n  -o-background-size: contain;\n  background-size: contain;\n">\n  <a href="#" class="popup-close">close</a>\n</div>\n';return __p},this.JST["app/templates/plugins/popup-video.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+='<div class=\'ZEEGA-popup-click-content popup-video\' >\n  <a href="#" class="popup-close">close</a>\n</div>\n';return __p},this.JST["app/templates/plugins/popup.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+='<a\n  href="#"\n  class="ZEEGA-popup-click-target"\n  ',attr.popup_target&&(__p+='\n  style="\n    background: url('+attr.popup_target.uri+') no-repeat center center;\n    -webkit-background-size: cover;\n    -moz-background-size: cover;\n    -o-background-size: cover;\n    background-size: cover;\n  "\n  '),__p+='\n  data-caption="',attr.popup_content&&(__p+=""+attr.popup_content.title+""),__p+='"\n  >\n  ',attr.popup_content&&(__p+="<span class=\"popup-title\" style='display:none'>"+attr.popup_content.title+"</span>"),__p+="\n</a>";return __p},this.JST["app/templates/plugins/rectangle.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="";return __p},this.JST["app/templates/plugins/slideshow-metadata.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="<div class='slide-title'>"+title+"</div>\n<div class='slide-description'>"+description+'</div>\n<a href="'+attribution_uri+"\" target='blank' class='attribution-link'>\n    <i class='slideshow-icon-"+archive.toLowerCase()+" ssarchive'></i>\n</a>\n";return __p},this.JST["app/templates/plugins/slideshow.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="<a href='#' class='slideshow-arrow arrow-left slideshow-control-prev disabled'></a>\n<a href='#' class='slideshow-arrow arrow-right slideshow-control-next'></a>\n\n<div class='slideshow-container' style='width:"+(attr.slides.length*100+"%")+"'>\n	",_.each(attr.slides,function(e,t){__p+="\n		<div class='slideshow-slide slideshow-slide-"+t+"' style='width:"+(100/attr.slides.length+"%")+";background:url("+e.attr.uri+") no-repeat center center;-webkit-background-size: ",slides_bleed?__p+="cover":__p+="contain",__p+="; -moz-background-size: ",slides_bleed?__p+="cover":__p+="contain",__p+="; -o-background-size: ",slides_bleed?__p+="cover":__p+="contain",__p+="; background-size: ",slides_bleed?__p+="cover":__p+="contain",__p+=";'></div>\n	"}),__p+="\n</div>";return __p},this.JST["app/templates/plugins/slideshowthumbslider.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="<div class='slideshow-thumb-wrapper'>\n    <ul>\n        ",_.each(attr.slides,function(e,t){__p+="\n            <li>\n                <div class='slideshow-thumbnail' style=\"background:url("+e.attr.thumbnail_url+"); background-repeat:no-repeat;background-size:100%;background-position:center\">\n                    <a href='#' class='slider-thumb' data-slidenum=\""+t+'"></a>\n                </div>\n            </li>\n        '}),__p+="\n    </ul>\n</div>";return __p},this.JST["app/templates/plugins/text.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+=""+attr.content+"";return __p},this.JST["app/templates/plugins/video.html"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+="";return __p},function(){var e;(function(){if(typeof e=="undefined"){e={};var t,n,r;(function(e){function i(e,t){var n,r,i,s,o,u,a,f,l,c,h=t&&t.split("/"),p=v.map,d=p&&p["*"]||{};if(e&&e.charAt(0)==="."&&t){h=h.slice(0,h.length-1),e=h.concat(e.split("/"));for(f=0;f<e.length;f+=1){c=e[f];if(c===".")e.splice(f,1),f-=1;else if(c===".."){if(f===1&&(e[2]===".."||e[0]===".."))return!0;f>0&&(e.splice(f-1,2),f-=2)}}e=e.join("/")}if((h||d)&&p){n=e.split("/");for(f=n.length;f>0;f-=1){r=n.slice(0,f).join("/");if(h)for(l=h.length;l>0;l-=1){i=p[h.slice(0,l).join("/")];if(i){i=i[r];if(i){s=i,o=f;break}}}if(s)break;!u&&d&&d[r]&&(u=d[r],a=f)}!s&&u&&(s=u,o=a),s&&(n.splice(0,o,s),e=n.join("/"))}return e}function s(t,n){return function(){return h.apply(e,g.call(arguments,0).concat([t,n]))}}function o(e){return function(t){return i(t,e)}}function u(e){return function(t){p[e]=t}}function a(t){if(d.hasOwnProperty(t)){var n=d[t];delete d[t],m[t]=!0,c.apply(e,n)}if(!p.hasOwnProperty(t))throw new Error("No "+t);return p[t]}function f(e,t){var n,r,s=e.indexOf("!");return s!==-1?(n=i(e.slice(0,s),t),e=e.slice(s+1),r=a(n),r&&r.normalize?e=r.normalize(e,o(t)):e=i(e,t)):e=i(e,t),{f:n?n+"!"+e:e,n:e,p:r}}function l(e){return function(){return v&&v.config&&v.config[e]||{}}}var c,h,p={},d={},v={},m={},g=[].slice;c=function(t,n,r,i){var o,c,h,v,g,y=[],b;i=i||t;if(typeof r=="function"){n=!n.length&&r.length?["require","exports","module"]:n;for(g=0;g<n.length;g+=1){v=f(n[g],i),c=v.f;if(c==="require")y[g]=s(t);else if(c==="exports")y[g]=p[t]={},b=!0;else if(c==="module")o=y[g]={id:t,uri:"",exports:p[t],config:l(t)};else if(p.hasOwnProperty(c)||d.hasOwnProperty(c))y[g]=a(c);else if(v.p)v.p.load(v.n,s(i,!0),u(c),{}),y[g]=p[c];else if(!m[c])throw new Error(t+" missing "+c)}h=r.apply(p[t],y);if(t)if(o&&o.exports!==e&&o.exports!==p[t])p[t]=o.exports;else if(h!==e||!b)p[t]=h}else t&&(p[t]=r)},t=n=h=function(t,n,r,i,s){return typeof t=="string"?a(f(t,n).f):(t.splice||(v=t,n.splice?(t=n,n=r,r=null):t=e),n=n||function(){},typeof r=="function"&&(r=i,i=s),i?c(e,t,n,r):setTimeout(function(){c(e,t,n,r)},15),h)},h.config=function(e){return v=e,h},r=function(e,t,n){t.splice||(n=t,t=[]),d[e]=[e,t,n]},r.amd={jQuery:!0}})(),e.requirejs=t,e.require=n,e.define=r}})(),e.define("../assets/js/libs/almond",function(){}),function(t,n){function r(e){return new i(e)}function i(e){if(e&&e._wrapped)return e;this._wrapped=e}function s(e,t,n){t||(t=0);var r=e.length,i=r-t>=(n||30),s=i?{}:e;if(i){var o,u=t-1;while(++u<r)o=e[u]+"",(Zt.call(s,o)?s[o]:s[o]=[]).push(e[u])}return function(e){if(i){var n=e+"";return Zt.call(s,n)&&R(s[n],e)>-1}return R(s,e,t)>-1}}function o(){var e,t,n,r=-1,i=arguments.length,s={bottom:"",exit:"",init:"",top:"",arrayBranch:{beforeLoop:""},objectBranch:{beforeLoop:""}};while(++r<i){e=arguments[r];for(t in e)n=(n=e[t])==null?"":n,/beforeLoop|inLoop/.test(t)?(typeof n=="string"&&(n={array:n,object:n}),s.arrayBranch[t]=n.array,s.objectBranch[t]=n.object):s[t]=n}var o=s.args,a=/^[^,]+/.exec(o)[0];s.firstArg=a,s.hasDontEnumBug=wn,s.isKeysFast=An,s.noArgsEnum=Sn,s.shadowed=Jt,s.useHas=s.useHas!==!1,s.useStrict=s.useStrict!==!1,"noCharByIndex"in s||(s.noCharByIndex=Nn),s.exit||(s.exit="if (!"+a+") return result");if(a!="collection"||!s.arrayBranch.inLoop)s.arrayBranch=null;var f=Function("arrayLikeClasses, ArrayProto, bind, compareAscending, concat, forIn, hasOwnProperty, identity, indexOf, isArguments, isArray, isFunction, isPlainObject, iteratorBind, objectClass, objectTypes, nativeKeys, propertyIsEnumerable, slice, stringClass, toString","var callee = function("+o+") {\n"+Bn(s)+"\n};\n"+"return callee");return f(Mn,Mt,it,u,Yt,Qn,Zt,vt,R,g,Xn,y,c,h,vn,Pn,an,tn,nn,gn,rn)}function u(e,t){var r=e.index,i=t.index;return e=e.criteria,t=t.criteria,e===n?1:t===n?-1:e<t?-1:e>t?1:r<i?-1:1}function a(e,t){return Gt[t]}function f(e){return"\\"+Hn[e]}function l(e){return Dn[e]}function c(e,t){var n=!1;if(!e||typeof e!="object"||!t&&g(e))return n;var r=e.constructor;return(!Cn||typeof e.toString=="function"||typeof (e+"")!="string")&&(!y(r)||r instanceof r)?En?(Qn(e,function(t,r){return n=!Zt.call(e,r),!1}),n===!1):(Qn(e,function(e,t){n=t}),n===!1||Zt.call(e,n)):n}function h(e,t){return function(n,r,i){return e.call(t,n,r,i)}}function p(){}function d(e,t){if(e&&Ft.test(t))return"<e%-"+t+"%>";var n=Gt.length;return Gt[n]="' +\n__e("+t+") +\n'",Qt+n}function v(e,t,n,r){if(r){var i=Gt.length;return Gt[i]="';\n"+r+";\n__p += '",Qt+i}return t?d(null,t):m(null,n)}function m(e,t){if(e&&Ft.test(t))return"<e%="+t+"%>";var n=Gt.length;return Gt[n]="' +\n((__t = ("+t+")) == null ? '' : __t) +\n'",Qt+n}function g(e){return rn.call(e)==fn}function y(e){return typeof e=="function"}function b(e,t,n,r,i){if(e==null)return e;n&&(t=!1),i||(i={value:null}),i.value==null&&(i.value=!!(_t.clone||Pt.clone||Ht.clone));var s=Pn[typeof e];if((s||i.value)&&e.clone&&y(e.clone))return i.value=null,e.clone(t);if(s){var o=rn.call(e);if(!_n[o]||xn&&g(e))return e;var u=o==ln;s=u||(o==vn?c(e,!0):s)}if(!s||!t)return s?u?nn.call(e):Kn({},e):e;var a=e.constructor;switch(o){case cn:return new a(e==1);case hn:return new a(+e);case dn:case gn:return new a(e);case mn:return a(e.source,Ut.exec(e))}r||(r=[]);var f=r.length;while(f--)if(r[f].source==e)return r[f].value;f=e.length;var l=u?a(f):{};r.push({value:l,source:e});if(u){var h=-1;while(++h<f)l[h]=b(e[h],t,null,r,i)}else Gn(e,function(e,n){l[n]=b(e,t,null,r,i)});return l}function w(e,t){return e?Zt.call(e,t):!1}function E(e){return e===!0||e===!1||rn.call(e)==cn}function S(e){return rn.call(e)==hn}function x(e){return e?e.nodeType===1:!1}function T(e,t,n,r){if(e==null||t==null)return e===t;r||(r={value:null}),r.value==null&&(r.value=!!(_t.isEqual||Pt.isEqual||Ht.isEqual));if(Pn[typeof e]||Pn[typeof t]||r.value){e._chain&&(e=e._wrapped),t._chain&&(t=t._wrapped);if(e.isEqual&&y(e.isEqual))return r.value=null,e.isEqual(t);if(t.isEqual&&y(t.isEqual))return r.value=null,t.isEqual(e)}if(e===t)return e!==0||1/e==1/t;var i=rn.call(e);if(i!=rn.call(t))return!1;switch(i){case cn:case hn:return+e==+t;case dn:return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case mn:case gn:return e==t+""}var s=Mn[i];if(xn&&!s&&(s=g(e))&&!g(t))return!1;if(!s&&(i!=vn||Cn&&(typeof e.toString!="function"&&typeof (e+"")=="string"||typeof t.toString!="function"&&typeof (t+"")=="string")))return!1;n||(n=[]);var o=n.length;while(o--)if(n[o]==e)return!0;var u=-1,a=!0,f=0;n.push(e);if(s){f=e.length,a=f==t.length;if(a)while(f--)if(!(a=T(e[f],t[f],n,r)))break;return a}var l=e.constructor,c=t.constructor;if(l!=c&&!(y(l)&&l instanceof l&&y(c)&&c instanceof c))return!1;for(var h in e)if(Zt.call(e,h)){f++;if(!Zt.call(t,h)||!T(e[h],t[h],n,r))return!1}for(h in t)if(Zt.call(t,h)&&!(f--))return!1;if(wn)while(++u<7){h=Jt[u];if(Zt.call(e,h)&&(!Zt.call(t,h)||!T(e[h],t[h],n,r)))return!1}return!0}function N(e){return un(e)&&rn.call(e)==dn}function C(e){return e?Pn[typeof e]:!1}function k(e){return rn.call(e)==dn&&e!=+e}function L(e){return e===null}function A(e){return rn.call(e)==dn}function O(e){return rn.call(e)==mn}function M(e){return rn.call(e)==gn}function _(e){return e===n}function D(e){var t={};if(!e)return t;var n,r=0,i=Yt.apply(Mt,arguments),s=i.length;while(++r<s)n=i[r],n in e&&(t[n]=e[n]);return t}function P(e){if(!e)return 0;var t=rn.call(e),n=e.length;return Mn[t]||xn&&g(e)||t==vn&&n>-1&&n===n>>>0&&y(e.splice)?n:er(e).length}function H(e,t,n,r){if(!e)return n;var i=e.length,s=arguments.length<3;r&&(t=h(t,r));if(i>-1&&i===i>>>0){var o=Nn&&rn.call(e)==gn?e.split(""):e;i&&s&&(n=o[--i]);while(i--)n=t(n,o[i],i,e);return n}var u,a=er(e);i=a.length,i&&s&&(n=e[a[--i]]);while(i--)u=a[i],n=t(n,e[u],u,e);return n}function B(e){if(!e)return[];if(e.toArray&&y(e.toArray))return e.toArray();var t=e.length;return t>-1&&t===t>>>0?(Tn?rn.call(e)==gn:typeof e=="string")?e.split(""):nn.call(e):nr(e)}function j(e){var t=[];if(!e)return t;var n=-1,r=e.length;while(++n<r)e[n]&&t.push(e[n]);return t}function F(e){var t=[];if(!e)return t;var n=-1,r=e.length,i=Yt.apply(t,arguments),o=s(i,r);while(++n<r)o(e[n])||t.push(e[n]);return t}function I(e,t,n){if(e)return t==null||n?e[0]:nn.call(e,0,t)}function q(e,t){var n=[];if(!e)return n;var r,i=-1,s=e.length;while(++i<s)r=e[i],Xn(r)?en.apply(n,t?r:q(r)):n.push(r);return n}function R(e,t,n){if(!e)return-1;var r=-1,i=e.length;if(n){if(typeof n!="number")return r=G(e,t),e[r]===t?r:-1;r=(n<0?Math.max(0,i+n):n)-1}while(++r<i)if(e[r]===t)return r;return-1}function U(e,t,n){return e?nn.call(e,0,-(t==null||n?1:t)):[]}function z(e){var t=[];if(!e)return t;var n,r=-1,i=e.length,o=nn.call(arguments,1),u=[];while(++r<i)n=e[r],R(t,n)<0&&sr(o,function(e,t){return(u[t]||(u[t]=s(e)))(n)})&&t.push(n);return t}function W(e,t,n){if(e){var r=e.length;return t==null||n?e[r-1]:nn.call(e,-t||r)}}function X(e,t,n){if(!e)return-1;var r=e.length;n&&typeof n=="number"&&(r=(n<0?Math.max(0,r+n):Math.min(n,r-1))+1);while(r--)if(e[r]===t)return r;return-1}function V(e,t,n){var r=-Infinity,i=r;if(!e)return i;var s,o=-1,u=e.length;if(!t){while(++o<u)e[o]>i&&(i=e[o]);return i}n&&(t=h(t,n));while(++o<u)s=t(e[o],o,e),s>r&&(r=s,i=e[o]);return i}function $(e,t,n){var r=Infinity,i=r;if(!e)return i;var s,o=-1,u=e.length;if(!t){while(++o<u)e[o]<i&&(i=e[o]);return i}n&&(t=h(t,n));while(++o<u)s=t(e[o],o,e),s<r&&(r=s,i=e[o]);return i}function J(e,t,n){e=+e||0,n=+n||1,t==null&&(t=e,e=0);var r=-1,i=Math.max(0,Math.ceil((t-e)/n)),s=Array(i);while(++r<i)s[r]=e,e+=n;return s}function K(e,t,n){return e?nn.call(e,t==null||n?1:t):[]}function Q(e){if(!e)return[];var t,n=-1,r=e.length,i=Array(r);while(++n<r)t=Math.floor(Math.random()*(n+1)),i[n]=i[t],i[t]=e[n];return i}function G(e,t,n,r){if(!e)return 0;var i,s=0,o=e.length;if(n){r&&(n=it(n,r)),t=n(t);while(s<o)i=s+o>>>1,n(e[i])<t?s=i+1:o=i}else while(s<o)i=s+o>>>1,e[i]<t?s=i+1:o=i;return s}function Y(){var e=-1,t=[],n=Yt.apply(t,arguments),r=n.length;while(++e<r)R(t,n[e])<0&&t.push(n[e]);return t}function Z(e,t,n,r){var i=[];if(!e)return i;var s,o=-1,u=e.length,a=[];typeof t=="function"&&(r=n,n=t,t=!1),n?r&&(n=h(n,r)):n=vt;while(++o<u){s=n(e[o],o,e);if(t?!o||a[a.length-1]!==s:R(a,s)<0)a.push(s),i.push(e[o])}return i}function et(e){var t=[];if(!e)return t;var n=-1,r=e.length,i=s(arguments,1,20);while(++n<r)i(e[n])||t.push(e[n]);return t}function tt(e){if(!e)return[];var t=-1,n=V(hr(arguments,"length")),r=Array(n);while(++t<n)r[t]=hr(arguments,t);return r}function nt(e,t){if(!e)return{};var n=-1,r=e.length,i={};t||(t=[]);while(++n<r)i[e[n]]=t[n];return i}function rt(e,t){return e<1?t():function(){if(--e<1)return t.apply(this,arguments)}}function it(e,t){function n(){var o=arguments,u=t;i||(e=t[r]),s.length&&(o=o.length?s.concat(nn.call(o)):s);if(this instanceof n){p.prototype=e.prototype,u=new p;var a=e.apply(u,o);return a&&Pn[typeof a]?a:u}return e.apply(u,o)}var r,i=y(e);if(!i)r=t,t=e;else if(Ln||sn&&arguments.length>2)return sn.call.apply(sn,arguments);var s=nn.call(arguments,2);return n}function st(){var e=arguments;return function(){var t=arguments,n=e.length;while(n--)t=[e[n].apply(this,t)];return t[0]}}function ot(e,t,n){function r(){u=null,n||e.apply(o,i)}var i,s,o,u;return function(){var a=n&&!u;return i=arguments,o=this,yn(u),u=bn(r,t),a&&(s=e.apply(o,i)),s}}function ut(e,t){var r=nn.call(arguments,2);return bn(function(){return e.apply(n,r)},t)}function at(e){var t=nn.call(arguments,1);return bn(function(){return e.apply(n,t)},1)}function ft(e,t){var n={};return function(){var r=t?t.apply(this,arguments):arguments[0];return Zt.call(n,r)?n[r]:n[r]=e.apply(this,arguments)}}function lt(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}}function ct(e){var t=nn.call(arguments,1),n=t.length;return function(){var r,i=arguments;return i.length&&(t.length=n,en.apply(t,i)),r=t.length==1?e.call(this,t[0]):e.apply(this,t),t.length=n,r}}function ht(e,t){function n(){u=new Date,o=null,e.apply(s,r)}var r,i,s,o,u=0;return function(){var a=new Date,f=t-(a-u);return r=arguments,s=this,f<=0?(u=a,i=e.apply(s,r)):o||(o=bn(n,f)),i}}function pt(e,t){return function(){var n=[e];return arguments.length&&en.apply(n,arguments),t.apply(this,n)}}function dt(e){return e==null?"":(e+"").replace(Vt,l)}function vt(e){return e}function mt(e){ar(Yn(e),function(t){var n=r[t]=e[t];i.prototype[t]=function(){var e=[this._wrapped];arguments.length&&en.apply(e,arguments);var t=n.apply(r,e);return this._chain&&(t=new i(t),t._chain=!0),t}})}function gt(){return t._=jt,this}function yt(e,t){if(!e)return null;var n=e[t];return y(n)?e[t]():n}function bt(e,t,n){n||(n={}),e+="";var i,s,o=n.escape,u=n.evaluate,l=n.interpolate,c=r.templateSettings,h=n.variable||c.variable,p=h;o==null&&(o=c.escape),u==null&&(u=c.evaluate||!1),l==null&&(l=c.interpolate),o&&(e=e.replace(o,d)),l&&(e=e.replace(l,m)),u!=Ct&&(Ct=u,At=RegExp("<e%-([\\s\\S]+?)%>|<e%=([\\s\\S]+?)%>"+(u?"|"+u.source:""),"g")),i=Gt.length,e=e.replace(At,v),i=i!=Gt.length,e="__p += '"+e.replace($t,f).replace(Xt,a)+"';\n",Gt.length=0,p||(h=kt||"obj",i?e="with ("+h+") {\n"+e+"\n}\n":(h!=kt&&(kt=h,Lt=RegExp("(\\(\\s*)"+h+"\\."+h+"\\b","g")),e=e.replace(zt,"$&"+h+".").replace(Lt,"$1__d"))),e=(i?e.replace(It,""):e).replace(qt,"$1").replace(Rt,"$1;"),e="function("+h+") {\n"+(p?"":h+" || ("+h+" = {});\n")+"var __t, __p = '', __e = _.escape"+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":(p?"":", __d = "+h+"."+h+" || "+h)+";\n")+e+"return __p\n}",On&&(e+="\n//@ sourceURL=/lodash/template/source["+Kt++ +"]");try{s=Function("_","return "+e)(r)}catch(g){s=function(){throw g}}return t?s(t):(s.source=e,s)}function wt(e,t,n){var r=-1;if(n)while(++r<e)t.call(n,r);else while(++r<e)t(r)}function Et(e){var t=Bt++;return e?e+t:t}function St(e){return e=new i(e),e._chain=!0,e}function xt(e,t){return t(e),e}function Tt(){return this._chain=!0,this}function Nt(){return this._wrapped}var Ct,kt,Lt,At,Ot=typeof exports=="object"&&exports&&(typeof global=="object"&&global&&global==global.global&&(t=global),exports),Mt=Array.prototype,_t=Boolean.prototype,Dt=Object.prototype,Pt=Number.prototype,Ht=String.prototype,Bt=0,jt=t._,Ft=/[-+=!~*%&^<>|{(\/]|\[\D|\b(?:delete|in|instanceof|new|typeof|void)\b/,It=/\b__p \+= '';/g,qt=/\b(__p \+=) '' \+/g,Rt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ut=/\w*$/,zt=/(?:__e|__t = )\(\s*(?![\d\s"']|this\.)/g,Wt=RegExp("^"+(Dt.valueOf+"").replace(/[.*+?^=!:${}()|[\]\/\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),Xt=/__token__(\d+)/g,Vt=/[&<"']/g,$t=/['\n\r\t\u2028\u2029\\]/g,Jt=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Kt=0,Qt="__token__",Gt=[],Yt=Mt.concat,Zt=Dt.hasOwnProperty,en=Mt.push,tn=Dt.propertyIsEnumerable,nn=Mt.slice,rn=Dt.toString,sn=Wt.test(sn=nn.bind)&&sn,on=Wt.test(on=Array.isArray)&&on,un=t.isFinite,an=Wt.test(an=Object.keys)&&an,fn="[object Arguments]",ln="[object Array]",cn="[object Boolean]",hn="[object Date]",pn="[object Function]",dn="[object Number]",vn="[object Object]",mn="[object RegExp]",gn="[object String]",yn=t.clearTimeout,bn=t.setTimeout,wn,En,Sn=!0;(function(){function e(){this.x=1}var t=[];e.prototype={valueOf:1,y:1};for(var n in new e)t.push(n);for(n in arguments)Sn=!n;wn=(t+"").length<4,En=t[0]!="x"})(1);var xn=!g(arguments),Tn=nn.call("x")[0]!="x",Nn="x"[0]+Object("x")[0]!="xx";try{var Cn=({toString:0}+"",rn.call(t.document||0)==vn)}catch(kn){}var Ln=sn&&/\n|Opera/.test(sn+rn.call(t.opera)),An=an&&/^.+$|true/.test(an+!!t.attachEvent);try{var On=(Function("//@cc_on !")(),!0)}catch(kn){}var Mn={};Mn[cn]=Mn[hn]=Mn[pn]=Mn[dn]=Mn[vn]=Mn[mn]=!1,Mn[fn]=Mn[ln]=Mn[gn]=!0;var _n={};_n[fn]=_n[pn]=!1,_n[ln]=_n[cn]=_n[hn]=_n[dn]=_n[vn]=_n[mn]=_n[gn]=!0;var Dn={"&":"&amp;","<":"&lt;",'"':"&quot;","'":"&#x27;"},Pn={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,"undefined":!1,unknown:!0},Hn={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"};r.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,variable:""};var Bn=bt("<% if (useStrict) { %>'use strict';\n<% } %>var index, value, iteratee = <%= firstArg %>, result<% if (init) { %> = <%= init %><% } %>;\n<%= exit %>;\n<%= top %>;\n<% if (arrayBranch) { %>var length = iteratee.length; index = -1;  <% if (objectBranch) { %>\nif (length > -1 && length === length >>> 0) {<% } %>  <% if (noCharByIndex) { %>\n  if (toString.call(iteratee) == stringClass) {\n    iteratee = iteratee.split('')\n  }  <% } %>\n  <%= arrayBranch.beforeLoop %>;\n  while (++index < length) {\n    value = iteratee[index];\n    <%= arrayBranch.inLoop %>\n  }  <% if (objectBranch) { %>\n}<% } %><% } %><% if (objectBranch) { %>  <% if (arrayBranch) { %>\nelse {  <%  } else if (noArgsEnum) { %>\n  var length = iteratee.length; index = -1;\n  if (length && isArguments(iteratee)) {\n    while (++index < length) {\n      value = iteratee[index += ''];\n      <%= objectBranch.inLoop %>\n    }\n  } else {  <% } %>  <% if (!hasDontEnumBug) { %>\n  var skipProto = typeof iteratee == 'function' && \n    propertyIsEnumerable.call(iteratee, 'prototype');\n  <% } %>  <% if (isKeysFast && useHas) { %>\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iteratee] ? nativeKeys(iteratee) : [],\n      length = ownProps.length;\n\n  <%= objectBranch.beforeLoop %>;\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n    <% if (!hasDontEnumBug) { %>if (!(skipProto && index == 'prototype')) {\n  <% } %>    value = iteratee[index];\n    <%= objectBranch.inLoop %>\n    <% if (!hasDontEnumBug) { %>}\n<% } %>  }  <% } else { %>\n  <%= objectBranch.beforeLoop %>;\n  for (index in iteratee) {    <% if (hasDontEnumBug) { %>\n    <%   if (useHas) { %>if (hasOwnProperty.call(iteratee, index)) {\n  <% } %>    value = iteratee[index];\n    <%= objectBranch.inLoop %>;\n    <%   if (useHas) { %>}<% } %>    <% } else { %>\n    if (!(skipProto && index == 'prototype')<% if (useHas) { %> &&\n        hasOwnProperty.call(iteratee, index)<% } %>) {\n      value = iteratee[index];\n      <%= objectBranch.inLoop %>\n    }    <% } %>\n  }  <% } %>  <% if (hasDontEnumBug) { %>\n\n  var ctor = iteratee.constructor;\n    <% for (var k = 0; k < 7; k++) { %>\n  index = '<%= shadowed[k] %>';\n  if (<%      if (shadowed[k] == 'constructor') {        %>!(ctor && ctor.prototype === iteratee) && <%      } %>hasOwnProperty.call(iteratee, index)) {\n    value = iteratee[index];\n    <%= objectBranch.inLoop %>\n  }    <% } %>  <% } %>  <% if (arrayBranch || noArgsEnum) { %>\n}<% } %><% } %>\n<%= bottom %>;\nreturn result"),jn={args:"collection, callback, thisArg",init:"collection",top:"if (!callback) {\n  callback = identity\n}\nelse if (thisArg) {\n  callback = iteratorBind(callback, thisArg)\n}",inLoop:"if (callback(value, index, collection) === false) return result"},Fn={init:"{}",top:"var prop;\nif (typeof callback != 'function') {\n  var valueProp = callback;\n  callback = function(value) { return value[valueProp] }\n}\nelse if (thisArg) {\n  callback = iteratorBind(callback, thisArg)\n}",inLoop:"prop = callback(value, index, collection);\n(hasOwnProperty.call(result, prop) ? result[prop]++ : result[prop] = 1)"},In={init:"true",inLoop:"if (!callback(value, index, collection)) return !result"},qn={useHas:!1,useStrict:!1,args:"object",init:"object",top:"for (var argsIndex = 1, argsLength = arguments.length; argsIndex < argsLength; argsIndex++) {\n  if (iteratee = arguments[argsIndex]) {",inLoop:"result[index] = value",bottom:"  }\n}"},Rn={init:"[]",inLoop:"callback(value, index, collection) && result.push(value)"},Un={top:"if (thisArg) callback = iteratorBind(callback, thisArg)"},zn={inLoop:{object:jn.inLoop}},Wn={init:"",exit:"if (!collection) return []",beforeLoop:{array:"result = Array(length)",object:"result = "+(An?"Array(length)":"[]")},inLoop:{array:"result[index] = callback(value, index, collection)",object:"result"+(An?"[ownIndex] = ":".push")+"(callback(value, index, collection))"}};xn&&(g=function(e){return!!e&&!!Zt.call(e,"callee")});var Xn=on||function(e){return rn.call(e)==ln};y(/x/)&&(y=function(e){return rn.call(e)==pn});var Vn=o({args:"object",init:"[]",inLoop:"result.push(index)"}),$n=o(qn,{inLoop:"if (result[index] == null) "+qn.inLoop}),Jn=o({useHas:!1,args:"object",init:"{}",top:"var props = concat.apply(ArrayProto, arguments)",inLoop:"if (indexOf(props, index) < 0) result[index] = value"}),Kn=o(qn),Qn=o(jn,Un,zn,{useHas:!1}),Gn=o(jn,Un,zn),Yn=o({useHas:!1,args:"object",init:"[]",inLoop:"if (isFunction(value)) result.push(index)",bottom:"result.sort()"}),Zn=o({args:"value",init:"true",top:"var className = toString.call(value),\n    length = value.length;\nif (arrayLikeClasses[className]"+(xn?" || isArguments(value)":"")+" ||\n"+"  (className == objectClass && length > -1 && length === length >>> 0 &&\n"+"  isFunction(value.splice))"+") return !length",inLoop:{object:"return false"}}),er=an?function(e){var t=typeof e;return t=="function"&&tn.call(e,"prototype")?Vn(e):e&&Pn[t]?an(e):[]}:Vn,tr=o(qn,{args:"object, source, indicator, stack",top:"var destValue, found, isArr, stackLength, recursive = indicator == isPlainObject;\nif (!recursive) stack = [];\nfor (var argsIndex = 1, argsLength = recursive ? 2 : arguments.length; argsIndex < argsLength; argsIndex++) {\n  if (iteratee = arguments[argsIndex]) {",inLoop:"if (value && ((isArr = isArray(value)) || isPlainObject(value))) {\n  found = false; stackLength = stack.length;\n  while (stackLength--) {\n    if (found = stack[stackLength].source == value) break\n  }\n  if (found) {\n    result[index] = stack[stackLength].value\n  } else {\n    destValue = (destValue = result[index]) && isArr\n      ? (isArray(destValue) ? destValue : [])\n      : (isPlainObject(destValue) ? destValue : {});\n    stack.push({ value: destValue, source: value });\n    result[index] = callee(destValue, value, isPlainObject, stack)\n  }\n} else if (value != null) {\n  result[index] = value\n}"}),nr=o({args:"object",init:"[]",inLoop:"result.push(value)"}),rr=o({args:"collection, target",init:"false",noCharByIndex:!1,beforeLoop:{array:"if (toString.call(iteratee) == stringClass) return collection.indexOf(target) > -1"},inLoop:"if (value === target) return true"}),ir=o(jn,Fn),sr=o(jn,In),or=o(jn,Rn),ur=o(jn,Un,{init:"",inLoop:"if (callback(value, index, collection)) return value"}),ar=o(jn,Un),fr=o(jn,Fn,{inLoop:"prop = callback(value, index, collection);\n(hasOwnProperty.call(result, prop) ? result[prop] : result[prop] = []).push(value)"}),lr=o(Wn,{args:"collection, methodName",top:"var args = slice.call(arguments, 2),\n    isFunc = typeof methodName == 'function'",inLoop:{array:"result[index] = (isFunc ? methodName : value[methodName]).apply(value, args)",object:"result"+(An?"[ownIndex] = ":".push")+"((isFunc ? methodName : value[methodName]).apply(value, args))"}}),cr=o(jn,Wn),hr=o(Wn,{args:"collection, property",inLoop:{array:"result[index] = value[property]",object:"result"+(An?"[ownIndex] = ":".push")+"(value[property])"}}),pr=o({args:"collection, callback, accumulator, thisArg",init:"accumulator",top:"var noaccum = arguments.length < 3;\nif (thisArg) callback = iteratorBind(callback, thisArg)",beforeLoop:{array:"if (noaccum) result = collection[++index]"},inLoop:{array:"result = callback(result, value, index, collection)",object:"result = noaccum\n  ? (noaccum = false, value)\n  : callback(result, value, index, collection)"}}),dr=o(jn,Rn,{inLoop:"!"+Rn.inLoop}),vr=o(jn,In,{init:"false",inLoop:In.inLoop.replace("!","")}),mr=o(jn,Fn,Wn,{inLoop:{array:"result[index] = {\n  criteria: callback(value, index, collection),\n  index: index,\n  value: value\n}",object:"result"+(An?"[ownIndex] = ":".push")+"({\n"+"  criteria: callback(value, index, collection),\n"+"  index: index,\n"+"  value: value\n"+"})"},bottom:"result.sort(compareAscending);\nlength = result.length;\nwhile (length--) {\n  result[length] = result[length].value\n}"}),gr=o(Rn,{args:"collection, properties",top:"var pass, prop, propIndex, props = [];\nforIn(properties, function(value, prop) { props.push(prop) });\nvar propsLength = props.length",inLoop:"for (pass = true, propIndex = 0; propIndex < propsLength; propIndex++) {\n  prop = props[propIndex];\n  if (!(pass = value[prop] === properties[prop])) break\n}\nif (pass) result.push(value)"}),yr=o({useHas:!1,useStrict:!1,args:"object",init:"object",top:"var funcs = arguments,\n    length = funcs.length;\nif (length > 1) {\n  for (var index = 1; index < length; index++) {\n    result[funcs[index]] = bind(result[funcs[index]], result)\n  }\n  return result\n}",inLoop:"if (isFunction(result[index])) {\n  result[index] = bind(result[index], result)\n}"});r.VERSION="0.5.2",r.after=rt,r.bind=it,r.bindAll=yr,r.chain=St,r.clone=b,r.compact=j,r.compose=st,r.contains=rr,r.countBy=ir,r.debounce=ot,r.defaults=$n,r.defer=at,r.delay=ut,r.difference=F,r.drop=Jn,r.escape=dt,r.every=sr,r.extend=Kn,r.filter=or,r.find=ur,r.first=I,r.flatten=q,r.forEach=ar,r.forIn=Qn,r.forOwn=Gn,r.functions=Yn,r.groupBy=fr,r.has=w,r.identity=vt,r.indexOf=R,r.initial=U,r.intersection=z,r.invoke=lr,r.isArguments=g,r.isArray=Xn,r.isBoolean=E,r.isDate=S,r.isElement=x,r.isEmpty=Zn,r.isEqual=T,r.isFinite=N,r.isFunction=y,r.isNaN=k,r.isNull=L,r.isNumber=A,r.isObject=C,r.isRegExp=O,r.isString=M,r.isUndefined=_,r.keys=er,r.last=W,r.lastIndexOf=X,r.map=cr,r.max=V,r.memoize=ft,r.merge=tr,r.min=$,r.mixin=mt,r.noConflict=gt,r.once=lt,r.partial=ct,r.pick=D,r.pluck=hr,r.range=J,r.reduce=pr,r.reduceRight=H,r.reject=dr,r.rest=K,r.result=yt,r.shuffle=Q,r.size=P,r.some=vr,r.sortBy=mr,r.sortedIndex=G,r.tap=xt,r.template=bt,r.throttle=ht,r.times=wt,r.toArray=B,r.union=Y,r.uniq=Z,r.uniqueId=Et,r.values=nr,r.where=gr,r.without=et,r.wrap=pt,r.zip=tt,r.zipObject=nt,r.all=sr,r.any=vr,r.collect=cr,r.detect=ur,r.each=ar,r.foldl=pr,r.foldr=H,r.head=I,r.include=rr,r.inject=pr,r.methods=Yn,r.select=or,r.tail=K,r.take=I,r.unique=Z,r._iteratorTemplate=Bn,r._shimKeys=Vn,i.prototype=r.prototype,mt(r),i.prototype.chain=Tt,i.prototype.value=Nt,ar(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=Mt[e];i.prototype[e]=function(){var e=this._wrapped;return t.apply(e,arguments),e.length===0&&delete e[0],this._chain&&(e=new i(e),e._chain=!0),e}}),ar(["concat","join","slice"],function(e){var t=Mt[e];i.prototype[e]=function(){var e=this._wrapped,n=t.apply(e,arguments);return this._chain&&(n=new i(n),n._chain=!0),n}}),typeof e.define=="function"&&typeof e.define.amd=="object"&&e.define.amd?(t._=r,e.define("lodash",[],function(){return r})):Ot?typeof module=="object"&&module&&module.exports==Ot?(module.exports=r)._=r:Ot._=r:t._=r}(this),function(){var t=this,n=t.Backbone,r=Array.prototype.slice,i=Array.prototype.splice,s;typeof exports!="undefined"?s=exports:s=t.Backbone={},s.VERSION="0.9.2";var o=t._;!o&&typeof require!="undefined"&&(o=e.require("underscore"));var u=t.jQuery||t.Zepto||t.ender;s.setDomLibrary=function(e){u=e},s.noConflict=function(){return t.Backbone=n,this},s.emulateHTTP=!1,s.emulateJSON=!1;var a=/\s+/,f=s.Events={on:function(e,t,n){var r,i,s,o,u;if(!t)return this;e=e.split(a),r=this._callbacks||(this._callbacks={});while(i=e.shift())u=r[i],s=u?u.tail:{},s.next=o={},s.context=n,s.callback=t,r[i]={tail:o,next:u?u.next:s};return this},off:function(e,t,n){var r,i,s,u,f,l;if(!(i=this._callbacks))return;if(!(e||t||n))return delete this._callbacks,this;e=e?e.split(a):o.keys(i);while(r=e.shift()){s=i[r],delete i[r];if(!s||!t&&!n)continue;u=s.tail;while((s=s.next)!==u)f=s.callback,l=s.context,(t&&f!==t||n&&l!==n)&&this.on(r,f,l)}return this},trigger:function(e){var t,n,i,s,o,u,f;if(!(i=this._callbacks))return this;u=i.all,e=e.split(a),f=r.call(arguments,1);while(t=e.shift()){if(n=i[t]){s=n.tail;while((n=n.next)!==s)n.callback.apply(n.context||this,f)}if(n=u){s=n.tail,o=[t].concat(f);while((n=n.next)!==s)n.callback.apply(n.context||this,o)}}return this}};f.bind=f.on,f.unbind=f.off;var l=s.Model=function(e,t){var n;e||(e={}),t&&t.parse&&(e=this.parse(e));if(n=k(this,"defaults"))e=o.extend({},n,e);t&&t.collection&&(this.collection=t.collection),this.attributes={},this._escapedAttributes={},this.cid=o.uniqueId("c"),this.changed={},this._silent={},this._pending={},this.set(e,{silent:!0}),this.changed={},this._silent={},this._pending={},this._previousAttributes=o.clone(this.attributes),this.initialize.apply(this,arguments)};o.extend(l.prototype,f,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return o.clone(this.attributes)},get:function(e){return this.attributes[e]},escape:function(e){var t;if(t=this._escapedAttributes[e])return t;var n=this.get(e);return this._escapedAttributes[e]=o.escape(n==null?"":""+n)},has:function(e){return this.get(e)!=null},set:function(e,t,n){var r,i,s;o.isObject(e)||e==null?(r=e,n=t):(r={},r[e]=t),n||(n={});if(!r)return this;r instanceof l&&(r=r.attributes);if(n.unset)for(i in r)r[i]=void 0;if(!this._validate(r,n))return!1;this.idAttribute in r&&(this.id=r[this.idAttribute]);var u=n.changes={},a=this.attributes,f=this._escapedAttributes,c=this._previousAttributes||{};for(i in r){s=r[i];if(!o.isEqual(a[i],s)||n.unset&&o.has(a,i))delete f[i],(n.silent?this._silent:u)[i]=!0;n.unset?delete a[i]:a[i]=s,!o.isEqual(c[i],s)||o.has(a,i)!=o.has(c,i)?(this.changed[i]=s,n.silent||(this._pending[i]=!0)):(delete this.changed[i],delete this._pending[i])}return n.silent||this.change(n),this},unset:function(e,t){return(t||(t={})).unset=!0,this.set(e,null,t)},clear:function(e){return(e||(e={})).unset=!0,this.set(o.clone(this.attributes),e)},fetch:function(e){e=e?o.clone(e):{};var t=this,n=e.success;return e.success=function(r,i,s){if(!t.set(t.parse(r,s),e))return!1;n&&n(t,r)},e.error=s.wrapError(e.error,t,e),(this.sync||s.sync).call(this,"read",this,e)},save:function(e,t,n){var r,i;o.isObject(e)||e==null?(r=e,n=t):(r={},r[e]=t),n=n?o.clone(n):{};if(n.wait){if(!this._validate(r,n))return!1;i=o.clone(this.attributes)}var u=o.extend({},n,{silent:!0});if(r&&!this.set(r,n.wait?u:n))return!1;var a=this,f=n.success;n.success=function(e,t,i){var s=a.parse(e,i);n.wait&&(delete n.wait,s=o.extend(r||{},s));if(!a.set(s,n))return!1;f?f(a,e):a.trigger("sync",a,e,n)},n.error=s.wrapError(n.error,a,n);var l=this.isNew()?"create":"update",c=(this.sync||s.sync).call(this,l,this,n);return n.wait&&this.set(i,u),c},destroy:function(e){e=e?o.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};if(this.isNew())return r(),!1;e.success=function(i){e.wait&&r(),n?n(t,i):t.trigger("sync",t,i,e)},e.error=s.wrapError(e.error,t,e);var i=(this.sync||s.sync).call(this,"delete",this,e);return e.wait||r(),i},url:function(){var e=k(this,"urlRoot")||k(this.collection,"url")||L();return this.isNew()?e:e+(e.charAt(e.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(e){e||(e={});var t=this._changing;this._changing=!0;for(var n in this._silent)this._pending[n]=!0;var r=o.extend({},e.changes,this._silent);this._silent={};for(var n in r)this.trigger("change:"+n,this,this.get(n),e);if(t)return this;while(!o.isEmpty(this._pending)){this._pending={},this.trigger("change",this,e);for(var n in this.changed){if(this._pending[n]||this._silent[n])continue;delete this.changed[n]}this._previousAttributes=o.clone(this.attributes)}return this._changing=!1,this},hasChanged:function(e){return arguments.length?o.has(this.changed,e):!o.isEmpty(this.changed)},changedAttributes:function(e){if(!e)return this.hasChanged()?o.clone(this.changed):!1;var t,n=!1,r=this._previousAttributes;for(var i in e){if(o.isEqual(r[i],t=e[i]))continue;(n||(n={}))[i]=t}return n},previous:function(e){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return o.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(e,t){if(t.silent||!this.validate)return!0;e=o.extend({},this.attributes,e);var n=this.validate(e,t);return n?(t&&t.error?t.error(this,n,t):this.trigger("error",this,n,t),!1):!0}});var c=s.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,{silent:!0,parse:t.parse})};o.extend(c.prototype,f,{model:l,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},add:function(e,t){var n,r,s,u,a,f,l={},c={},h=[];t||(t={}),e=o.isArray(e)?e.slice():[e];for(n=0,s=e.length;n<s;n++){if(!(u=e[n]=this._prepareModel(e[n],t)))throw new Error("Can't add an invalid model to a collection");a=u.cid,f=u.id;if(l[a]||this._byCid[a]||f!=null&&(c[f]||this._byId[f])){h.push(n);continue}l[a]=c[f]=u}n=h.length;while(n--)e.splice(h[n],1);for(n=0,s=e.length;n<s;n++)(u=e[n]).on("all",this._onModelEvent,this),this._byCid[u.cid]=u,u.id!=null&&(this._byId[u.id]=u);this.length+=s,r=t.at!=null?t.at:this.models.length,i.apply(this.models,[r,0].concat(e)),this.comparator&&this.sort({silent:!0});if(t.silent)return this;for(n=0,s=this.models.length;n<s;n++){if(!l[(u=this.models[n]).cid])continue;t.index=n,u.trigger("add",u,this,t)}return this},remove:function(e,t){var n,r,i,s;t||(t={}),e=o.isArray(e)?e.slice():[e];for(n=0,r=e.length;n<r;n++){s=this.getByCid(e[n])||this.get(e[n]);if(!s)continue;delete this._byId[s.id],delete this._byCid[s.cid],i=this.indexOf(s),this.models.splice(i,1),this.length--,t.silent||(t.index=i,s.trigger("remove",s,this,t)),this._removeReference(s)}return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,t),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,o.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},get:function(e){return e==null?void 0:this._byId[e.id!=null?e.id:e]},getByCid:function(e){return e&&this._byCid[e.cid||e]},at:function(e){return this.models[e]},where:function(e){return o.isEmpty(e)?[]:this.filter(function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},sort:function(e){e||(e={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");var t=o.bind(this.comparator,this);return this.comparator.length==1?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("reset",this,e),this},pluck:function(e){return o.map(this.models,function(t){return t.get(e)})},reset:function(e,t){e||(e=[]),t||(t={});for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return this._reset(),this.add(e,o.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},fetch:function(e){e=e?o.clone(e):{},e.parse===undefined&&(e.parse=!0);var t=this,n=e.success;return e.success=function(r,i,s){t[e.add?"add":"reset"](t.parse(r,s),e),n&&n(t,r)},e.error=s.wrapError(e.error,t,e),(this.sync||s.sync).call(this,"read",this,e)},create:function(e,t){var n=this;t=t?o.clone(t):{},e=this._prepareModel(e,t);if(!e)return!1;t.wait||n.add(e,t);var r=t.success;return t.success=function(i,s,o){t.wait&&n.add(i,t),r?r(i,s):i.trigger("sync",e,s,t)},e.save(null,t),e},parse:function(e,t){return e},chain:function(){return o(this.models).chain()},_reset:function(e){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(e,t){t||(t={});if(e instanceof l)e.collection||(e.collection=this);else{var n=e;t.collection=this,e=new this.model(n,t),e._validate(e.attributes,t)||(e=!1)}return e},_removeReference:function(e){this==e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e=="add"||e=="remove")&&n!=this)return;e=="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],this._byId[t.id]=t),this.trigger.apply(this,arguments)}});var h=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];o.each(h,function(e){c.prototype[e]=function(){return o[e].apply(o,[this.models].concat(o.toArray(arguments)))}});var p=s.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},d=/:\w+/g,v=/\*\w+/g,m=/[-[\]{}()+?.,\\^$|#\s]/g;o.extend(p.prototype,f,{initialize:function(){},route:function(e,t,n){return s.history||(s.history=new g),o.isRegExp(e)||(e=this._routeToRegExp(e)),n||(n=this[t]),s.history.route(e,o.bind(function(r){var i=this._extractParameters(e,r);n&&n.apply(this,i),this.trigger.apply(this,["route:"+t].concat(i)),s.history.trigger("route",this,t,i)},this)),this},navigate:function(e,t){s.history.navigate(e,t)},_bindRoutes:function(){if(!this.routes)return;var e=[];for(var t in this.routes)e.unshift([t,this.routes[t]]);for(var n=0,r=e.length;n<r;n++)this.route(e[n][0],e[n][1],this[e[n][1]])},_routeToRegExp:function(e){return e=e.replace(m,"\\$&").replace(d,"([^/]+)").replace(v,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var g=s.History=function(){this.handlers=[],o.bindAll(this,"checkUrl")},y=/^[#\/]/,b=/msie [\w.]+/;g.started=!1,o.extend(g.prototype,f,{interval:50,getHash:function(e){var t=e?e.location:window.location,n=t.href.match(/#(.*)$/);return n?n[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||t){e=window.location.pathname;var n=window.location.search;n&&(e+=n)}else e=this.getHash();return e.indexOf(this.options.root)||(e=e.substr(this.options.root.length)),e.replace(y,"")},start:function(e){if(g.started)throw new Error("Backbone.history has already been started");g.started=!0,this.options=o.extend({},{root:"/"},this.options,e),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var t=this.getFragment(),n=document.documentMode,r=b.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);r&&(this.iframe=u('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?u(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?u(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=window.location,s=i.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!s)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&s&&i.hash&&(this.fragment=this.getHash().replace(y,""),window.history.replaceState({},document.title,i.protocol+"//"+i.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){u(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),g.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t==this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t==this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=o.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0});return n},navigate:function(e,t){if(!g.started)return!1;if(!t||t===!0)t={trigger:t};var n=(e||"").replace(y,"");if(this.fragment==n)return;this._hasPushState?(n.indexOf(this.options.root)!=0&&(n=this.options.root+n),this.fragment=n,window.history[t.replace?"replaceState":"pushState"]({},document.title,n)):this._wantsHashChange?(this.fragment=n,this._updateHash(window.location,n,t.replace),this.iframe&&n!=this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,n,t.replace))):window.location.assign(this.options.root+e),t.trigger&&this.loadUrl(e)},_updateHash:function(e,t,n){n?e.replace(e.toString().replace(/(javascript:|#).*$/,"")+"#"+t):e.hash=t}});var w=s.View=function(e){this.cid=o.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},E=/^(\S+)\s*(.*)$/,S=["model","collection","el","id","attributes","className","tagName"];o.extend(w.prototype,f,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(e,t,n){var r=document.createElement(e);return t&&u(r).attr(t),n&&u(r).html(n),r},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof u?e:u(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=k(this,"events")))return;this.undelegateEvents();for(var t in e){var n=e[t];o.isFunction(n)||(n=this[e[t]]);if(!n)throw new Error('Method "'+e[t]+'" does not exist');var r=t.match(E),i=r[1],s=r[2];n=o.bind(n,this),i+=".delegateEvents"+this.cid,s===""?this.$el.bind(i,n):this.$el.delegate(s,i,n)}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=o.extend({},this.options,e));for(var t=0,n=S.length;t<n;t++){var r=S[t];e[r]&&(this[r]=e[r])}this.options=e},_ensureElement:function(){if(!this.el){var e=k(this,"attributes")||{};this.id&&(e.id=this.id),this.className&&(e["class"]=this.className),this.setElement(this.make(this.tagName,e),!1)}else this.setElement(this.el,!1)}});var x=function(e,t){var n=C(this,e,t);return n.extend=this.extend,n};l.extend=c.extend=p.extend=w.extend=x;var T={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};s.sync=function(e,t,n){var r=T[e];n||(n={});var i={type:r,dataType:"json"};return n.url||(i.url=k(t,"url")||L()),!n.data&&t&&(e=="create"||e=="update")&&(i.contentType="application/json",i.data=JSON.stringify(t.toJSON())),s.emulateJSON&&(i.contentType="application/x-www-form-urlencoded",i.data=i.data?{model:i.data}:{}),s.emulateHTTP&&(r==="PUT"||r==="DELETE")&&(s.emulateJSON&&(i.data._method=r),i.type="POST",i.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r)}),i.type!=="GET"&&!s.emulateJSON&&(i.processData=!1),u.ajax(o.extend(i,n))},s.wrapError=function(e,t,n){return function(r,i){i=r===t?i:r,e?e(t,i,n):t.trigger("error",t,i,n)}};var N=function(){},C=function(e,t,n){var r;return t&&t.hasOwnProperty("constructor")?r=t.constructor:r=function(){e.apply(this,arguments)},o.extend(r,e),N.prototype=e.prototype,r.prototype=new N,t&&o.extend(r.prototype,t),n&&o.extend(r,n),r.prototype.constructor=r,r.__super__=e.prototype,r},k=function(e,t){return!e||!e[t]?null:o.isFunction(e[t])?e[t]():e[t]},L=function(){throw new Error('A "url" property or function must be specified')}}.call(this),e.define("backbone",["lodash"],function(e){return function(){var t,n;return t||e.Backbone}}(this)),function(e){var t,n=e.Backbone,r=e._,i=e.$,s=n.View.prototype._configure,o=n.View.prototype.render,u=n.View.extend({constructor:function(e){e=e||{},u.setupView(this,e),n.View.call(this,e)},swapLayout:function(e){return e.views=r.defaults({},this.views,e.views),e.setElement(this.el),e},insertView:function(e,t){return t?this.setView(e,t,!0):this.setView(e,!0)},insertViews:function(e){return r.each(e,function(t,n){e[n]=[].concat(t)}),this.setViews(e)},getView:function(e){return this.getViews(e).first().value()},getViews:function(e){var t=r.chain(this.views).map(function(e){return[].concat(e)},this).flatten().value();return r.chain(r.filter(t,e?e:r.identity))},setView:function(e,t,n){var i,s,o=this;r.isString(e)||(n=t,t=e,e=""),this.views=this.views||{},!n&&this.views[e]&&(r.isArray(this.views[e])?r.each(this.views[e],function(e){e.remove()}):this.views[e].remove());if(!t.__manager__)throw new Error("manage property not set.  http://tbranyen.github.com/backbone.layoutmanager/#usage/structuring-a-view");return s=t._options(),t.render=function(i){function a(){(!n||t.keep||!l.hasRendered)&&s.partial(o.el,e,t.el,n),t.delegateEvents(),l.handler&&(l.handler.resolveWith(t,[t.el]),delete l.handler),f.resolveWith(t,[t.el]),r.isFunction(i)&&i.call(t,t.el)}var f=s.deferred(),l=t.__manager__;return l.viewDeferred=f,t._removeViews(),u.prototype.render.call(t).then(a),f.promise()},t.__manager__.parent=o,t.__manager__.selector=e,n?(i=this.views[e]=this.views[e]||[],r.isArray(this.views[e])||(i=this.views[e]=[this.views[e]]),r.indexOf(i,t)>-1?t:(i.push(t),t.__manager__.append=!0,t)):this.views[e]=t},setViews:function(e){return r.each(e,function(e,t){if(r.isArray(e))return r.each(e,function(e){this.insertView(t,e)},this);this.setView(t,e)},this),this},render:function(e){var t,n=this,i=this._options(),s=i.deferred(),o=this.__manager__;return o.renderDeferred?(o.callback=e,o.renderDeferred):(o.renderDeferred=s,this._render(u._viewRender).fetch.then(function(){var e=r.map(n.views,function(e){function t(e,n){if(!e.length)return n();var r=e.shift();r.render(function(){t(e,n)})}var n;return r.isArray(e)?(n=i.deferred(),t(r.clone(e),function(){n.resolve()}),n.promise()):e.render()});i.when(e).then(function(){s.resolveWith(n,[n.el])})}),t=s.then(function(){r.isFunction(e)&&e.call(n,n.el),n.__manager__.handler&&(n.__manager__.handler.resolveWith(n,[n.el]),delete n.__manager__.handler),r.isFunction(n.__manager__.callback)&&(n.__manager__.callback.call(n,n.el),delete n.__manager__.callback),delete n.__manager__.renderDeferred}),r.defaults(t,n))},remove:function(){return u._removeView(this,!0),this._remove.apply(this,arguments)},_options:function(){return r.extend({},this,u.prototype.options,this.options)}},{_cache:{},_makeAsync:function(e,t){var n=e.deferred();return n.async=function(){return n._isAsync=!0,t},n},_viewRender:function(e){function t(t,r){u.cache(n,r),r&&o.html(e.el,o.render(r,t)),s.fetch.resolveWith(e,[e.el])}var n,i,s,o=e._options();return{render:function(a){var f=e.__manager__,l=e.template||o.template;return e.serialize&&(o.serialize=e.serialize),!a&&r.isFunction(o.serialize)?a=o.serialize.call(e):!a&&r.isObject(o.serialize)&&(a=o.serialize),s=u._makeAsync(o,r.bind(t,e,a)),s.fetch=o.deferred(),f.handler=s,r.isString(l)&&(n=f.prefix+l),(i=u.cache(n))?(t(a,i,n),s):(r.isString(l)?i=o.fetch.call(s,f.prefix+l):l!=null&&(i=o.fetch.call(s,l)),s._isAsync||t(a,i),s)}}},cleanViews:function(e){r.each([].concat(e),function(e){e.unbind(),e.views&&r.each(e.views,function(e){u.cleanViews(e)}),r.isFunction(e.cleanup)&&e.cleanup.call(e)})},cache:function(e,t){if(e in this._cache)return this._cache[e];if(e!=null&&t!=null)return this._cache[e]=t},configure:function(e){r.extend(u.prototype.options,e),e.manage&&(n.View.prototype.manage=!0)},setupView:function(e,i){var s,o,a=n.LayoutManager.prototype,f=r.pick(e,t);if(e.__manager__)return;r.defaults(e,{views:{},__manager__:{},_options:u.prototype._options,_removeViews:u._removeViews,_removeView:u._removeView}),e instanceof n.Layout?e.__manager__.prefix=e._options().paths.layout||"":e.__manager__.prefix=e._options().paths.template||"",i=e.options=r.defaults(i||{},e.options,a.options),o=r.pick(i,["events"].concat(r.values(i.events))),r.extend(e,o),delete f.render,r.extend(i,f),e._remove=n.View.prototype.remove,e._render=function(e){var t,n=this._options().beforeRender,s=this._options().afterRender;return this._removeViews(),r.isFunction(n)&&n.call(this,this),this.trigger("beforeRender",this),t=e(this).render(),t.then(function(){var e=this,t=e.__manager__,n=t.parent,o=function(){e.delegateEvents(),e.__manager__.hasRendered=!0,r.isFunction(s)&&s.call(e,e),e.trigger("afterRender",e)},u=function(e){var t=e.__manager__;return t.parent&&!t.parent.__manager__.hasRendered?t.parent:e};if(!n)return o.call(e);if(n.__manager__.hasRendered)return i.when([t.viewDeferred,n.__manager__.viewDeferred]).then(function(){o.call(e)});n=u(e),n.on("afterRender",function(){n.off(null,null,e),o.call(e)},e)}),t},e.render=u.prototype.render,e.remove!==a.remove&&(e._remove=e.remove,e.remove=a.remove),s=i.views||e.views,r.keys(s).length&&e.setViews(s),e.template&&(i.template=e.template,delete e.template)},_removeViews:function(e){e=e||this,e.getViews().each(function(e){u._removeView(e,!0)})},_removeView:function(e,t){var n=e.__manager__,i=r.isBoolean(e.keep)?e.keep:e.options.keep;t=t&&n.parent,u.cleanViews(e);if(!i&&(n.append===!0||t)&&n.hasRendered){e.$el.remove();if(r.isArray(n.parent.views[n.selector]))return n.parent.getView(function(e,t){e.__manager__===n&&n.parent.views[n.selector].splice(t,1)});delete n.parent.views[n.selector]}}});r.each(["get","set","insert"],function(e){var t=n.View.prototype,r=u.prototype;t[e+"View"]=r[e+"View"],t[e+"Views"]=r[e+"Views"]}),n.Layout=n.LayoutManager=u,n.LayoutView=n.View.extend({manage:!0}),n.View.prototype._configure=function(){var e=s.apply(this,arguments);return this.manage&&u.setupView(this),e},u.prototype.options={paths:{},deferred:function(){return i.Deferred()},fetch:function(e){return r.template(i(e).html())},partial:function(e,t,n,r){var s=t?i(e).find(t):i(e);return s.length?(this[r?"append":"html"](s,n),!0):!1},html:function(e,t){i(e).html(t)},append:function(e,t){i(e).append(t)},when:function(e){return i.when.apply(null,e)},render:function(e,t){return e(t)}},t=r.keys(u.prototype.options)}(this),e.define("plugins/backbone.layoutmanager",function(){}),e.define("zeega",["backbone","plugins/backbone.layoutmanager"],function(e){var t={root:"/"},n=window.JST=window.JST||{},r=e.noConflict();return r.Model.prototype.put=function(){var e=[].slice.call(arguments).concat([{silent:!0}]);return this.set.apply(this,e)},_.extend(t,{module:function(e){return _.extend({Views:{}},e)},Backbone:r},r.Events)}),e.define("modules/player/data",["zeega"],function(e){var t={};return t.Model=e.Backbone.Model.extend({url:null,defaults:{authors:null,cover_image:null,date_created:null,date_published:null,date_updated:null,description:null,enabled:!0,estimated_time:null,frames:[],id:3662,item_id:null,layers:[],location:null,published:!1,sequences:[],tags:null,title:null,user_id:null},validate:function(e){this.clear({silent:!0}),this.put(_.pick(e,_.keys(this.defaults)))}}),t}),e.define("zeega_dir/plugins/layers/_layer/_layer",["zeega"],function(e){return _Layer=e.Backbone.Model.extend({layerType:null,controls:[],defaults:{citation:!0,default_controls:!0,draggable:!0,has_controls:!0,linkable:!0,mode:"player",resizable:!1},defaultAttributes:{},initialize:function(){this.defaults=_.extend(this.defaults,this.defaultAttributes),this.init()},init:function(){},player_onPreload:function(){},player_onPlay:function(){},player_onPause:function(){},player_onExit:function(){},player_onUnrender:function(){},player_onRenderError:function(){},editor_onLayerEnter:function(){},editor_onLayerExit:function(){},editor_onControlsOpen:function(){},editor_onControlsClosed:function(){}}),_Layer.Visual=e.Backbone.LayoutView.extend({className:"visual-element",template:"",fetch:function(t){var n;return t="app/templates/"+t+".html",JST[t]?JST[t]:(n=this.async(),$.ajax({url:e.root+t}).then(function(e){n(JST[t]=_.template(e))}))},serialize:function(){return this.model.toJSON()},initialize:function(){this.init()},beforePlayerRender:function(){},beforeRender:function(){var e=$(this.model.get("_target")).find(".ZEEGA-player-window");this.className=this._className+" "+this.className,this.beforePlayerRender(),$(e).append(this.el),this.$el.addClass("visual-element-"+this.model.get("type").toLowerCase()),this.moveOffStage(),this.applySize()},afterRender:function(){this.verifyReady(),this.onRender()},onRender:function(){},applySize:function(){this.$el.css({height:this.getAttr("height")+"%",width:this.getAttr("width")+"%"})},init:function(){},render:function(){},verifyReady:function(){this.model.trigger("visual_ready",this.model.id)},player_onPreload:function(){this.render()},player_onPlay:function(){this.onPlay()},player_onPause:function(){this.onPause()},player_onExit:function(){this.pause(),this.moveOffStage(),this.onExit()},player_onUnrender:function(){},player_onRenderError:function(){},onPreload:function(){},onPlay:function(){},onPause:function(){},onExit:function(){},updateZIndex:function(e){this.$el.css("z-index",e)},editor_onLayerEnter:function(){},editor_onLayerExit:function(){},editor_onControlsOpen:function(){},editor_onControlsClosed:function(){},moveOffStage:function(){this.$el.css({top:"-1000%",left:"-1000%"})},moveOnStage:function(){this.$el.css({top:this.getAttr("top")+"%",left:this.getAttr("left")+"%"})},play:function(){this.isPlaying=!0,this.moveOnStage(),this.player_onPlay()},pause:function(){this.isPlaying=!1,this.player_onPause()},playPause:function(){this.isPlaying!==!1?(this.isPlaying=!1,this.player_onPause()):(this.isPlaying=!0,this.player_onPlay())},getAttr:function(e){return this.model.get("attr")[e]}}),_Layer.LayoutView=e.Backbone.LayoutView.extend({fetch:function(t){var n;return t="app/templates/"+t+".html",JST[t]?JST[t]:(n=this.async(),$.ajax({url:e.root+t}).then(function(e){n(JST[t]=_.template(e))}))}}),_Layer}),function(e,t){var n="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";e.fn.imagesLoaded=function(r){function i(){var t=e(c),n=e(h);u&&(h.length?u.reject(f,t,n):u.resolve(f)),e.isFunction(r)&&r.call(o,f,t,n)}function s(t,r){t.src===n||-1!==e.inArray(t,l)||(l.push(t),r?h.push(t):c.push(t),e.data(t,"imagesLoaded",{isBroken:r,src:t.src}),a&&u.notifyWith(e(t),[r,f,e(c),e(h)]),f.length===l.length&&(setTimeout(i),f.unbind(".imagesLoaded")))}var o=this,u=e.isFunction(e.Deferred)?e.Deferred():0,a=e.isFunction(u.notify),f=o.find("img").add(o.filter("img")),l=[],c=[],h=[];return f.length?f.bind("load.imagesLoaded error.imagesLoaded",function(e){s(e.target,"error"===e.type)}).each(function(r,i){var o=i.src,u=e.data(i,"imagesLoaded");if(u&&u.src===o)s(i,u.isBroken);else if(i.complete&&i.naturalWidth!==t)s(i,0===i.naturalWidth||0===i.naturalHeight);else if(i.readyState||i.complete)i.src=n,i.src=o}):i(),u?u.promise(o):o}}(jQuery),e.define("plugins/jquery.imagesloaded.min",function(){}),e.define("zeega_dir/plugins/layers/image/image",["zeega","zeega_dir/plugins/layers/_layer/_layer","plugins/jquery.imagesloaded.min"],function(e,t){var n=e.module();return n.Image=t.extend({layerType:"Image",defaultAttributes:{title:"Image Layer",url:"none",left:0,top:0,height:100,width:100,opacity:1,aspect:1.33},controls:[{type:"checkbox",property:"dissolve",label:"Fade In"},{type:"slider",property:"width",label:"Scale",suffix:"%",min:1,max:200},{type:"slider",property:"opacity",label:"Scale",step:.01,min:.05,max:1}]}),n.Image.Visual=t.Visual.extend({template:"plugins/image",serialize:function(){return this.model.toJSON()},verifyReady:function(){var e=this.$el.imagesLoaded();e.done(function(){this.model.trigger("visual_ready",this.model.id)}.bind(this)),e.fail(function(){this.model.trigger("visual_error",this.model.id)}.bind(this))}}),n}),e.define("zeega_dir/plugins/layers/link/link",["zeega","zeega_dir/plugins/layers/_layer/_layer"],function(e,t){var n=e.module();return n.Link=t.extend({layerType:"Link",defaultAttributes:{title:"Link Layer",from_sequence:null,to_frame:null,from_frame:null,left:25,top:25,height:50,width:50,opacity:1,opacity_hover:1,blink_on_start:!0,glow_on_hover:!0,citation:!1,linkable:!1,default_controls:!1}}),n.Link.Visual=t.Visual.extend({template:"plugins/link",serialize:function(){return console.log("link layer",this.model),this.model.toJSON()},beforePlayerRender:function(){var e=this,t={"border-radius":"0",height:this.getAttr("height")+"%",background:this.getAttr("backgroundColor"),opacity:this.getAttr("opacity"),"box-shadow":"0 0 10px rgba(255,255,255,"+this.getAttr("opacity")+")"};this.$el.attr("data-glowOnHover",this.getAttr("glow_on_hover")),this.$(".ZEEGA-link-inner").css(t)},events:{"click a":"goClick",mouseover:"onMouseOver",mouseout:"onMouseOut"},onMouseOver:function(){this.$el.stop().fadeTo(500,this.getAttr("opacity_hover"))},onMouseOut:function(){this.$el.stop().fadeTo(500,this.getAttr("opacity"))},goClick:function(){return this.model.relay.set("current_frame",this.getAttr("to_frame")),!1}}),n}),e.define("zeega_dir/plugins/layers/slideshow/slideshow-metadata",["zeega","zeega_dir/plugins/layers/_layer/_layer"],function(e,t){var n={};return n.View=t.LayoutView.extend({className:"slide-metadata",template:"plugins/slideshow-metadata",initialize:function(){this.model.on("all",function(e){console.log("e",e)}),this.model.on("slideshow_update",this.onUpdate,this),this.slideInfo=this.model.get("attr").slides[0].attr},onUpdate:function(e){this.slideInfo=e.data.attr,this.render()},serialize:function(){return _.extend({title:"",description:""},this.slideInfo)}}),n}),e.define("zeega_dir/plugins/layers/slideshow/thumbnail-slider",["zeega","zeega_dir/plugins/layers/_layer/_layer","zeega_dir/plugins/layers/slideshow/slideshow-metadata"],function(e,t,n){var r=t.LayoutView.extend({slide:0,slidePos:0,className:"slideshow-slider",template:"plugins/slideshowthumbslider",initialize:function(){this.slideNum=this.model.get("attr").slides.length,this.model.on("slideshow_update",function(e){this.highlightThumb(e.slideNum)},this),e.on("resize_window",this.onResize,this)},serialize:function(){return this.model.toJSON()},afterRender:function(){this.makeDraggable(),this.sinkThumbSlider(),this.metadata=new n.View({model:this.model}),this.$el.prepend(this.metadata.el),this.metadata.render()},makeDraggable:function(){var e=this.$el.closest(".ZEEGA-player-window").width(),t=-this.$(".slideshow-thumb-wrapper ul").width()+e-10;this.$(".slideshow-thumb-wrapper ul").draggable({axis:"x",containment:[t-e/2,0,e/2,0]})},onResize:function(){this.$el.css("bottom",0)},events:{"click a.slider-thumb":"onClickThumb","click a.trackback":"onClickTrackback",mouseenter:"onMouseOver",mouseleave:"sinkThumbSlider"},onMouseOver:function(){this.sinkThumbsTimer&&clearTimeout(this.sinkThumbsTimer),$(".slideshow-slider").animate({bottom:0})},sinkThumbSlider:function(){var e=this;this.sinkThumbsTimer=setTimeout(function(){$(".slideshow-slider").animate({bottom:-70})},2e3)},onClickThumb:function(e){var t=$(e.target).closest("a").data("slidenum");return this.highlightThumb(t),this.model.trigger("slideshow_switch-frame",t),!1},onClickTrackback:function(){return!1},highlightThumb:function(e){var t=this.$el.closest(".ZEEGA-player-window").width(),n=0,r=this.$("li"),i=r.eq(e);this.slide=e,r.removeClass("active"),i.addClass("active"),n=t/2-i.position().left,this.$(".slideshow-thumb-wrapper ul").stop().animate({left:n},250)}});return r}),function(e,t){function n(t){e.fn.cycle.debug&&r(t)}function r(){window.console&&console.log&&console.log("[cycle] "+Array.prototype.join.call(arguments," "))}function i(t,n,r){var i=e(t).data("cycle.opts");if(!i)return;var s=!!t.cyclePause;s&&i.paused?i.paused(t,i,n,r):!s&&i.resumed&&i.resumed(t,i,n,r)}function s(n,s,o){function a(t,n,i){if(!t&&n===!0){var s=e(i).data("cycle.opts");if(!s)return r("options not found, can not resume"),!1;i.cycleTimeout&&(clearTimeout(i.cycleTimeout),i.cycleTimeout=0),h(s.elements,s,1,!s.backwards)}}n.cycleStop===t&&(n.cycleStop=0);if(s===t||s===null)s={};if(s.constructor==String){switch(s){case"destroy":case"stop":var f=e(n).data("cycle.opts");if(!f)return!1;return n.cycleStop++,n.cycleTimeout&&clearTimeout(n.cycleTimeout),n.cycleTimeout=0,f.elements&&e(f.elements).stop(),e(n).removeData("cycle.opts"),s=="destroy"&&u(n,f),!1;case"toggle":return n.cyclePause=n.cyclePause===1?0:1,a(n.cyclePause,o,n),i(n),!1;case"pause":return n.cyclePause=1,i(n),!1;case"resume":return n.cyclePause=0,a(!1,o,n),i(n),!1;case"prev":case"next":f=e(n).data("cycle.opts");if(!f)return r('options not found, "prev/next" ignored'),!1;return e.fn.cycle[s](f),!1;default:s={fx:s}}return s}if(s.constructor==Number){var l=s;return s=e(n).data("cycle.opts"),s?l<0||l>=s.elements.length?(r("invalid slide index: "+l),!1):(s.nextSlide=l,n.cycleTimeout&&(clearTimeout(n.cycleTimeout),n.cycleTimeout=0),typeof o=="string"&&(s.oneTimeFx=o),h(s.elements,s,1,l>=s.currSlide),!1):(r("options not found, can not advance slide"),!1)}return s}function o(t,n){if(!e.support.opacity&&n.cleartype&&t.style.filter)try{t.style.removeAttribute("filter")}catch(r){}}function u(t,n){n.next&&e(n.next).unbind(n.prevNextEvent),n.prev&&e(n.prev).unbind(n.prevNextEvent),(n.pager||n.pagerAnchorBuilder)&&e.each(n.pagerAnchors||[],function(){this.unbind().remove()}),n.pagerAnchors=null,e(t).unbind("mouseenter.cycle mouseleave.cycle"),n.destroy&&n.destroy(n)}function a(n,s,u,a,p){var g,y=e.extend({},e.fn.cycle.defaults,a||{},e.metadata?n.metadata():e.meta?n.data():{}),b=e.isFunction(n.data)?n.data(y.metaAttr):null;b&&(y=e.extend(y,b)),y.autostop&&(y.countdown=y.autostopCount||u.length);var w=n[0];n.data("cycle.opts",y),y.$cont=n,y.stopCount=w.cycleStop,y.elements=u,y.before=y.before?[y.before]:[],y.after=y.after?[y.after]:[],!e.support.opacity&&y.cleartype&&y.after.push(function(){o(this,y)}),y.continuous&&y.after.push(function(){h(u,y,0,!y.backwards)}),f(y),!e.support.opacity&&y.cleartype&&!y.cleartypeNoBg&&m(s),n.css("position")=="static"&&n.css("position","relative"),y.width&&n.width(y.width),y.height&&y.height!="auto"&&n.height(y.height),y.startingSlide!==t?(y.startingSlide=parseInt(y.startingSlide,10),y.startingSlide>=u.length||y.startSlide<0?y.startingSlide=0:g=!0):y.backwards?y.startingSlide=u.length-1:y.startingSlide=0;if(y.random){y.randomMap=[];for(var E=0;E<u.length;E++)y.randomMap.push(E);y.randomMap.sort(function(e,t){return Math.random()-.5});if(g)for(var S=0;S<u.length;S++)y.startingSlide==y.randomMap[S]&&(y.randomIndex=S);else y.randomIndex=1,y.startingSlide=y.randomMap[1]}else y.startingSlide>=u.length&&(y.startingSlide=0);y.currSlide=y.startingSlide||0;var x=y.startingSlide;s.css({position:"absolute",top:0,left:0}).hide().each(function(t){var n;y.backwards?n=x?t<=x?u.length+(t-x):x-t:u.length-t:n=x?t>=x?u.length-(t-x):x-t:u.length-t,e(this).css("z-index",n)}),e(u[x]).css("opacity",1).show(),o(u[x],y),y.fit&&(y.aspect?s.each(function(){var t=e(this),n=y.aspect===!0?t.width()/t.height():y.aspect;y.width&&t.width()!=y.width&&(t.width(y.width),t.height(y.width/n)),y.height&&t.height()<y.height&&(t.height(y.height),t.width(y.height*n))}):(y.width&&s.width(y.width),y.height&&y.height!="auto"&&s.height(y.height))),y.center&&(!y.fit||y.aspect)&&s.each(function(){var t=e(this);t.css({"margin-left":y.width?(y.width-t.width())/2+"px":0,"margin-top":y.height?(y.height-t.height())/2+"px":0})}),y.center&&!y.fit&&!y.slideResize&&s.each(function(){var t=e(this);t.css({"margin-left":y.width?(y.width-t.width())/2+"px":0,"margin-top":y.height?(y.height-t.height())/2+"px":0})});var T=(y.containerResize||y.containerResizeHeight)&&!n.innerHeight();if(T){var N=0,C=0;for(var k=0;k<u.length;k++){var L=e(u[k]),A=L[0],O=L.outerWidth(),M=L.outerHeight();O||(O=A.offsetWidth||A.width||L.attr("width")),M||(M=A.offsetHeight||A.height||L.attr("height")),N=O>N?O:N,C=M>C?M:C}y.containerResize&&N>0&&C>0&&n.css({width:N+"px",height:C+"px"}),y.containerResizeHeight&&C>0&&n.css({height:C+"px"})}var _=!1;y.pause&&n.bind("mouseenter.cycle",function(){_=!0,this.cyclePause++,i(w,!0)}).bind("mouseleave.cycle",function(){_&&this.cyclePause--,i(w,!0)});if(l(y)===!1)return!1;var D=!1;a.requeueAttempts=a.requeueAttempts||0,s.each(function(){var t=e(this);this.cycleH=y.fit&&y.height?y.height:t.height()||this.offsetHeight||this.height||t.attr("height")||0,this.cycleW=y.fit&&y.width?y.width:t.width()||this.offsetWidth||this.width||t.attr("width")||0;if(t.is("img")){var n=e.browser.msie&&this.cycleW==28&&this.cycleH==30&&!this.complete,i=e.browser.mozilla&&this.cycleW==34&&this.cycleH==19&&!this.complete,s=e.browser.opera&&(this.cycleW==42&&this.cycleH==19||this.cycleW==37&&this.cycleH==17)&&!this.complete,o=this.cycleH===0&&this.cycleW===0&&!this.complete;if(n||i||s||o){if(p.s&&y.requeueOnImageNotLoaded&&++a.requeueAttempts<100)return r(a.requeueAttempts," - img slide not loaded, requeuing slideshow: ",this.src,this.cycleW,this.cycleH),setTimeout(function(){e(p.s,p.c).cycle(a)},y.requeueTimeout),D=!0,!1;r("could not determine size of image: "+this.src,this.cycleW,this.cycleH)}}return!0});if(D)return!1;y.cssBefore=y.cssBefore||{},y.cssAfter=y.cssAfter||{},y.cssFirst=y.cssFirst||{},y.animIn=y.animIn||{},y.animOut=y.animOut||{},s.not(":eq("+x+")").css(y.cssBefore),e(s[x]).css(y.cssFirst);if(y.timeout){y.timeout=parseInt(y.timeout,10),y.speed.constructor==String&&(y.speed=e.fx.speeds[y.speed]||parseInt(y.speed,10)),y.sync||(y.speed=y.speed/2);var P=y.fx=="none"?0:y.fx=="shuffle"?500:250;while(y.timeout-y.speed<P)y.timeout+=y.speed}y.easing&&(y.easeIn=y.easeOut=y.easing),y.speedIn||(y.speedIn=y.speed),y.speedOut||(y.speedOut=y.speed),y.slideCount=u.length,y.currSlide=y.lastSlide=x,y.random?(++y.randomIndex==u.length&&(y.randomIndex=0),y.nextSlide=y.randomMap[y.randomIndex]):y.backwards?y.nextSlide=y.startingSlide===0?u.length-1:y.startingSlide-1:y.nextSlide=y.startingSlide>=u.length-1?0:y.startingSlide+1;if(!y.multiFx){var H=e.fn.cycle.transitions[y.fx];if(e.isFunction(H))H(n,s,y);else if(y.fx!="custom"&&!y.multiFx)return r("unknown transition: "+y.fx,"; slideshow terminating"),!1}var B=s[x];return y.skipInitializationCallbacks||(y.before.length&&y.before[0].apply(B,[B,B,y,!0]),y.after.length&&y.after[0].apply(B,[B,B,y,!0])),y.next&&e(y.next).bind(y.prevNextEvent,function(){return d(y,1)}),y.prev&&e(y.prev).bind(y.prevNextEvent,function(){return d(y,0)}),(y.pager||y.pagerAnchorBuilder)&&v(u,y),c(y,u),y}function f(t){t.original={before:[],after:[]},t.original.cssBefore=e.extend({},t.cssBefore),t.original.cssAfter=e.extend({},t.cssAfter),t.original.animIn=e.extend({},t.animIn),t.original.animOut=e.extend({},t.animOut),e.each(t.before,function(){t.original.before.push(this)}),e.each(t.after,function(){t.original.after.push(this)})}function l(t){var i,s,o=e.fn.cycle.transitions;if(t.fx.indexOf(",")>0){t.multiFx=!0,t.fxs=t.fx.replace(/\s*/g,"").split(",");for(i=0;i<t.fxs.length;i++){var u=t.fxs[i];s=o[u];if(!s||!o.hasOwnProperty(u)||!e.isFunction(s))r("discarding unknown transition: ",u),t.fxs.splice(i,1),i--}if(!t.fxs.length)return r("No valid transitions named; slideshow terminating."),!1}else if(t.fx=="all"){t.multiFx=!0,t.fxs=[];for(var a in o)o.hasOwnProperty(a)&&(s=o[a],o.hasOwnProperty(a)&&e.isFunction(s)&&t.fxs.push(a))}if(t.multiFx&&t.randomizeEffects){var f=Math.floor(Math.random()*20)+30;for(i=0;i<f;i++){var l=Math.floor(Math.random()*t.fxs.length);t.fxs.push(t.fxs.splice(l,1)[0])}n("randomized fx sequence: ",t.fxs)}return!0}function c(t,n){t.addSlide=function(r,i){var s=e(r),o=s[0];t.autostopCount||t.countdown++,n[i?"unshift":"push"](o),t.els&&t.els[i?"unshift":"push"](o),t.slideCount=n.length,t.random&&(t.randomMap.push(t.slideCount-1),t.randomMap.sort(function(e,t){return Math.random()-.5})),s.css("position","absolute"),s[i?"prependTo":"appendTo"](t.$cont),i&&(t.currSlide++,t.nextSlide++),!e.support.opacity&&t.cleartype&&!t.cleartypeNoBg&&m(s),t.fit&&t.width&&s.width(t.width),t.fit&&t.height&&t.height!="auto"&&s.height(t.height),o.cycleH=t.fit&&t.height?t.height:s.height(),o.cycleW=t.fit&&t.width?t.width:s.width(),s.css(t.cssBefore),(t.pager||t.pagerAnchorBuilder)&&e.fn.cycle.createPagerAnchor(n.length-1,o,e(t.pager),n,t),e.isFunction(t.onAddSlide)?t.onAddSlide(s):s.hide()}}function h(r,i,s,o){function u(){var e=0,t=i.timeout;i.timeout&&!i.continuous?(e=p(r[i.currSlide],r[i.nextSlide],i,o),i.fx=="shuffle"&&(e-=i.speedOut)):i.continuous&&a.cyclePause&&(e=10),e>0&&(a.cycleTimeout=setTimeout(function(){h(r,i,0,!i.backwards)},e))}var a=i.$cont[0],f=r[i.currSlide],l=r[i.nextSlide];s&&i.busy&&i.manualTrump&&(n("manualTrump in go(), stopping active transition"),e(r).stop(!0,!0),i.busy=0,clearTimeout(a.cycleTimeout));if(i.busy){n("transition active, ignoring new tx request");return}if(a.cycleStop!=i.stopCount||a.cycleTimeout===0&&!s)return;if(!s&&!a.cyclePause&&!i.bounce&&(i.autostop&&--i.countdown<=0||i.nowrap&&!i.random&&i.nextSlide<i.currSlide)){i.end&&i.end(i);return}var c=!1;if((s||!a.cyclePause)&&i.nextSlide!=i.currSlide){c=!0;var d=i.fx;f.cycleH=f.cycleH||e(f).height(),f.cycleW=f.cycleW||e(f).width(),l.cycleH=l.cycleH||e(l).height(),l.cycleW=l.cycleW||e(l).width(),i.multiFx&&(o&&(i.lastFx===t||++i.lastFx>=i.fxs.length)?i.lastFx=0:!o&&(i.lastFx===t||--i.lastFx<0)&&(i.lastFx=i.fxs.length-1),d=i.fxs[i.lastFx]),i.oneTimeFx&&(d=i.oneTimeFx,i.oneTimeFx=null),e.fn.cycle.resetState(i,d),i.before.length&&e.each(i.before,function(e,t){if(a.cycleStop!=i.stopCount)return;t.apply(l,[f,l,i,o])});var v=function(){i.busy=0,e.each(i.after,function(e,t){if(a.cycleStop!=i.stopCount)return;t.apply(l,[f,l,i,o])}),a.cycleStop||u()};n("tx firing("+d+"); currSlide: "+i.currSlide+"; nextSlide: "+i.nextSlide),i.busy=1,i.fxFn?i.fxFn(f,l,i,v,o,s&&i.fastOnEvent):e.isFunction(e.fn.cycle[i.fx])?e.fn.cycle[i.fx](f,l,i,v,o,s&&i.fastOnEvent):e.fn.cycle.custom(f,l,i,v,o,s&&i.fastOnEvent)}else u();if(c||i.nextSlide==i.currSlide){var m;i.lastSlide=i.currSlide,i.random?(i.currSlide=i.nextSlide,++i.randomIndex==r.length&&(i.randomIndex=0,i.randomMap.sort(function(e,t){return Math.random()-.5})),i.nextSlide=i.randomMap[i.randomIndex],i.nextSlide==i.currSlide&&(i.nextSlide=i.currSlide==i.slideCount-1?0:i.currSlide+1)):i.backwards?(m=i.nextSlide-1<0,m&&i.bounce?(i.backwards=!i.backwards,i.nextSlide=1,i.currSlide=0):(i.nextSlide=m?r.length-1:i.nextSlide-1,i.currSlide=m?0:i.nextSlide+1)):(m=i.nextSlide+1==r.length,m&&i.bounce?(i.backwards=!i.backwards,i.nextSlide=r.length-2,i.currSlide=r.length-1):(i.nextSlide=m?0:i.nextSlide+1,i.currSlide=m?r.length-1:i.nextSlide-1))}c&&i.pager&&i.updateActivePagerLink(i.pager,i.currSlide,i.activePagerClass)}function p(e,t,r,i){if(r.timeoutFn){var s=r.timeoutFn.call(e,e,t,r,i);while(r.fx!="none"&&s-r.speed<250)s+=r.speed;n("calculated timeout: "+s+"; speed: "+r.speed);if(s!==!1)return s}return r.timeout}function d(t,n){var r=n?1:-1,i=t.elements,s=t.$cont[0],o=s.cycleTimeout;o&&(clearTimeout(o),s.cycleTimeout=0);if(t.random&&r<0)t.randomIndex--,--t.randomIndex==-2?t.randomIndex=i.length-2:t.randomIndex==-1&&(t.randomIndex=i.length-1),t.nextSlide=t.randomMap[t.randomIndex];else if(t.random)t.nextSlide=t.randomMap[t.randomIndex];else{t.nextSlide=t.currSlide+r;if(t.nextSlide<0){if(t.nowrap)return!1;t.nextSlide=i.length-1}else if(t.nextSlide>=i.length){if(t.nowrap)return!1;t.nextSlide=0}}var u=t.onPrevNextEvent||t.prevNextClick;return e.isFunction(u)&&u(r>0,t.nextSlide,i[t.nextSlide]),h(i,t,1,n),!1}function v(t,n){var r=e(n.pager);e.each(t,function(i,s){e.fn.cycle.createPagerAnchor(i,s,r,t,n)}),n.updateActivePagerLink(n.pager,n.startingSlide,n.activePagerClass)}function m(t){function r(e){return e=parseInt(e,10).toString(16),e.length<2?"0"+e:e}function i(t){for(;t&&t.nodeName.toLowerCase()!="html";t=t.parentNode){var n=e.css(t,"background-color");if(n&&n.indexOf("rgb")>=0){var i=n.match(/\d+/g);return"#"+r(i[0])+r(i[1])+r(i[2])}if(n&&n!="transparent")return n}return"#ffffff"}n("applying clearType background-color hack"),t.each(function(){e(this).css("background-color",i(this))})}var g="2.9999.8";e.support===t&&(e.support={opacity:!e.browser.msie}),e.expr[":"].paused=function(e){return e.cyclePause},e.fn.cycle=function(t,i){var o={s:this.selector,c:this.context};return this.length===0&&t!="stop"?!e.isReady&&o.s?(r("DOM not ready, queuing slideshow"),e(function(){e(o.s,o.c).cycle(t,i)}),this):(r("terminating; zero elements found by selector"+(e.isReady?"":" (DOM not ready)")),this):this.each(function(){var u=s(this,t,i);if(u===!1)return;u.updateActivePagerLink=u.updateActivePagerLink||e.fn.cycle.updateActivePagerLink,this.cycleTimeout&&clearTimeout(this.cycleTimeout),this.cycleTimeout=this.cyclePause=0,this.cycleStop=0;var f=e(this),l=u.slideExpr?e(u.slideExpr,this):f.children(),c=l.get();if(c.length<2){r("terminating; too few slides: "+c.length);return}var d=a(f,l,c,u,o);if(d===!1)return;var v=d.continuous?10:p(c[d.currSlide],c[d.nextSlide],d,!d.backwards);v&&(v+=d.delay||0,v<10&&(v=10),n("first timeout: "+v),this.cycleTimeout=setTimeout(function(){h(c,d,0,!u.backwards)},v))})},e.fn.cycle.resetState=function(t,n){n=n||t.fx,t.before=[],t.after=[],t.cssBefore=e.extend({},t.original.cssBefore),t.cssAfter=e.extend({},t.original.cssAfter),t.animIn=e.extend({},t.original.animIn),t.animOut=e.extend({},t.original.animOut),t.fxFn=null,e.each(t.original.before,function(){t.before.push(this)}),e.each(t.original.after,function(){t.after.push(this)});var r=e.fn.cycle.transitions[n];e.isFunction(r)&&r(t.$cont,e(t.elements),t)},e.fn.cycle.updateActivePagerLink=function(t,n,r){e(t).each(function(){e(this).children().removeClass(r).eq(n).addClass(r)})},e.fn.cycle.next=function(e){d(e,1)},e.fn.cycle.prev=function(e){d(e,0)},e.fn.cycle.createPagerAnchor=function(t,r,s,o,u){var a;e.isFunction(u.pagerAnchorBuilder)?(a=u.pagerAnchorBuilder(t,r),n("pagerAnchorBuilder("+t+", el) returned: "+a)):a='<a href="#">'+(t+1)+"</a>";if(!a)return;var f=e(a);if(f.parents("body").length===0){var l=[];s.length>1?(s.each(function(){var t=f.clone(!0);e(this).append(t),l.push(t[0])}),f=e(l)):f.appendTo(s)}u.pagerAnchors=u.pagerAnchors||[],u.pagerAnchors.push(f);var c=function(n){n.preventDefault(),u.nextSlide=t;var r=u.$cont[0],i=r.cycleTimeout;i&&(clearTimeout(i),r.cycleTimeout=0);var s=u.onPagerEvent||u.pagerClick;e.isFunction(s)&&s(u.nextSlide,o[u.nextSlide]),h(o,u,1,u.currSlide<t)};/mouseenter|mouseover/i.test(u.pagerEvent)?f.hover(c,function(){}):f.bind(u.pagerEvent,c),!/^click/.test(u.pagerEvent)&&!u.allowPagerClickBubble&&f.bind("click.cycle",function(){return!1});var p=u.$cont[0],d=!1;u.pauseOnPagerHover&&f.hover(function(){d=!0,p.cyclePause++,i(p,!0,!0)},function(){d&&p.cyclePause--,i(p,!0,!0)})},e.fn.cycle.hopsFromLast=function(e,t){var n,r=e.lastSlide,i=e.currSlide;return t?n=i>r?i-r:e.slideCount-r:n=i<r?r-i:r+e.slideCount-i,n},e.fn.cycle.commonReset=function(t,n,r,i,s,o){e(r.elements).not(t).hide(),typeof r.cssBefore.opacity=="undefined"&&(r.cssBefore.opacity=1),r.cssBefore.display="block",r.slideResize&&i!==!1&&n.cycleW>0&&(r.cssBefore.width=n.cycleW),r.slideResize&&s!==!1&&n.cycleH>0&&(r.cssBefore.height=n.cycleH),r.cssAfter=r.cssAfter||{},r.cssAfter.display="none",e(t).css("zIndex",r.slideCount+(o===!0?1:0)),e(n).css("zIndex",r.slideCount+(o===!0?0:1))},e.fn.cycle.custom=function(t,n,r,i,s,o){var u=e(t),a=e(n),f=r.speedIn,l=r.speedOut,c=r.easeIn,h=r.easeOut;a.css(r.cssBefore),o&&(typeof o=="number"?f=l=o:f=l=1,c=h=null);var p=function(){a.animate(r.animIn,f,c,function(){i()})};u.animate(r.animOut,l,h,function(){u.css(r.cssAfter),r.sync||p()}),r.sync&&p()},e.fn.cycle.transitions={fade:function(t,n,r){n.not(":eq("+r.currSlide+")").css("opacity",0),r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r),r.cssBefore.opacity=0}),r.animIn={opacity:1},r.animOut={opacity:0},r.cssBefore={top:0,left:0}}},e.fn.cycle.ver=function(){return g},e.fn.cycle.defaults={activePagerClass:"activeSlide",after:null,allowPagerClickBubble:!1,animIn:null,animOut:null,aspect:!1,autostop:0,autostopCount:0,backwards:!1,before:null,center:null,cleartype:!e.support.opacity,cleartypeNoBg:!1,containerResize:1,containerResizeHeight:0,continuous:0,cssAfter:null,cssBefore:null,delay:0,easeIn:null,easeOut:null,easing:null,end:null,fastOnEvent:0,fit:0,fx:"fade",fxFn:null,height:"auto",manualTrump:!0,metaAttr:"cycle",next:null,nowrap:0,onPagerEvent:null,onPrevNextEvent:null,pager:null,pagerAnchorBuilder:null,pagerEvent:"click.cycle",pause:0,pauseOnPagerHover:0,prev:null,prevNextEvent:"click.cycle",random:0,randomizeEffects:1,requeueOnImageNotLoaded:!0,requeueTimeout:250,rev:0,shuffle:null,skipInitializationCallbacks:!1,slideExpr:null,slideResize:1,speed:1e3,speedIn:null,speedOut:null,startingSlide:t,sync:1,timeout:4e3,timeoutFn:null,updateActivePagerLink:null,width:null}}(jQuery),function(e){e.fn.cycle.transitions.none=function(t,n,r){r.fxFn=function(t,n,r,i){e(n).show(),e(t).hide(),i()}},e.fn.cycle.transitions.fadeout=function(t,n,r){n.not(":eq("+r.currSlide+")").css({display:"block",opacity:1}),r.before.push(function(t,n,r,i,s,o){e(t).css("zIndex",r.slideCount+(o!==!0?1:0)),e(n).css("zIndex",r.slideCount+(o!==!0?0:1))}),r.animIn.opacity=1,r.animOut.opacity=0,r.cssBefore.opacity=1,r.cssBefore.display="block",r.cssAfter.zIndex=0},e.fn.cycle.transitions.scrollUp=function(t,n,r){t.css("overflow","hidden"),r.before.push(e.fn.cycle.commonReset);var i=t.height();r.cssBefore.top=i,r.cssBefore.left=0,r.cssFirst.top=0,r.animIn.top=0,r.animOut.top=-i},e.fn.cycle.transitions.scrollDown=function(t,n,r){t.css("overflow","hidden"),r.before.push(e.fn.cycle.commonReset);var i=t.height();r.cssFirst.top=0,r.cssBefore.top=-i,r.cssBefore.left=0,r.animIn.top=0,r.animOut.top=i},e.fn.cycle.transitions.scrollLeft=function(t,n,r){t.css("overflow","hidden"),r.before.push(e.fn.cycle.commonReset);var i=t.width();r.cssFirst.left=0,r.cssBefore.left=i,r.cssBefore.top=0,r.animIn.left=0,r.animOut.left=0-i},e.fn.cycle.transitions.scrollRight=function(t,n,r){t.css("overflow","hidden"),r.before.push(e.fn.cycle.commonReset);var i=t.width();r.cssFirst.left=0,r.cssBefore.left=-i,r.cssBefore.top=0,r.animIn.left=0,r.animOut.left=i},e.fn.cycle.transitions.scrollHorz=function(t,n,r){t.css("overflow","hidden").width(),r.before.push(function(t,n,r,i){r.rev&&(i=!i),e.fn.cycle.commonReset(t,n,r),r.cssBefore.left=i?n.cycleW-1:1-n.cycleW,r.animOut.left=i?-t.cycleW:t.cycleW}),r.cssFirst.left=0,r.cssBefore.top=0,r.animIn.left=0,r.animOut.top=0},e.fn.cycle.transitions.scrollVert=function(t,n,r){t.css("overflow","hidden"),r.before.push(function(t,n,r,i){r.rev&&(i=!i),e.fn.cycle.commonReset(t,n,r),r.cssBefore.top=i?1-n.cycleH:n.cycleH-1,r.animOut.top=i?t.cycleH:-t.cycleH}),r.cssFirst.top=0,r.cssBefore.left=0,r.animIn.top=0,r.animOut.left=0},e.fn.cycle.transitions.slideX=function(t,n,r){r.before.push(function(t,n,r){e(r.elements).not(t).hide(),e.fn.cycle.commonReset(t,n,r,!1,!0),r.animIn.width=n.cycleW}),r.cssBefore.left=0,r.cssBefore.top=0,r.cssBefore.width=0,r.animIn.width="show",r.animOut.width=0},e.fn.cycle.transitions.slideY=function(t,n,r){r.before.push(function(t,n,r){e(r.elements).not(t).hide(),e.fn.cycle.commonReset(t,n,r,!0,!1),r.animIn.height=n.cycleH}),r.cssBefore.left=0,r.cssBefore.top=0,r.cssBefore.height=0,r.animIn.height="show",r.animOut.height=0},e.fn.cycle.transitions.shuffle=function(t,n,r){var i,s=t.css("overflow","visible").width();n.css({left:0,top:0}),r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r,!0,!0,!0)}),r.speedAdjusted||(r.speed=r.speed/2,r.speedAdjusted=!0),r.random=0,r.shuffle=r.shuffle||{left:-s,top:15},r.els=[];for(i=0;i<n.length;i++)r.els.push(n[i]);for(i=0;i<r.currSlide;i++)r.els.push(r.els.shift());r.fxFn=function(t,n,r,i,s){r.rev&&(s=!s);var o=s?e(t):e(n);e(n).css(r.cssBefore);var u=r.slideCount;o.animate(r.shuffle,r.speedIn,r.easeIn,function(){var n=e.fn.cycle.hopsFromLast(r,s);for(var a=0;a<n;a++)s?r.els.push(r.els.shift()):r.els.unshift(r.els.pop());if(s)for(var f=0,l=r.els.length;f<l;f++)e(r.els[f]).css("z-index",l-f+u);else{var c=e(t).css("z-index");o.css("z-index",parseInt(c,10)+1+u)}o.animate({left:0,top:0},r.speedOut,r.easeOut,function(){e(s?this:t).hide(),i&&i()})})},e.extend(r.cssBefore,{display:"block",opacity:1,top:0,left:0})},e.fn.cycle.transitions.turnUp=function(t,n,r){r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r,!0,!1),r.cssBefore.top=n.cycleH,r.animIn.height=n.cycleH,r.animOut.width=n.cycleW}),r.cssFirst.top=0,r.cssBefore.left=0,r.cssBefore.height=0,r.animIn.top=0,r.animOut.height=0},e.fn.cycle.transitions.turnDown=function(t,n,r){r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r,!0,!1),r.animIn.height=n.cycleH,r.animOut.top=t.cycleH}),r.cssFirst.top=0,r.cssBefore.left=0,r.cssBefore.top=0,r.cssBefore.height=0,r.animOut.height=0},e.fn.cycle.transitions.turnLeft=function(t,n,r){r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r,!1,!0),r.cssBefore.left=n.cycleW,r.animIn.width=n.cycleW}),r.cssBefore.top=0,r.cssBefore.width=0,r.animIn.left=0,r.animOut.width=0},e.fn.cycle.transitions.turnRight=function(t,n,r){r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r,!1,!0),r.animIn.width=n.cycleW,r.animOut.left=t.cycleW}),e.extend(r.cssBefore,{top:0,left:0,width:0}),r.animIn.left=0,r.animOut.width=0},e.fn.cycle.transitions.zoom=function(t,n,r){r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r,!1,!1,!0),r.cssBefore.top=n.cycleH/2,r.cssBefore.left=n.cycleW/2,e.extend(r.animIn,{top:0,left:0,width:n.cycleW,height:n.cycleH}),e.extend(r.animOut,{width:0,height:0,top:t.cycleH/2,left:t.cycleW/2})}),r.cssFirst.top=0,r.cssFirst.left=0,r.cssBefore.width=0,r.cssBefore.height=0},e.fn.cycle.transitions.fadeZoom=function(t,n,r){r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r,!1,!1),r.cssBefore.left=n.cycleW/2,r.cssBefore.top=n.cycleH/2,e.extend(r.animIn,{top:0,left:0,width:n.cycleW,height:n.cycleH})}),r.cssBefore.width=0,r.cssBefore.height=0,r.animOut.opacity=0},e.fn.cycle.transitions.blindX=function(t,n,r){var i=t.css("overflow","hidden").width();r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r),r.animIn.width=n.cycleW,r.animOut.left=t.cycleW}),r.cssBefore.left=i,r.cssBefore.top=0,r.animIn.left=0,r.animOut.left=i},e.fn.cycle.transitions.blindY=function(t,n,r){var i=t.css("overflow","hidden").height();r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r),r.animIn.height=n.cycleH,r.animOut.top=t.cycleH}),r.cssBefore.top=i,r.cssBefore.left=0,r.animIn.top=0,r.animOut.top=i},e.fn.cycle.transitions.blindZ=function(t,n,r){var i=t.css("overflow","hidden").height(),s=t.width();r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r),r.animIn.height=n.cycleH,r.animOut.top=t.cycleH}),r.cssBefore.top=i,r.cssBefore.left=s,r.animIn.top=0,r.animIn.left=0,r.animOut.top=i,r.animOut.left=s},e.fn.cycle.transitions.growX=function(t,n,r){r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r,!1,!0),r.cssBefore.left=this.cycleW/2,r.animIn.left=0,r.animIn.width=this.cycleW,r.animOut.left=0}),r.cssBefore.top=0,r.cssBefore.width=0},e.fn.cycle.transitions.growY=function(t,n,r){r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r,!0,!1),r.cssBefore.top=this.cycleH/2,r.animIn.top=0,r.animIn.height=this.cycleH,r.animOut.top=0}),r.cssBefore.height=0,r.cssBefore.left=0},e.fn.cycle.transitions.curtainX=function(t,n,r){r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r,!1,!0,!0),r.cssBefore.left=n.cycleW/2,r.animIn.left=0,r.animIn.width=this.cycleW,r.animOut.left=t.cycleW/2,r.animOut.width=0}),r.cssBefore.top=0,r.cssBefore.width=0},e.fn.cycle.transitions.curtainY=function(t,n,r){r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r,!0,!1,!0),r.cssBefore.top=n.cycleH/2,r.animIn.top=0,r.animIn.height=n.cycleH,r.animOut.top=t.cycleH/2,r.animOut.height=0}),r.cssBefore.height=0,r.cssBefore.left=0},e.fn.cycle.transitions.cover=function(t,n,r){var i=r.direction||"left",s=t.css("overflow","hidden").width(),o=t.height();r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r),r.cssAfter.display="",i=="right"?r.cssBefore.left=-s:i=="up"?r.cssBefore.top=o:i=="down"?r.cssBefore.top=-o:r.cssBefore.left=s}),r.animIn.left=0,r.animIn.top=0,r.cssBefore.top=0,r.cssBefore.left=0},e.fn.cycle.transitions.uncover=function(t,n,r){var i=r.direction||"left",s=t.css("overflow","hidden").width(),o=t.height();r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r,!0,!0,!0),i=="right"?r.animOut.left=s:i=="up"?r.animOut.top=-o:i=="down"?r.animOut.top=o:r.animOut.left=-s}),r.animIn.left=0,r.animIn.top=0,r.cssBefore.top=0,r.cssBefore.left=0},e.fn.cycle.transitions.toss=function(t,n,r){var i=t.css("overflow","visible").width(),s=t.height();r.before.push(function(t,n,r){e.fn.cycle.commonReset(t,n,r,!0,!0,!0),!r.animOut.left&&!r.animOut.top?e.extend(r.animOut,{left:i*2,top:-s/2,opacity:0}):r.animOut.opacity=0}),r.cssBefore.left=0,r.cssBefore.top=0,r.animIn.left=0},e.fn.cycle.transitions.wipe=function(t,n,r){var i=t.css("overflow","hidden").width(),s=t.height();r.cssBefore=r.cssBefore||{};var o;if(r.clip)if(/l2r/.test(r.clip))o="rect(0px 0px "+s+"px 0px)";else if(/r2l/.test(r.clip))o="rect(0px "+i+"px "+s+"px "+i+"px)";else if(/t2b/.test(r.clip))o="rect(0px "+i+"px 0px 0px)";else if(/b2t/.test(r.clip))o="rect("+s+"px "+i+"px "+s+"px 0px)";else if(/zoom/.test(r.clip)){var u=parseInt(s/2,10),a=parseInt(i/2,10);o="rect("+u+"px "+a+"px "+u+"px "+a+"px)"}r.cssBefore.clip=r.cssBefore.clip||o||"rect(0px 0px 0px 0px)";var f=r.cssBefore.clip.match(/(\d+)/g),l=parseInt(f[0],10),c=parseInt(f[1],10),h=parseInt(f[2],10),p=parseInt(f[3],10);r.before.push(function(t,n,r){if(t==n)return;var o=e(t),u=e(n);e.fn.cycle.commonReset(t,n,r,!0,!0,!1),r.cssAfter.display="block";var a=1,f=parseInt(r.speedIn/13,10)-1;(function d(){var e=l?l-parseInt(a*(l/f),10):0,t=p?p-parseInt(a*(p/f),10):0,n=h<s?h+parseInt(a*((s-h)/f||1),10):s,r=c<i?c+parseInt(a*((i-c)/f||1),10):i;u.css({clip:"rect("+e+"px "+r+"px "+n+"px "+t+"px)"}),a++<=f?setTimeout(d,13):o.css("display","none")})()}),e.extend(r.cssBefore,{display:"block",opacity:1,top:0,left:0}),r.animIn={left:0},r.animOut={left:0}}}(jQuery),e.define("zeega_dir/plugins/layers/slideshow/cycle/cycle",function(){}),e.define("zeega_dir/plugins/layers/slideshow/slideshow",["zeega","zeega_dir/plugins/layers/_layer/_layer","zeega_dir/plugins/layers/slideshow/thumbnail-slider","zeega_dir/plugins/layers/slideshow/cycle/cycle"],function(e,t,n){var r=e.module();return r.SlideShow=t.extend({layerType:"SlideShow",defaultAttributes:{arrows:!0,keyboard:!1,thumbnail_slider:!0,start_slide:null,start_slide_id:null,slides_bleed:!0,title:"Slideshow Layer",url:"none",left:0,top:0,height:100,width:100,opacity:1,aspect:1.33}}),r.SlideShow.Visual=t.Visual.extend({template:"plugins/slideshow",slide:0,init:function(){this.slideCount=this.model.get("attr").slides.length,this.model.on("slideshow_switch-frame",this.scrollTo,this),e.on("resize_window",this.positionArrows,this)},serialize:function(){return this.model.toJSON()},onPlay:function(){var e,t=this.model.get("start_slide"),n=this.model.get("start_slide_id");this.$el.css({height:"100%"}),this.hideArrows(),this.initKeyboard(),this.emitSlideData(this.slide),this.positionArrows(),this.$(".slideshow-container").cycle({timeout:0,fx:"scrollHorz"})},onRender:function(){this.$el.css("height",this.$el.closest(".ZEEGA-player").height()),this.thumbSlider=new n({model:this.model}),this.$el.append(this.thumbSlider.el),this.thumbSlider.render()},onExit:function(){this.killKeyboard(),this.$(".slideshow-container").cycle("destroy")},events:{"click  .slideshow-control-prev":"goLeft","click  .slideshow-control-next":"goRight"},goLeft:function(){return this.slide>0&&(this.slide--,this.scrollTo(this.slide)),!1},goRight:function(){return this.slide<this.slideCount-1&&(this.slide++,this.scrollTo(this.slide)),!1},scrollTo:function(e){this.slide=e,this.hideArrows(),this.$(".slideshow-container").cycle(e),this.updateTitle(e),this.emitSlideData(e)},updateTitle:function(e){var t=this.model.get("attr").slides[e];this.$(".slide-title").text(t.attr.title),this.$(".slide-description").text(t.attr.description)},emitSlideData:function(e){this.model.trigger("slideshow_update",{slideNum:e,data:this.getAttr("slides")[e]})},positionArrows:function(){this.$(".slideshow-arrow").css({top:this.$el.closest(".ZEEGA-player").height()/2-50+"px",height:this.$el.closest(".ZEEGA-player").height()/10+"px",width:this.$el.closest(".ZEEGA-player").height()/10+"px"})},hideArrows:function(){this.slideCount<=1?this.$(".slideshow-arrow").remove():this.slide===0?this.$(".slideshow-control-prev").addClass("disabled"):this.slide==this.slideCount-1?this.$(".slideshow-control-next").addClass("disabled"):this.$(".slideshow-control-prev, .slideshow-control-next").removeClass("disabled")},initKeyboard:function(){this.getAttr("keyboard")&&$(window).on("keyup.slideshow",function(e){switch(e.which){case 37:_this.goLeft();break;case 39:_this.goRight()}})},killKeyboard:function(){this.getAttr("keyboard")&&$(window).off("keyup.slideshow")}}),r}),window.Modernizr=function(e,t,n){function r(e){d.cssText=e}function i(e,t){return r(y.join(e+";")+(t||""))}function s(e,t){return typeof e===t}function o(e,t){return!!~(""+e).indexOf(t)}function u(e,t,r){for(var i in e){var o=t[e[i]];if(o!==n)return r===!1?e[i]:s(o,"function")?o.bind(r||t):o}return!1}function a(){l.input=function(n){for(var r=0,i=n.length;r<i;r++)N[n[r]]=n[r]in v;return N.list&&(N.list=!!t.createElement("datalist")&&!!e.HTMLDataListElement),N}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),l.inputtypes=function(e){for(var r=0,i,s,o,u=e.length;r<u;r++)v.setAttribute("type",s=e[r]),i=v.type!=="text",i&&(v.value=m,v.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(s)&&v.style.WebkitAppearance!==n?(c.appendChild(v),o=t.defaultView,i=o.getComputedStyle&&o.getComputedStyle(v,null).WebkitAppearance!=="textfield"&&v.offsetHeight!==0,c.removeChild(v)):/^(search|tel)$/.test(s)||(/^(url|email)$/.test(s)?i=v.checkValidity&&v.checkValidity()===!1:i=v.value!=m)),T[e[r]]=!!i;return T}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var f="2.6.2",l={},c=t.documentElement,h="modernizr",p=t.createElement(h),d=p.style,v=t.createElement("input"),m=":)",g={}.toString,y=" -webkit- -moz- -o- -ms- ".split(" "),b="Webkit Moz O ms",w=b.split(" "),E=b.toLowerCase().split(" "),S={svg:"http://www.w3.org/2000/svg"},x={},T={},N={},C=[],k=C.slice,L,A=function(e,n,r,i){var s,o,u,a,f=t.createElement("div"),l=t.body,p=l||t.createElement("body");if(parseInt(r,10))while(r--)u=t.createElement("div"),u.id=i?i[r]:h+(r+1),f.appendChild(u);return s=["&#173;",'<style id="s',h,'">',e,"</style>"].join(""),f.id=h,(l?f:p).innerHTML+=s,p.appendChild(f),l||(p.style.background="",p.style.overflow="hidden",a=c.style.overflow,c.style.overflow="hidden",c.appendChild(p)),o=n(f,e),l?f.parentNode.removeChild(f):(p.parentNode.removeChild(p),c.style.overflow=a),!!o},O=function(t){var n=e.matchMedia||e.msMatchMedia;if(n)return n(t).matches;var r;return A("@media "+t+" { #"+h+" { position: absolute; } }",function(t){r=(e.getComputedStyle?getComputedStyle(t,null):t.currentStyle)["position"]=="absolute"}),r},M=function(){function e(e,i){i=i||t.createElement(r[e]||"div"),e="on"+e;var o=e in i;return o||(i.setAttribute||(i=t.createElement("div")),i.setAttribute&&i.removeAttribute&&(i.setAttribute(e,""),o=s(i[e],"function"),s(i[e],"undefined")||(i[e]=n),i.removeAttribute(e))),i=null,o}var r={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return e}(),_={}.hasOwnProperty,D;!s(_,"undefined")&&!s(_.call,"undefined")?D=function(e,t){return _.call(e,t)}:D=function(e,t){return t in e&&s(e.constructor.prototype[t],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if(typeof t!="function")throw new TypeError;var n=k.call(arguments,1),r=function(){if(this instanceof r){var i=function(){};i.prototype=t.prototype;var s=new i,o=t.apply(s,n.concat(k.call(arguments)));return Object(o)===o?o:s}return t.apply(e,n.concat(k.call(arguments)))};return r}),x.canvas=function(){var e=t.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")},x.canvastext=function(){return!!l.canvas&&!!s(t.createElement("canvas").getContext("2d").fillText,"function")},x.webgl=function(){return!!e.WebGLRenderingContext},x.touch=function(){var n;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?n=!0:A(["@media (",y.join("touch-enabled),("),h,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(e){n=e.offsetTop===9}),n},x.geolocation=function(){return"geolocation"in navigator},x.postmessage=function(){return!!e.postMessage},x.websqldatabase=function(){return!!e.openDatabase},x.hashchange=function(){return M("hashchange",e)&&(t.documentMode===n||t.documentMode>7)},x.history=function(){return!!e.history&&!!history.pushState},x.draganddrop=function(){var e=t.createElement("div");return"draggable"in e||"ondragstart"in e&&"ondrop"in e},x.websockets=function(){return"WebSocket"in e||"MozWebSocket"in e},x.video=function(){var e=t.createElement("video"),n=!1;try{if(n=!!e.canPlayType)n=new Boolean(n),n.ogg=e.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),n.h264=e.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),n.webm=e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")}catch(r){}return n},x.audio=function(){var e=t.createElement("audio"),n=!1;try{if(n=!!e.canPlayType)n=new Boolean(n),n.ogg=e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),n.mp3=e.canPlayType("audio/mpeg;").replace(/^no$/,""),n.wav=e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),n.m4a=(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,"")}catch(r){}return n},x.localstorage=function(){try{return localStorage.setItem(h,h),localStorage.removeItem(h),!0}catch(e){return!1}},x.sessionstorage=function(){try{return sessionStorage.setItem(h,h),sessionStorage.removeItem(h),!0}catch(e){return!1}},x.webworkers=function(){return!!e.Worker},x.applicationcache=function(){return!!e.applicationCache},x.svg=function(){return!!t.createElementNS&&!!t.createElementNS(S.svg,"svg").createSVGRect},x.inlinesvg=function(){var e=t.createElement("div");return e.innerHTML="<svg/>",(e.firstChild&&e.firstChild.namespaceURI)==S.svg},x.smil=function(){return!!t.createElementNS&&/SVGAnimate/.test(g.call(t.createElementNS(S.svg,"animate")))},x.svgclippaths=function(){return!!t.createElementNS&&/SVGClipPath/.test(g.call(t.createElementNS(S.svg,"clipPath")))};for(var P in x)D(x,P)&&(L=P.toLowerCase(),l[L]=x[P](),C.push((l[L]?"":"no-")+L));return l.input||a(),l.addTest=function(e,t){if(typeof e=="object")for(var r in e)D(e,r)&&l.addTest(r,e[r]);else{e=e.toLowerCase();if(l[e]!==n)return l;t=typeof t=="function"?t():t,typeof enableClasses!="undefined"&&enableClasses&&(c.className+=" "+(t?"":"no-")+e),l[e]=t}return l},r(""),p=v=null,function(e,t){function n(e,t){var n=e.createElement("p"),r=e.getElementsByTagName("head")[0]||e.documentElement;return n.innerHTML="x<style>"+t+"</style>",r.insertBefore(n.lastChild,r.firstChild)}function r(){var e=g.elements;return typeof e=="string"?e.split(" "):e}function i(e){var t=v[e[p]];return t||(t={},d++,e[p]=d,v[d]=t),t}function s(e,n,r){n||(n=t);if(m)return n.createElement(e);r||(r=i(n));var s;return r.cache[e]?s=r.cache[e].cloneNode():c.test(e)?s=(r.cache[e]=r.createElem(e)).cloneNode():s=r.createElem(e),s.canHaveChildren&&!l.test(e)?r.frag.appendChild(s):s}function o(e,n){e||(e=t);if(m)return e.createDocumentFragment();n=n||i(e);var s=n.frag.cloneNode(),o=0,u=r(),a=u.length;for(;o<a;o++)s.createElement(u[o]);return s}function u(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(n){return g.shivMethods?s(n,e,t):t.createElem(n)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+r().join().replace(/\w+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(g,t.frag)}function a(e){e||(e=t);var r=i(e);return g.shivCSS&&!h&&!r.hasCSS&&(r.hasCSS=!!n(e,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),m||u(e,r),e}var f=e.html5||{},l=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,c=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,h,p="_html5shiv",d=0,v={},m;(function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",h="hidden"in e,m=e.childNodes.length==1||function(){t.createElement("a");var e=t.createDocumentFragment();return typeof e.cloneNode=="undefined"||typeof e.createDocumentFragment=="undefined"||typeof e.createElement=="undefined"}()}catch(n){h=!0,m=!0}})();var g={elements:f.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:f.shivCSS!==!1,supportsUnknownElements:m,shivMethods:f.shivMethods!==!1,type:"default",shivDocument:a,createElement:s,createDocumentFragment:o};e.html5=g,a(t)}(this,t),l._version=f,l._prefixes=y,l._domPrefixes=E,l._cssomPrefixes=w,l.mq=O,l.hasEvent=M,l.testStyles=A,l}(this,this.document),e.define("libs/modernizr",function(){}),function(e,t){function n(e){E.put.call(this,e)}function r(e){this.parent=e,this.byStart=[{start:-1,end:-1}],this.byEnd=[{start:-1,end:-1}],this.animating=[],this.startIndex=0,this.endIndex=0,this.previousUpdateTime=-1,this.count=1}function i(e,t,n){return e[t]&&e[t]===n}function s(e,t){var n={};for(var r in e)h.call(t,r)&&h.call(e,r)&&(n[r]=e[r]);return n}function o(e,t){return function(){if(S.plugin.debug)return e.apply(this,arguments);try{return e.apply(this,arguments)}catch(n){S.plugin.errors.push({plugin:t,thrown:n,source:e.toString()}),this.emit("pluginerror",S.plugin.errors)}}}if(!t.addEventListener){e.Popcorn={isSupported:!1};var u="byId forEach extend effects error guid sizeOf isArray nop position disable enable destroyaddTrackEvent removeTrackEvent getTrackEvents getTrackEvent getLastTrackEventId timeUpdate plugin removePlugin compose effect xhr getJSONP getScript".split(/\s+/);while(u.length)e.Popcorn[u.shift()]=function(){};return}var a=Array.prototype,f=Object.prototype,l=a.forEach,c=a.slice,h=f.hasOwnProperty,p=f.toString,d=e.Popcorn,v=[],m=!1,g=!1,y={events:{hash:{},apis:{}}},b=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t,n){e.setTimeout(t,16)}}(),w=function(e){return Object.keys?Object.keys(e):function(e){var t,n=[];for(t in e)h.call(e,t)&&n.push(t);return n}(e)},E={put:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t])}},S=function(e,t){return new S.p.init(e,t||null)};S.version="95162da",S.isSupported=!0,S.instances=[],S.p=S.prototype={init:function(e,n){var i,s,o=this;if(typeof e=="function"){if(t.readyState==="complete"){e(t,S);return}v.push(e);if(!m){m=!0;var u=function(){g=!0,t.removeEventListener("DOMContentLoaded",u,!1);for(var e=0,n=v.length;e<n;e++)v[e].call(t,S);v=null};t.addEventListener("DOMContentLoaded",u,!1)}return}if(typeof e=="string")try{i=t.querySelector(e)}catch(a){throw new Error("Popcorn.js Error: Invalid media element selector: "+e)}this.media=i||e,s=this.media.nodeName&&this.media.nodeName.toLowerCase()||"video",this[s]=this.media,this.options=S.extend({},n)||{},this.id=this.options.id||S.guid(s);if(S.byId(this.id))throw new Error("Popcorn.js Error: Cannot use duplicate ID ("+this.id+")");this.isDestroyed=!1,this.data={running:{cue:[]},timeUpdate:S.nop,disabled:{},events:{},hooks:{},history:[],state:{volume:this.media.volume},trackRefs:{},trackEvents:new r(this)},S.instances.push(this);var f=function(){o.media.currentTime<0&&(o.media.currentTime=0),o.media.removeEventListener("loadedmetadata",f,!1);var e,t,n,r,i,s;e=o.media.duration,t=e!=e?Number.MAX_VALUE:e+1,S.addTrackEvent(o,{start:t,end:t}),o.isDestroyed||(o.data.durationChange=function(){var e=o.media.duration,t=e+1,n=o.data.trackEvents.byStart,r=o.data.trackEvents.byEnd;n.pop(),r.pop();for(var i=r.length-1;i>0;i--)r[i].end>e&&o.removeTrackEvent(r[i]._id);for(var s=0;s<n.length;s++)n[s].end>e&&o.removeTrackEvent(n[s]._id);o.data.trackEvents.byEnd.push({start:t,end:t}),o.data.trackEvents.byStart.push({start:t,end:t})},o.media.addEventListener("durationchange",o.data.durationChange,!1)),o.options.frameAnimation?(o.data.timeUpdate=function(){S.timeUpdate(o,{}),S.forEach(S.manifest,function(e,t){n=o.data.running[t];if(n){i=n.length;for(var u=0;u<i;u++)r=n[u],s=r._natives,s&&s.frame&&s.frame.call(o,{},r,o.currentTime())}}),o.emit("timeupdate"),!o.isDestroyed&&b(o.data.timeUpdate)},!o.isDestroyed&&b(o.data.timeUpdate)):(o.data.timeUpdate=function(e){S.timeUpdate(o,e)},o.isDestroyed||o.media.addEventListener("timeupdate",o.data.timeUpdate,!1))};return o.media.addEventListener("error",function(){o.error=o.media.error},!1),o.media.readyState>=1?f():o.media.addEventListener("loadedmetadata",f,!1),this}},S.p.init.prototype=S.p,S.byId=function(e){var t=S.instances,n=t.length,r=0;for(;r<n;r++)if(t[r].id===e)return t[r];return null},S.forEach=function(e,t,n){if(!e||!t)return{};n=n||this;var r,i;if(l&&e.forEach===l)return e.forEach(t,n);if(p.call(e)==="[object NodeList]"){for(r=0,i=e.length;r<i;r++)t.call(n,e[r],r,e);return e}for(r in e)h.call(e,r)&&t.call(n,e[r],r,e);return e},S.extend=function(e){var t=e,n=c.call(arguments,1);return S.forEach(n,function(e){for(var n in e)t[n]=e[n]}),t},S.extend(S,{noConflict:function(t){return t&&(e.Popcorn=d),S},error:function(e){throw new Error(e)},guid:function(e){return S.guid.counter++,(e?e:"")+(+(new Date)+S.guid.counter)},sizeOf:function(e){var t=0;for(var n in e)t++;return t},isArray:Array.isArray||function(e){return p.call(e)==="[object Array]"},nop:function(){},position:function(n){if(!n.parentNode)return null;var r=n.getBoundingClientRect(),i={},s=n.ownerDocument,o=t.documentElement,u=t.body,a,f,l,c,h,p;a=o.clientTop||u.clientTop||0,f=o.clientLeft||u.clientLeft||0,l=e.pageYOffset&&o.scrollTop||u.scrollTop,c=e.pageXOffset&&o.scrollLeft||u.scrollLeft,h=Math.ceil(r.top+l-a),p=Math.ceil(r.left+c-f);for(var d in r)i[d]=Math.round(r[d]);return S.extend({},i,{top:h,left:p})},disable:function(e,t){if(e.data.disabled[t])return;e.data.disabled[t]=!0;if(t in S.registryByName&&e.data.running[t])for(var n=e.data.running[t].length-1,r;n>=0;n--)r=e.data.running[t][n],r._natives.end.call(e,null,r),e.emit("trackend",S.extend({},r,{plugin:r.type,type:"trackend"}));return e},enable:function(e,t){if(!e.data.disabled[t])return;e.data.disabled[t]=!1;if(t in S.registryByName&&e.data.running[t])for(var n=e.data.running[t].length-1,r;n>=0;n--)r=e.data.running[t][n],r._natives.start.call(e,null,r),e.emit("trackstart",S.extend({},r,{plugin:r.type,type:"trackstart",track:r}));return e},destroy:function(e){var t=e.data.events,n=e.data.trackEvents,r,i,s,o;for(i in t){r=t[i];for(s in r)delete r[s];t[i]=null}for(o in S.registryByName)S.removePlugin(e,o);n.byStart.length=0,n.byEnd.length=0,e.isDestroyed||(e.data.timeUpdate&&e.media.removeEventListener("timeupdate",e.data.timeUpdate,!1),e.isDestroyed=!0),S.instances.splice(S.instances.indexOf(e),1)}}),S.guid.counter=1,S.extend(S.p,function(){var e="load play pause currentTime playbackRate volume duration preload playbackRate autoplay loop controls muted buffered readyState seeking paused played seekable ended",t={};return S.forEach(e.split(/\s+/g),function(e){t[e]=function(t){var n;return typeof this.media[e]=="function"?(t!=null&&/play|pause/.test(e)&&(this.media.currentTime=S.util.toSeconds(t)),this.media[e](),this):t!=null?(n=this.media[e],this.media[e]=t,n!==t&&this.emit("attrchange",{attribute:e,previousValue:n,currentValue:t}),this):this.media[e]}}),t}()),S.forEach("enable disable".split(" "),function(e){S.p[e]=function(t){return S[e](this,t)}}),S.extend(S.p,{roundTime:function(){return Math.round(this.media.currentTime)},exec:function(e,t,r){var i=arguments.length,s="trackadded",o,u,a;try{u=S.util.toSeconds(e)}catch(f){}typeof u=="number"&&(e=u);if(typeof e=="number"&&i===2)r=t,t=e,e=S.guid("cue");else if(i===1)t=-1;else{o=this.getTrackEvent(e);if(o)this.data.trackEvents.remove(e),n.end(this,o),S.removeTrackEvent.ref(this,e),s="cuechange",typeof e=="string"&&i===2&&(typeof t=="number"&&(r=o._natives.start),typeof t=="function"&&(r=t,t=o.start));else if(i>=2){if(typeof t=="string"){try{u=S.util.toSeconds(t)}catch(f){}t=u}typeof t=="number"&&(r=r||S.nop()),typeof t=="function"&&(r=t,t=-1)}}return a={id:e,start:t,end:t+1,_running:!1,_natives:{start:r||S.nop,end:S.nop,type:"cue"}},o&&(a=S.extend(o,a)),s==="cuechange"?(a._id=a.id||a._id||S.guid(a._natives.type),this.data.trackEvents.add(a),n.start(this,a),this.timeUpdate(this,null,!0),S.addTrackEvent.ref(this,a),this.emit(s,S.extend({},a,{id:e,type:s,previousValue:{time:o.start,fn:o._natives.start},currentValue:{time:t,fn:r||S.nop},track:o}))):S.addTrackEvent(this,a),this},mute:function(e){var t=e==null||e===!0?"muted":"unmuted";return t==="unmuted"&&(this.media.muted=!1,this.media.volume=this.data.state.volume),t==="muted"&&(this.data.state.volume=this.media.volume,this.media.muted=!0),this.emit(t),this},unmute:function(e){return this.mute(e==null?!1:!e)},position:function(){return S.position(this.media)},toggle:function(e){return S[this.data.disabled[e]?"enable":"disable"](this,e)},defaults:function(e,t){return S.isArray(e)?(S.forEach(e,function(e){for(var t in e)this.defaults(t,e[t])},this),this):(this.options.defaults||(this.options.defaults={}),this.options.defaults[e]||(this.options.defaults[e]={}),S.extend(this.options.defaults[e],t),this)}}),S.Events={UIEvents:"blur focus focusin focusout load resize scroll unload",MouseEvents:"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave click dblclick",Events:"loadstart progress suspend emptied stalled play pause error loadedmetadata loadeddata waiting playing canplay canplaythrough seeking seeked timeupdate ended ratechange durationchange volumechange"},S.Events.Natives=S.Events.UIEvents+" "+S.Events.MouseEvents+" "+S.Events.Events,y.events.apiTypes=["UIEvents","MouseEvents","Events"],function(e,t){var n=y.events.apiTypes,r=e.Natives.split(/\s+/g),i=0,s=r.length,o;for(;i<s;i++)t.hash[r[i]]=!0;n.forEach(function(n,r){t.apis[n]={};var i=e[n].split(/\s+/g),s=i.length,o=0;for(;o<s;o++)t.apis[n][i[o]]=!0})}(S.Events,y.events),S.events={isNative:function(e){return!!y.events.hash[e]},getInterface:function(e){if(!S.events.isNative(e))return!1;var t=y.events,n=t.apiTypes,r=t.apis,i=0,s=n.length,o,u;for(;i<s;i++){u=n[i];if(r[u][e]){o=u;break}}return o},all:S.Events.Natives.split(/\s+/g),fn:{trigger:function(n,r){var i,s,o,u=this.data.events[n];if(u){i=S.events.getInterface(n);if(i)return s=t.createEvent(i),s.initEvent(n,!0,!0,e,1),this.media.dispatchEvent(s),this;o=u.slice();while(o.length)o.shift().call(this,r)}return this},listen:function(e,t){var n=this,r=!0,i=S.events.hooks[e],s=e,o,u;if(typeof t!="function")throw new Error("Popcorn.js Error: Listener is not a function");return this.data.events[e]||(this.data.events[e]=[],r=!1),i&&(i.add&&i.add.call(this,{},t),i.bind&&(e=i.bind),i.handler&&(u=t,t=function(e){i.handler.call(n,e,u)}),r=!0,this.data.events[e]||(this.data.events[e]=[],r=!1)),this.data.events[e].push(t),!r&&S.events.all.indexOf(e)>-1&&this.media.addEventListener(e,function(t){if(n.data.events[e]){o=n.data.events[e].slice();while(o.length)o.shift().call(n,t)}},!1),this},unlisten:function(e,t){var n,r=this.data.events[e];if(!r)return;if(typeof t=="string"){for(var i=0;i<r.length;i++)r[i].name===t&&r.splice(i--,1);return this}if(typeof t=="function"){while(n!==-1)n=r.indexOf(t),n!==-1&&r.splice(n,1);return this}return this.data.events[e]=null,this}},hooks:{canplayall:{bind:"canplaythrough",add:function(e,t){var n=!1;this.media.readyState&&(setTimeout(function(){t.call(this,e)}.bind(this),0),n=!0),this.data.hooks.canplayall={fired:n}},handler:function(e,t){this.data.hooks.canplayall.fired||(t.call(this,e),this.data.hooks.canplayall.fired=!0)}}}},S.forEach([["trigger","emit"],["listen","on"],["unlisten","off"]],function(e){S.p[e[0]]=S.p[e[1]]=S.events.fn[e[0]]}),n.start=function(e,t){t.end>e.media.currentTime&&t.start<=e.media.currentTime&&!t._running&&(t._running=!0,e.data.running[t._natives.type].push(t),e.data.disabled[t._natives.type]||(t._natives.start.call(e,null,t),e.emit("trackstart",S.extend({},t,{plugin:t._natives.type,type:"trackstart",track:t}))))},n.end=function(e,t){var n;(t.end<=e.media.currentTime||t.start>e.media.currentTime)&&t._running&&(n=e.data.running[t._natives.type],t._running=!1,n.splice(n.indexOf(t),1),e.data.disabled[t._natives.type]||(t._natives.end.call(e,null,t),e.emit("trackend",S.extend({},t,{plugin:t._natives.type,type:"trackend",track:t}))))},r.prototype.where=function(e){return(this.parent.getTrackEvents()||[]).filter(function(t){var n,r;if(!e)return!0;for(n in e){r=e[n];if(i(t,n,r)||i(t._natives,n,r))return!0}return!1})},r.prototype.add=function(e){var t=this.byStart,n=this.byEnd,r,i;e&&e._id&&this.parent.data.history.push(e._id),e.start=S.util.toSeconds(e.start,this.parent.options.framerate),e.end=S.util.toSeconds(e.end,this.parent.options.framerate);for(r=t.length-1;r>=0;r--)if(e.start>=t[r].start){t.splice(r+1,0,e);break}for(i=n.length-1;i>=0;i--)if(e.end>n[i].end){n.splice(i+1,0,e);break}r<=this.parent.data.trackEvents.startIndex&&e.start<=this.parent.data.trackEvents.previousUpdateTime&&this.parent.data.trackEvents.startIndex++,i<=this.parent.data.trackEvents.endIndex&&e.end<this.parent.data.trackEvents.previousUpdateTime&&this.parent.data.trackEvents.endIndex++,this.count++},r.prototype.remove=function(e,t){e instanceof n&&(e=e.id);if(typeof e=="object")return this.where(e).forEach(function(e){this.removeTrackEvent(e._id)},this.parent),this;var r,i,s,o,u,a=this.byStart.length,f=0,l=0,c=[],h=[],p=[],d=[],v={};t=t||{};while(--a>-1)r=this.byStart[f],i=this.byEnd[f],r._id||(c.push(r),h.push(i)),r._id&&(r._id!==e&&c.push(r),i._id!==e&&h.push(i),r._id===e&&(l=f,u=r)),f++;a=this.animating.length,f=0;if(a)while(--a>-1)s=this.animating[f],s._id||p.push(s),s._id&&s._id!==e&&p.push(s),f++;l<=this.startIndex&&this.startIndex--,l<=this.endIndex&&this.endIndex--,this.byStart=c,this.byEnd=h,this.animating=p,this.count--,o=this.parent.data.history.length;for(var m=0;m<o;m++)this.parent.data.history[m]!==e&&d.push(this.parent.data.history[m]);this.parent.data.history=d},S.addTrackEvent=function(e,t){var r;if(t instanceof n)return;t=new n(t),t&&t._natives&&t._natives.type&&e.options.defaults&&e.options.defaults[t._natives.type]&&(r=S.extend({},t),S.extend(t,e.options.defaults[t._natives.type],r)),t._natives&&(t._id=t.id||t._id||S.guid(t._natives.type),t._natives._setup&&(t._natives._setup.call(e,t),e.emit("tracksetup",S.extend({},t,{plugin:t._natives.type,type:"tracksetup",track:t})))),e.data.trackEvents.add(t),n.start(e,t),this.timeUpdate(e,null,!0),t._id&&S.addTrackEvent.ref(e,t),e.emit("trackadded",S.extend({},t,t._natives?{plugin:t._natives.type}:{},{type:"trackadded",track:t}))},S.addTrackEvent.ref=function(e,t){return e.data.trackRefs[t._id]=t,e},S.removeTrackEvent=function(e,t){var n=e.getTrackEvent(t);if(!n)return;n._natives._teardown&&n._natives._teardown.call(e,n),e.data.trackEvents.remove(t),S.removeTrackEvent.ref(e,t),n._natives&&e.emit("trackremoved",S.extend({},n,{plugin:n._natives.type,type:"trackremoved",track:n}))},S.removeTrackEvent.ref=function(e,t){return delete e.data.trackRefs[t],e},S.getTrackEvents=function(e){var t=[],n=e.data.trackEvents.byStart,r=n.length,i=0,s;for(;i<r;i++)s=n[i],s._id&&t.push(s);return t},S.getTrackEvents.ref=function(e){return e.data.trackRefs},S.getTrackEvent=function(e,t){return e.data.trackRefs[t]},S.getTrackEvent.ref=function(e,t){return e.data.trackRefs[t]},S.getLastTrackEventId=function(e){return e.data.history[e.data.history.length-1]},S.timeUpdate=function(e,t){var n=e.media.currentTime,r=e.data.trackEvents.previousUpdateTime,i=e.data.trackEvents,s=i.endIndex,o=i.startIndex,u=i.byStart.length,a=i.byEnd.length,f=S.registryByName,l="trackstart",c="trackend",h,p,d,v,m,g;if(r<=n){while(i.byEnd[s]&&i.byEnd[s].end<=n){h=i.byEnd[s],v=h._natives,m=v&&v.type;if(!!v&&!f[m]&&!e[m]){S.removeTrackEvent(e,h._id);return}h._running===!0&&(h._running=!1,g=e.data.running[m],g.splice(g.indexOf(h),1),e.data.disabled[m]||(v.end.call(e,t,h),e.emit(c,S.extend({},h,{plugin:m,type:c,track:h})))),s++}while(i.byStart[o]&&i.byStart[o].start<=n){p=i.byStart[o],v=p._natives,m=v&&v.type;if(!!v&&!f[m]&&!e[m]){S.removeTrackEvent(e,p._id);return}p.end>n&&p._running===!1&&(p._running=!0,e.data.running[m].push(p),e.data.disabled[m]||(v.start.call(e,t,p),e.emit(l,S.extend({},p,{plugin:m,type:l,track:p})))),o++}}else if(r>n){while(i.byStart[o]&&i.byStart[o].start>n){p=i.byStart[o],v=p._natives,m=v&&v.type;if(!!v&&!f[m]&&!e[m]){S.removeTrackEvent(e,p._id);return}p._running===!0&&(p._running=!1,g=e.data.running[m],g.splice(g.indexOf(p),1),e.data.disabled[m]||(v.end.call(e,t,p),e.emit(c,S.extend({},p,{plugin:m,type:c,track:p})))),o--}while(i.byEnd[s]&&i.byEnd[s].end>n){h=i.byEnd[s],v=h._natives,m=v&&v.type;if(!!v&&!f[m]&&!e[m]){S.removeTrackEvent(e,h._id);return}h.start<=n&&h._running===!1&&(h._running=!0,e.data.running[m].push(h),e.data.disabled[m]||(v.start.call(e,t,h),e.emit(l,S.extend({},h,{plugin:m,type:l,track:h})))),s--}}i.endIndex=s,i.startIndex=o,i.previousUpdateTime=n,i.byStart.length<u&&i.startIndex--,i.byEnd.length<a&&i.endIndex--},S.extend(S.p,{getTrackEvents:function(){return S.getTrackEvents.call(null,this)},getTrackEvent:function(e){return S.getTrackEvent.call(null,this,e)},getLastTrackEventId:function(){return S.getLastTrackEventId.call(null,this)},removeTrackEvent:function(e){return S.removeTrackEvent.call(null,this,e),this},removePlugin:function(e){return S.removePlugin.call(null,this,e),this},timeUpdate:function(e){return S.timeUpdate.call(null,this,e),this},destroy:function(){return S.destroy.call(null,this),this}}),S.manifest={},S.registry=[],S.registryByName={},S.plugin=function(e,t,r){if(S.protect.natives.indexOf(e.toLowerCase())>=0){S.error("'"+e+"' is a protected function name");return}var i=typeof t=="function",u=["start","end","type","manifest"],a=["_setup","_teardown","start","end","frame"],f={},l,p=function(e,t){return e=e||S.nop,t=t||S.nop,function(){e.apply(this,arguments),t.apply(this,arguments)}};S.manifest[e]=r=r||t.manifest||{},a.forEach(function(n){t[n]=o(t[n]||S.nop,e)});var d=function(t,i){if(!i)return this;if(i.ranges&&S.isArray(i.ranges))return S.forEach(i.ranges,function(t){var n=S.extend({},i,t);delete n.ranges,this[e](n)},this),this;var s=i._natives={},o="",f,l;return S.extend(s,t),i._natives.type=i._natives.plugin=e,i._running=!1,s.start=s.start||s["in"],s.end=s.end||s.out,i.once&&(s.end=p(s.end,function(){this.removeTrackEvent(i._id)})),s._teardown=p(function(){var e=c.call(arguments),t=this.data.running[s.type];e.unshift(null),e[1]._running&&t.splice(t.indexOf(i),1)&&s.end.apply(this,e),e[1]._running=!1,this.emit("trackend",S.extend({},i,{plugin:s.type,type:"trackend",track:S.getTrackEvent(this,i.id||i._id)}))},s._teardown),s._teardown=p(s._teardown,function(){this.emit("trackteardown",S.extend({},i,{plugin:e,type:"trackteardown",track:S.getTrackEvent(this,i.id||i._id)}))}),i.compose=i.compose||[],typeof i.compose=="string"&&(i.compose=i.compose.split(" ")),i.effect=i.effect||[],typeof i.effect=="string"&&(i.effect=i.effect.split(" ")),i.compose=i.compose.concat(i.effect),i.compose.forEach(function(e){o=S.compositions[e]||{},a.forEach(function(e){s[e]=p(s[e],o[e])})}),i._natives.manifest=r,"start"in i||(i.start=i["in"]||0),!i.end&&i.end!==0&&(i.end=i.out||Number.MAX_VALUE),h.call(i,"toString")||(i.toString=function(){var t=["start: "+i.start,"end: "+i.end,"id: "+(i.id||i._id)];return i.target!=null&&t.push("target: "+i.target),e+" ( "+t.join(", ")+" )"}),i.target||(l="options"in r&&r.options,i.target=l&&"target"in l&&l.target),!i._id&&i._natives&&(i._id=S.guid(i._natives.type)),i instanceof n?(i._natives&&(i._id=i.id||i._id||S.guid(i._natives.type),i._natives._setup&&(i._natives._setup.call(this,i),this.emit("tracksetup",S.extend({},i,{plugin:i._natives.type,type:"tracksetup",track:i})))),this.data.trackEvents.add(i),n.start(this,i),this.timeUpdate(this,null,!0),i._id&&S.addTrackEvent.ref(this,i)):S.addTrackEvent(this,i),S.forEach(t,function(e,t){u.indexOf(t)===-1&&this.on(t,e)},this),this};S.p[e]=f[e]=function(r,o){var u=arguments.length,a,f,l,c,p;if(r&&!o)o=r,r=null;else{a=this.getTrackEvent(r);if(!!a)return p=o,c=s(a,p),a._natives._update?(this.data.trackEvents.remove(a),h.call(o,"start")&&(a.start=o.start),h.call(o,"end")&&(a.end=o.end),n.end(this,a),i&&t.call(this,a),a._natives._update.call(this,a,o),this.data.trackEvents.add(a),n.start(this,a),a._natives.type!=="cue"&&this.emit("trackchange",{id:a.id,type:"trackchange",previousValue:c,currentValue:p,track:a}),this):(S.extend(a,o),this.data.trackEvents.remove(r),a._natives._teardown&&a._natives._teardown.call(this,a),S.removeTrackEvent.ref(this,r),i?d.call(this,t.call(this,a),a):(a._id=a.id||a._id||S.guid(a._natives.type),a._natives&&a._natives._setup&&(a._natives._setup.call(this,a),this.emit("tracksetup",S.extend({},a,{plugin:a._natives.type,type:"tracksetup",track:a}))),this.data.trackEvents.add(a),n.start(this,a),this.timeUpdate(this,null,!0),S.addTrackEvent.ref(this,a)),this.emit("trackchange",{id:a.id,type:"trackchange",previousValue:c,currentValue:a,track:a}),this);o.id=r}return this.data.running[e]=this.data.running[e]||[],f=this.options.defaults&&this.options.defaults[e]||{},l=S.extend({},f,o),d.call(this,i?t.call(this,l):t,l),this},r&&S.extend(t,{manifest:r});var v={fn:f[e],definition:t,base:t,parents:[],name:e};return S.registry.push(S.extend(f,v,{type:e})),S.registryByName[e]=v,f},S.plugin.errors=[],S.plugin.debug=S.version==="@VERSION",S.removePlugin=function(e,t){if(!t){t=e,e=S.p;if(S.protect.natives.indexOf(t.toLowerCase())>=0){S.error("'"+t+"' is a protected function name");return}var n=S.registry.length,r;for(r=0;r<n;r++)if(S.registry[r].name===t){S.registry.splice(r,1),delete S.registryByName[t],delete S.manifest[t],delete e[t];return}}var i=e.data.trackEvents.byStart,s=e.data.trackEvents.byEnd,o=e.data.trackEvents.animating,u,a;for(u=0,a=i.length;u<a;u++)i[u]&&i[u]._natives&&i[u]._natives.type===t&&(i[u]._natives._teardown&&i[u]._natives._teardown.call(e,i[u]),i.splice(u,1),u--,a--,e.data.trackEvents.startIndex<=u&&(e.data.trackEvents.startIndex--,e.data.trackEvents.endIndex--)),s[u]&&s[u]._natives&&s[u]._natives.type===t&&s.splice(u,1);for(u=0,a=o.length;u<a;u++)o[u]&&o[u]._natives&&o[u]._natives.type===t&&(o.splice(u,1),u--,a--)},S.compositions={},S.compose=function(e,t,n){S.manifest[e]=n=n||t.manifest||{},S.compositions[e]=t},S.plugin.effect=S.effect=S.compose;var x=/^(?:\.|#|\[)/;S.dom={debug:!1,find:function(e,n){var r=null;n=n||t;if(e){if(!x.test(e)){r=t.getElementById(e);if(r!==null)return r}try{r=n.querySelector(e)}catch(i){if(S.dom.debug)throw new Error(i)}}return r}};var T=/\?/,N={ajax:null,url:"",data:"",dataType:"",success:S.nop,type:"GET",async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8"};S.xhr=function(e){var t;e.dataType=e.dataType&&e.dataType.toLowerCase()||null;if(!(!e.dataType||e.dataType!=="jsonp"&&e.dataType!=="script")){S.xhr.getJSONP(e.url,e.success,e.dataType==="script");return}t=S.extend({},N,e),t.ajax=new XMLHttpRequest;if(t.ajax)return t.type==="GET"&&t.data&&(t.url+=(T.test(t.url)?"&":"?")+t.data,t.data=null),t.ajax.open(t.type,t.url,t.async),t.type==="POST"&&t.ajax.setRequestHeader("Content-Type",t.contentType),t.ajax.send(t.data||null),S.xhr.httpData(t)},S.xhr.httpData=function(e){var t,n=null,r,i=null;return e.ajax.onreadystatechange=function(){if(e.ajax.readyState===4){try{n=JSON.parse(e.ajax.responseText)}catch(s){}t={xml:e.ajax.responseXML,text:e.ajax.responseText,json:n};if(!t.xml||!t.xml.documentElement){t.xml=null;try{r=new DOMParser,i=r.parseFromString(e.ajax.responseText,"text/xml"),i.getElementsByTagName("parsererror").length||(t.xml=i)}catch(s){}}e.dataType&&(t=t[e.dataType]),e.success.call(e.ajax,t)}},t},S.xhr.getJSONP=function(e,n,r){var i=t.head||t.getElementsByTagName("head")[0]||t.documentElement,s=t.createElement("script"),o=!1,u=[],a=/(=)\?(?=&|$)|\?\?/,f,l,c,h,p;r||(p=e.match(/(callback=[^&]*)/),p!==null&&p.length?(l=p[1].split("=")[1],l==="?"&&(l="jsonp"),h=S.guid(l),e=e.replace(/(callback=[^&]*)/,"callback="+h)):(h=S.guid("jsonp"),a.test(e)&&(e=e.replace(a,"$1"+h)),u=e.split(/\?(.+)?/),e=u[0]+"?",u[1]&&(e+=u[1]+"&"),e+="callback="+h),window[h]=function(e){n&&n(e),o=!0}),s.addEventListener("load",function(){r&&n&&n(),o&&delete window[h],i.removeChild(s)},!1),s.addEventListener("error",function(e){n&&n({error:e}),r||delete window[h],i.removeChild(s)},!1),s.src=e,i.insertBefore(s,i.firstChild);return},S.getJSONP=S.xhr.getJSONP,S.getScript=S.xhr.getScript=function(e,t){return S.xhr.getJSONP(e,t,!0)},S.util={toSeconds:function(e,t){var n=/^([0-9]+:){0,2}[0-9]+([.;][0-9]+)?$/,r="Invalid time format",i,s,o,u,a,f;return typeof e=="number"?e:(typeof e=="string"&&!n.test(e)&&S.error(r),i=e.split(":"),s=i.length-1,o=i[s],o.indexOf(";")>-1&&(a=o.split(";"),f=0,t&&typeof t=="number"&&(f=parseFloat(a[1],10)/t),i[s]=parseInt(a[0],10)+f),u=i[0],{1:parseFloat(u,10),2:parseInt(u,10)*60+parseFloat(i[1],10),3:parseInt(u,10)*3600+parseInt(i[1],10)*60+parseFloat(i[2],10)}[i.length||1])}},S.p.cue=S.p.exec,S.protect={natives:w(S.p).map(function(e){return e.toLowerCase()})},S.forEach({listen:"on",unlisten:"off",trigger:"emit",exec:"cue"},function(e,t){var n=S.p[t];S.p[t]=function(){return typeof console!="undefined"&&console.warn&&(console.warn("Deprecated method '"+t+"', "+(e==null?"do not use.":"use '"+e+"' instead.")),S.p[t]=n),S.p[e].apply(this,[].slice.call(arguments))}}),e.Popcorn=S}(window,window.document),function(e,t){function n(e){var t=typeof e=="string"?e:[e.language,e.region].join("-"),n=t.split("-");return{iso6391:t,language:n[0]||"",region:n[1]||""}}var r=e.navigator,i=n(r.userLanguage||r.language);t.locale={get:function(){return i},set:function(e){return i=n(e),t.locale.broadcast(),i},broadcast:function(e){var n=t.instances,r=n.length,i=0,s;e=e||"locale:changed";for(;i<r;i++)s=n[i],e in s.data.events&&s.trigger(e)}}}(this,this.Popcorn),function(e){var t=function(t,n){return t=t||e.nop,n=n||e.nop,function(){t.apply(this,arguments),n.apply(this,arguments)}},n=/^(#([\w\-\_\.]+))$/;e.player=function(n,r){if(e[n])return;r=r||{};var i=function(n,i,s){s=s||{};var o=new Date/1e3,u=o,a=0,f=0,l=1,c=!1,h={},p=typeof n=="string"?e.dom.find(n):n,d={},v,m;Object.prototype.__defineGetter__||(d=p||document.createElement("div"));for(var g in p){if(g in d)continue;typeof p[g]=="object"?d[g]=p[g]:typeof p[g]=="function"?d[g]=function(e){return"length"in p[e]&&!p[e].call?p[e]:function(){return p[e].apply(p,arguments)}}(g):e.player.defineProperty(d,g,{get:function(e){return function(){return p[e]}}(g),set:e.nop,configurable:!0})}var y=function(){o=new Date/1e3,d.paused||(d.currentTime=d.currentTime+(o-u),d.dispatchEvent("timeupdate"),v=setTimeout(y,10)),u=o};return d.play=function(){this.paused=!1,d.readyState>=4&&(u=new Date/1e3,d.dispatchEvent("play"),y())},d.pause=function(){this.paused=!0,d.dispatchEvent("pause")},e.player.defineProperty(d,"currentTime",{get:function(){return a},set:function(e){return a=+e,d.dispatchEvent("timeupdate"),a},configurable:!0}),e.player.defineProperty(d,"volume",{get:function(){return l},set:function(e){return l=+e,d.dispatchEvent("volumechange"),l},configurable:!0}),e.player.defineProperty(d,"muted",{get:function(){return c},set:function(e){return c=+e,d.dispatchEvent("volumechange"),c},configurable:!0}),e.player.defineProperty(d,"readyState",{get:function(){return f},set:function(e){return f=e,f},configurable:!0}),d.addEventListener=function(e,t){return h[e]||(h[e]=[]),h[e].push(t),t},d.removeEventListener=function(e,t){var n,r=h[e];if(!r)return;for(n=h[e].length-1;n>=0;n--)t===r[n]&&r.splice(n,1);return t},d.dispatchEvent=function(t){var n,r=this,i,s=t.type;s||(s=t,i=e.events.getInterface(s),i&&(n=document.createEvent(i),n.initEvent(s,!0,!0,window,1)));if(h[s])for(var o=h[s].length-1;o>=0;o--)h[s][o].call(r,n,r)},d.src=i||"",d.duration=0,d.paused=!0,d.ended=0,s&&s.events&&e.forEach(s.events,function(e,t){d.addEventListener(t,e,!1)}),r._canPlayType(p.nodeName,i)!==!1?r._setup?r._setup.call(d,s):(d.readyState=4,d.dispatchEvent("loadedmetadata"),d.dispatchEvent("loadeddata"),d.dispatchEvent("canplaythrough")):setTimeout(function(){d.dispatchEvent("error")},0),m=new e.p.init(d,s),r._teardown&&(m.destroy=t(m.destroy,function(){r._teardown.call(d,s)})),m};i.canPlayType=r._canPlayType=r._canPlayType||e.nop,e[n]=e.player.registry[n]=i},e.player.registry={},e.player.defineProperty=Object.defineProperty||function(t,n,r){t.__defineGetter__(n,r.get||e.nop),t.__defineSetter__(n,r.set||e.nop)},e.player.playerQueue=function(){var e=[],t=!1;return{next:function(){t=!1,e.shift(),e[0]&&e[0]()},add:function(n){e.push(function(){t=!0,n&&n()}),!t&&e[0]()}}},e.smart=function(t,n,r){var i=typeof t=="string"?e.dom.find(t):t,s,o,u,a,f,l,c,h="HTMLVimeoVideoElement HTMLSoundCloudAudioElement HTMLNullVideoElement".split(" ");if(!i){e.error("Specified target `"+t+"` was not found.");return}n=typeof n=="string"?[n]:n;for(s=0,c=n.length;s<c;s++){o=n[s];for(u=0;u<h.length;u++){f=e[h[u]];if(f&&f._canPlaySrc(o)==="probably")return a=f(i),l=e(a,r),setTimeout(function(){a.src=o},0),l}for(var p in e.player.registry)if(e.player.registry.hasOwnProperty(p)&&e.player.registry[p].canPlayType(i.nodeName,o))return e[p](i,o,r)}var d,v=e.guid("popcorn-video-");d='<video id="'+v+'" preload=auto autobuffer>';for(s=0,c=n.length;s<c;s++)d+='<source src="'+n[s]+'">';return d+="</video>",i.innerHTML=d,r&&r.events&&r.events.error&&i.addEventListener("error",r.events.error,!1),e("#"+v,r)}}(Popcorn),function(e,t){var n=e.document,r=e.location,i=/:\/\//,s=r.href.replace(r.href.split("/").slice(-1)[0],""),o=function(e,t,n){e=e||0,t=(t||e||0)+1,n=n||1;var r=Math.ceil((t-e)/n)||0,i=0,s=[];s.length=r;while(i<r)s[i++]=e,e+=n;return s};t.sequence=function(e,n){return new t.sequence.init(e,n)},t.sequence.init=function(e,r){this.parent=n.getElementById(e),this.seqId=t.guid("__sequenced"),this.queue=[],this.playlist=[],this.inOuts={ofVideos:[],ofClips:[]},this.dims={width:0,height:0},this.active=0,this.cycling=!1,this.playing=!1,this.times={last:0},this.events={};var o=this,u=0;return t.forEach(r,function(r,u){var a=n.createElement("video");a.preload="auto",a.controls=!0,a.style.display=u&&"none"||"",a.id=o.seqId+"-"+u,o.queue.push(a);var f=r["in"],l=r.out;o.inOuts.ofVideos.push({"in":f!==undefined&&f||1,out:l!==undefined&&l||0}),o.inOuts.ofVideos[u].out=o.inOuts.ofVideos[u].out||o.inOuts.ofVideos[u]["in"]+2,a.src=i.test(r.src)?r.src:s+r.src,a.setAttribute("data-sequence-owner",e),a.setAttribute("data-sequence-guid",o.seqId),a.setAttribute("data-sequence-id",u),a.setAttribute("data-sequence-clip",[o.inOuts.ofVideos[u]["in"],o.inOuts.ofVideos[u].out].join(":")),o.parent.appendChild(a),o.playlist.push(t("#"+a.id))}),o.inOuts.ofVideos.forEach(function(e){var t=e.out-e["in"],n={"in":u,out:u+t};o.inOuts.ofClips.push(n),u=n.out+1}),t.forEach(this.queue,function(e,n){function r(t){return n||(o.dims.width=e.videoWidth,o.dims.height=e.videoHeight),e.currentTime=o.inOuts.ofVideos[n]["in"]-.5,e.removeEventListener("canplaythrough",r,!1),!0}e.addEventListener("canplaythrough",r,!1),e.addEventListener("play",function(e){o.playing=!0},!1),e.addEventListener("pause",function(e){o.playing=!1},!1),e.addEventListener("timeupdate",function(n){var r=n.srcElement||n.target,i=+(r.dataset&&r.dataset.sequenceId||r.getAttribute("data-sequence-id")),s=Math.floor(e.currentTime);o.times.last!==s&&i===o.active&&(o.times.last=s,s===o.inOuts.ofVideos[i].out&&t.sequence.cycle.call(o,i))},!1)}),this},t.sequence.init.prototype=t.sequence.prototype,t.sequence.cycle=function(e){this.queue||t.error("Popcorn.sequence.cycle is not a public method");var n=this.queue,r=this.inOuts.ofVideos,i=n[e],s=0,o,u,a,f;return n[e+1]&&(s=e+1),n[e+1]?(o=n[s],u=r[s],t.extend(o,{width:this.dims.width,height:this.dims.height}),a=this.playlist[s],f=this.playlist[e],i.pause(),this.active=s,this.times.last=u["in"]-1,a.currentTime(u["in"]),a[s?"play":"pause"](),this.trigger("cycle",{position:{previous:e,current:s}}),s&&(i.style.display="none",o.style.display=""),this.cycling=!1):(s=0,this.playlist[e].pause()),this};var u=["timeupdate","play","pause"];t.extend(t.sequence.prototype,{eq:function(e){return this.playlist[e]},remove:function(){this.parent.innerHTML=null},clip:function(e){return this.inOuts.ofVideos[e]},duration:function(){var e=0,t=this.inOuts.ofClips,n=0;for(;n<t.length;n++)e+=t[n].out-t[n]["in"]+1;return e-1},play:function(){return this.playlist[this.active].play(),this},exec:function(e,n){var r=this.active;return this.inOuts.ofClips.forEach(function(t,n){e>=t["in"]&&e<=t.out&&(r=n)}),e+=this.inOuts.ofVideos[r]["in"]-this.inOuts.ofClips[r]["in"],t.addTrackEvent(this.playlist[r],{start:e-1,end:e,_running:!1,_natives:{start:n||t.nop,end:t.nop,type:"exec"}}),this},listen:function(e,n){var r=this,i=this.playlist,s=i.length,o=0,a;return n||(n=t.nop),t.Events.Natives.indexOf(e)>-1?t.forEach(i,function(t){t.listen(e,function(i){i.active=r,u.indexOf(e)>-1?n.call(t,i):++o===s&&n.call(t,i)})}):(this.events[e]||(this.events[e]={}),a=n.name||t.guid("__"+e),this.events[e][a]=n),this},unlisten:function(e,t){},trigger:function(e,n){var r=this;if(t.Events.Natives.indexOf(e)>-1)return;return this.events[e]&&t.forEach(this.events[e],function(t,i){t.call(r,{type:e},n)}),this}}),t.forEach(t.manifest,function(e,n){t.sequence.prototype[n]=function(e){var r={},i=[],s,u,a,f,l,c,h,p,d;for(s=0;s<this.inOuts.ofClips.length;s++)u=this.inOuts.ofClips[s],a=o(u["in"],u.out),f=a.indexOf(e.start),l=a.indexOf(e.end),f>-1&&(r[s]=t.extend({},u,{start:a[f],clipIdx:f})),l>-1&&(r[s]=t.extend({},u,{end:a[l],clipIdx:l}));c=Object.keys(r).map(function(e){return+e}),i=o(c[0],c[1]);for(s=0;s<i.length;s++){var v={},m=i[s],g=r[m];g?(h=this.inOuts.ofVideos[m],p=g.clipIdx,d=o(h["in"],h.out),g.start&&(v.start=d[p],v.end=d[d.length-1]),g.end&&(v.start=d[0],v.end=d[p])):(v.start=this.inOuts.ofVideos[m]["in"],v.end=this.inOuts.ofVideos[m].out),this.playlist[m][n](t.extend({},e,v))}return this}})}(this,Popcorn),function(e){document.addEventListener("DOMContentLoaded",function(){var t="data-timeline-sources",n=document.querySelectorAll("["+t+"]");e.forEach(n,function(r,i){var s=n[i],o=!1,u,a,f;s.id||(s.id=e.guid("__popcorn")),s.nodeType&&s.nodeType===1&&(f=e("#"+s.id),u=(s.getAttribute(t)||"").split(","),u[0]&&e.forEach(u,function(e){a=e.split("!"),a.length===1&&(a=e.match(/(.*)[\/\\]([^\/\\]+\.\w+)$/)[2].split("."),a[0]="parse"+a[1].toUpperCase(),a[1]=e),u[0]&&f[a[0]]&&f[a[0]](a[1])}),!f.autoplay()||f.play())})},!1)}(Popcorn),function(e){var t=Array.prototype,n=Object.prototype,r=t.forEach,i=t.slice,s=n.hasOwnProperty,o=n.toString;e.parsers={},e.parser=function(t,n,r){if(e.protect.natives.indexOf(t.toLowerCase())>=0){e.error("'"+t+"' is a protected function name");return}typeof n=="function"&&!r&&(r=n,n="");if(typeof r!="function"||typeof n!="string")return;var i=e.events.all,o,u={};return o=function(t,i,o){if(!t)return this;typeof i!="function"&&!o&&(o=i,i=null);var u=this;return e.xhr({url:t,dataType:n,success:function(e){var t=r(e,o),n,a,f,l=0;n=t.data||[],a=n.length,f=null;if(!a)return;for(;l<a;l++){f=n[l];for(var c in f)s.call(f,c)&&!!u[c]&&u[c](f[c])}i&&i()}}),this},u[t]=o,e.extend(e.p,u),u}}(Popcorn),function(e,t){function n(e){var t=n.options,r=t.parser[t.strictMode?"strict":"loose"].exec(e),i={},s=14;while(s--)i[t.key[s]]=r[s]||"";return i[t.q.name]={},i[t.key[12]].replace(t.q.parser,function(e,n,r){n&&(i[t.q.name][n]=r)}),i}function r(){var r={},s={},o;return Object.prototype.__defineGetter__||(r=t.createElement("div")),r._util={type:"HTML5",TIMEUPDATE_MS:250,MIN_WIDTH:300,MIN_HEIGHT:150,isAttributeSet:function(e){return typeof e=="string"||e===!0},parseUri:n},r.addEventListener=function(e,n,r){t.addEventListener(this._eventNamespace+e,n,r)},r.removeEventListener=function(e,n,r){t.removeEventListener(this._eventNamespace+e,n,r)},r.dispatchEvent=function(e){var n=t.createEvent("CustomEvent"),r={type:e,target:this.parentNode,data:null};n.initCustomEvent(this._eventNamespace+e,!1,!1,r),t.dispatchEvent(n)},r.load=e.nop,r.canPlayType=function(e){return""},r.getBoundingClientRect=function(){return o.getBoundingClientRect()},r.NETWORK_EMPTY=0,r.NETWORK_IDLE=1,r.NETWORK_LOADING=2,r.NETWORK_NO_SOURCE=3,r.HAVE_NOTHING=0,r.HAVE_METADATA=1,r.HAVE_CURRENT_DATA=2,r.HAVE_FUTURE_DATA=3,r.HAVE_ENOUGH_DATA=4,Object.defineProperties(r,{currentSrc:{get:function(){return this.src!==undefined?this.src:""},configurable:!0},parentNode:{get:function(){return o},set:function(e){o=e},configurable:!0},preload:{get:function(){return"auto"},set:e.nop,configurable:!0},controls:{get:function(){return!0},set:e.nop,configurable:!0},poster:{get:function(){return""},set:e.nop,configurable:!0},crossorigin:{get:function(){return""},configurable:!0},played:{get:function(){return i},configurable:!0},seekable:{get:function(){return i},configurable:!0},buffered:{get:function(){return i},configurable:!0},defaultMuted:{get:function(){return!1},configurable:!0},defaultPlaybackRate:{get:function(){return 1},configurable:!0},style:{get:function(){return this.parentNode.style},configurable:!0},id:{get:function(){return this.parentNode.id},configurable:!0}}),r}n.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var i={length:0,start:e.nop,end:e.nop};window.MediaError=window.MediaError||function(){function e(e,t){this.code=e||null,this.message=t||""}return e.MEDIA_ERR_NONE_ACTIVE=0,e.MEDIA_ERR_ABORTED=1,e.MEDIA_ERR_NETWORK=2,e.MEDIA_ERR_DECODE=3,e.MEDIA_ERR_NONE_SUPPORTED=4,e}(),e._MediaElementProto=r}(Popcorn,window.document),function(e,t,n){function r(e){function n(t,n){var r=JSON.stringify({method:t,value:n});if(!e.contentWindow)return;e.contentWindow.postMessage(r,i)}var r=this,i=e.src.split("?")[0],s=0;i.substr(0,2)==="//"&&(i=t.location.protocol+i);var o="play pause paused seekTo unload getCurrentTime getDuration getVideoEmbedCode getVideoHeight getVideoWidth getVideoUrl getColor setColor setLoop getVolume setVolume addEventListener".split(" ");o.forEach(function(e){r[e]=function(t){n(e,t)}})}function i(i){function a(e){F.unshift(e)}function f(e){B.addEventListener("loadProgress"),B.addEventListener("playProgress"),B.addEventListener("play"),B.addEventListener("pause"),B.addEventListener("finish"),B.addEventListener("seek"),B.getDuration(),D.networkState=O.NETWORK_LOADING,O.dispatchEvent("loadstart"),O.dispatchEvent("progress")}function l(e){var t=D.duration;if(t!==e){D.duration=e,O.dispatchEvent("durationchange");if(isNaN(t)){D.networkState=O.NETWORK_IDLE,D.readyState=O.HAVE_METADATA,O.dispatchEvent("loadedmetadata"),O.dispatchEvent("loadeddata"),D.readyState=O.HAVE_FUTURE_DATA,O.dispatchEvent("canplay"),D.readyState=O.HAVE_ENOUGH_DATA,O.dispatchEvent("canplaythrough"),D.autoplay&&O.play();var n=F.length;while(n--)F[n](),delete F[n]}}}function c(){P||a(function(){c()}),B.getDuration()}function h(){if(!P||!B)return;clearInterval(q),B.pause(),t.removeEventListener("message",S,!1),M.removeChild(_),_=n.createElement("iframe")}function p(e){if(!P){a(function(){p(e)});return}d(),B.seekTo(e)}function d(){D.seeking=!0,O.dispatchEvent("seeking")}function v(){D.seeking=!1,O.dispatchEvent("timeupdate"),O.dispatchEvent("seeked"),O.dispatchEvent("canplay"),O.dispatchEvent("canplaythrough")}function m(){D.paused=!0,j||(j=!0,clearInterval(I),O.dispatchEvent("pause"))}function g(){O.dispatchEvent("timeupdate")}function y(){D.ended&&p(0),q||(q=setInterval(x,s),D.loop&&O.dispatchEvent("play")),I=setInterval(g,O._util.TIMEUPDATE_MS),D.paused=!1,j&&(j=!1,D.loop||O.dispatchEvent("play"),O.dispatchEvent("playing"))}function b(){D.loop?(p(0),O.play()):(D.ended=!0,O.dispatchEvent("ended"))}function w(e){var t=D.currentTime=e;t!==R&&O.dispatchEvent("timeupdate"),R=D.currentTime}function E(e){if(e.origin!==u)return;var n;try{n=JSON.parse(e.data)}catch(i){console.warn(i)}if(n.player_id!=H)return;switch(n.event){case"ready":B=new r(_),B.addEventListener("loadProgress"),B.addEventListener("pause"),B.setVolume(0),B.play();break;case"loadProgress":var s=parseFloat(n.data.duration);s>0&&!P&&(P=!0,B.pause());break;case"pause":B.setVolume(1),t.removeEventListener("message",E,!1),t.addEventListener("message",S,!1),f()}}function S(e){if(e.origin!==u)return;var t;try{t=JSON.parse(e.data)}catch(n){console.warn(n)}if(t.player_id!=H)return;switch(t.method){case"getCurrentTime":w(parseFloat(t.value));break;case"getDuration":l(parseFloat(t.value));break;case"getVolume":N(parseFloat(t.value))}switch(t.event){case"loadProgress":O.dispatchEvent("progress"),l(parseFloat(t.data.duration));break;case"playProgress":w(parseFloat(t.data.seconds));break;case"play":y();break;case"pause":m();break;case"finish":b();break;case"seek":w(parseFloat(t.data.seconds)),v()}}function x(){B.getCurrentTime()}function T(e){if(!O._canPlaySrc(e)){D.error={name:"MediaError",message:"Media Source Not Supported",code:MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED},O.dispatchEvent("error");return}D.src=e,P&&h(),P=!1;var n=O._util.parseUri(e),r=n.queryKey,i,s=["api=1","player_id="+H,"title=0","byline=0","portrait=0"];D.loop=r.loop==="1"||D.loop,delete r.loop,D.autoplay=r.autoplay==="1"||D.autoplay,delete r.autoplay,n=u+"/video/"+/\d+$/.exec(n.path)+"?";for(i in r)r.hasOwnProperty(i)&&s.push(encodeURIComponent(i)+"="+encodeURIComponent(r[i]));n+=s.join("&"),_.id=H,_.style.width="100%",_.style.height="100%",_.frameBorder=0,_.webkitAllowFullScreen=!0,_.mozAllowFullScreen=!0,_.allowFullScreen=!0,M.appendChild(_),_.src=n,t.addEventListener("message",E,!1)}function N(e){D.volume!==e&&(D.volume=e,O.dispatchEvent("volumechange"))}function C(e){D.volume=e;if(!P){a(function(){C(e)});return}B.setVolume(e),O.dispatchEvent("volumechange")}function k(){return D.muted>0?D.muted:D.volume}function L(e){if(!P){D.muted=e?1:0,a(function(){L(e)});return}e?(D.muted=D.volume,C(0)):(D.muted=0,C(D.muted))}function A(){return D.muted>0}if(!t.postMessage)throw"ERROR: HTMLVimeoVideoElement requires window.postMessage";var O=new e._MediaElementProto,M=typeof i=="string"?e.dom.find(i):i,_=n.createElement("iframe"),D={src:o,networkState:O.NETWORK_EMPTY,readyState:O.HAVE_NOTHING,seeking:!1,autoplay:o,preload:o,controls:!1,loop:!1,poster:o,volume:1,muted:0,currentTime:0,duration:NaN,ended:!1,paused:!0,error:null},P=!1,H=e.guid(),B,j=!0,F=[],I,q,R=0;return O._eventNamespace=e.guid("HTMLVimeoVideoElement::"),O.parentNode=M,O._util.type="Vimeo",O.play=function(){D.paused=!1;if(!P){a(function(){O.play()});return}B.play()},O.pause=function(){D.paused=!0;if(!P){a(function(){O.pause()});return}B.pause()},Object.defineProperties(O,{src:{get:function(){return D.src},set:function(e){e&&e!==D.src&&T(e)}},autoplay:{get:function(){return D.autoplay},set:function(e){D.autoplay=O._util.isAttributeSet(e)}},loop:{get:function(){return D.loop},set:function(e){D.loop=O._util.isAttributeSet(e)}},width:{get:function(){return O.parentNode.offsetWidth}},height:{get:function(){return O.parentNode.offsetHeight}},currentTime:{get:function(){return D.currentTime},set:function(e){p(e)}},duration:{get:function(){return D.duration}},ended:{get:function(){return D.ended}},paused:{get:function(){return D.paused}},seeking:{get:function(){return D.seeking}},readyState:{get:function(){return D.readyState}},networkState:{get:function(){return D.networkState}},volume:{get:function(){return k()},set:function(e){if(e<0||e>1)throw"Volume value must be between 0.0 and 1.0";C(e)}},muted:{get:function(){return A()},set:function(e){L(O._util.isAttributeSet(e))}},error:{get:function(){return D.error}}}),O._canPlaySrc=e.HTMLVimeoVideoElement._canPlaySrc,O.canPlayType=e.HTMLVimeoVideoElement.canPlayType,O}var s=16,o="",u="https://player.vimeo.com";e.HTMLVimeoVideoElement=function(e){return new i(e)},e.HTMLVimeoVideoElement._canPlaySrc=function(e){return/player.vimeo.com\/video\/\d+/.test(e)||/vimeo.com\/\d+/.test(e)?"probably":o},e.HTMLVimeoVideoElement.canPlayType=function(e){return e==="video/x-vimeo"?"probably":o}}(Popcorn,window,document),function(e,t,n){function r(){var e;if(YT.loaded){c=!0;while(p.length)e=p.shift(),e()}else setTimeout(r,250)}function i(){var e;return h||(t.YT?r():(e=n.createElement("script"),e.addEventListener("load",r,!1),e.src="https://www.youtube.com/iframe_api",n.head.appendChild(e)),h=!0),c}function s(e){p.push(e)}function o(r){function o(e){V.push(e)}function c(){W.pauseVideo(),b("play",c),y("play",M)}function h(){y("pause",D),b("pause",h)}function p(e){var t=function(){W.isMuted()?(y("play",g),W.playVideo()):setTimeout(t,0)};R=!0,W.mute(),t()}function d(e){var t={name:"MediaError"};switch(e.data){case 2:t.message="Invalid video parameter.",t.code=MediaError.MEDIA_ERR_ABORTED;break;case 5:t.message="The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.",t.code=MediaError.MEDIA_ERR_DECODE;case 100:t.message="Video not found.",t.code=MediaError.MEDIA_ERR_NETWORK;break;case 101:case 150:t.message="Video not usable.",t.code=MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED;break;default:t.message="Unknown error.",t.code=5}q.error=t,j.dispatchEvent("error")}function v(){y("play",M),y("pause",D);if(q.autoplay||!q.paused)b("play",v),q.paused=!1,o(function(){q.paused||M()});q.muted||W.unMute(),q.readyState=j.HAVE_METADATA,j.dispatchEvent("loadedmetadata"),Q=setInterval(N,u),j.dispatchEvent("loadeddata"),q.readyState=j.HAVE_FUTURE_DATA,j.dispatchEvent("canplay"),U=!0,J=setInterval(C,50);while(V.length)V[0](),V.shift();q.readyState=j.HAVE_ENOUGH_DATA,j.dispatchEvent("canplaythrough")}function m(){b("pause",m);if(W.getCurrentTime()>0){setTimeout(m,0);return}q.autoplay||!q.paused?(y("play",v),W.playVideo()):v()}function g(){b("play",g);if(W.getCurrentTime()===0){setTimeout(g,0);return}y("pause",m),W.seekTo(0),W.pauseVideo()}function y(e,t){j.addEventListener("youtube-"+e,t,!1)}function b(e,t){j.removeEventListener("youtube-"+e,t,!1)}function w(e){j.dispatchEvent("youtube-"+e)}function E(){q.networkState=j.NETWORK_LOADING;var e=W.getDuration();q.duration!==e&&(q.duration=e,j.dispatchEvent("durationchange")),j.dispatchEvent("waiting")}function S(e){switch(e.data){case YT.PlayerState.ENDED:w("ended");break;case YT.PlayerState.PLAYING:w("play");break;case YT.PlayerState.PAUSED:W.getDuration()!==W.getCurrentTime()&&w("pause");break;case YT.PlayerState.BUFFERING:w("buffering");break;case YT.PlayerState.CUED:}e.data!==YT.PlayerState.BUFFERING&&$===YT.PlayerState.BUFFERING&&_(),$=e.data}function x(){if(!R||!W)return;b("buffering",E),b("ended",P),b("play",M),b("pause",D),D(),U=!1,z=!1,q.currentTime=0,V=[],clearInterval(Q),clearInterval(J),W.stopVideo(),W.clearVideo(),W.destroy(),I=n.createElement("div")}function T(e){if(!j._canPlaySrc(e)){q.error={name:"MediaError",message:"Media Source Not Supported",code:MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED},j.dispatchEvent("error");return}q.src=e;if(!i()){s(function(){T(e)});return}if(R){if(!U){o(function(){T(e)});return}x()}F.appendChild(I);var n=j._util.parseUri(e).queryKey;delete n.v,q.autoplay=n.autoplay==="1"||q.autoplay,delete n.autoplay,q.loop=n.loop==="1"||q.loop,delete n.loop,n.rel=n.rel||0,n.modestbranding=n.modestbranding||1,n.iv_load_policy=n.iv_load_policy||3,n.disablekb=n.disablekb||1,n.showinfo=n.showinfo||0;var r=t.location.protocol==="file:"?"*":t.location.protocol+"//"+t.location.host;n.origin=n.origin||r,n.controls=n.controls||q.controls?2:0,q.controls=n.controls,n.wmode=n.wmode||"opaque",n.html5!==0&&(n.html5=1),e=f.exec(e)[1],W=new YT.Player(I,{width:"100%",height:"100%",wmode:n.wmode,videoId:e,playerVars:n,events:{onReady:p,onError:d,onStateChange:S}}),q.networkState=j.NETWORK_LOADING,j.dispatchEvent("loadstart"),j.dispatchEvent("progress")}function N(){var e=W.getCurrentTime();q.seeking?l(e-q.currentTime)<1&&O():(l(q.currentTime-e)>u&&(A(),O()),q.currentTime=e)}function C(){var e=W.getVideoLoadedFraction();e&&K!==e&&(K=e,_())}function k(e){if(e===q.currentTime)return;q.currentTime=e;if(!U){o(function(){A(),W.seekTo(e)});return}A(),W.seekTo(e)}function L(){j.dispatchEvent("timeupdate")}function A(){y("pause",h),b("pause",D),q.seeking=!0,j.dispatchEvent("seeking")}function O(){q.ended=!1,q.seeking=!1,j.dispatchEvent("timeupdate"),j.dispatchEvent("seeked"),j.dispatchEvent("canplay"),j.dispatchEvent("canplaythrough")}function M(){q.ended&&(k(0),q.ended=!1),G=setInterval(L,j._util.TIMEUPDATE_MS),q.paused=!1;if(X){X=!1;if(q.loop&&!z||!q.loop)z=!0,j.dispatchEvent("play");j.dispatchEvent("playing")}}function _(){j.dispatchEvent("progress")}function D(){q.paused=!0,X||(X=!0,clearInterval(G),j.dispatchEvent("pause"))}function P(){q.loop?(k(0),j.play()):(q.ended=!0,D(),y("play",c),b("play",M),j.dispatchEvent("timeupdate"),j.dispatchEvent("ended"))}function H(e){q.muted=e;if(!U){o(function(){H(q.muted)});return}W[e?"mute":"unMute"](),j.dispatchEvent("volumechange")}function B(){return q.muted}if(!t.postMessage)throw"ERROR: HTMLYouTubeVideoElement requires window.postMessage";var j=new e._MediaElementProto,F=typeof r=="string"?n.querySelector(r):r,I=n.createElement("div"),q={src:a,networkState:j.NETWORK_EMPTY,readyState:j.HAVE_NOTHING,seeking:!1,autoplay:a,preload:a,controls:!1,loop:!1,poster:a,volume:1,muted:!1,currentTime:0,duration:NaN,ended:!1,paused:!0,error:null},R=!1,U=!1,z=!1,W,X=!0,V=[],$=-1,J,K=0,Q,G;return j._eventNamespace=e.guid("HTMLYouTubeVideoElement::"),j.parentNode=F,j._util.type="YouTube",y("buffering",E),y("ended",P),j.play=function(){q.paused=!1;if(!U){o(function(){j.play()});return}W.playVideo()},j.pause=function(){q.paused=!0;if(!U){o(function(){j.pause()});return}h(),W.pauseVideo()},Object.defineProperties(j,{src:{get:function(){return q.src},set:function(e){e&&e!==q.src&&T(e)}},autoplay:{get:function(){return q.autoplay},set:function(e){q.autoplay=j._util.isAttributeSet(e)}},loop:{get:function(){return q.loop},set:function(e){q.loop=j._util.isAttributeSet(e)}},width:{get:function(){return j.parentNode.offsetWidth}},height:{get:function(){return j.parentNode.offsetHeight}},currentTime:{get:function(){return q.currentTime},set:function(e){k(e)}},duration:{get:function(){return q.duration}},ended:{get:function(){return q.ended}},paused:{get:function(){return q.paused}},seeking:{get:function(){return q.seeking}},readyState:{get:function(){return q.readyState}},networkState:{get:function(){return q.networkState}},volume:{get:function(){return q.volume},set:function(e){if(e<0||e>1)throw"Volume value must be between 0.0 and 1.0";q.volume=e;if(!U){o(function(){j.volume=e});return}W.setVolume(q.volume*100),j.dispatchEvent("volumechange")}},muted:{get:function(){return B()},set:function(e){H(j._util.isAttributeSet(e))}},error:{get:function(){return q.error}},buffered:{get:function(){var e={start:function(e){if(e===0)return 0;throw"INDEX_SIZE_ERR: DOM Exception 1"},end:function(e){if(e===0)return q.duration?q.duration*K:0;throw"INDEX_SIZE_ERR: DOM Exception 1"},length:1};return e},configurable:!0}}),j._canPlaySrc=e.HTMLYouTubeVideoElement._canPlaySrc,j.canPlayType=e.HTMLYouTubeVideoElement.canPlayType,j}var u=10,a="",f=/^.*(?:\/|v=)(.{11})/,l=Math.abs,c=!1,h=!1,p=[];e.HTMLYouTubeVideoElement=function(e){return new o(e)},e.HTMLYouTubeVideoElement._canPlaySrc=function(e){return/(?:http:\/\/www\.|http:\/\/|www\.|\.|^)(youtu).*(?:\/|v=)(.{11})/.test(e)?"probably":a},e.HTMLYouTubeVideoElement.canPlayType=function(e){return e==="video/x-youtube"?"probably":a}}(Popcorn,window,document),function(e,t){function n(e){return"maybe"}function r(e,r){var i=typeof e=="string"?t.querySelector(e):e,s=t.createElement(r);return i.appendChild(s),s._canPlaySrc=n,s}e.HTMLVideoElement=function(e){return r(e,"video")},e.HTMLVideoElement._canPlaySrc=n,e.HTMLAudioElement=function(e){return r(e,"audio")},e.HTMLAudioElement._canPlaySrc=n}(Popcorn,window.document),function(e,t,n){function r(){f=!0;var e=c.length;while(e--)c[e](),delete c[e]}function i(){t.jwplayer?r():setTimeout(i,100)}function s(){if(!l){if(!t.jwplayer){var e=n.createElement("script");e.src="https://jwpsrv.com/library/zaIF4JI9EeK2FSIACpYGxA.js";var r=n.getElementsByTagName("script")[0];r.parentNode.insertBefore(e,r)}l=!0,i()}return f}function o(e){c.unshift(e)}function u(r){function i(e){I.unshift(e)}function u(){var e=j.getDuration();if(e==-1||e==undefined)setTimeout(u,0);else{M.duration=e,A.dispatchEvent("durationchange"),_=!0,M.readyState=A.HAVE_METADATA,A.dispatchEvent("loadedmetadata"),A.dispatchEvent("loadeddata"),M.readyState=A.HAVE_FUTURE_DATA,A.dispatchEvent("canplay"),H=!0;var t=0;while(I.length)I[t](),I.shift();M.readyState=A.HAVE_ENOUGH_DATA,A.dispatchEvent("canplaythrough")}}function f(){u()}function l(){D?D=!1:z?(z=!1,f()):T()}function c(){U?(U=!1,M.autoplay||!M.paused?(M.paused=!1,i(S),f()):(z=!0,P=!0,j.pause(!0))):P?(P=!1,D=!0,j.pause(!0)):S()}function h(){M.seeking&&E()}function p(){j.onPause(l),j.onTime(function(){!M.ended&&!M.seeking&&(M.currentTime=j.getPosition(),A.dispatchEvent("timeupdate"))}),j.onSeek(h),j.onPlay(function(){M.ended||c()}),j.onBufferChange(x),j.onComplete(N),j.play(!0)}function d(){return j.getDuration()}function v(e){var t={name:"MediaError"};t.message=e.message,t.code=e.code||5,M.error=t,A.dispatchEvent("error")}function m(){if(!_||!j)return;j.destroy()}function g(e){if(!A._canPlaySrc(e)){M.error={name:"MediaError",message:"Media Source Not Supported",code:MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED},A.dispatchEvent("error");return}var t=A._util.parseUri(e).queryKey;M.controls=t.controls=t.controls||M.controls,M.src=e;if(!s()){o(function(){g(e)});return}_&&m();var n={width:"100%",height:"100%",autostart:M.autoplay,controls:M.controls};typeof e=="string"?n.file=e:n.sources=e,jwplayer(O.id).setup(n),j=jwplayer(O.id),j.onReady(p),j.onError(v),jwplayer.utils.log=function(e,t){typeof console!="undefined"&&typeof console.log!="undefined"&&(t?console.log(e,t):console.log(e)),e==="No suitable players found and fallback enabled"&&v({message:e,code:4})},M.networkState=A.NETWORK_LOADING,A.dispatchEvent("loadstart"),A.dispatchEvent("progress")}function y(){return M.currentTime}function b(e){M.currentTime=e;if(!H){i(function(){w(),j.seek(e)});return}w(),j.seek(e)}function w(){M.seeking=!0,M.paused&&(P=!0),A.dispatchEvent("seeking")}function E(){M.ended=!1,M.seeking=!1,A.dispatchEvent("timeupdate"),A.dispatchEvent("seeked"),A.dispatchEvent("canplay"),A.dispatchEvent("canplaythrough")}function S(){M.paused=!1;if(_&&F){F=!1;if(M.loop&&!B||!M.loop)B=!0,A.dispatchEvent("play");A.dispatchEvent("playing")}}function x(){A.dispatchEvent("progress")}function T(){M.paused=!0,F||(F=!0,A.dispatchEvent("pause"))}function N(){M.loop?b(0):(M.ended=!0,T(),A.dispatchEvent("timeupdate"),A.dispatchEvent("ended"))}function C(e){M.volume=e;if(!H){i(function(){C(M.volume)});return}j.setVolume(M.volume*100),A.dispatchEvent("volumechange")}function k(e){M.muted=e;if(!H){i(function(){k(M.muted)});return}j.setMute(e),A.dispatchEvent("volumechange")}function L(){return M.muted}if(!t.postMessage)throw"ERROR: HTMLJWPlayerVideoElement requires window.postMessage";var A=new e._MediaElementProto,O=typeof r=="string"?n.querySelector(r):r,M={src:a,networkState:A.NETWORK_EMPTY,readyState:A.HAVE_NOTHING,seeking:!1,autoplay:a,preload:a,controls:!1,loop:!1,poster:a,volume:1,muted:!1,currentTime:0,duration:NaN,ended:!1,paused:!0,error:null},_=!1,D=!1,P=!1,H=!1,B=!1,j,F=!0,I=[],q=-1,R=0,U=!0,z=!1;return A._eventNamespace=e.guid("HTMLJWPlayerVideoElement::"),A.parentNode=O,A._util.type="JWPlayer",A.play=function(){A.dispatchEvent("play"),M.paused=!1;if(!H){i(function(){A.play()});return}M.ended&&(b(0),M.ended=!1),j.play(!0)},A.pause=function(){M.paused=!0;if(!H){i(function(){A.pause()});return}j.pause(!0)},Object.defineProperties(A,{src:{get:function(){return M.src},set:function(e){e&&e!==M.src&&g(e)}},autoplay:{get:function(){return M.autoplay},set:function(e){M.autoplay=A._util.isAttributeSet(e)}},loop:{get:function(){return M.loop},set:function(e){M.loop=A._util.isAttributeSet(e)}},width:{get:function(){return A.parentNode.offsetWidth}},height:{get:function(){return A.parentNode.offsetHeight}},currentTime:{get:function(){return y()},set:function(e){b(e)}},duration:{get:function(){return d()}},ended:{get:function(){return M.ended}},paused:{get:function(){return M.paused}},seeking:{get:function(){return M.seeking}},readyState:{get:function(){return M.readyState}},networkState:{get:function(){return M.networkState}},volume:{get:function(){return M.volume},set:function(e){if(e<0||e>1)throw"Volume value must be between 0.0 and 1.0";C(e)}},muted:{get:function(){return M.muted},set:function(e){k(A._util.isAttributeSet(e))}},error:{get:function(){return M.error}},buffered:{get:function(){var e={start:function(e){if(e===0)return 0;throw"INDEX_SIZE_ERR: DOM Exception 1"},end:function(e){var t;if(e===0)return t=d(),t?t*(j.getBuffer()/100):0;throw"INDEX_SIZE_ERR: DOM Exception 1"},length:1};return e}}}),A._canPlaySrc=e.HTMLJWPlayerVideoElement._canPlaySrc,A.canPlayType=e.HTMLJWPlayerVideoElement.canPlayType,A}var a="",f=!1,l=!1,c=[];e.HTMLJWPlayerVideoElement=function(e){return new u(e)},e.HTMLJWPlayerVideoElement._canPlaySrc=function(e){if(typeof e!="string")return"probably";if(/.+\.+/g.exec(e))return"probably"},e.HTMLJWPlayerVideoElement.canPlayType=function(e){return"probably"}}(Popcorn,window,document),function(e,t){function n(t){this.startTime=0,this.currentTime=t.currentTime||0,this.duration=t.duration||NaN,this.playInterval=null,this.paused=!0,this.defaultPlaybackRate=1,this.playbackRate=1,this.ended=t.endedCallback||e.nop}function r(e){e.currentTime+=(Date.now()-e.startTime)/(1e3/e.playbackRate),e.startTime=Date.now(),e.currentTime>=e.duration&&(e.pause(e.duration),e.ended()),e.currentTime<0&&e.pause(0)}function i(r){function i(e){A.push(e)}function s(){var e;C=!0,L.networkState=x.NETWORK_IDLE,L.readyState=x.HAVE_METADATA,x.dispatchEvent("loadedmetadata"),x.dispatchEvent("loadeddata"),L.readyState=x.HAVE_FUTURE_DATA,x.dispatchEvent("canplay"),L.readyState=x.HAVE_ENOUGH_DATA,x.dispatchEvent("canplaythrough");while(A.length)e=A.shift(),e();L.autoplay&&x.play()}function o(){return k?k.duration:NaN}function f(){if(!C||!k)return;k.pause(),k=null,T.removeChild(N),N=t.createElement("div")}function l(e){if(!x._canPlaySrc(e)){L.error={name:"MediaError",message:"Media Source Not Supported",code:MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED},x.dispatchEvent("error");return}L.src=e,C&&f(),N.width=L.width,N.height=L.height,T.appendChild(N);var t=a.exec(e),r=+t[1],i=+t[2];k=new n({currentTime:r,duration:i,endedCallback:y}),x.dispatchEvent("loadstart"),x.dispatchEvent("progress"),x.dispatchEvent("durationchange"),s()}function c(){return C?k.currentTime:0}function h(e){if(e===c())return;if(!C){i(function(){h(e)});return}d(),k.seekTo(e),v()}function p(){x.dispatchEvent("timeupdate")}function d(e){L.seeking=!0,x.dispatchEvent("seeking")}function v(){L.ended=!1,L.seeking=!1,x.dispatchEvent("timeupdate"),x.dispatchEvent("seeked"),x.dispatchEvent("canplay"),x.dispatchEvent("canplaythrough")}function m(){L.paused===1?(L.paused=!1,x.dispatchEvent("play"),x.dispatchEvent("playing")):(L.ended&&(h(0),L.ended=!1),L.paused&&(L.paused=!1,L.loop||x.dispatchEvent("play"),x.dispatchEvent("playing"))),O=setInterval(p,x._util.TIMEUPDATE_MS)}function g(){L.paused=!0,clearInterval(O),x.dispatchEvent("pause")}function y(){L.loop?(h(0),x.play()):(L.ended=!0,g(),x.dispatchEvent("timeupdate"),x.dispatchEvent("ended"))}function b(e){L.volume=e,x.dispatchEvent("volumechange")}function w(){return L.volume}function E(e){L.muted=e,x.dispatchEvent("volumechange")}function S(){return L.muted}var x=new e._MediaElementProto,T=typeof r=="string"?t.querySelector(r):r,N=t.createElement("div"),C=!1,k,L={src:u,networkState:x.NETWORK_EMPTY,readyState:x.HAVE_NOTHING,autoplay:u,preload:u,controls:u,loop:!1,poster:u,volume:1,muted:!1,width:T.width|0?T.width:x._util.MIN_WIDTH,height:T.height|0?T.height:x._util.MIN_HEIGHT,seeking:!1,ended:!1,paused:1,error:null},A=[],O;return x._eventNamespace=e.guid("HTMLNullVideoElement::"),x.parentNode=T,x._util.type="NullVideo",x.play=function(){if(!C){i(function(){x.play()});return}k.play(),L.paused&&m()},x.pause=function(){if(!C){i(function(){x.pause()});return}k.pause(),L.paused||g()},Object.defineProperties(x,{src:{get:function(){return L.src},set:function(e){e&&e!==L.src&&l(e)}},autoplay:{get:function(){return L.autoplay},set:function(e){L.autoplay=x._util.isAttributeSet(e)}},loop:{get:function(){return L.loop},set:function(e){L.loop=x._util.isAttributeSet(e)}},width:{get:function(){return N.width},set:function(e){N.width=e,L.width=N.width}},height:{get:function(){return N.height},set:function(e){N.height=e,L.height=N.height}},currentTime:{get:function(){return c()},set:function(e){h(e)}},duration:{get:function(){return o()}},ended:{get:function(){return L.ended}},paused:{get:function(){return L.paused}},seeking:{get:function(){return L.seeking}},readyState:{get:function(){return L.readyState}},networkState:{get:function(){return L.networkState}},volume:{get:function(){return w()},set:function(e){if(e<0||e>1)throw"Volume value must be between 0.0 and 1.0";b(e)}},muted:{get:function(){return S()},set:function(e){E(x._util.isAttributeSet(e))}},playbackRate:{get:function(){return k.playbackRate},set:function(e){k.playbackRate=e,x.dispatchEvent("ratechange")}},error:{get:function(){return L.error}}}),x._canPlaySrc=e.HTMLNullVideoElement._canPlaySrc,x.canPlayType=e.HTMLNullVideoElement.canPlayType,x}var s=16,o=s/1e3,u="",a=/#t=(\d+\.?\d*)?,?(\d+\.?\d*)/;n.prototype={play:function(){var e=this;this.paused&&(this.paused=!1,this.startTime=Date.now(),this.playInterval=setInterval(function(){r(e)},s))},pause:function(){this.paused||(this.paused=!0,clearInterval(this.playInterval))},seekTo:function(e){e=e<0?0:e,e=e>this.duration?this.duration:e,this.currentTime=e}},e.HTMLNullVideoElement=function(e){return new i(e)},e.HTMLNullVideoElement._canPlaySrc=function(e){return a.test(e)?"probably":u},e.HTMLNullVideoElement.canPlayType=function(e){return e==="video/x-nullvideo"?"probably":u}}(Popcorn,document),function(e,t,n){function r(){return f||(e.getScript("https://w.soundcloud.com/player/api.js",function(){e.getScript("https://connect.soundcloud.com/sdk.js",function(){a=!0,SC.initialize({client_id:"PRaNFlda6Bhf5utPjUsptg"});var e=l.length;while(e--)l[e](),delete l[e]})}),f=!0),a}function i(e){l.unshift(e)}function s(s){function a(e){j.unshift(e)}function f(){B.bind(SC.Widget.Events.LOAD_PROGRESS,function(e){S({type:"loadProgress",data:e.currentPosition/1e3})}),B.bind(SC.Widget.Events.PLAY_PROGRESS,function(e){S({type:"playProgress",data:e.currentPosition/1e3})}),B.bind(SC.Widget.Events.PLAY,function(e){S({type:"play"})}),B.bind(SC.Widget.Events.PAUSE,function(e){S({type:"pause"})}),B.bind(SC.Widget.Events.SEEK,function(e){B.getPosition(function(e){var t=e/1e3;if(D.seeking){Math.floor(t)!==Math.floor(D.currentTime)?B.seekTo(D.currentTime*1e3):m();return}S({type:"seek",data:t})})}),B.bind(SC.Widget.Events.FINISH,function(){S({type:"finish"})}),P=!0,B.getDuration(c)}function l(e){B.bind(SC.Widget.Events.PLAY_PROGRESS,function(e){B.setVolume(0),e.currentPosition>0&&(B.unbind(SC.Widget.Events.PLAY_PROGRESS),B.bind(SC.Widget.Events.PAUSE,function(){B.unbind(SC.Widget.Events.PAUSE),B.setVolume(1),B.bind(SC.Widget.Events.SEEK,function(){B.unbind(SC.Widget.Events.SEEK),f()}),B.seekTo(0)}),B.pause())}),B.play()}function c(e){e/=1e3;var t=D.duration;if(t!==e){D.duration=e,O.dispatchEvent("durationchange");if(isNaN(t)){D.networkState=O.NETWORK_IDLE,D.readyState=O.HAVE_METADATA,O.dispatchEvent("loadedmetadata"),O.dispatchEvent("loadeddata"),D.readyState=O.HAVE_FUTURE_DATA,O.dispatchEvent("canplay"),D.readyState=O.HAVE_ENOUGH_DATA,O.dispatchEvent("canplaythrough");var n=j.length;while(n--)j[n](),delete j[n];D.paused&&D.autoplay&&O.play()}}}function h(){P||a(function(){h()}),B.getDuration(c)}function p(){if(!P||!B)return;clearInterval(I),B.pause(),B.unbind(SC.Widget.Events.READY),B.unbind(SC.Widget.Events.LOAD_PROGRESS),B.unbind(SC.Widget.Events.PLAY_PROGRESS),B.unbind(SC.Widget.Events.PLAY),B.unbind(SC.Widget.Events.PAUSE),B.unbind(SC.Widget.Events.SEEK),B.unbind(SC.Widget.Events.FINISH),M.removeChild(_),_=n.createElement("iframe")}function d(e){function t(){v(),B.seekTo(e)}D.currentTime=e,e*=1e3;if(!P){addMediaReadyCallback(t);return}t()}function v(){D.seeking=!0,O.dispatchEvent("seeking")}function m(){D.ended=!1,D.seeking=!1,O.dispatchEvent("timeupdate"),O.dispatchEvent("seeked"),O.dispatchEvent("canplay"),O.dispatchEvent("canplaythrough")}function g(){D.paused=!0,H||(H=!0,clearInterval(F),O.dispatchEvent("pause"))}function y(){O.dispatchEvent("timeupdate")}function b(){I||(I=setInterval(x,o),D.loop&&O.dispatchEvent("play")),F=setInterval(y,O._util.TIMEUPDATE_MS),D.paused=!1,H&&(H=!1,D.loop||O.dispatchEvent("play"),O.dispatchEvent("playing"))}function w(){D.loop?(d(0),O.play()):(D.ended=!0,O.pause(),g(),O.dispatchEvent("timeupdate"),O.dispatchEvent("ended"))}function E(e){D.currentTime=e,e!==q&&O.dispatchEvent("timeupdate"),q=e}function S(e){switch(e.type){case"loadProgress":O.dispatchEvent("progress");break;case"playProgress":E(e.data);break;case"play":b();break;case"pause":g();break;case"finish":w();break;case"seek":E(e.data)}}function x(){if(D.ended)return;B.getPosition(function(e){E(e/1e3)})}function T(t){if(!O._canPlaySrc(t)){D.error={name:"MediaError",message:"Media Source Not Supported",code:MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED},O.dispatchEvent("error");return}D.src=t,P&&p();if(!r()){i(function(){T(t)});return}P=!1,SC.get("/resolve",{url:t},function(t){var n;t.errors&&(n={name:"MediaError"},t.errors[0]&&t.errors[0].error_message==="404 - Not Found"&&(n.message="Video not found.",n.code=MediaError.MEDIA_ERR_NETWORK),D.error=n,O.dispatchEvent("error")),_.id=e.guid("soundcloud-"),_.width=D.width,_.height=D.height,_.frameBorder=0,_.webkitAllowFullScreen=!0,_.mozAllowFullScreen=!0,_.allowFullScreen=!0,A(D.controls),M.appendChild(_),_.onload=function(){_.onload=null,B=SC.Widget(_),B.bind(SC.Widget.Events.READY,l),D.networkState=O.NETWORK_LOADING,O.dispatchEvent("loadstart"),O.dispatchEvent("progress")},_.src="https://w.soundcloud.com/player/?url="+t.uri+"&show_artwork=false"+"&buying=false"+"&liking=false"+"&sharing=false"+"&download=false"+"&show_comments=false"+"&show_user=false"+"&single_active=false"})}function N(e){D.volume=e;if(!P){a(function(){N(e)});return}B.setVolume(e),O.dispatchEvent("volumechange")}function C(){return D.muted>0?D.muted:D.volume}function k(e){if(!P){D.muted=e?1:0,a(function(){k(e)});return}e?(D.muted=D.volume,N(0)):(D.muted=0,N(D.muted))}function L(){return D.muted>0}function A(e){P?(_.style.position="absolute",_.style.visibility=e?"visible":"hidden"):(_.style.opacity=e?"1":"0",_.style.pointerEvents=e?"auto":"none"),D.controls=e}if(!t.postMessage)throw"ERROR: HTMLSoundCloudAudioElement requires window.postMessage";var O=new e._MediaElementProto,M=typeof s=="string"?e.dom.find(s):s,_=n.createElement("iframe"),D={src:u,networkState:O.NETWORK_EMPTY,readyState:O.HAVE_NOTHING,seeking:!1,autoplay:u,preload:u,controls:!1,loop:!1,poster:u,volume:1,muted:0,currentTime:0,duration:NaN,ended:!1,paused:!0,width:M.width|0?M.width:O._util.MIN_WIDTH,height:M.height|0?M.height:O._util.MIN_HEIGHT,error:null},P=!1,H=!0,B,j=[],F,I,q=0;return O._eventNamespace=e.guid("HTMLSoundCloudAudioElement::"),O.parentNode=M,O._util.type="SoundCloud",O.play=function(){D.paused=!1;if(!P){a(function(){O.play()});return}D.ended&&d(0),B.play()},O.pause=function(){D.paused=!0;if(!P){a(function(){O.pause()});return}B.pause()},Object.defineProperties(O,{src:{get:function(){return D.src},set:function(e){e&&e!==D.src&&T(e)}},autoplay:{get:function(){return D.autoplay},set:function(e){D.autoplay=O._util.isAttributeSet(e)}},loop:{get:function(){return D.loop},set:function(e){D.loop=O._util.isAttributeSet(e)}},width:{get:function(){return _.width},set:function(e){_.width=e,D.width=_.width}},height:{get:function(){return _.height},set:function(e){_.height=e,D.height=_.height}},currentTime:{get:function(){return D.currentTime},set:function(e){d(e)}},duration:{get:function(){return D.duration}},ended:{get:function(){return D.ended}},paused:{get:function(){return D.paused}},seeking:{get:function(){return D.seeking}},readyState:{get:function(){return D.readyState}},networkState:{get:function(){return D.networkState}},volume:{get:function(){return C()},set:function(e){if(e<0||e>1)throw"Volume value must be between 0.0 and 1.0";N(e)}},muted:{get:function(){return L()},set:function(e){k(O._util.isAttributeSet(e))}},error:{get:function(){return D.error}},controls:{get:function(){return D.controls},set:function(e){A(!!e)}}}),O._canPlaySrc=e.HTMLSoundCloudAudioElement._canPlaySrc,O.canPlayType=e.HTMLSoundCloudAudioElement.canPlayType,O}var o=16,u="",a=!1,f=!1,l=[];e.HTMLSoundCloudAudioElement=function(e){return new s(e)},e.HTMLSoundCloudAudioElement._canPlaySrc=function(e){return/(?:https?:\/\/www\.|https?:\/\/|www\.|\.|^)(soundcloud)/.test(e)?"probably":u},e.HTMLSoundCloudAudioElement.canPlayType=function(e){return e==="audio/x-soundcloud"?"probably":u}}(Popcorn,window,document),function(e){var t=1,n=!1;e.plugin("googlefeed",function(r){var i=function(){var t=!1,r=0,i=document.getElementsByTagName("link"),s=i.length,o=document.head||document.getElementsByTagName("head")[0],u=document.createElement("link"),a="//www.google.com/uds/solutions/dynamicfeed/gfdynamicfeedcontrol.";window.GFdynamicFeedControl?n=!0:e.getScript(a+"js",function(){n=!0});for(;r<s;r++)i[r].href===a+"css"&&(t=!0);t||(u.type="text/css",u.rel="stylesheet",u.href=a+"css",o.insertBefore(u,o.firstChild))};window.google?i():e.getScript("//www.google.com/jsapi",function(){google.load("feeds","1",{callback:function(){i()}})});var s=document.createElement("div"),o=document.getElementById(r.target),u=function(){n?r.feed=new GFdynamicFeedControl(r.url,s,{vertical:r.orientation.toLowerCase()==="vertical"?!0:!1,horizontal:r.orientation.toLowerCase()==="horizontal"?!0:!1,title:r.title=r.title||"Blog"}):setTimeout(function(){u()},5)};if(!r.orientation||r.orientation.toLowerCase()!=="vertical"&&r.orientation.toLowerCase()!=="horizontal")r.orientation="vertical";return s.style.display="none",s.id="_feed"+t,s.style.width="100%",s.style.height="100%",t++,o&&o.appendChild(s),u(),r.toString=function(){return r.url||r._natives.manifest.options.url["default"]},{start:function(e,t){s.setAttribute("style","display:inline")},end:function(e,t){s.setAttribute("style","display:none")},_teardown:function(e){document.getElementById(e.target)&&document.getElementById(e.target).removeChild(s),delete e.feed}}},{about:{name:"Popcorn Google Feed Plugin",version:"0.1",author:"David Seifried",website:"dseifried.wordpress.com"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},target:"feed-container",url:{elem:"input",type:"url",label:"Feed URL","default":"http://planet.mozilla.org/rss20.xml"},title:{elem:"input",type:"text",label:"Title","default":"Planet Mozilla",optional:!0},orientation:{elem:"select",options:["Vertical","Horizontal"],label:"Orientation","default":"Vertical",optional:!0}}})}(Popcorn),document.addEventListener("click",function(e){var t=e.target;(t.nodeName==="A"||t.parentNode&&t.parentNode.nodeName==="A")&&Popcorn.instances.forEach(function(e){e.options.pauseOnLinkClicked&&e.pause()})},!1),function(e){function t(e,n){if(e.map){e.map.div.style.display=n;return}setTimeout(function(){t(e,n)},10)}var n,r=1;e.plugin("openmap",function(n){var i,s,o,u,a,f,l,c,h=document.getElementById(n.target);return i=document.createElement("div"),i.id="openmapdiv"+r,i.style.width="100%",i.style.height="100%",r++,h&&h.appendChild(i),c=function(){if(!window.OpenLayers||!window.OpenLayers.Layer.Stamen)setTimeout(function(){c()},50);else{n.location?(location=new OpenLayers.LonLat(0,0),e.getJSONP("//tinygeocoder.com/create-api.php?q="+n.location+"&callback=jsonp",function(e){s=new OpenLayers.LonLat(e[1],e[0])})):s=new OpenLayers.LonLat(n.lng,n.lat),n.type=n.type||"ROADMAP";switch(n.type){case"SATELLITE":n.map=new OpenLayers.Map({div:i,maxResolution:.28125,tileSize:new OpenLayers.Size(512,512)});var t=new OpenLayers.Layer.WorldWind("LANDSAT","//worldwind25.arc.nasa.gov/tile/tile.aspx",2.25,4,{T:"105"});n.map.addLayer(t),u=new OpenLayers.Projection("EPSG:4326"),o=new OpenLayers.Projection("EPSG:4326");break;case"TERRAIN":u=new OpenLayers.Projection("EPSG:4326"),o=new OpenLayers.Projection("EPSG:4326"),n.map=new OpenLayers.Map({div:i,projection:o});var r=new OpenLayers.Layer.WMS("USGS Terraserver","//terraserver-usa.org/ogcmap.ashx?",{layers:"DRG"});n.map.addLayer(r);break;case"STAMEN-TONER":case"STAMEN-WATERCOLOR":case"STAMEN-TERRAIN":var a=n.type.replace("STAMEN-","").toLowerCase(),f=new OpenLayers.Layer.Stamen(a);u=new OpenLayers.Projection("EPSG:4326"),o=new OpenLayers.Projection("EPSG:900913"),s=s.transform(u,o),n.map=new OpenLayers.Map({div:i,projection:o,displayProjection:u,controls:[new OpenLayers.Control.Navigation,new OpenLayers.Control.PanPanel,new OpenLayers.Control.ZoomPanel]}),n.map.addLayer(f);break;default:o=new OpenLayers.Projection("EPSG:900913"),u=new OpenLayers.Projection("EPSG:4326"),s=s.transform(u,o),n.map=new OpenLayers.Map({div:i,projection:o,displayProjection:u});var l=new OpenLayers.Layer.OSM;n.map.addLayer(l)}n.map&&(n.map.setCenter(s,n.zoom||10),n.map.div.style.display="none")}},c(),{_setup:function(t){window.OpenLayers||e.getScript("//openlayers.org/api/OpenLayers.js",function(){e.getScript("//maps.stamen.com/js/tile.stamen.js")});var n=function(){if(!t.map)setTimeout(function(){n()},13);else{t.zoom=t.zoom||2,t.zoom&&typeof t.zoom!="number"&&(t.zoom=+t.zoom),t.map.setCenter(s,t.zoom);if(t.markers){var r=OpenLayers.Util.extend({},OpenLayers.Feature.Vector.style["default"]),i=function(e){clickedFeature=e.feature;if(!clickedFeature.attributes.text)return;l=new OpenLayers.Popup.FramedCloud("featurePopup",clickedFeature.geometry.getBounds().getCenterLonLat(),new OpenLayers.Size(120,250),clickedFeature.attributes.text,null,!0,function(e){f.unselect(this.feature)}),clickedFeature.popup=l,l.feature=clickedFeature,t.map.addPopup(l)},c=function(e){feature=e.feature,feature.popup&&(l.feature=null,t.map.removePopup(feature.popup),feature.popup.destroy(),feature.popup=null)},h=function(t){e.getJSONP("//tinygeocoder.com/create-api.php?q="+t.location+"&callback=jsonp",function(e){var n=(new OpenLayers.Geometry.Point(e[1],e[0])).transform(u,o),i=OpenLayers.Util.extend({},r);if(!t.size||isNaN(t.size))t.size=14;i.pointRadius=t.size,i.graphicOpacity=1,i.externalGraphic=t.icon;var s=new OpenLayers.Feature.Vector(n,null,i);t.text&&(s.attributes={text:t.text}),a.addFeatures([s])})};a=new OpenLayers.Layer.Vector("Point Layer",{style:r}),t.map.addLayer(a);for(var p=0,d=t.markers.length;p<d;p++){var v=t.markers[p];v.text&&(f||(f=new OpenLayers.Control.SelectFeature(a),t.map.addControl(f),f.activate(),a.events.on({featureselected:i,featureunselected:c})));if(v.location){var m=h;m(v)}else{var g=(new OpenLayers.Geometry.Point(v.lng,v.lat)).transform(u,o),y=OpenLayers.Util.extend({},r);if(!v.size||isNaN(v.size))v.size=14;y.pointRadius=v.size,y.graphicOpacity=1,y.externalGraphic=v.icon;var b=new OpenLayers.Feature.Vector(g,null,y);v.text&&(b.attributes={text:v.text}),a.addFeatures([b])}}}}};n()},start:function(e,n){t(n,"block")},end:function(e,n){t(n,"none")},_teardown:function(e){h&&h.removeChild(i),i=map=s=o=u=a=f=l=null}}},{about:{name:"Popcorn OpenMap Plugin",version:"0.3",author:"@mapmeld",website:"mapadelsur.blogspot.com"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},target:"map-container",type:{elem:"select",options:["ROADMAP","SATELLITE","TERRAIN"],label:"Map Type",optional:!0},zoom:{elem:"input",type:"number",label:"Zoom","default":2},lat:{elem:"input",type:"text",label:"Lat",optional:!0},lng:{elem:"input",type:"text",label:"Lng",optional:!0},location:{elem:"input",type:"text",label:"Location","default":"Toronto, Ontario, Canada"},markers:{elem:"input",type:"text",label:"List Markers",optional:!0}}})}(Popcorn),function(e,t){var n={};e.plugin("documentcloud",{manifest:{about:{name:"Popcorn Document Cloud Plugin",version:"0.1",author:"@humphd, @ChrisDeCairos",website:"http://vocamus.net/dave"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},target:"documentcloud-container",width:{elem:"input",type:"text",label:"Width",optional:!0},height:{elem:"input",type:"text",label:"Height",optional:!0},src:{elem:"input",type:"url",label:"PDF URL","default":"http://www.documentcloud.org/documents/70050-urbina-day-1-in-progress.html"},preload:{elem:"input",type:"checkbox",label:"Preload","default":!0},page:{elem:"input",type:"number",label:"Page Number",optional:!0},aid:{elem:"input",type:"number",label:"Annotation Id",optional:!0}}},_setup:function(r){function i(){function i(e){r._key=e.api.getId(),r._changeView=function(e){r.aid?e.pageSet.showAnnotation(e.api.getAnnotation(r.aid)):e.api.setCurrentPage(r.page)}}function s(t){var s=!1;return e.forEach(o.viewers,function(e,u){if(e.api.getSchema().canonicalURL===t){var a;i(e),a=n[r._key],r._containerId=a.id,a.num+=1,s=!0,o.loaded=!0}}),s}function a(){var e={num:1,id:r._containerId};n[r._key]=e,o.loaded=!0}o.loaded=!1;var f=r.url.replace(/\.html$/,".js"),l=r.target,c=t.getElementById(l),h=t.createElement("div"),p=e.position(c),d=r.width||p.width,v=r.height||p.height,m=r.sidebar||!0,g=r.text||!0,y=r.pdf||!0,b=r.showAnnotations||!0,w=r.zoom||700,E=r.search||!0,S=r.page,x;if(!s(r.url)){h.id=r._containerId=e.guid(l),x="#"+h.id,c.appendChild(h),u.trigger("documentready");var T=r.page||r.aid?function(e){i(e),r._changeView(e),h.style.visibility="hidden",e.elements.pages.hide(),a()}:function(e){i(e),a(),h.style.visibility="hidden",e.elements.pages.hide()};o.load(f,{width:d,height:v,sidebar:m,text:g,pdf:y,showAnnotations:b,zoom:w,search:E,container:x,afterLoad:T})}}function s(){window.DV.loaded?i():setTimeout(s,25)}var o=window.DV=window.DV||{},u=this;if(!o.loading){o.loading=!0,o.recordHit="//www.documentcloud.org/pixel.gif";var a=t.createElement("link"),f=t.getElementsByTagName("head")[0];a.rel="stylesheet",a.type="text/css",a.media="screen",a.href="//s3.documentcloud.org/viewer/viewer-datauri.css",f.appendChild(a),o.loaded=!1,e.getScript("http://s3.documentcloud.org/viewer/viewer.js",function(){o.loading=!1,i()})}else s();r.toString=function(){return r.src||r._natives.manifest.options.src["default"]}},start:function(e,n){var r=t.getElementById(n._containerId),i=DV.viewers[n._key];(n.page||n.aid)&&i&&n._changeView(i),r&&i&&(r.style.visibility="visible",i.elements.pages.show())},end:function(e,n){var r=t.getElementById(n._containerId);r&&DV.viewers[n._key]&&(r.style.visibility="hidden",DV.viewers[n._key].elements.pages.hide())},_teardown:function(e){var r=t.getElementById(e._containerId),i=e._key;if(i&&DV.viewers[i]&&--n[i].num===0){DV.viewers[i].api.unload();while(r.hasChildNodes())r.removeChild(r.lastChild);r.parentNode.removeChild(r)}}})}(Popcorn,window.document),function(e){var t={},n=0,r=function(e){t[e]=document.createElement("div");var n=document.getElementById(e);return n&&n.appendChild(t[e]),t[e].style.height="100%",t[e].style.position="relative",t[e]},i=document.createElement("span"),s=["webkit","Moz","ms","O",""],o=["Transform","TransitionDuration","TransitionTimingFunction"],u={},a;document.getElementsByTagName("head")[0].appendChild(i);for(var f=0,l=o.length;f<l;f++)for(var c=0,h=s.length;c<h;c++){a=s[c]+o[f];if(a in i.style){u[o[f].toLowerCase()]=a;break}}document.getElementsByTagName("head")[0].appendChild(i),e.plugin("wordriver",{manifest:{about:{name:"Popcorn WordRiver Plugin"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},target:"wordriver-container",text:{elem:"input",type:"text",label:"Text","default":"Popcorn.js"},color:{elem:"input",type:"text",label:"Color","default":"Green",optional:!0}}},_setup:function(e){e._duration=e.end-e.start,e._container=t[e.target]||r(e.target),e.word=document.createElement("span"),e.word.style.position="absolute",e.word.style.whiteSpace="nowrap",e.word.style.opacity=0,e.word.style.MozTransitionProperty="opacity, -moz-transform",e.word.style.webkitTransitionProperty="opacity, -webkit-transform",e.word.style.OTransitionProperty="opacity, -o-transform",e.word.style.transitionProperty="opacity, transform",e.word.style[u.transitionduration]="1s, "+e._duration+"s",e.word.style[u.transitiontimingfunction]="linear",e.word.innerHTML=e.text,e.word.style.color=e.color||"black"},start:function(e,t){t._container.appendChild(t.word),t.word.style[u.transform]="",t.word.style.fontSize=~~(30+20*Math.random())+"px",n%=t._container.offsetWidth-t.word.offsetWidth,t.word.style.left=n+"px",n+=t.word.offsetWidth+10,t.word.style[u.transform]="translateY("+(t._container.offsetHeight-t.word.offsetHeight)+"px)",t.word.style.opacity=1,setTimeout(function(){t.word.style.opacity=0},(t.end-t.start-1||1)*1e3)},end:function(e,t){t.word.style.opacity=0},_teardown:function(e){var n=document.getElementById(e.target);e.word.parentNode&&e._container.removeChild(e.word),t[e.target]&&!t[e.target].childElementCount&&n&&n.removeChild(t[e.target])&&delete t[e.target]}})}(Popcorn),function(e){function t(e,t){return String(e).replace(/&(?!\w+;)|[<>"']/g,function(e){return i[e]||e})}function n(e){return e.replace(/\r?\n/gm,"<br>")}function r(e,t){var n=e.container=document.createElement("div"),r=n.style,i=e.media,s=function(){var t=e.position();r.fontSize="18px",r.width=i.offsetWidth+"px",r.top=t.top+i.offsetHeight-n.offsetHeight-40+"px",r.left=t.left+"px",setTimeout(s,10)};return n.id=t||"",r.position="absolute",r.color="white",r.textShadow="black 2px 2px 6px",r.fontWeight="bold",r.textAlign="center",s(),e.media.parentNode.appendChild(n),n}var i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};e.plugin("text",{manifest:{about:{name:"Popcorn Text Plugin",version:"0.1",author:"@humphd"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},text:{elem:"input",type:"text",label:"Text","default":"Popcorn.js"},escape:{elem:"input",type:"checkbox",label:"Escape"},multiline:{elem:"input",type:"checkbox",label:"Multiline"}}},_setup:function(i){var s,o,u=i._container=document.createElement("div");u.style.display="none",i.target?(s=e.dom.find(i.target),s?["VIDEO","AUDIO"].indexOf(s.nodeName)>-1&&(s=r(this,i.target+"-overlay")):s=r(this,i.target)):this.container?s=this.container:s=r(this),i._target=s,o=i.escape?t(i.text):i.text,o=i.multiline?n(o):o,u.innerHTML=o||"",s.appendChild(u),i.toString=function(){return i.text||i._natives.manifest.options.text["default"]}},start:function(e,t){t._container.style.display="inline"},end:function(e,t){t._container.style.display="none"},_teardown:function(e){var t=e._target;t&&t.removeChild(e._container)}})}(Popcorn),function(e){var t=1;e.plugin("timeline",function(e){var n=document.getElementById(e.target),r=document.createElement("div"),i,s=!0;return n&&!n.firstChild?(n.appendChild(i=document.createElement("div")),i.style.width="inherit",i.style.height="inherit",i.style.overflow="auto"):i=n.firstChild,r.style.display="none",r.id="timelineDiv"+t,e.direction=e.direction||"up",e.direction.toLowerCase()==="down"&&(s=!1),n&&i&&(s?i.insertBefore(r,i.firstChild):i.appendChild(r)),t++,r.innerHTML="<p><span id='big' style='font-size:24px; line-height: 130%;' >"+e.title+"</span><br />"+"<span id='mid' style='font-size: 16px;'>"+e.text+"</span><br />"+e.innerHTML,{start:function(e,t){r.style.display="block",t.direction==="down"&&(i.scrollTop=i.scrollHeight)},end:function(e,t){r.style.display="none"},_teardown:function(e){i&&r&&i.removeChild(r)&&!i.firstChild&&n.removeChild(i)}}},{about:{name:"Popcorn Timeline Plugin",version:"0.1",author:"David Seifried @dcseifried",website:"dseifried.wordpress.com"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},target:"feed-container",title:{elem:"input",type:"text",label:"Title"},text:{elem:"input",type:"text",label:"Text"},innerHTML:{elem:"input",type:"text",label:"HTML Code",optional:!0},direction:{elem:"select",options:["DOWN","UP"],label:"Direction",optional:!0}}})}(Popcorn),function(e){e.plugin("code",function(t){var n=!1,r=this,i=function(){var e=function(e){return function(t,i){var s=function(){n&&t.call(r,i),n&&e(s)};s()}};return window.webkitRequestAnimationFrame?e(window.webkitRequestAnimationFrame):window.mozRequestAnimationFrame?e(window.mozRequestAnimationFrame):e(function(e){window.setTimeout(e,16)})}();if(!t.onStart||typeof t.onStart!="function")t.onStart=e.nop;return t.onEnd&&typeof t.onEnd!="function"&&(t.onEnd=undefined),t.onFrame&&typeof t.onFrame!="function"&&(t.onFrame=undefined),{start:function(e,t){t.onStart.call(r,t),t.onFrame&&(n=!0,i(t.onFrame,t))},end:function(e,t){t.onFrame&&(n=!1),t.onEnd&&t.onEnd.call(r,t)}}},{about:{name:"Popcorn Code Plugin",version:"0.1",author:"David Humphrey (@humphd)",website:"http://vocamus.net/dave"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},onStart:{elem:"input",type:"function",label:"onStart"},onFrame:{elem:"input",type:"function",label:"onFrame",optional:!0},onEnd:{elem:"input",type:"function",label:"onEnd"}}})}(Popcorn),function(e,t){var n="http://popcornjs.org/code/modules/player/popcorn.player.js",r=/(?:http:\/\/www\.|http:\/\/|www\.|\.|^)(youtu|vimeo|soundcloud|baseplayer)/,i,s={},o={vimeo:!1,youtube:!1,soundcloud:!1,module:!1};Object.defineProperty(s,i,{get:function(){return o[i]},set:function(e){o[i]=e}}),e.plugin("mediaspawner",{manifest:{about:{name:"Popcorn Media Spawner Plugin",version:"0.1",author:"Matthew Schranz, @mjschranz",website:"mschranz.wordpress.com"},options:{source:{elem:"input",type:"text",label:"Media Source","default":"http://www.youtube.com/watch?v=CXDstfD9eJ0"},caption:{elem:"input",type:"text",label:"Media Caption","default":"Popcorn Popping",optional:!0},target:"mediaspawner-container",start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},autoplay:{elem:"input",type:"checkbox",label:"Autoplay Video",optional:!0},width:{elem:"input",type:"number",label:"Media Width","default":400,units:"px",optional:!0},height:{elem:"input",type:"number",label:"Media Height","default":200,units:"px",optional:!0}}},_setup:function(t){function i(){function n(){a!=="HTML5"&&!window.Popcorn[a]?setTimeout(function(){n()},300):(t.id=t._container.id,t._container.style.width=t.width+"px",t._container.style.height=t.height+"px",t.popcorn=e.smart("#"+t.id,t.source),a==="HTML5"&&t.popcorn.controls(!0),t._container.style.width="0px",t._container.style.height="0px",t._container.style.visibility="hidden",t._container.style.overflow="hidden")}a!=="HTML5"&&!window.Popcorn[a]&&!s[a]?(s[a]=!0,e.getScript("http://popcornjs.org/code/players/"+a+"/popcorn."+a+".js",function(){n()})):n()}function o(){window.Popcorn.player?i():setTimeout(function(){o()},300)}var u=document.getElementById(t.target)||{},a,f,l,c;c=r.exec(t.source),c?(a=c[1],a==="youtu"&&(a="youtube")):a="HTML5",t._type=a,t._container=document.createElement("div"),f=t._container,f.id="mediaSpawnerdiv-"+e.guid(),t.width=t.width||400,t.height=t.height||200,t.caption&&(l=document.createElement("div"),l.innerHTML=t.caption,l.style.display="none",t._capCont=l,f.appendChild(l)),u&&u.appendChild(f),!window.Popcorn.player&&!s.module?(s.module=!0,e.getScript(n,o)):o(),t.toString=function(){return t.source||t._natives.manifest.options.source["default"]}},start:function(e,t){t._capCont&&(t._capCont.style.display=""),t._container.style.width=t.width+"px",t._container.style.height=t.height+"px",t._container.style.visibility="visible",t._container.style.overflow="visible",t.autoplay&&t.popcorn.play()},end:function(e,t){t._capCont&&(t._capCont.style.display="none"),t._container.style.width="0px",t._container.style.height="0px",t._container.style.visibility="hidden",t._container.style.overflow="hidden",t.popcorn.pause()},_teardown:function(e){e.popcorn&&e.popcorn.destory&&e.popcorn.destroy(),document.getElementById(e.target)&&document.getElementById(e.target).removeChild(e._container)}})}(Popcorn,this),function(e){var t=0,n=function(t,n){var r=t.container=document.createElement("div"),i=r.style,s=t.media,o=function(){var e=t.position();i.fontSize="18px",i.width=s.offsetWidth+"px",i.top=e.top+s.offsetHeight-r.offsetHeight-40+"px",i.left=e.left+"px",setTimeout(o,10)};return r.id=n||e.guid(),i.position="absolute",i.color="white",i.textShadow="black 2px 2px 6px",i.fontWeight="bold",i.textAlign="center",o(),t.media.parentNode.appendChild(r),r};e.plugin("subtitle",{manifest:{about:{name:"Popcorn Subtitle Plugin",version:"0.1",author:"Scott Downe",website:"http://scottdowne.wordpress.com/"},options:{start:{elem:"input",type:"text",label:"Start"},end:{elem:"input",type:"text",label:"End"},target:"subtitle-container",text:{elem:"input",type:"text",label:"Text"}}},_setup:function(e){var r=document.createElement("div");r.id="subtitle-"+t++,r.style.display="none",!this.container&&(!e.target||e.target==="subtitle-container")&&n(this),e.target&&e.target!=="subtitle-container"?e.container=document.getElementById(e.target)||n(this,e.target):e.container=this.container,document.getElementById(e.container.id)&&document.getElementById(e.container.id).appendChild(r),e.innerContainer=r,e.showSubtitle=function(){e.innerContainer.innerHTML=e.text||""}},start:function(e,t){t.innerContainer.style.display="inline",t.showSubtitle(t,t.text)},end:function(e,t){t.innerContainer.style.display="none",t.innerContainer.innerHTML=""},_teardown:function(e){e.container.removeChild(e.innerContainer)}})}(Popcorn),function(e){e.plugin("webpage",{manifest:{about:{name:"Popcorn Webpage Plugin",version:"0.1",author:"@annasob",website:"annasob.wordpress.com"},options:{id:{elem:"input",type:"text",label:"Id",optional:!0},start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},src:{elem:"input",type:"url",label:"Webpage URL","default":"http://mozillapopcorn.org"},target:"iframe-container"}},_setup:function(e){var t=document.getElementById(e.target);e.src=e.src.replace(/^(https?:)?(\/\/)?/,"//"),e._iframe=document.createElement("iframe"),e._iframe.setAttribute("width","100%"),e._iframe.setAttribute("height","100%"),e._iframe.id=e.id,e._iframe.src=e.src,e._iframe.style.display="none",t&&t.appendChild(e._iframe)},start:function(e,t){t._iframe.src=t.src,t._iframe.style.display="inline"},end:function(e,t){t._iframe.style.display="none"},_teardown:function(e){document.getElementById(e.target)&&document.getElementById(e.target).removeChild(e._iframe)}})}(Popcorn);var t;(function(e){e.plugin("wikipedia",{manifest:{about:{name:"Popcorn Wikipedia Plugin",version:"0.1",author:"@annasob",website:"annasob.wordpress.com"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},lang:{elem:"input",type:"text",label:"Language","default":"english",optional:!0},src:{elem:"input",type:"url",label:"Wikipedia URL","default":"http://en.wikipedia.org/wiki/Cat"},title:{elem:"input",type:"text",label:"Title","default":"Cats",optional:!0},numberofwords:{elem:"input",type:"number",label:"Number of Words","default":"200",optional:!0},target:"wikipedia-container"}},_setup:function(t){var n,r=e.guid();t.lang||(t.lang="en"),t.numberofwords=t.numberofwords||200,window["wikiCallback"+r]=function(e){t._link=document.createElement("a"),t._link.setAttribute("href",t.src),t._link.setAttribute("target","_blank"),t._link.innerHTML=t.title||e.parse.displaytitle,t._desc=document.createElement("p"),n=e.parse.text["*"].substr(e.parse.text["*"].indexOf("<p>")),n=n.replace(/((<(.|\n)+?>)|(\((.*?)\) )|(\[(.*?)\]))/g,""),n=n.split(" "),t._desc.innerHTML=n.slice(0,n.length>=t.numberofwords?t.numberofwords:n.length).join(" ")+" ...",t._fired=!0},t.src&&e.getScript("//"+t.lang+".wikipedia.org/w/api.php?action=parse&props=text&redirects&page="+t.src.slice(t.src.lastIndexOf("/")+1)+"&format=json&callback=wikiCallback"+r),t.toString=function(){return t.src||t._natives.manifest.options.src["default"]}},start:function(e,t){var n=function(){t._fired?t._link&&t._desc&&document.getElementById(t.target)&&(document.getElementById(t.target).appendChild(t._link),document.getElementById(t.target).appendChild(t._desc),t._added=!0):setTimeout(function(){n()},13)};n()},end:function(e,t){t._added&&(document.getElementById(t.target).removeChild(t._link),document.getElementById(t.target).removeChild(t._desc))},_teardown:function(e){e._added&&(e._link.parentNode&&document.getElementById(e.target).removeChild(e._link),e._desc.parentNode&&document.getElementById(e.target).removeChild(e._desc),delete e.target)}})})(Popcorn);var n;(function(e){function t(e,t,n){var r=e.type?e.type.toUpperCase():"HYBRID",i;if(r==="STAMEN-WATERCOLOR"||r==="STAMEN-TERRAIN"||r==="STAMEN-TONER")i=r.replace("STAMEN-","").toLowerCase();var s=new google.maps.Map(n,{mapTypeId:i?i:google.maps.MapTypeId[r],mapTypeControlOptions:{mapTypeIds:[]}});return i&&s.mapTypes.set(i,new google.maps.StamenMapType(i)),s.getDiv().style.display="none",s}var r=1,i=!1,s=!1,o,u;n=function(t){typeof google!="undefined"&&google.maps&&google.maps.Geocoder&&google.maps.LatLng?(o=new google.maps.Geocoder,e.getScript("//maps.stamen.com/js/tile.stamen.js",function(){s=!0})):setTimeout(function(){n(t)},1)},u=function(){document.body?(i=!0,e.getScript("//maps.google.com/maps/api/js?sensor=false&callback=googleCallback")):setTimeout(function(){u()},1)},e.plugin("googlemap",function(e){var n,a,f,l=document.getElementById(e.target);e.type=e.type||"ROADMAP",e.zoom=e.zoom||1,e.lat=e.lat||0,e.lng=e.lng||0,i||u(),n=document.createElement("div"),n.id="actualmap"+r,n.style.width=e.width||"100%",e.height?n.style.height=e.height:l&&l.clientHeight?n.style.height=l.clientHeight+"px":n.style.height="100%",r++,l&&l.appendChild(n);var c=function(){s?n&&(e.location?o.geocode({address:e.location},function(r,i){n&&i===google.maps.GeocoderStatus.OK&&(e.lat=r[0].geometry.location.lat(),e.lng=r[0].geometry.location.lng(),f=new google.maps.LatLng(e.lat,e.lng),a=t(e,f,n))}):(f=new google.maps.LatLng(e.lat,e.lng),a=t(e,f,n))):setTimeout(function(){c()},5)};return c(),e.toString=function(){return e.location||(e.lat&&e.lng?e.lat+", "+e.lng:e._natives.manifest.options.location["default"])},{start:function(e,t){var r=this,i,s=function(){if(a){t._map=a,a.getDiv().style.display="block",google.maps.event.trigger(a,"resize"),a.setCenter(f),t.zoom&&typeof t.zoom!="number"&&(t.zoom=+t.zoom),a.setZoom(t.zoom),t.heading&&typeof t.heading!="number"&&(t.heading=+t.heading),t.pitch&&typeof t.pitch!="number"&&(t.pitch=+t.pitch);if(t.type==="STREETVIEW"){a.setStreetView(i=new google.maps.StreetViewPanorama(n,{position:f,pov:{heading:t.heading=t.heading||0,pitch:t.pitch=t.pitch||0,zoom:t.zoom}}));var e=function(n,i){var s=google.maps.geometry.spherical.computeHeading;setTimeout(function(){var i=r.media.currentTime;if(typeof t.tween=="object"){for(var a=0,f=n.length;a<f;a++){var l=n[a];i>=l.interval*(a+1)/1e3&&(i<=l.interval*(a+2)/1e3||i>=l.interval*f/1e3)&&(d.setPosition(new google.maps.LatLng(l.position.lat,l.position.lng)),d.setPov({heading:l.pov.heading||s(l,n[a+1])||0,zoom:l.pov.zoom||0,pitch:l.pov.pitch||0}))}e(n,n[0].interval)}else{for(var c=0,h=n.length;c<h;c++){var p=t.interval;i>=p*(c+1)/1e3&&(i<=p*(c+2)/1e3||i>=p*h/1e3)&&(o.setPov({heading:s(n[c],n[c+1])||0,zoom:t.zoom,pitch:t.pitch||0}),o.setPosition(u[c]))}e(u,t.interval)}},i)};if(t.location&&typeof t.tween=="string"){var o=i,u=[],l=new google.maps.DirectionsService,c=new google.maps.DirectionsRenderer(o),h={origin:t.location,destination:t.tween,travelMode:google.maps.TravelMode.DRIVING};l.route(h,function(e,t){t==google.maps.DirectionsStatus.OK&&(c.setDirections(e),p(e,r))});var p=function(n,r){var i=n.routes[0].overview_path;for(var s=0,o=i.length;s<o;s++)u.push(new google.maps.LatLng(i[s].lat(),i[s].lng()));t.interval=t.interval||1e3,e(u,10)}}else if(typeof t.tween=="object"){var d=i;for(var v=0,m=t.tween.length;v<m;v++)t.tween[v].interval=t.tween[v].interval||1e3,e(t.tween,10)}}t.onmaploaded&&t.onmaploaded(t,a)}else setTimeout(function(){s()},13)};s()},end:function(e,t){a&&(a.getDiv().style.display="none")},_teardown:function(e){var t=document.getElementById(e.target);t&&t.removeChild(n),n=a=f=null,e._map=null}}},{about:{name:"Popcorn Google Map Plugin",version:"0.1",author:"@annasob",website:"annasob.wordpress.com"},options:{start:{elem:"input",type:"start",label:"Start"},end:{elem:"input",type:"start",label:"End"},target:"map-container",type:{elem:"select",options:["ROADMAP","SATELLITE","STREETVIEW","HYBRID","TERRAIN","STAMEN-WATERCOLOR","STAMEN-TERRAIN","STAMEN-TONER"],label:"Map Type",optional:!0},zoom:{elem:"input",type:"text",label:"Zoom","default":0,optional:!0},lat:{elem:"input",type:"text",label:"Lat",optional:!0},lng:{elem:"input",type:"text",label:"Lng",optional:!0},location:{elem:"input",type:"text",label:"Location","default":"Toronto, Ontario, Canada"},heading:{elem:"input",type:"text",label:"Heading","default":0,optional:!0},pitch:{elem:"input",type:"text",label:"Pitch","default":1,optional:!0}}})})(Popcorn),function(e){e.plugin("footnote",{manifest:{about:{name:"Popcorn Footnote Plugin",version:"0.2",author:"@annasob, @rwaldron",website:"annasob.wordpress.com"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},text:{elem:"input",type:"text",label:"Text"},target:"footnote-container"}},_setup:function(t){var n=e.dom.find(t.target);t._container=document.createElement("div"),t._container.style.display="none",t._container.innerHTML=t.text,n.appendChild(t._container)},start:function(e,t){t._container.style.display="inline"},end:function(e,t){t._container.style.display="none"},_teardown:function(t){var n=e.dom.find(t.target);n&&n.removeChild(t._container)}})}(Popcorn),function(e){var t=0;e.plugin("flickr",function(n){var r,i=document.getElementById(n.target),s,o,u,a,f=n.numberofimages||4,l=n.height||"50px",c=n.width||"50px",h=n.padding||"5px",p=n.border||"0px";r=document.createElement("div"),r.id="flickr"+t,r.style.width="100%",r.style.height="100%",r.style.display="none",t++,i&&i.appendChild(r);var d=function(){s?setTimeout(function(){d()},5):(o="http://api.flickr.com/services/rest/?method=flickr.people.findByUsername&",o+="username="+n.username+"&api_key="+n.apikey+"&format=json&jsoncallback=flickr",e.getJSONP(o,function(e){s=e.user.nsid,v()}))},v=function(){o="http://api.flickr.com/services/feeds/photos_public.gne?",s&&(o+="id="+s+"&"),n.tags&&(o+="tags="+n.tags+"&"),o+="lang=en-us&format=json&jsoncallback=flickr",e.xhr.getJSONP(o,function(t){var n=document.createElement("div");n.innerHTML="<p style='padding:"+h+";'>"+t.title+"<p/>",e.forEach(t.items,function(e,t){if(!(t<f))return!1;u=document.createElement("a"),u.setAttribute("href",e.link),u.setAttribute("target","_blank"),a=document.createElement("img"),a.setAttribute("src",e.media.m),a.setAttribute("height",l),a.setAttribute("width",c),a.setAttribute("style","border:"+p+";padding:"+h),u.appendChild(a),n.appendChild(u)}),r.appendChild(n)})};return n.username&&n.apikey?d():(s=n.userid,v()),n.toString=function(){return n.tags||n.username||"Flickr"},{start:function(e,t){r.style.display="inline"},end:function(e,t){r.style.display="none"},_teardown:function(e){document.getElementById(e.target)&&document.getElementById(e.target).removeChild(r)}}},{about:{name:"Popcorn Flickr Plugin",version:"0.2",author:"Scott Downe, Steven Weerdenburg, Annasob",website:"http://scottdowne.wordpress.com/"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},userid:{elem:"input",type:"text",label:"User ID",optional:!0},tags:{elem:"input",type:"text",label:"Tags"},username:{elem:"input",type:"text",label:"Username",optional:!0},apikey:{elem:"input",type:"text",label:"API Key",optional:!0},target:"flickr-container",height:{elem:"input",type:"text",label:"Height","default":"50px",optional:!0},width:{elem:"input",type:"text",label:"Width","default":"50px",optional:!0},padding:{elem:"input",type:"text",label:"Padding",optional:!0},border:{elem:"input",type:"text",label:"Border","default":"5px",optional:!0},numberofimages:{elem:"input",type:"number","default":4,label:"Number of Images"}}})}(Popcorn),function(e){function t(e){function t(){var t=e.getBoundingClientRect(),n=s.getBoundingClientRect();n.left!==t.left&&(s.style.left=t.left+"px"),n.top!==t.top&&(s.style.top=t.top+"px")}var i=-1,s=document.createElement("div"),o=getComputedStyle(e).zIndex;return s.setAttribute("data-popcorn-helper-container",!0),s.style.position="absolute",isNaN(o)?s.style.zIndex=n:s.style.zIndex=o+1,document.body.appendChild(s),{element:s,start:function(){i=setInterval(t,r)},stop:function(){clearInterval(i),i=-1},destroy:function(){document.body.removeChild(s),i!==-1&&clearInterval(i)}}}var n=2e3,r=10;e.plugin("image",{manifest:{about:{name:"Popcorn image Plugin",version:"0.1",author:"Scott Downe",website:"http://scottdowne.wordpress.com/"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},src:{elem:"input",type:"url",label:"Image URL","default":"http://mozillapopcorn.org/wp-content/themes/popcorn/images/for_developers.png"},href:{elem:"input",type:"url",label:"Link","default":"http://mozillapopcorn.org/wp-content/themes/popcorn/images/for_developers.png",optional:!0},target:"image-container",text:{elem:"input",type:"text",label:"Caption","default":"Popcorn.js",optional:!0}}},_setup:function(n){var r=document.createElement("img"),i=document.getElementById(n.target);n.anchor=document.createElement("a"),n.anchor.style.position="relative",n.anchor.style.textDecoration="none",n.anchor.style.display="none",i&&(["VIDEO","AUDIO"].indexOf(i.nodeName)>-1?(n.trackedContainer=t(i),n.trackedContainer.element.appendChild(n.anchor)):i.appendChild(n.anchor)),r.addEventListener("load",function(){r.style.borderStyle="none",n.anchor.href=n.href||n.src||"#",n.anchor.target="_blank";var t,s;r.style.height=i.style.height,r.style.width=i.style.width,n.anchor.appendChild(r),n.text&&(t=r.height/12+"px",s=document.createElement("div"),e.extend(s.style,{color:"black",fontSize:t,fontWeight:"bold",position:"relative",textAlign:"center",width:r.style.width||r.width+"px",zIndex:"10"}),s.innerHTML=n.text||"",s.style.top=(r.style.height.replace("px","")||r.height)/2-s.offsetHeight/2+"px",n.anchor.insertBefore(s,r))},!1),r.src=n.src,n.toString=function(){var e=n.src||n._natives.manifest.options.src["default"],t=e.replace(/.*\//g,"");return t.length?t:e}},start:function(e,t){t.anchor.style.display="inline",t.trackedContainer&&t.trackedContainer.start()},end:function(e,t){t.anchor.style.display="none",t.trackedContainer&&t.trackedContainer.stop()},_teardown:function(e){e.trackedContainer?e.trackedContainer.destroy():e.anchor.parentNode&&e.anchor.parentNode.removeChild(e.anchor)}})}(Popcorn),function(e){e.plugin("mustache",function(t){var n,r,i,s;e.getScript("http://mustache.github.com/extras/mustache.js");var o=!!t.dynamic,u=typeof t.template,a=typeof t.data,f=document.getElementById(t.target);return t.container=f||document.createElement("div"),u==="function"?o?i=t.template:s=t.template(t):u==="string"?s=t.template:s="",a==="function"?o?n=t.data:r=t.data(t):a==="string"?r=JSON.parse(t.data):a==="object"?r=t.data:r="",{start:function(e,t){var o=function(){if(!window.Mustache)setTimeout(function(){o()},10);else{n&&(r=n(t)),i&&(s=i(t));var e=Mustache.to_html(s,r).replace(/^\s*/mg,"");t.container.innerHTML=e}};o()},end:function(e,t){t.container.innerHTML=""},_teardown:function(e){n=r=i=s=null}}},{about:{name:"Popcorn Mustache Plugin",version:"0.1",author:"David Humphrey (@humphd)",website:"http://vocamus.net/dave"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},target:"mustache-container",template:{elem:"input",type:"text",label:"Template"},data:{elem:"input",type:"text",label:"Data"},dynamic:{elem:"input",type:"checkbox",label:"Dynamic","default":!0}}})}(Popcorn),function(e){function t(e,t){var n={};return n[e]=t,n}function n(e){var t=e.split(":");try{var n=t[2].split(",");return n.length===1&&(n=t[2].split(".")),parseFloat(t[0],10)*3600+parseFloat(t[1],10)*60+parseFloat(n[0],10)+parseFloat(n[1],10)/1e3}catch(r){return 0}}function r(e,t){var n=t;while(!e[n])n++;return n}function i(e){var t=e.length-1;while(t>=0&&!e[t])t--;return t}e.parser("parseSRT",function(e,s){var o={title:"",remote:"",data:[]},u=[],a=0,f=0,l,c,h,p,d;l=e.text.split(/(?:\r\n|\r|\n)/gm),p=i(l)+1;for(a=0;a<p;a++){d={},h=[],a=r(l,a),d.id=parseInt(l[a++],10),c=l[a++].split(/[\t ]*-->[\t ]*/),d.start=n(c[0]),f=c[1].indexOf(" "),f!==-1&&(c[1]=c[1].substr(0,f)),d.end=n(c[1]);while(a<p&&l[a])h.push(l[a++]);d.text=h.join("\\N").replace(/\{(\\[\w]+\(?([\w\d]+,?)+\)?)+\}/gi,""),d.text=d.text.replace(/</g,"&lt;").replace(/>/g,"&gt;"),d.text=d.text.replace(/&lt;(\/?(font|b|u|i|s))((\s+(\w|\w[\w\-]*\w)(\s*=\s*(?:\".*?\"|'.*?'|[^'\">\s]+))?)+\s*|\s*)(\/?)&gt;/gi,"<$1$3$7>"),d.text=d.text.replace(/\\N/gi,"<br />"),s&&s.target&&(d.target=s.target),u.push(t("subtitle",d))}return o.data=u,o})}(Popcorn),function(e){e.parser("parseXML","XML",function(t){var n={title:"",remote:"",data:[]},r={},i=function(e){var t=e.split(":");if(t.length===1)return parseFloat(t[0],10);if(t.length===2)return parseFloat(t[0],10)+parseFloat(t[1]/12,10);if(t.length===3)return parseInt(t[0]*60,10)+parseFloat(t[1],10)+parseFloat(t[2]/12,10);if(t.length===4)return parseInt(t[0]*3600,10)+parseInt(t[1]*60,10)+parseFloat(t[2],10)+parseFloat(t[3]/12,10)},s=function(e){var t={};for(var n=0,s=e.length;n<s;n++){var o=e.item(n).nodeName,u=e.item(n).nodeValue,a=r[u];if(o==="in")t.start=i(u);else if(o==="out")t.end=i(u);else if(o==="resourceid")for(var f in a)a.hasOwnProperty(f)&&!t[f]&&f!=="id"&&(t[f]=a[f]);else t[o]=u}return t},o=function(e,t){var n={};return n[e]=t,n},u=function(t,i,a){var f={};e.extend(f,i,s(t.attributes),{text:t.textContent||t.text});var l=t.childNodes;if(l.length<1||l.length===1&&l[0].nodeType===3)a?r[f.id]=f:n.data.push(o(t.nodeName,f));else for(var c=0;c<l.length;c++)l[c].nodeType===1&&u(l[c],f,a)},a=t.documentElement.childNodes;for(var f=0,l=a.length;f<l;f++)a[f].nodeType===1&&(a[f].nodeName==="manifest"?u(a[f],{},!0):u(a[f],{},!1));return n})}(Popcorn),function(e){function t(e,s,o){var u=e.firstChild,a=n(e,o),f=[],l;while(u)u.nodeType===1&&(u.nodeName==="p"?f.push(r(u,s,a)):u.nodeName==="div"&&(l=i(u.getAttribute("begin")),l<0&&(l=s),f.push.apply(f,t(u,l,a)))),u=u.nextSibling;return f}function n(e,t){var n=e.getAttribute("region");return n!==null?n:t||""}function r(e,t,r){var s={};return s.text=(e.textContent||e.text).replace(u,"").replace(a,"<br />"),s.id=e.getAttribute("xml:id")||e.getAttribute("id"),s.start=i(e.getAttribute("begin"),t),s.end=i(e.getAttribute("end"),t),s.target=n(e,r),s.end<0&&(s.end=i(e.getAttribute("duration"),0),s.end>=0?s.end+=s.start:s.end=Number.MAX_VALUE),{subtitle:s}}function i(t,n){var r;if(!t)return-1;try{return e.util.toSeconds(t)}catch(i){return r=s(t),parseFloat(t.substring(0,r))*o(t.substring(r))+(n||0)}}function s(e){var t=e.length-1;while(t>=0&&e[t]<="9"&&e[t]>="0")t--;return t}function o(e){return{h:3600,m:60,s:1,ms:.001}[e]||-1}var u=/^[\s]+|[\s]+$/gm,a=/(?:\r\n|\r|\n)/gm;e.parser("parseTTML",function(e){var n={title:"",remote:"",data:[]},r;if(!e.xml||!e.xml.documentElement)return n;r=e.xml.documentElement.firstChild;if(!r)return n;while(r.nodeName!=="body")r=r.nextSibling;return r&&(n.data=t(r,0)),n})}(Popcorn),function(e){e.parser("parseJSON","JSON",function(t){var n={title:"",remote:"",data:[]},r={},i=t;return e.forEach(i.data,function(e,t){n.data.push(e)}),n})}(Popcorn),function(e){function t(e){var t=e.split(":"),n=e.length,r;if(n!==12&&n!==9)throw"Bad cue";n=t.length-1;try{r=parseInt(t[n-1],10)*60+parseFloat(t[n],10),n===2&&(r+=parseInt(t[0],10)*3600)}catch(i){throw"Bad cue"}return r}function n(e,t){var n={};return n[e]=t,n}function r(e){var n,r,i={},s=/-->/,o=/[\t ]+/;if(!e||e.indexOf("-->")===-1)throw"Bad cue";n=e.replace(s," --> ").split(o);if(n.length<2)throw"Bad cue";return i.id=e,i.start=t(n[0]),i.end=t(n[2]),i}function i(e,t,n){while(n<t&&!e[n])n++;return n}function s(e,t,n){while(n<t&&e[n])n++;return n}e.parser("parseVTT",function(e){var t={title:"",remote:"",data:[]},o=[],u=0,a=0,f,l,c,h=/(?:\r\n|\r|\n)/gm;f=e.text.split(h),a=f.length;if(a===0||f[0]!=="WEBVTT")return t;u++;while(u<a){l=[];try{u=i(f,a,u),c=r(f[u++]);while(u<a&&f[u])l.push(f[u++]);c.text=l.join("<br />"),o.push(n("subtitle",c))}catch(p){u=s(f,a,u)}}return t.data=o,t})}(Popcorn),function(e){e.parser("parseTTXT",function(e){var t={title:"",remote:"",data:[]},n=function(e){var t=e.split(":"),n=0;try{return parseFloat(t[0],10)*60*60+parseFloat(t[1],10)*60+parseFloat(t[2],10)}catch(r){n=0}return n},r=function(e,t){var n={};return n[e]=t,n},i=e.xml.lastChild.lastChild,s=Number.MAX_VALUE,o=[];while(i){if(i.nodeType===1&&i.nodeName==="TextSample"){var u={};u.start=n(i.getAttribute("sampleTime")),u.text=i.getAttribute("text"),u.text&&(u.end=s-.001,o.push(r("subtitle",u))),s=u.start}i=i.previousSibling}return t.data=o.reverse(),t})}(Popcorn),function(e){e.parser("parseSBV",function(e){var t={title:"",remote:"",data:[]},n=[],r,i=0,s=0,o=0,u=function(e){var t=e.split(":"),n=t.length-1,r;try{r=parseInt(t[n-1],10)*60+parseFloat(t[n],10),n===2&&(r+=parseInt(t[0],10)*3600)}catch(i){throw"Bad cue"}return r},a=function(e,t){var n={};return n[e]=t,n};r=e.text.split(/(?:\r\n|\r|\n)/gm),s=r.length;while(i<s){var f={},l=[],c=r[i++].split(",");try{f.start=u(c[0]),f.end=u(c[1]);while(i<s&&r[i])l.push(r[i++]);f.text=l.join("<br />"),n.push(a("subtitle",f))}catch(h){while(i<s&&r[i])i++}while(i<s&&!r[i])i++}return t.data=n,t})}(Popcorn),function(e){function t(e,t){var i=e.substr(10).split(","),s=/\{(\\[\w]+\(?([\w\d]+,?)+\)?)+\}/gi,o=/\\N/gi,u;u={start:n(i[t.start]),end:n(i[t.end])};if(u.start===-1||u.end===-1)throw"Invalid time";return u.text=r(i,t.text).replace(s,"").replace(o,"<br />"),u}function n(e){var t=e.split(":");return e.length!==10||t.length<3?-1:parseInt(t[0],10)*3600+parseInt(t[1],10)*60+parseFloat(t[2],10)}function r(e,t){var n=e.length,r=[],i=t;for(;i<n;i++)r.push(e[i]);return r.join(",")}function i(e,t){var n={};return n[e]=t,n}function s(e){var t=e.substr(8).split(", "),n={},r,i;for(i=0,r=t.length;i<r;i++)t[i]==="Start"?n.start=i:t[i]==="End"?n.end=i:t[i]==="Text"&&(n.text=i);return n}e.parser("parseSSA",function(e){var n={title:"",remote:"",data:[]},r=/(?:\r\n|\r|\n)/gm,o=[],u,a,f=0,l;u=e.text.split(r),l=u.length;while(f<l&&u[f]!=="[Events]")f++;a=s(u[++f]);while(++f<l&&u[f]&&u[f][0]!=="[")try{o.push(i("subtitle",t(u[f],a)))}catch(c){}return n.data=o,n})}(Popcorn),function(e,t){t.player("vimeo",{_canPlayType:function(e,n){return typeof n=="string"&&t.HTMLVimeoVideoElement._canPlaySrc(n)}}),t.vimeo=function(e,n,r){typeof console!="undefined"&&console.warn&&console.warn("Deprecated player 'vimeo'. Please use Popcorn.HTMLVimeoVideoElement directly.");var i=t.HTMLVimeoVideoElement(e),s=t(i,r);return setTimeout(function(){i.src=n},0),s}}(window,Popcorn),function(e,t){var n=function(e,n){return typeof n=="string"&&t.HTMLYouTubeVideoElement._canPlaySrc(n)};t.player("youtube",{_canPlayType:n}),t.youtube=function(e,n,r){typeof console!="undefined"&&console.warn&&console.warn("Deprecated player 'youtube'. Please use Popcorn.HTMLYouTubeVideoElement directly.");var i=t.HTMLYouTubeVideoElement(e),s=t(i,r);return setTimeout(function(){i.src=n},0),s},t.youtube.canPlayType=n}(window,Popcorn),function(e,t){t.player("soundcloud",{_canPlayType:function(e,n){return typeof n=="string"&&t.HTMLSoundCloudAudioElement._canPlaySrc(n)&&e.toLowerCase()!=="audio"}}),t.soundcloud=function(e,n,r){typeof console!="undefined"&&console.warn&&console.warn("Deprecated player 'soundcloud'. Please use Popcorn.HTMLSoundCloudAudioElement directly.");var i=t.HTMLSoundCloudAudioElement(e),s=t(i,r);return setTimeout(function(){i.src=n},0),s}}(window,Popcorn),function(e){var t=function(t,n){var r=0,i=0,s;e.forEach(n.classes,function(e,t){s=[],e==="parent"?s[0]=document.querySelectorAll("#"+n.target)[0].parentNode:s=document.querySelectorAll("#"+n.target+" "+e);for(r=0,i=s.length;r<i;r++)s[r].classList.toggle(t)})};e.compose("applyclass",{manifest:{about:{name:"Popcorn applyclass Effect",version:"0.1",author:"@scottdowne",website:"scottdowne.wordpress.com"},options:{}},_setup:function(e){e.classes={},e.applyclass=e.applyclass||"";var t=e.applyclass.replace(/\s/g,"").split(","),n=[],r=0,i=t.length;for(;r<i;r++)n=t[r].split(":"),n[0]&&(e.classes[n[0]]=n[1]||"")},start:t,end:t})}(Popcorn),e.define("vendor/popcorn/popcorn-complete",function(){}),e.define("zeega_dir/plugins/media-player/media-player",["zeega","libs/modernizr","vendor/popcorn/popcorn-complete"],function(e){var t={Views:{}};return t.Views.Player=e.Backbone.View.extend({className:"media-player-container",defaults:{control_mode:"none",control_fade:!0,media_target:null,controls_target:null,autoplay:!1,cue_in:0,cue_out:null,volume:.5,fade_in:0,fade_out:0},initialize:function(e){var t,n,r,i;i=null,this.model!==undefined&&(t=_.extend({},this.model.toJSON()),r=_.defaults(_.extend(t.attr,this.options),this.defaults),this.model.get("uri")!==undefined?n=this.getFormat(t.attribution_uri):t.attr&&t.attr.uri?(n=this.getFormat(t.attr.attribution_uri),r.id=this.model.id):console.log("I dont know what kind of media this is:("),this.format=n,this.settings=r,this.settings.model=i),this.model.on("pause_play",this.playPause,this)},render:function(){this.$el.css({width:"100%",height:"100%"});var e=this.templates[this.format]?this.format:"defaulttemplate";return this.$el.html(_.template(this.templates[e](),this.settings)),this.controls=new t.Views.Player.Controls[this.settings.control_mode]({model:this.model,detached_controls:!_.isNull(this.settings.controls_target)}),_.isNull(this.settings.controls_target)?this.$el.append(this.controls.render().el):$(this.settings.controls_target).html(this.controls.render().el),this},placePlayer:function(){var e=this,t=this.model.get("type");if(!this.isVideoLoaded){switch(this.format){case"html5":t=="Audio"&&Modernizr.audio.mp3===""||t=="Video"&&Modernizr.audio.h264===""?this.useFlash():this.useHTML5();break;case"flashvideo":this.useFlash();break;case"youtube":this.useYoutube();break;case"vimeo":this.useVimeo();break;default:console.log("none set")}this.initPopcornEvents(),this.isVideoLoaded=!0}},initPopcornEvents:function(){this.popcorn&&(this.popcorn.on("canplay",function(){this.private_onCanPlay(),this.onCanplay()}.bind(this)),this.popcorn.on("timeupdate",function(){this.private_onTimeUpdate()}.bind(this)),this.popcorn.on("ended",function(){this.onEnded()}.bind(this)))},addPopcornToControls:function(){this.controls&&this.popcorn&&this.settings.control_mode!="none"&&this.controls.addPopcorn(this.popcorn)},useHTML5:function(){var e=this,t="#media-player-html5-"+this.model.id,n=this.model;this.popcorn=Popcorn(t),this.addPopcornToControls(),this.setVolume(0),this.popcorn.on("canplay",function(){e.settings.fade_in===0&&e.setVolume(e.settings.volume),e.settings.cue_in!==0?(this.on("seeked",function(){n.can_play=!0,n.trigger("visual_ready",e.model.id)}),e.setCurrentTime(e.settings.cue_in)):(n.can_play=!0,n.trigger("visual_ready",e.model.id))})},useYoutube:function(){var e=this,t="#media-player-"+this.model.id,n=this.model.get("attr").attribution_uri,r=this.model;this.popcorn=Popcorn.youtube(t,n,{volume:this.settings.volume*100,cue_in:this.settings.cue_in}),this.addPopcornToControls(),this.setVolume(0),this.popcorn.on("canplaythrough",function(){e.popcorn.play(),e.popcorn.pause(),r.can_play=!0,r.trigger("visual_ready",e.model.id),r.get("attr").fade_in===0&&e.volume(r.get("attr").volume),e.popcorn.pause()})},useFlash:function(){var e=this,t="#media-player-"+this.model.id,n=this.model.get("attr").uri,r=this.model;this.popcorn=Popcorn.flashvideo(t,n,{volume:this.settings.volume,cue_in:this.settings.cue_in}),this.popcorn.on("loadeddata",function(){r.can_play=!0,r.trigger("visual_ready",e.model.id),r.get("attr").fade_in===0&&e.volume(r.get("attr").volume)})},useVimeo:function(){this.popcorn=Popcorn.vimeo("#media-player-"+this.model.id,this.get("url")),this.popcorn.on("loadeddata",function(){_this.trigger("video_canPlay"),_this.popcorn.currentTime(_this.get("cue_in"))})},private_onCanPlay:function(){this.model.set("duration",this.popcorn.duration()),this.model.get("cue_out")===null&&this.model.set("cue_out",this.popcorn.duration())},onCanplay:function(){this.settings.autoplay&&this.popcorn&&this.popcorn.play()},_onEnded:function(){this.model.trigger("media_ended",this.model.toJSON())},setVolume:function(e){var t;t=isNaN(+(t=e<0?0:e>1?1:e))?0:t,this.popcorn.volume(t)},getVolume:function(){return this.popcorn.volume()},setCurrentTime:function(e){_.isNumber(e)&&this.popcorn.currentTime(e)},getCurrentTime:function(){return this.popcorn.currentTime()},private_onTimeUpdate:function(){var e=this.settings.cue_out;e===0&&(this.settings.cue_out=e=his.getDuration()),e!==null&&this.popcorn.currentTime()>=e&&(this.pause(),this.popcorn.currentTime(this.settings.cue_in))},getDuration:function(){return this.popcorn.duration()},play:function(){this.popcorn&&this.popcorn.paused()&&this.popcorn.play()},pause:function(){this.popcorn&&!this.popcorn.paused()&&this.popcorn.pause()},playPause:function(){this.popcorn&&(this.popcorn.paused()?this.popcorn.play():this.popcorn.pause())},destroy:function(){this.popcorn&&(this.popcorn.pause(),Popcorn.destroy(this.popcorn))},getFormat:function(e){var t="html5";return e.match(/http:\/\/(?:youtu\.be\/|(?:[a-z]{2,3}\.)?youtube\.com\/watch(?:\?|#\!)v=)([\w\-]{11}).*/gi)&&(t="youtube"),e.match(/^http:\/\/(?:www\.)?vimeo.com\/(.*)/)&&(t="vimeo"),/Firefox/.test(navigator.userAgent)&&t==="html5"&&(t="flashvideo"),t},templates:{html5:function(){return html="<div id='media-player-<%= id %>' class='media-container'><video id='media-player-html5-<%= id %>' class='media-element media-type-<%= media_type %>' src='<%= uri %>'></video></div>",html},flashvideo:function(){return html="<div id='media-player-<%= id %>' class='media-container' style='width:100%;height:100%;'></div>",html},defaulttemplate:function(){return html="<div id='media-player-<%= id %>' class='media-container' style='width:100%;height:100%;'></div>",html}}}),t.Views.Player.Controls=t.Views.Player.Controls||{},t.Views.Player.Controls.none=e.Backbone.View.extend({className:"controls playback-controls controls-none",item_mode:!1,initialize:function(){this.options.detached_controls&&this.$el.addClass("playback-layer-controls"),this.model.get("uri")&&(this.item_mode=!0),this.init()},init:function(){}}),t.Views.Player.Controls.simple=t.Views.Player.Controls.none.extend({className:"controls playback-controls controls-simple",addPopcorn:function(e){this.popcorn=e,this.initPopcornEvents()},initPopcornEvents:function(){var e=this;this.popcorn.on("canplay",function(){e.onCanPlay()}),this.popcorn.on("canplaythrough",function(){e.onCanPlay()}),this.popcorn.on("ended",function(){e.onEnded()}),this.popcorn.on("playing",function(){e.onPlaying()}),this.popcorn.on("pause",function(){e.onPause()})},render:function(){return this.$el.html(this.getTemplate()),this},events:{click:"playPause",mouseover:"onMouseover",mouseout:"onMouseout"},onCanPlay:function(){this.updatePlayPauseIcon(),this.updateCues()},updateCues:function(){var e=this.item_mode,t=this.model.get("attr");this.cueIn=e?this.model.get("cue_in"):t.cue_in,this.cueOut=e?this.model.get("cue_out"):t.cue_out,this.cueOut||(this.cueOut=this.duration)},playPause:function(){return this.popcorn&&(this.popcorn.paused()?this.popcorn.play():this.popcorn.pause(),this.updatePlayPauseIcon()),!1},updatePlayPauseIcon:function(){this.popcorn&&this.$el.find(".pause-play i").removeClass(this.popcorn.paused()?"icon-pause":"icon-play").addClass(this.popcorn.paused()?"icon-play":"icon-pause")},onPlaying:function(){this.model.get("control_fade")&&this.setFadeTimeout(),this.updatePlayPauseIcon(),this.updatePlayPauseIcon()},setFadeTimeout:function(){this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){this.fadeOutControls(),clearTimeout(this.timer)}.bind(this),3500)},onMouseover:function(){this.model.get("control_fade")&&!this.popcorn.paused()&&(this.timer&&clearTimeout(this.timer),this.fadeInControls())},onMouseout:function(){this.model.get("control_fade")&&!this.popcorn.paused()&&this.setFadeTimeout()},fadeOutControls:function(){var e=this.$el.find(".player-control-inner");e.is(":visible")&&!this.popcorn.paused()&&e.fadeOut("slow")},fadeInControls:function(){var e=this.$el.find(".player-control-inner");e.is(":hidden")&&e.fadeIn("fast")},onPause:function(){this.timer&&clearTimeout(this.timer),this.fadeInControls(),this.updatePlayPauseIcon()},onEnded:function(){this.$el.find(".pause-play i").addClass("icon-play").removeClass("icon-pause")},getTemplate:function(){var e="<div class='player-control-inner'><a href='#' class='pause-play pull-left'><i class='icon-pause icon-white'></i></a></div>";return e}}),t.Views.Player.Controls.standard=t.Views.Player.Controls.simple.extend({isSeeking:!1,className:"controls playback-controls controls-standard",addPopcorn:function(e){this.popcorn=e,this.initPopcornEvents()},initPopcornEvents:function(){var e=this;this.popcorn.on("canplay",function(){e.onCanPlay()}),this.popcorn.on("canplaythrough",function(){e.onCanPlay()}),this.popcorn.on("ended",function(){e.onEnded()}),this.popcorn.on("playing",function(){e.onPlaying()}),this.popcorn.on("pause",function(){e.onPause()}),this.popcorn.on("timeupdate",function(){e.updateElapsed()})},events:{"click .pause-play":"playPause",mouseover:"onMouseover",mouseout:"onMouseout"},onCanPlay:function(){this.updateDuration(),this.updateCues(),this.updatePlayPauseIcon(),this.initScrubber()},initScrubber:function(){var e=this;this.$(".media-scrubber").slider({range:"min",min:0,max:this.duration,slide:function(t,n){e.scrub(n.value)},stop:function(t,n){e.seek(n.value)}})},updateDuration:function(){this.duration=this.popcorn.duration(),this.$(".media-time-duration").html(convertTime(this.duration))},updateElapsed:function(){var e=this.popcorn.currentTime();console.log("update",e),this.$(".media-time-elapsed").html(convertTime(e)),this.$(".media-scrubber").slider("value",e)},scrub:function(e){var t=this;this.isSeeking=!0},seek:function(e){var t=!this.popcorn.paused();t&&this.popcorn.pause(),e<this.cueIn?e=this.cueIn:e>this.cueOut&&(e=this.cueOut),this.$el.find(".media-scrubber").slider("value",e),this.popcorn.currentTime(e),t&&this.popcorn.play()},getTemplate:function(){var e="<div class='player-control-inner'><div class='media-scrubber'></div><div class='control-panel-inner'><a href='#' class='pause-play pull-left'><i class='icon-pause icon-white'></i></a><div class='pull-right'><span class='media-time-elapsed'>0:00</span> / <span class='media-time-duration'>0:00</span></div></div></div>";return e}}),t.Views.Player.Controls.editor=t.Views.Player.Controls.standard.extend({className:"controls playback-controls controls-editor",initPopcornEvents:function(){var e=this;this.popcorn.on("canplay",function(){e.onCanPlay()}),this.popcorn.on("canplaythrough",function(){e.onCanPlay()}),this.popcorn.on("ended",function(){e.onEnded()}),this.popcorn.on("timeupdate",function(){e.updateElapsed()}),this.popcorn.on("playing",function(){e.onPlaying()}),this.popcorn.on("pause",function(){e.onPause()})},events:{"click .pause-play":"playPause",mouseover:"onMouseover",mouseout:"onMouseout","mousedown .progress-outer":"scrub"},onCanPlay:function(){this.updateDuration(),this.updateCues(),this.updatePlayPauseIcon(),this.initScrubber(),this.initCropTool()},updateDuration:function(){this.duration=this.popcorn.duration(),this.$el.find(".media-time-duration").html(convertTime(this.duration))},updateElapsed:function(){var e=this.popcorn.currentTime();this.$(".media-time-elapsed").html(convertTime(e)),this.$(".media-scrubber").slider("value",e),e>=this.cueOut&&this.popcorn.pause()},initCropTool:function(){var e=this;this.$el.find(".crop-time-left .time").text(convertTime(this.cueIn)),this.$el.find(".crop-time-right .time").text(convertTime(this.cueOut)),this.$el.find(".crop-slider").slider({range:!0,min:0,max:e.duration,values:[e.cueIn,e.cueOut],slide:function(t,n){e.onCropSlide(t,n)},stop:function(t,n){e.onCropStop(t,n)}}),this.$el.find(".crop-time-left .time").unbind("keypress").keypress(function(t){var n;if(!(t.which>=48&&t.which<=58||t.which==13))return!1;if(t.which==13)return n=e.convertToSeconds($(this).text()),n===!1?$(this).text(convertTime(e.model.get("cue_in"))):(n=n<0?0:n,n=n>e.model.get("cue_out")?e.model.get("cue_out"):n,$(this).text(convertTime(n)),e.$el.find(".crop-slider").slider("values",0,n),e.cueIn=n,e.model.update({cue_in:n}),e.seek(n)),this.blur(),!1}),this.$el.find(".crop-time-right .time").unbind("keypress").keypress(function(t){var n;if(!(t.which>=48&&t.which<=58||t.which==13))return!1;if(t.which==13)return n=e.convertToSeconds($(this).text()),n===!1?$(this).text(convertTime(e.model.get("cue_out"))):(n=n>e.duration?e.duration:n,n=n<e.model.get("cue_in")?e.model.get("cue_in"):n,$(this).text(convertTime(n)),e.$el.find(".crop-slider").slider("values",1,n),e.cueOut=n,e.seek(Math.max(n-5,e.cueIn)),e.model.update({cue_out:n})),this.blur(),!1}),$(".time").mousedown(function(){$(this).focus()})},convertToSeconds:function(e){var t=e.split(/:/),n=!1,r=0;return _.each(t.reverse(),function(e,t){var i;if(e.length>2)return n=!0,!1;i=parseInt(e,10);if(!_.isNumber(i))return n=!0,!1;t?r+=i*t*60:r+=i}),n?!1:r},onCropSlide:function(e,t){this.$el.find(".crop-time-left .time").html(convertTime(t.values[0])),this.$el.find(".crop-time-right .time").html(convertTime(t.values[1]))},onCropStop:function(e,t){this.cueIn=t.values[0],this.cueOut=t.values[1],this.item_mode||this.model.update({cue_in:t.values[0],cue_out:t.values[1]}),this.popcorn.pause(),this.seek(t.values[0])},getTemplate:function(){var e="<div class='player-control-inner'><div class='crop-wrapper'><div class='crop-time-values clearfix'><span class='crop-time-left'>in [<span class='time' contenteditable='true'>0:00</span>]</span><span class='crop-time-right'>out [<span class='time' contenteditable='true'>0:00</span>]</span></div><div class='crop-slider'></div></div><div class='media-scrubber'></div><div class='control-panel-inner'><a href='#' class='pause-play pull-left'><i class='icon-play icon-white'></i></a><div class='pull-right'><span class='media-time-elapsed'>0:00</span> / <span class='media-time-duration'>0:00</span></div></div></div>";return e}}),t}),e.define("zeega_dir/plugins/layers/video/video",["zeega","zeega_dir/plugins/layers/_layer/_layer","zeega_dir/plugins/media-player/media-player"],function(e,t,n){var r=e.module();return r.Video=t.extend({layerType:"Video",defaultAttributes:{title:"Video Layer",url:"none",left:0,top:0,height:100,width:100,volume:.5,cue_in:0,cue_out:null,fade_in:0,fade_out:0,dissolve:!1,loop:!1,opacity:1,dimension:1.5,citation:!0}}),r.Video.Visual=t.Visual.extend({template:"plugins/video",ended:!1,playbackCount:0,init:function(){},onPlay:function(){this.ended=!1,this.mediaPlayer.play()},onPause:function(){this.mediaPlayer.pause()},onExit:function(){this.mediaPlayer.pause()},verifyReady:function(){if(this.mediaPlayer_loaded!==!0){var e=this;this.mediaPlayer=new n.Views.Player({model:this.model,control_mode:"none",media_target:"#visual-element-"+this.id}),this.$el.append(this.mediaPlayer.el),this.mediaPlayer.render(),this.mediaPlayer.placePlayer(),this.mediaPlayer.popcorn.listen("timeupdate",function(){e.onTimeUpdate()}),this.model.on("media_ended",function(){e.onEnded()}),this.mediaPlayer_loaded=!0}else this.mediaPlayer.pause()},onTimeUpdate:function(){if(!this.ended){var e,t,n,r,i,s;e=this.getAttr("cue_in"),t=this.getAttr("cue_out"),n=this.getAttr("fade_in"),r=this.getAttr("fade_out"),i=this.getAttr("volume"),t===0||t===null?s=this.mediaPlayer.getDuration():s=t;var o=this.mediaPlayer.getCurrentTime(),u=parseFloat(e)+parseFloat(n),a=s-parseFloat(r);n>0&&o<u?this.mediaPlayer.setVolume(i*(1-(u-o)/n*((u-o)/n))):n>0&&o>a||Math.abs(i-this.mediaPlayer.getVolume())>.01&&this.mediaPlayer.setVolume(i);var f={cue_in:this.getAttr("cue_in"),cue_out:this.getAttr("cue_out"),id:this.model.id,media_type:this.getAttr("media_type"),layer_type:this.getAttr("layer_type"),current_time:this.mediaPlayer.getCurrentTime(),duration:this.mediaPlayer.getDuration()};this.model.status.emit("media_timeupdate",f),this.mediaPlayer.getCurrentTime()>=s&&this.onEnded()}},onEnded:function(){this.playbackCount++,this.model.trigger("playback_ended",this.model.toJSON()),this.getAttr("loop")?(this.mediaPlayer.currentTime(this.getAttr("cue_in")),this.mediaPlayer.play()):this.ended=!0}}),r.Youtube=r.Video.extend(),r.Youtube.Visual=r.Video.Visual.extend(),r.Vimeo=r.Video.extend(),r.Vimeo.Visual=r.Video.Visual.extend(),r}),e.define("zeega_dir/plugins/layers/audio/audio",["zeega","zeega_dir/plugins/layers/_layer/_layer","zeega_dir/plugins/layers/video/video"],function(e,t,n){var r=e.module();return r.Audio=t.extend({layerType:"Audio",defaultAttributes:{title:"Audio Layer",url:"none",left:0,top:0,height:0,width:0,volume:.5,cue_in:0,cue_out:null,fade_in:0,fade_out:0,opacity:0,citation:!0}}),r.Audio.Visual=n.Video.Visual.extend({template:"plugins/audio"}),r}),e.define("zeega_dir/plugins/layers/rectangle/rectangle",["zeega","zeega_dir/plugins/layers/_layer/_layer"],function(e,t){var n=e.module();return n.Rectangle=t.extend({layerType:"Rectangle",defaultAttributes:{citation:!1,default_controls:!1,height:50,left:25,linkable:!1,opacity:1,opacity_hover:1,title:"Rectangle Layer",top:25,width:50}}),n.Rectangle.Visual=t.Visual.extend({template:"plugins/rectangle",serialize:function(){return this.model.toJSON()},beforePlayerRender:function(){var e={"background-color":this.getAttr("backgroundColor"),height:this.getAttr("height")+"%",opacity:this.getAttr("opacity")};this.$el.css(e)}}),n}),e.define("zeega_dir/plugins/layers/text/text",["zeega","zeega_dir/plugins/layers/_layer/_layer"],function(e,t){var n=e.module();return n.Text=t.extend({layerType:"Text",defaultAttributes:{citation:!1,default_controls:!0,left:30,opacity:1,title:"Text Layer",top:40,width:25}}),n.Text.Visual=t.Visual.extend({template:"plugins/text",serialize:function(){return this.model.toJSON()},onRender:function(){this.$el.css({color:this.model.get("attr").color,fontSize:this.model.get("attr").fontSize+"%"})}}),n}),e.define("zeega_dir/plugins/layers/popup/popup",["zeega","zeega_dir/plugins/layers/_layer/_layer","zeega_dir/plugins/media-player/media-player"],function(e,t,n){var r=e.module();r.Popup=t.extend({layerType:"Popup",defaultAttributes:{citation:!1,default_controls:!0,left:30,opacity:1,pauses_player:!0,title:"Popup Layer",top:40,width:25}}),r.Popup.Visual=t.Visual.extend({template:"plugins/popup",serialize:function(){return this.model.toJSON()},events:{"click .ZEEGA-popup-click-target":"popLayer"},popLayer:function(){this.model.get("attr").popup_content&&(this.popup=new i({model:this.model,template:"plugins/popup-"+this.model.get("attr").popup_content.media_type.toLowerCase()}),this.model.status.get("project").Layout.$el.append(this.popup.el),this.popup.render(),this.model.on("popup_remove",this.popupClosed,this),this.model.status.get("project").pause())},popupClosed:function(){this.model.status.get("project").play()},onExit:function(){this.popup&&this.popup.removePopup()}});var i=t.LayoutView.extend({className:"ZEEGA-popup-overlay",serialize:function(){return this.model.toJSON()},afterRender:function(){if(this.model.get("attr").popup_content.media_type=="Video"){var t=_.extend({},this.model.toJSON().attr.popup_content,{attr:this.model.toJSON().attr.popup_content}),r=new e.Backbone.Model(t);this.mediaPlayer=new n.Views.Player({model:r,control_mode:"none"}),this.$(".popup-video").append(this.mediaPlayer.el),this.mediaPlayer.render(),this.mediaPlayer.placePlayer(),r.on("visual_ready",function(){this.mediaPlayer.play()}.bind(this))}},events:{click:"closeOverlay","click a":"closeOverlay"},closeOverlay:function(){return this.removePopup(),this.model.trigger("popup_remove"),!1},removePopup:function(){this.mediaPlayer&&this.mediaPlayer.destroy(),this.remove()}});return r}),e.define("zeega_dir/plugins/layers/_all",["zeega_dir/plugins/layers/image/image","zeega_dir/plugins/layers/link/link","zeega_dir/plugins/layers/slideshow/slideshow","zeega_dir/plugins/layers/video/video","zeega_dir/plugins/layers/audio/audio","zeega_dir/plugins/layers/rectangle/rectangle","zeega_dir/plugins/layers/text/text","zeega_dir/plugins/layers/popup/popup"],function(e,t,n,r,i,s,o,u){var a={};return _.extend(a,e,t,n,r,i,s,o,u)}),e.define("zeega_dir/player/layer",["zeega","zeega_dir/plugins/layers/_all"],function(e,t){var n=e.module(),r=e.Backbone.Model.extend({ready:!1,state:"waiting",defaults:{mode:"player"},initialize:function(){var e=t[this.get("type")];if(e){var n=this;this.layerClass=new e,this.set(_.defaults(this.toJSON(),this.layerClass.defaults)),this.visualElement=new e.Visual({model:this,attributes:function(){return _.extend({},_.result(this,"domAttributes"),{id:"visual-element-"+n.id,"data-layer_id":n.id})}}),this.on("visual_ready",this.onVisualReady,this),this.on("visual_error",this.onVisualError,this)}else this.ready=!0,this.state="error",console.log("could not find valid layer type: ",this.get("type"))},render:function(){this.visualElement?this.state=="waiting"?(this.state="loading",this.status.emit("layer_loading",this.toJSON()),this.visualElement.player_onPreload()):this.state=="ready"&&this.visualElement.play():console.log("***    The layer "+this.get("type")+" is missing. ): ",this.id)},onVisualReady:function(){this.ready=!0,this.state="ready",this.trigger("layer_ready",this.toJSON())},onVisualError:function(){this.ready=!0,this.state="error",this.trigger("layer_error",this.toJSON())},updateZIndex:function(e){this.visualElement.updateZIndex(e)},pause:function(){this.visualElement.player_onPause()},play:function(){this.visualElement.player_onPlay()},exit:function(){this.layerClass&&this.visualElement.player_onExit()},remove:function(){this.layerClass&&this.visualElement.remove()},destroy:function(){this.state!="waiting"&&this.state!="destroyed"&&(this.state="destroyed")}});return n.Collection=e.Backbone.Collection.extend({model:r}),n}),e.define("zeega_dir/player/frame",["zeega","zeega_dir/player/layer"],function(e,t){var n=e.module(),r=e.Backbone.Model.extend({ready:!1,state:"waiting",hasPlayed:!1,elapsed:0,renderOnReady:null,defaults:{attr:{advance:0},common_layers:{},layers:[],link_to:[],link_from:[],preload_frames:[],_next:null,_prev:null},getNext:function(){return this.get("_next")},getPrev:function(){return this.get("_prev")},setConnections:function(){var e=this.get("_prev"),t=this.get("_next");this.set("connections",e&t?"lr":e?"l":t?"r":"none")},preload:function(){this.ready||this.layers.each(function(e){if(e.state==="waiting"||e.state==="loading")e.on("layer_ready",this.onLayerReady,this),e.render()},this)},render:function(e){var t;this.ready?(t=this.get("common_layers")[e]||[],this.layers.each(function(e){_.include(t,e.id)||e.render()}),this.status.set("current_frame",this.id),advance=this.get("attr").advance,advance&&this.startTimer(advance),!this.get("_next")&&this.get("link_to").length===0&&this.status.emit("deadend_frame",_.extend({},this.toJSON()))):this.renderOnReady=e,this.layers.each(function(e,t){e.updateZIndex(t)})},onLayerReady:function(e){this.status.emit("layer_ready",e),this.isFrameReady()&&!this.ready&&this.onFrameReady();var t=this.layers.map(function(e){return e.state})},onFrameReady:function(){var e={frame:this.toJSON(),layers:this.layers.toJSON()};this.ready=!0,this.state="ready",this.status.emit("frame_ready",e),_.isNull(this.renderOnReady)||(this.status.emit("can_play",e),this.render(this.renderOnReady),this.renderOnReady=null)},getLayerStates:function(){var e=_.toArray(this.layers);return["ready","waiting","loading","destroyed","error"].reduce(function(t,n){var r=e.filter(function(e){return e.state===n});return t[n]=r.map(function(e){return e.attributes}),t},{})},isFrameReady:function(){var e=this.getLayerStates();return e.ready.length+e.error.length===this.layers.length?!0:!1},pause:function(){this.timer&&(clearTimeout(this.timer),this.elapsed+=(new Date).getTime()-this.status.playTimestamp),this.layers.each(function(e){e.pause()})},play:function(){var e;this.layers.each(function(e){e.play()}),e=this.get("attr").advance,e&&this.startTimer(e-this.elapsed)},startTimer:function(e){this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){this.relay.set({current_frame:this.get("_next")})}.bind(this),e)},exit:function(e){var t=this.get("common_layers")[e]||[];this.elapsed=0,this.timer&&clearTimeout(this.timer),this.layers.each(function(e){_.include(t,e.id)||e.exit()})},unrender:function(e){},destroy:function(){this.state!=="waiting"&&this.state!=="destroyed"&&(this.layers.each(function(e){e.destroy()}),this.state="destroyed")}});return n.Collection=e.Backbone.Collection.extend({model:r,load:function(n,r,i){var s=this,o=new t.Collection(r);sequenceCollection=new e.Backbone.Collection(n),this.each(function(e){var r=[];e.layers=new t.Collection,e.relay=s.relay,e.status=s.status,_.each(e.get("layers"),function(t){e.layers.add(o.get(t))}),sequenceCollection.each(function(t,r){var i=t.get("frames"),s=t.get("advance_to"),o=i.indexOf(e.id),u=null,a=null;o>-1&&(o>0&&i.length>1?u=i[o-1]:r>0&&n[r-1].advance_to,o<i.length-1&&i.length>1?a=i[o+1]:s&&sequenceCollection.get(s)&&(a=sequenceCollection.get(s).get("frames")[0]),e.set({_prev:u,_next:a,_sequence:t.id}),e.setConnections())});var i=e.layers.where({type:"Link"}),u=[],a=[];_.each(i,function(t){t.get("attr").from_frame==e.id?u.push(t.get("attr").to_frame):(e.layers.remove(t),a.push(t.get("attr").from_frame))}),e.set({link_to:u,link_from:a}),e.layers.each(function(e){e.relay=s.relay,e.status=s.status})}),this.each(function(e){var t,n,r=["_prev","_next","link_to","link_from"].map(function(t){return e.get(t)});t=_.uniq(_.compact(_.union.apply(null,r))),n=t.reduce(function(t,n){return t[n]=_.intersection(e.layers.pluck("id"),this.get(n).layers.pluck("id")),t}.bind(s),{}),e.set({common_layers:n})}),this.each(function(e){var t=sequenceCollection.get(e.get("_sequence"))?sequenceCollection.get(e.get("_sequence")).get("advance_to"):!1,n=e.get("_next"),r=e.get("_prev"),s=[e.id,n,r];for(var o=0;o<i-1;o++){n=n?this.get(n).get("_next"):null,r=r?this.get(r).get("_next"):null;if(!n&&!r)break;s.push(n,r)}s=s.filter(Boolean),t&&sequenceCollection.get(t)&&s.push(sequenceCollection.get(t).get("frames")[0]),e.set("preload_frames",_.union(s,e.get("link_to"),e.get("link_from")))}.bind(this))}}),n}),e.define("zeega_dir/parsers/zeega-project",["lodash"],function(){var e="zeega-project",t={};return t[e]={name:e},t[e].validate=function(e){return e.sequences&&e.frames&&e.layers?!0:!1},t[e].parse=function(e,t){return e},t}),e.define("zeega_dir/parsers/zeega-project-published",["lodash"],function(){var e="zeega-project-published",t={};return t[e]={name:e},t[e].validate=function(e){return e.items&&e.items[0].media_type=="project"?!0:!1},t[e].parse=function(e,t){return e.items[0].text},t}),e.define("zeega_dir/parsers/zeega-collection",["lodash"],function(){function e(e,i){var s,o,u=[],a=[];_.each(e.items,function(e){e.layer_type=="Image"?u.push(e):(e.layer_type=="Audio"||e.media_type=="Video")&&a.push(e)}),u.length&&(o=r(u,i.layerOptions.slideshow.start,i.layerOptions.slideshow.start_id,i.layerOptions.slideshow.bleed));var f=t(a);o&&f.push(o),a.length?s=n(a,o?[o.id]:[]):s=[{id:1,layers:[1],attr:{advance:0}}];var l={id:0,title:"collection",persistent_layers:o?[o.id]:[],frames:_.pluck(s,"id")};return _.extend(e.items[0],{sequences:[l],frames:s,layers:f})}function t(e){var t={width:100,top:0,left:0,loop:!1};return _.map(e,function(e){return{attr:_.defaults(e,t),type:e.layer_type,id:e.id}})}function n(e,t){return _.map(e,function(e){var n=e.media_type=="Video"?[e.id]:_.compact([e.id].concat(t));return{id:e.id,layers:n,attr:{advance:0}}})}function r(e,t,n,r){var i={keyboard:!1,width:100,top:0,left:0},s=_.map(e,function(e){return{attr:e,type:e.layer_type,id:e.id}});return{attr:_.defaults({slides:s},i),start_slide:parseInt(t,10)||0,start_slide_id:parseInt(n,10)||null,slides_bleed:r,type:"SlideShow",id:1}}var i="zeega-collection",s={};s[i]={name:i},s[i].validate=function(e){return e.items&&e.items[0]&&e.items[0].child_items?!0:!1},s[i].parse=function(t,n){var r={};return n.layerOptions&&n.layerOptions.slideshow&&n.layerOptions.slideshow.display&&t.items.length>0?r=e(t,n):r=o(t,n),r};var o=function(e,r){var i=t(e.items),s=n(e.items),o={id:0,title:"collection",persistent_layers:[],frames:_.pluck(s,"id")};return _.extend(e.items[0],{sequences:[o],frames:s,layers:i})};return s}),e.define("zeega_dir/parsers/zeega-dynamic-collection",function(){}),e.define("zeega_dir/parsers/flickr",["lodash"],function(){function e(e){var t={width:100,top:0,left:0};return _.map(e,function(e){return e.uri=e.media.m,{attr:_.defaults(e,t),type:"Image",id:e.link}})}function t(e,t){return _.map(e,function(e){return{id:e.link,layers:_.compact([e.link].concat(t)),attr:{advance:0}}})}var n="flickr",r={};return r[n]={name:n},r[n].validate=function(e){return e.generator&&e.generator=="http://www.flickr.com/"?!0:!1},r[n].parse=function(n,r){var i=e(n.items),s=t(n.items),o={id:0,title:"flickr collection",persistent_layers:[],frames:_.pluck(s,"id")};return _.extend(n,{sequences:[o],frames:s,layers:i})},r}),e.define("zeega_dir/parsers/youtube",["lodash"],function(){function e(e){var t=0,n=0,r=e.length;for(;n<r;n++)t+=e.charCodeAt(n);return t}function t(e){var t={width:100,top:0,left:0,media_type:"Video",layer_type:"Youtube"};return _.map(e,function(e){return{attr:_.extend(_.defaults(e,t),{attribution_uri:"http://www.youtube.com/watch?v="+e.media$group.yt$videoid.$t}),type:"Video",id:e.media$group.yt$videoid.$t,attribution_uri:"http://www.youtube.com/watch?v="+e.media$group.yt$videoid.$t,uri:e.media$group.yt$videoid.$t}})}function n(e,t){return _.map(e,function(e){var n=e.media$group.yt$videoid.$t;return{id:n,layers:_.compact([n].concat(t)),attr:{advance:0}}})}var r="youtube",i={};return i[r]={name:r},i[r].validate=function(e){return e.generator&&e.generator=="http://gdata.youtube.com/"?!0:!0},i[r].parse=function(e,r){var i=t(e.feed.entry),s=n(e.feed.entry),o={id:0,title:"youtube playlist",persistent_layers:[],frames:_.pluck(s,"id")},u=_.extend(e,{sequences:[o],frames:s,layers:i});return u},i}),e.define("zeega_dir/parsers/_all",["zeega_dir/parsers/zeega-project","zeega_dir/parsers/zeega-project-published","zeega_dir/parsers/zeega-collection","zeega_dir/parsers/zeega-dynamic-collection","zeega_dir/parsers/flickr","zeega_dir/parsers/youtube"],function(e,t,n,r,i,s){var o={};return _.extend(o,e,t,n,r,i,s)}),e.define("modules/player/relay",["zeega"],function(e){var t={};return t.Model=e.Backbone.Model.extend({defaults:{current_frame:null,current_frame_model:null}}),t}),e.define("modules/player/status",["zeega"],function(e){var t={};return t.Model=e.Backbone.Model.extend({silent:!1,projectTimerstamp:null,frameTimestamp:null,pauseTimestamp:null,defaults:{previous_frame:null,previous_frame_model:null,current_frame:null,current_frame_model:null,current_sequence:null,current_sequence_model:null,current_layers:[],frameHistory:[],sequenceHistory:[]},initialize:function(){this.initTimer=_.once(this._initProjectTimer),this.get("project").on("play",this.onPlay,this),this.get("project").on("pause",this.onPause,this),this.on("change:current_frame",this.onChangeFrame,this)},onChangeFrame:function(e){var t,n,r,i,s=this.get("current_frame"),o=this.get("current_frame_model");this.pauseTimestamp=null,this.initTimer(),this.frameTimestamp=(new Date).getTime(),s&&this.put({previous_frame:s,previous_frame_model:o}),t=this.get("project").get("frames").get(s),n=t.get("_sequence"),r=this.get("frameHistory"),r.push(t.id),this.put({current_frame_model:t,frameHistory:r}),this.emit("frame_rendered",_.extend({},t.toJSON(),{layers:t.layers.toJSON()})),this.get("current_sequence")!=n&&(i=this.get("sequenceHistory"),i.push(n),this.set({current_sequence:n,current_sequence_model:this.get("project").get("sequences").get(n),sequenceHistory:i}),this.emit("sequence_enter",_.extend({},this.get("current_sequence_model").toJSON())))},emit:function(e,t){this.silent||this.get("project").trigger(e,t)},_initProjectTimer:function(){this.projectTimerstamp=(new Date).getTime()},onPlay:function(){this.playTimestamp=(new Date).getTime()},onPause:function(){this.pauseTimestamp=(new Date).getTime()}}),t}),e.define("modules/player/player-layout",["zeega"],function(e){var t={};return t.Layout=e.Backbone.Layout.extend({fetch:function(t){var n;return t="app/templates/layouts/"+t+".html",JST[t]?JST[t]:(n=this.async(),$.ajax({url:e.root+t}).then(function(e){n(JST[t]=_.template(e))}))},template:"player-layout",className:"ZEEGA-player",initialize:function(){var e=this.model.get("divId"),t=_.debounce(function(){this.resizeWindow()}.bind(this),300);$(window).resize(t)},serialize:function(){return this.model.toJSON()},afterRender:function(){this.$(".ZEEGA-player-window").css(this.getWindowSize()),this.setControls()},setControls:function(){var e=this.model.get("next"),t=this.model.get("prev"),n=this;e&&e.length&&$(e).click(function(){return n.model.cueNext(),!1}),t&&t.length&&$(t).click(function(){return n.model.cuePrev(),!1})},resizeWindow:function(){var t=this.getWindowSize();this.$(".ZEEGA-player-window").animate(t),this.model.trigger("window_resized",t),e.trigger("resize_window",t)},getWindowSize:function(){var e={},t=this.model.get("window_ratio")||4/3,n=$(this.model.get("target")).find(".ZEEGA-player").width(),r=$(this.model.get("target")).find(".ZEEGA-player").height(),i=n/r;return this.model.get("window_fit")?i>t?(e.width=n,e.height=n/t):(e.width=r*t,e.height=r):i>t?(e.width=r*t,e.height=r):(e.width=n,e.height=n/t),e.fontSize=e.width/520+"em",e.width+="px",e.height+="px",e}}),t}),e.define("modules/player/player",["zeega","modules/player/data","zeega_dir/player/frame","zeega_dir/player/layer","zeega_dir/parsers/_all","modules/player/relay","modules/player/status","modules/player/player-layout"],function(e,t,n,r,i,s,o,u){return Player=e.Backbone.Model.extend({ready:!1,state:"paused",relay:null,status:null,Layout:null,defaults:{data:null,frames:null,layers:null,layerOptions:{},preloadRadius:2,sequences:null,parser:null,autoplay:!0,collectionMode:"standard",fadeIn:500,fadeOut:500,keyboard:!0,next:null,prev:null,startFrame:null,target:null,url:null},initialize:function(e){this.relay=new s.Model,this.status=new o.Model({project:this}),this.data=new t.Model(e),this.data.url=e.url,this._setTarget(),this._load(e)},_load:function(t){var n=new e.Backbone.Model;if(t.url)n.url=t.url,n.fetch().success(function(e){this._detectAndParseData(e)}.bind(this)).error(function(){throw new Error("Ajax load fail")});else{if(!t.data)throw new TypeError("`url` expected non null");this._detectAndParseData(t.data)}},_setTarget:function(){this.put({target:$(this.get("target")||document.body)})},_detectAndParseData:function(e){var t;_.each(i,function(n){if(n.validate(e))return console.log("parsed using: "+n.name),this.parser=n.name,t=n.parse(e,this.toJSON()),!1}.bind(this));if(t===undefined)throw new Error("Valid parser not found");this.data.set(t),this._parseProjectData(t),this._listen()},_parseProjectData:function(t){var r,i,s,o;s=this.data.get("layers"),i=new n.Collection(this.data.get("frames")),r=new e.Backbone.Collection(this.data.get("sequences")),_.each(s,function(e){e._target=this.get("target")}.bind(this)),i.relay=this.relay,i.status=this.status,i.load(this.data.get("sequences"),s,this.get("preloadRadius"),_),(this.get("startFrame")===null||i.get(this.get("startFrame"))===undefined)&&this.put({startFrame:r.at(0).get("frames")[0]}),this.put({frames:i,sequences:r}),this._render(),this.status.emit("data_loaded",_.extend({},this.data.toJSON()))},_listen:function(){this.on("cue_frame",this.cueFrame,this),this.relay.on("change:current_frame",this._remote_cueFrame,this)},_remote_cueFrame:function(e,t){this.cueFrame(t)},_render:function(){var e=this.get("target");this.Layout=new u.Layout({model:this,attributes:{id:"ZEEGA-player-"+this.data.id,"data-projectID":this.id}}),e.is("body")||e.css("position","relative"),e.append(this.Layout.el),this.Layout.render(),_.delay(function(){this._onRendered()}.bind(this),100)},_fadeIn:function(){this.Layout.$el.fadeTo("fast",1)},_onRendered:function(){this.ready=!0,this._initEvents(),this.status.emit("ready",this),this.preloadFramesFrom(this.get("startFrame")),this.get("autoplay")&&this.play()},_initEvents:function(){var e=this;this.get("keyboard")&&$(window).keyup(function(t){switch(t.which){case 37:e.cuePrev();break;case 39:e.cueNext();break;case 32:e.playPause()}})},play:function(){var e=this.status.get("current_frame"),t=this.get("startFrame"),n,r;if(!this.ready)this.render();else if(this.state=="paused"){this._fadeIn(),e&&(this.state="playing",this.status.emit("play",this),this.status.get("current_frame_model").play()),n=e===null,r=t===null;if(n&&r)this.cueFrame(this.get("sequences")[0].frames[0]);else if(n&&!r&&this.get("frames").get(t))this.cueFrame(t);else if(!!n)throw new Error("Valid parser not found")}},pause:function(){this.state=="playing"&&(this.state="paused",this.status.get("current_frame_model").pause(),this.status.emit("pause"))},playPause:function(){this.state=="paused"?this.play():this.pause()},cueNext:function(e){this.cueFrame(this.status.get("current_frame_model").get("_next"),e)},cuePrev:function(e){this.cueFrame(this.status.get("current_frame_model").get("_prev"),e)},cueFrame:function(e,t){t=t||0,e!==undefined&&this.get("frames").get(e)!==undefined&&(t>0?_.delay(function(){this._goToFrame(e)}.bind(this),t):this._goToFrame(e))},_goToFrame:function(e){var t;this.preloadFramesFrom(e),this.status.get("current_frame")&&(this.status.get("current_frame_model").exit(e),t=this.status.get("current_frame_model").id),this.status.set("current_frame",e),this.relay.put("current_frame",e),this.status.get("current_frame_model").render(t),this.state!=="playing"&&(this.state="playing",this.status.emit("play",this))},cueNextSequence:function(){var e=this.status.get("current_sequence_model").get("advance_to");e&&this.get("sequences").get(e)&&this.cueFrame(this.get("sequences").get(e).get("frames")[0])},cuePrevSequence:function(){var e=this.status.get("sequenceHistory"),t;e.pop(),this.status.set("sequenceHistory",e),t=e[e.length-1],t&&this.cueFrame(this.get("sequences").get(t).get("frames")[0])},preloadFramesFrom:function(e){var t=this,n=this.get("frames").get(e);_.each(n.get("preload_frames"),function(e){t.get("frames").get(e).preload()})},getProjectData:function(){var e=this.get("frames").map(function(e){return _.extend({},e.toJSON(),{layers:e.layers.toJSON()})});return _.extend({},this.toJSON(),{frames:e})},getFrameData:function(){return this.status.get("current_frame")?_.extend({},this.status.get("current_frame_model").toJSON(),{layers:this.status.get("current_frame_model").layers.toJSON()}):!1},getProjectTree:function(){return!1},destroy:function(){var e=this;this.Layout.$el.fadeOut(this.get("fadeOut"),function(){e.get("frames").each(function(e){e.destroy()}),e.status.emit("player_destroyed")})},fitWindow:function(){this.Layout.resizeWindow()}}),e.player=Player,e}),e.require(["modules/player/player"],function(e){window.Zeega=e,$(window).trigger("zeega_ready")}),e.define("main",function(){})}(),define("zeegaplayer",function(){}),function(e){var t,n=e.Backbone,r=e._,i=e.$,s=n.View.prototype._configure,o=n.View.prototype.render,u=n.View.extend({constructor:function(e){e=e||{},u.setupView(this,e),n.View.call(this,e)},swapLayout:function(e){return e.views=r.defaults({},this.views,e.views),e.setElement(this.el),e},insertView:function(e,t){return t?this.setView(e,t,!0):this.setView(e,!0)},insertViews:function(e){return r.each(e,function(t,n){e[n]=[].concat(t)}),this.setViews(e)},getView:function(e){return this.getViews(e).first().value()},getViews:function(e){var t=r.chain(this.views).map(function(e){return[].concat(e)},this).flatten().value();return r.chain(r.filter(t,e?e:r.identity))},setView:function(e,t,n){var i,s,o=this;return r.isString(e)||(n=t,t=e,e=""),this.views=this.views||{},!n&&this.views[e]&&(r.isArray(this.views[e])?r.each(this.views[e],function(e){e.remove()}):this.views[e].remove()),s=t._options(),t.__manager__||u.setupView(t,s),t.render=function(i){function a(){(!n||t.keep||!l.hasRendered)&&s.partial(o.el,e,t.el,n),t.delegateEvents(),l.handler&&(l.handler.resolveWith(t,[t.el]),delete l.handler),f.resolveWith(t,[t.el]),r.isFunction(i)&&i.call(t,t.el)}var f=s.deferred(),l=t.__manager__;return l.viewDeferred=f,t._removeView(),u.prototype.render.call(t).then(a),f.promise()},t.__manager__.parent=o,t.__manager__.selector=e,n?(i=this.views[e]=this.views[e]||[],r.isArray(this.views[e])||(i=this.views[e]=[this.views[e]]),r.indexOf(i,t)>-1?t:(i.push(t),t.__manager__.append=!0,t)):this.views[e]=t},setViews:function(e){return r.each(e,function(e,t){if(r.isArray(e))return r.each(e,function(e){this.insertView(t,e)},this);this.setView(t,e)},this),this},render:function(e){var t=this,n=this._options(),i=n.deferred();return this.__manager__.renderDeferred?(this.__manager__.callback=e,this.__manager__.renderDeferred):(this._render(u._viewRender).fetch.then(function(){t.__manager__.renderDeferred=i;var e=r.map(t.views,function(e){function t(e,n){if(!e.length)return n();var r=e.shift();r.render(function(){t(e,n)})}var i;return r.isArray(e)?(i=n.deferred(),t(r.clone(e),function(){i.resolve()}),i.promise()):e.render()});n.when(e).then(function(){i.resolveWith(t,[t.el])})}),i.then(function(){r.isFunction(e)&&e.call(t,t.el),t.__manager__.handler&&(t.__manager__.handler.resolveWith(t,[t.el]),delete t.__manager__.handler),r.isFunction(t.__manager__.callback)&&(t.__manager__.callback.call(t,t.el),delete t.__manager__.callback),delete t.__manager__.renderDeferred}))},remove:function(){return u.cleanViews(this),this._remove.apply(this,arguments)},_options:function(){return r.extend({},this,u.prototype.options,this.options)}},{_cache:{},_makeAsync:function(e,t){var n=e.deferred();return n.async=function(){return n._isAsync=!0,t},n},_viewRender:function(e){function t(t,r){u.cache(n,r),r&&o.html(e.el,o.render(r,t)),s.fetch.resolveWith(e,[e.el])}var n,i,s,o=e._options();return{render:function(a){var f=e.__manager__,l=e.template||o.template;return e.serialize&&(o.serialize=e.serialize),!a&&r.isFunction(o.serialize)?a=o.serialize.call(e):!a&&r.isObject(o.serialize)&&(a=o.serialize),s=u._makeAsync(o,r.bind(t,e,a)),s.fetch=o.deferred(),f.handler=s,r.isString(l)&&(n=f.prefix+l),(i=u.cache(n))?(t(a,i,n),s):(r.isString(l)?i=o.fetch.call(s,f.prefix+l):l!=null&&(i=o.fetch.call(s,l)),s._isAsync||t(a,i),s)}}},cleanViews:function(e){r.each([].concat(e),function(e){e.unbind(),e.views&&r.each(e.views,function(e){u.cleanViews(e)}),r.isFunction(e.cleanup)&&e.cleanup.call(e)})},cache:function(e,t){if(e in this._cache)return this._cache[e];if(e!=null&&t!=null)return this._cache[e]=t},configure:function(e){r.extend(u.prototype.options,e),e.manage&&(n.View.prototype.manage=!0)},setupView:function(e,i){var s,o,a=n.LayoutManager.prototype,f=r.pick(e,t);if(e.__manager__)return;r.defaults(e,{views:{},__manager__:{},_options:u.prototype._options,_removeView:u._removeView}),e instanceof n.Layout?e.__manager__.prefix=e._options().paths.layout||"":e.__manager__.prefix=e._options().paths.template||"",i=e.options=r.defaults(i||{},e.options,a.options),o=r.pick(i,["events"].concat(r.values(i.events))),r.extend(e,o),delete f.render,r.extend(i,f),e._remove=n.View.prototype.remove,e._render=function(e){var t,n=this._options().beforeRender,s=this._options().afterRender;return this._removeView(),r.isFunction(n)&&n.call(this,this),this.trigger("beforeRender",this),t=e(this).render(),t.then(function(){var e=this,t=e.__manager__,n=t.parent,o=function(){e.delegateEvents(),e.__manager__.hasRendered=!0,r.isFunction(s)&&s.call(e,e),e.trigger("afterRender",e)},u=function(e){var t=e.__manager__;return t.parent&&!t.hasRendered?u(t.parent):e};if(!n)return o.call(e);if(n.__manager__.hasRendered)return i.when([t.viewDeferred,n.__manager__.viewDeferred]).then(function(){o.call(e)});n=u(e),n.on("afterRender",function(){n.off(null,null,e),o.call(e)},e)}),t},e.render=u.prototype.render,e.remove!==a.remove&&(e._remove=e.remove,e.remove=a.remove),s=i.views||e.views,r.keys(s).length&&e.setViews(s),e.template&&(i.template=e.template,delete e.template)},_removeView:function(e){e=e||this,e.getViews().each(function(e){var t=e.__manager__,n=r.isBoolean(e.keep)?e.keep:e.options.keep;if(!n&&t.append===!0&&t.hasRendered){e.remove();if(r.isArray(t.parent.views[t.selector]))return t.parent.getView(function(e,n){e.__manager__.selector===t.selector&&t.parent.views[t.selector].splice(n,1)});delete t.parent[t.selector]}})}});r.each(["get","set","insert"],function(e){var t=n.View.prototype,r=u.prototype;t[e+"View"]=r[e+"View"],t[e+"Views"]=r[e+"Views"]}),n.Layout=n.LayoutManager=u,n.LayoutView=n.View.extend({manage:!0}),n.View.prototype._configure=function(){var e=s.apply(this,arguments);return this.manage&&u.setupView(this),e},u.prototype.options={paths:{},deferred:function(){return i.Deferred()},fetch:function(e){return r.template(i(e).html())},partial:function(e,t,n,r){var s=t?i(e).find(t):i(e);return s.length?(this[r?"append":"html"](s,n),!0):!1},html:function(e,t){i(e).html(t)},append:function(e,t){i(e).append(t)},when:function(e){return i.when.apply(null,e)},render:function(e,t){return e(t)}},t=r.keys(u.prototype.options)}(this),define("plugins/backbone.layoutmanager",function(){}),define("app",["lodash","backbone","plugins/backbone.layoutmanager"],function(e,t){var n={root:"/",players:new t.Model},r=window.JST=window.JST||{};return t.LayoutManager.configure({manage:!0,paths:{layout:"app/templates/layouts/",template:"app/templates/"},fetch:function(t){var i;return t+=".html",r[t]?r[t]:(i=this.async(),$.ajax({url:n.root+t}).then(function(n){i(r[t]=e.template(n))}))}}),e.extend(n,{module:function(t){return e.extend({Views:{}},t)},useLayout:function(n,r){if(this.layout&&this.layout.options.template===n)return this.layout;this.layout&&this.layout.remove();var i=new t.Layout(e.extend({template:n,className:"layout "+n,id:"layout"},r));return $("#main").empty().append(i.el),i.render(),this.layout=i,i}},t.Events)}),define("modules/state",["app","backbone"],function(e,t){var n={};return n=t.Model.extend({defaults:{base_rendered:!1,first_visit:!0},initialize:function(){this.checkFirstVisit()},checkFirstVisit:function(){localStorage.visited=="true"?this.set("first_visit",!1):localStorage.visited=!0}}),n}),define("modules/loader",["app","backbone"],function(e,t){var n={};return n.View=t.View.extend({DELAY:3e3,layerCount:0,layersReady:0,className:"ZEEGA-loader-overlay",template:"bgbloader",initialize:function(){var t=this;_.bindAll(this,"render"),e.bgImages=new n.ImagesCollection(69796),e.bgImages.fetch().success(function(){t.preloadStartImg(),t.preloadEndImg()}),e.state.get("first_visit")||(this.DELAY=0),this.model.on("layer_loading",this.onLayerLoading,this),this.model.on("layer_ready",this.onLayerReady,this),this.model.on("data_loaded",this.onDataLoaded,this)},afterRender:function(){this.bgImageReady&&this.$(".ZEEGA-loader-bg:animated").length===0&&this.$(".ZEEGA-loader-bg").animate({opacity:.5},500)},preloadStartImg:function(){var t=$("<img />"),n=Math.floor(Math.random()*e.bgImages.length),r=this;this.rndImgUrl=e.bgImages.at(n).get("uri"),t.attr("src",this.rndImgUrl).on("load",function(){r.bgImageReady=!0,r.render()})},preloadEndImg:function(){var t=Math.floor(Math.random()*e.bgImages.length),n=e.bgImages.at(t).get("uri"),r=$("<img />");r.attr("src",n),e.endImageUrl=n},serialize:function(){return this.bgImageReady?{rndImgUrl:this.rndImgUrl}:{rndImgUrl:""}},onDataLoaded:function(){this.render()},onLayerLoading:function(e){this.layerCount++},onLayerReady:function(e){this.layersReady++,this.$(".logo-splat").stop().animate({height:this.layersReady/this.layerCount*100+"%"}),this.layersReady==this.layerCount&&this.onCanPlay()},onCanPlay:function(){var e=this;_.delay(function(){e.$(".loader-content").fadeOut(500,function(){_.delay(function(){e.$el.fadeOut(500,function(){e.remove()})},500)}),e.model.play()},this.DELAY)},events:{"click .fullscreen":"goFullscreen"},goFullscreen:function(){return docElm=document.getElementById("body-main"),docElm.requestFullscreen?docElm.requestFullscreen():docElm.mozRequestFullScreen?docElm.mozRequestFullScreen():docElm.webkitRequestFullScreen&&docElm.webkitRequestFullScreen(),this.$("#project-fullscreen-toggle i").removeClass("icon-resize-full").addClass("icon-resize-small"),!1}}),n.ImagesCollection=t.Collection.extend({initialize:function(e){this.zeegaId=e},url:function(){return localStorage.api+"/items/"+this.zeegaId+"/items"},parse:function(e){return e.items}}),n}),define("modules/controls",["app","backbone"],function(e,t){var n={};return n.View=t.View.extend({template:"controls",className:"ZEEGA-player-controls",initialize:function(){this.model.on("frame_rendered",this.updateArrowState,this)},events:{"click .next-arrow":"skip","click .prev-arrow":"skipBack","mouseenter .prev-arrow":"mouseenterPrev","mouseenter .next-arrow":"mouseenterNext","mouseout .prev-arrow":"mouseoutPrev","mouseout .next-arrow":"mouseoutNext"},mouseenterNext:function(){this.$(".arrow-text").addClass("next")},mouseoutNext:function(){this.$(".arrow-text").removeClass("next")},mouseenterPrev:function(){this.$(".arrow-text").addClass("prev")},mouseoutPrev:function(){this.$(".arrow-text").removeClass("prev")},skip:function(){if(this.model.status.attributes.current_frame_model.get("_prev")===null&&this.model.status.attributes.current_frame!=27708&&this.model.status.attributes.current_frame!=28506){var e=this.model.status.attributes.current_frame_model.layers.models[0].get("attr").cue_in+this.model.status.attributes.current_frame_model.get("attr").advance/1e3;this.model.status.attributes.current_frame_model.layers.models[0].visualElement.mediaPlayer.setCurrentTime(e),this.model.cueNext()}else this.model.cueNextSequence()},skipBack:function(){this.model.cuePrevSequence();var e=this.model.status.attributes.current_frame_model,t=e.layers.models[0],n=t.visualElement.mediaPlayer;n.setCurrentTime(t.get("attr").cue_in)}}),n}),define("modules/share",["app","backbone"],function(e,t){var n={};return n.View=t.View.extend({template:"share",className:"BGB-overlay",events:{"click .close-modal":"close"},close:function(){this.model.play(),this.remove()}}),n}),define("modules/titles",["app","backbone","modules/share"],function(e,t,n){var r={};return r.View=t.View.extend({visible:!0,template:"titles",className:"BGB-player-titles",seqTitle:"",titlebarHeight:84,titlebarHidden:!0,serialize:function(){return _.extend({title:""},{title:this.seqTitle,seqTitle:this.seqDescription})},initialize:function(){var e=this;_.bindAll(this,"showTitlebar","hideTitlebar","showOnHover"),this.model.on("frame_rendered",this.render,this),this.model.on("data_loaded",this.render,this),this.model.on("sequence_enter",_.after(2,function(){this.showTitlebar(7e3)}),this),this.model.on("sequence_enter",this.getSequenceTitle,this),this.model.on("media_timeupdate",this.onTimeupdate,this),$("body").on("mousemove",_.debounce(this.showOnHover,100))},events:{"click .share":"share","click .fullscreen":"fullscreen","click .play-pause":"playPause"},share:function(){return this.model.pause(),this.shareView||(this.shareView=new n.View({model:this.model})),$("body").append(this.shareView.el),this.shareView.render(),!1},fullscreen:function(){return docElm=document.getElementById("body-main"),docElm.requestFullscreen?docElm.requestFullscreen():docElm.mozRequestFullScreen?docElm.mozRequestFullScreen():docElm.webkitRequestFullScreen&&docElm.webkitRequestFullScreen(),this.$("#project-fullscreen-toggle i").removeClass("icon-resize-full").addClass("icon-resize-small"),!1},afterRender:function(){this.titlebarHeight=this.$el.height()},onTimeupdate:function(e){var t,n;e.cue_in&&e.cue_out?(n=e.cue_out-e.cue_in,t=e.current_time-e.cue_in):e.cue_out?(n=e.cue_out,t=e.current_time):(n=e.duration,t=e.current_time),this.$(".elapsed-bar").css("width",t/n*100+"%"),this.$(".time-elapsed").text(this._convertTime(t)),this.$(".time-duration").text(this._convertTime(n))},_convertTime:function(e){var t=Math.floor(e/60),n=Math.floor(e%60);return n<10&&(n="0"+n),t+":"+n},showOnHover:function(e){this.hideTimerRunning||(e.pageY>window.innerHeight-this.titlebarHeight&&this.titlebarHidden?this.showTitlebar():e.pageY<window.innerHeight-this.titlebarHeight&&!this.titlebarHidden&&this.hideTitlebar())},showTitlebar:function(e){this.titlebarHidden=!1,this.hideTimerRunning&&(clearTimeout(this.hideTimer),this.hideTimerRunning=!1),this.$el.stop().animate({bottom:0},500),e&&(this.hideTimer=setTimeout(this.hideTitlebar,e),this.hideTimerRunning=!0)},hideTitlebar:function(){this.titlebarHidden=!0,this.hideTimerRunning=!1,this.$el.stop().animate({bottom:this.titlebarHeight*-1},500)},getSequenceTitle:function(e){this.seqTitle=e.title?e.title:"",this.seqDescription=e.description?e.description:"",this.render()},playPause:function(){e.player.playPause(),this.$(".play-pause").toggleClass("play")}}),r}),define("modules/collection-popup",["app","backbone"],function(e,t){var n={};n.View=t.View.extend({template:"zeega-popup",className:"ZEEGA-popup",events:{"click .continue-arrow":"continueSequence","click .continue":"closeCaption","click .skip":"continueSequence"},initialize:function(){this.collectionModel=new r({id:this.options.collection_id}),this.collectionModel.fetch().success(function(e){this.$(".popup-title").text(this.collectionModel.get("title"))}.bind(this))},serialize:function(){return{id:this.options.collection_id,name:"",caption:this.options.caption||""}},afterRender:function(){this.initPlayer()},initPlayer:function(){this.player=new Zeega.player({target:this.$(".ZEEGA-popup-project-target"),autoplay:!0,layerOptions:{slideshow:{display:!0,bleed:!1}},url:localStorage.api+"/items/"+this.options.collection_id+"/items"}),this.player.on("all",function(e,t){e!="media_timeupdate"&&console.log("    zeega popup event:",e,t)})},continueSequence:function(){e.player.cueNext()},skipGallery:function(){this.dispose(),this.closeCaption()},dispose:function(){var e=this;this.player.destroy()},closeCaption:function(){return this.$(".caption").fadeOut(function(){$(this).remove()}),!1}});var r=t.Model.extend({url:function(){return localStorage.api+"/items/"+this.id},parse:function(e){return e.items[0]}});return n}),define("modules/bgb-end",["app","backbone"],function(e,t){var n={};return n.View=t.View.extend({template:"bgb-end",className:"BGB-end",serialize:function(){return{rndImgUrl:e.endImageUrl}}}),n}),define("modules/ui",["app","backbone","modules/loader","modules/controls","modules/titles","modules/collection-popup","modules/bgb-end"],function(e,t,n,r,i,s,o){var u={},a=3e3;return u.Layout=t.LayoutView.extend({el:"#main",template:"ui-base",initialize:function(){e.player.on("frame_rendered",this.checkForCollectionFrame,this),e.player.on("frame_rendered",this.updateContinue,this),e.player.on("deadend_frame",this.showBGBEnd,this),this.loader=new n.View({model:e.player}),this.controls=new r.View({model:e.player}),this.titles=new i.View({model:e.player}),this.insertView(this.loader),this.insertView(this.controls),this.insertView(this.titles),this.render()},afterRender:function(){e.state.set("base_rendered",!0)},updateContinue:function(e){e.attr.advance?this.$(".continue-arrow").removeClass("show"):this.$(".continue-arrow").addClass("show")},checkForCollectionFrame:function(e){this.popup&&(this.popup.player.on("player_destroyed",function(){this.popup.remove(),this.popup=null},this),this.popup.dispose()),e.id==28729?(this.popup=new s.View({collection_id:67060,caption:"In the oil patch, there are lots of pickups. And lots of pickup truck stickers. This gallery shows a sampling of those for sale on the sticker bus and those spotted on trucks and cars. Warning: Some are lewd and crude. <span class='emphasis'>Viewer discretion advised.</span>"}),this.insertView(this.popup),this.popup.render()):e.id==31018?(this.popup=new s.View({collection_id:67034}),this.insertView(this.popup),this.popup.render()):e.id==30928?this.controls.remove():e.id==31358&&this.showBGBEnd()},showBGBEnd:function(){this.ending||(this.ending=new o.View,this.insertView(this.ending),this.ending.render())},events:{"mouseenter .bgb-logo":"onMouseOverLogo","mouseout .bgb-logo":"onMouseOutLogo"},onMouseOverLogo:function(){this.$(".bgb-logo img").attr("src","assets/img/bgblogo-hover.png")},onMouseOutLogo:function(){this.$(".bgb-logo img").attr("src","assets/img/bgblogo.png")}}),u}),define("modules/controller",["app","backbone","modules/state","modules/ui"],function(e,t,n,r){var i={};return i.Model=t.Model.extend({initialize:function(){this.initPlayer(),e.state=new n,e.layout=new r.Layout},initPlayer:function(){var t=new Zeega.player({window_fit:!0,autoplay:!1,keyboard:!0,preloadRadius:5,startFrame:27708,url:localStorage.api+"/items/69795"});t.on("frame_rendered window_resized",this.updateYoutubeSize,this),e.player=t},updateYoutubeSize:function(){_.delay(function(){var e=window.innerHeight*(16/9),t=(window.innerWidth-e)/2;$(".ZEEGA-player .visual-element-video").css({height:window.innerHeight,width:e,left:t})},0)}}),i}),define("router",["app","modules/controller","zeegaplayer"],function(e,t){var n=Backbone.Router.extend({routes:{"":"base","project/:project_id":"goToProject","p/:project_id":"goToProject","project/:project_id/frame/:frame_id":"goToProjectFrame","p/:project_id/f/:frame_id":"goToProjectFrame"},base:function(){i()},goToProject:function(t){i(),e.state.set("project_id",t)},goToProjectFrame:function(t,n){i(),e.state.set({project_id:t,frame_id:n})}}),r=function(){new t.Model},i=_.once(r);return n}),window.Modernizr=function(e,t,n){function r(e){d.cssText=e}function i(e,t){return r(y.join(e+";")+(t||""))}function s(e,t){return typeof e===t}function o(e,t){return!!~(""+e).indexOf(t)}function u(e,t,r){for(var i in e){var o=t[e[i]];if(o!==n)return r===!1?e[i]:s(o,"function")?o.bind(r||t):o}return!1}function a(){l.input=function(n){for(var r=0,i=n.length;r<i;r++)N[n[r]]=n[r]in v;return N.list&&(N.list=!!t.createElement("datalist")&&!!e.HTMLDataListElement),N}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),l.inputtypes=function(e){for(var r=0,i,s,o,u=e.length;r<u;r++)v.setAttribute("type",s=e[r]),i=v.type!=="text",i&&(v.value=m,v.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(s)&&v.style.WebkitAppearance!==n?(c.appendChild(v),o=t.defaultView,i=o.getComputedStyle&&o.getComputedStyle(v,null).WebkitAppearance!=="textfield"&&v.offsetHeight!==0,c.removeChild(v)):/^(search|tel)$/.test(s)||(/^(url|email)$/.test(s)?i=v.checkValidity&&v.checkValidity()===!1:i=v.value!=m)),T[e[r]]=!!i;return T}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var f="2.6.2",l={},c=t.documentElement,h="modernizr",p=t.createElement(h),d=p.style,v=t.createElement("input"),m=":)",g={}.toString,y=" -webkit- -moz- -o- -ms- ".split(" "),b="Webkit Moz O ms",w=b.split(" "),E=b.toLowerCase().split(" "),S={svg:"http://www.w3.org/2000/svg"},x={},T={},N={},C=[],k=C.slice,L,A=function(e,n,r,i){var s,o,u,a,f=t.createElement("div"),l=t.body,p=l||t.createElement("body");if(parseInt(r,10))while(r--)u=t.createElement("div"),u.id=i?i[r]:h+(r+1),f.appendChild(u);return s=["&#173;",'<style id="s',h,'">',e,"</style>"].join(""),f.id=h,(l?f:p).innerHTML+=s,p.appendChild(f),l||(p.style.background="",p.style.overflow="hidden",a=c.style.overflow,c.style.overflow="hidden",c.appendChild(p)),o=n(f,e),l?f.parentNode.removeChild(f):(p.parentNode.removeChild(p),c.style.overflow=a),!!o},O=function(t){var n=e.matchMedia||e.msMatchMedia;if(n)return n(t).matches;var r;return A("@media "+t+" { #"+h+" { position: absolute; } }",function(t){r=(e.getComputedStyle?getComputedStyle(t,null):t.currentStyle)["position"]=="absolute"}),r},M=function(){function e(e,i){i=i||t.createElement(r[e]||"div"),e="on"+e;var o=e in i;return o||(i.setAttribute||(i=t.createElement("div")),i.setAttribute&&i.removeAttribute&&(i.setAttribute(e,""),o=s(i[e],"function"),s(i[e],"undefined")||(i[e]=n),i.removeAttribute(e))),i=null,o}var r={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return e}(),_={}.hasOwnProperty,D;!s(_,"undefined")&&!s(_.call,"undefined")?D=function(e,t){return _.call(e,t)}:D=function(e,t){return t in e&&s(e.constructor.prototype[t],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if(typeof t!="function")throw new TypeError;var n=k.call(arguments,1),r=function(){if(this instanceof r){var i=function(){};i.prototype=t.prototype;var s=new i,o=t.apply(s,n.concat(k.call(arguments)));return Object(o)===o?o:s}return t.apply(e,n.concat(k.call(arguments)))};return r}),x.canvas=function(){var e=t.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")},x.canvastext=function(){return!!l.canvas&&!!s(t.createElement("canvas").getContext("2d").fillText,"function")},x.webgl=function(){return!!e.WebGLRenderingContext},x.touch=function(){var n;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?n=!0:A(["@media (",y.join("touch-enabled),("),h,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(e){n=e.offsetTop===9}),n},x.geolocation=function(){return"geolocation"in navigator},x.postmessage=function(){return!!e.postMessage},x.websqldatabase=function(){return!!e.openDatabase},x.hashchange=function(){return M("hashchange",e)&&(t.documentMode===n||t.documentMode>7)},x.history=function(){return!!e.history&&!!history.pushState},x.draganddrop=function(){var e=t.createElement("div");return"draggable"in e||"ondragstart"in e&&"ondrop"in e},x.websockets=function(){return"WebSocket"in e||"MozWebSocket"in e},x.video=function(){var e=t.createElement("video"),n=!1;try{if(n=!!e.canPlayType)n=new Boolean(n),n.ogg=e.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),n.h264=e.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),n.webm=e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")}catch(r){}return n},x.audio=function(){var e=t.createElement("audio"),n=!1;try{if(n=!!e.canPlayType)n=new Boolean(n),n.ogg=e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),n.mp3=e.canPlayType("audio/mpeg;").replace(/^no$/,""),n.wav=e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),n.m4a=(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,"")}catch(r){}return n},x.localstorage=function(){try{return localStorage.setItem(h,h),localStorage.removeItem(h),!0}catch(e){return!1}},x.sessionstorage=function(){try{return sessionStorage.setItem(h,h),sessionStorage.removeItem(h),!0}catch(e){return!1}},x.webworkers=function(){return!!e.Worker},x.applicationcache=function(){return!!e.applicationCache},x.svg=function(){return!!t.createElementNS&&!!t.createElementNS(S.svg,"svg").createSVGRect},x.inlinesvg=function(){var e=t.createElement("div");return e.innerHTML="<svg/>",(e.firstChild&&e.firstChild.namespaceURI)==S.svg},x.smil=function(){return!!t.createElementNS&&/SVGAnimate/.test(g.call(t.createElementNS(S.svg,"animate")))},x.svgclippaths=function(){return!!t.createElementNS&&/SVGClipPath/.test(g.call(t.createElementNS(S.svg,"clipPath")))};for(var P in x)D(x,P)&&(L=P.toLowerCase(),l[L]=x[P](),C.push((l[L]?"":"no-")+L));return l.input||a(),l.addTest=function(e,t){if(typeof e=="object")for(var r in e)D(e,r)&&l.addTest(r,e[r]);else{e=e.toLowerCase();if(l[e]!==n)return l;t=typeof t=="function"?t():t,typeof enableClasses!="undefined"&&enableClasses&&(c.className+=" "+(t?"":"no-")+e),l[e]=t}return l},r(""),p=v=null,function(e,t){function n(e,t){var n=e.createElement("p"),r=e.getElementsByTagName("head")[0]||e.documentElement;return n.innerHTML="x<style>"+t+"</style>",r.insertBefore(n.lastChild,r.firstChild)}function r(){var e=g.elements;return typeof e=="string"?e.split(" "):e}function i(e){var t=v[e[p]];return t||(t={},d++,e[p]=d,v[d]=t),t}function s(e,n,r){n||(n=t);if(m)return n.createElement(e);r||(r=i(n));var s;return r.cache[e]?s=r.cache[e].cloneNode():c.test(e)?s=(r.cache[e]=r.createElem(e)).cloneNode():s=r.createElem(e),s.canHaveChildren&&!l.test(e)?r.frag.appendChild(s):s}function o(e,n){e||(e=t);if(m)return e.createDocumentFragment();n=n||i(e);var s=n.frag.cloneNode(),o=0,u=r(),a=u.length;for(;o<a;o++)s.createElement(u[o]);return s}function u(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(n){return g.shivMethods?s(n,e,t):t.createElem(n)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+r().join().replace(/\w+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(g,t.frag)}function a(e){e||(e=t);var r=i(e);return g.shivCSS&&!h&&!r.hasCSS&&(r.hasCSS=!!n(e,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),m||u(e,r),e}var f=e.html5||{},l=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,c=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,h,p="_html5shiv",d=0,v={},m;(function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",h="hidden"in e,m=e.childNodes.length==1||function(){t.createElement("a");var e=t.createDocumentFragment();return typeof e.cloneNode=="undefined"||typeof e.createDocumentFragment=="undefined"||typeof e.createElement=="undefined"}()}catch(n){h=!0,m=!0}})();var g={elements:f.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:f.shivCSS!==!1,supportsUnknownElements:m,shivMethods:f.shivMethods!==!1,type:"default",shivDocument:a,createElement:s,createDocumentFragment:o};e.html5=g,a(t)}(this,t),l._version=f,l._prefixes=y,l._domPrefixes=E,l._cssomPrefixes=w,l.mq=O,l.hasEvent=M,l.testStyles=A,l}(this,this.document),define("modernizr",function(e){return function(){return e.Modernizr}}(this)),require(["app","router","modernizr"],function(e,t,n){n.canvas||(window.location.pathname="old-browser.html"),e.router=new t,Backbone.history.start({pushState:!1,root:e.root}),$(document).on("click","a:not([data-bypass])",function(t){var n={prop:$(this).prop("href"),attr:$(this).attr("href")},r=location.protocol+"//"+location.host+e.root;n.prop&&n.prop.slice(0,r.length)===r&&(t.preventDefault(),Backbone.history.navigate(n.attr,!0))})}),define("main",function(){}),require.config({deps:["zeegaplayer","main"],paths:{libs:"../assets/js/libs",plugins:"../assets/js/plugins",vendor:"../assets/vendor",lodash:"../assets/js/libs/lodash",backbone:"../assets/js/libs/backbone",zeega:"../assets/js/zeega",zeegaplayer:"../assets/vendor/zeegaplayer/dist/debug/zeega",modernizr:"../assets/js/libs/modernizr"},shim:{backbone:{deps:["lodash"],exports:"Backbone"},"plugins/backbone.layoutmanager":["backbone"],zeegaplayer:["backbone"],modernizr:{exports:"Modernizr"}}}),define("config",function(){});